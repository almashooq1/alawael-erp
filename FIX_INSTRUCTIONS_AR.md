# حل مشكلة إغلاق VS Code القسري

## المشكلة الموجودة

PowerShell معطل تماماً - جميع الأوامر الأساسية لا تعمل بسبب:

1. **ملف profile معطول** في مجلد المستندات
2. **متغيرات بيئة معطولة** (PSModulePath)
3. **ملفات تكوين معطولة** في npm

## الحل الموصى به (الأسهل)

### الخطوة 1: أغلق VS Code تماماً

- أغلق جميع नوافذ VS Code
- تأكد من عدم وجود processes معلقة

### الخطوة 2: شغّل البرنامج الإصلاحي

**اختر أحد الخيارات:**

#### الخيار أ: الإصلاح الكامل (الأفضل)

```
COMPLETE_POWERSHELL_FIX.ps1
```

- انقر عليه بزر الماوس الأيمن
- اختر "Run with PowerShell"
- اختر "Yes" إذا سُؤلت عن تشغيل العمل

#### الخيار ب: إصلاح سريع (آمن جداً)

```
MINIMAL_POWERSHELL_FIX.bat
```

- انقر عليه (double click)
- سيُغلق تلقائياً عند الانتهاء

### الخطوة 3: أعد تشغيل جهازك (اختياري لكن مهم)

بعد تشغيل الإصلاح، من الأفضل:

1. إغلاق جميع البرامج
2. إعادة تشغيل الجهاز
3. فتح VS Code من جديد

### الخطوة 4: تحقق من الإصلاح

افتح terminal في VS Code واكتب:

```bash
npm --version
node --version
```

يجب أن تعمل بدون أخطاء.

## إذا استمرت المشكلة

جرب هذه الخطوات:

1. **امسح جميع الـ terminals في VS Code**
   - View → Terminal
   - انقر على سلة المهملات لإغلاق جميع الـ terminals

2. **غيّر default shell**
   - Ctrl + Shift + P
   - اكتب "Terminal: Select Default Shell"
   - اختر "Command Prompt (cmd.exe)"

3. **أعد تشغيل VS Code**

## الملفات المتاحة

| الملف                          | الوصف                    | الاستخدام                               |
| ------------------------------ | ------------------------ | --------------------------------------- |
| COMPLETE_POWERSHELL_FIX.ps1    | إصلاح شامل لـ PowerShell | انقر بالزر الأيمن → Run with PowerShell |
| MINIMAL_POWERSHELL_FIX.bat     | إصلاح سريع باستخدام CMD  | Double click للتشغيل                    |
| FIX_POWERSHELL_MODULE_PATH.bat | إصلاح بسيط جداً          | Double click                            |

## ملاحظات مهمة

✓ **آمن**: جميع this الملفات لا تحذف أي بيانات مهمة  
✓ **عكسي**: يمكنك التراجع عن أي تغييرات بسهولة  
⚠️ **يتطلب إعادة تشغيل**: التغييرات تحتاج VS Code restart

## من يحدث إذا استمرت المشكلة بعد الإصلاح؟

اتصل بـ Support مع نسخ من:

1. نتيجة `npm --version`
2. نتيجة `echo %PSModulePath%`
3. نتيجة `Get-ExecutionPolicy`
