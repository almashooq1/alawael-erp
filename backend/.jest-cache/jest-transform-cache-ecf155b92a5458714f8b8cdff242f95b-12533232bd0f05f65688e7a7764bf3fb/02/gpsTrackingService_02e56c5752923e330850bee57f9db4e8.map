{"version":3,"names":["GPSLocation","require","Driver","GPSTrackingService","recordLocation","driverId","locationData","coordinates","speed","heading","altitude","accuracy","satellites","acceleration","seatbeltStatus","engineRunning","driver","findById","Error","location","type","longitude","latitude","violations","checkViolations","length","alerts","save","lastKnownLocation","timestamp","Date","error","console","maxSpeedAllowed","push","severity","message","totalAccel","Math","sqrt","x","y","z","toFixed","getCurrentLocation","getLatestLocation","getRouteMap","startTime","endTime","locations","getLocationsInTimeRange","totalDistance","i","getDistanceTo","avgSpeed","reduce","acc","loc","map","lat","lon","stats","averageSpeed","maxSpeed","max","l","duration","pointCount","getBehaviorReport","speedViolations","filter","speedLimitViolation","harshAccelerations","harshAcceleration","harshBrakings","harshBraking","sharpTurns","sharpTurn","baseScore","penalties","speedViolation","totalPenalty","Object","values","a","b","behaviorScore","score","grading","getGradeFromScore","speeding","recommendations","generateRecommendations","summary","findNearbyDrivers","maxDistance","findNearby","getFleetStatistics","timeRange","now","setHours","setDate","getDate","setMonth","getMonth","query","$gte","$lte","find","getAverageSpeed","totalLocationsTracked","totalActiveDrivers","Set","size","distanceDriven","module","exports"],"sources":["gpsTrackingService.js"],"sourcesContent":["/**\r\n * GPS Tracking Service\r\n * خدمات تتبع GPS المتقدمة\r\n */\r\n\r\nconst GPSLocation = require('../models/GPSLocation');\r\nconst Driver = require('../models/Driver');\r\n\r\nclass GPSTrackingService {\r\n  /**\r\n   * تسجيل موقع جديد\r\n   */\r\n  static async recordLocation(driverId, locationData) {\r\n    try {\r\n      const {\r\n        coordinates,\r\n        speed,\r\n        heading,\r\n        altitude,\r\n        accuracy,\r\n        satellites,\r\n        acceleration,\r\n        seatbeltStatus,\r\n        engineRunning,\r\n      } = locationData;\r\n\r\n      // التحقق من وجود السائق\r\n      const driver = await Driver.findById(driverId);\r\n      if (!driver) {\r\n        throw new Error('السائق غير موجود');\r\n      }\r\n\r\n      // إنشاء موقع جديد\r\n      const location = new GPSLocation({\r\n        driver: driverId,\r\n        location: {\r\n          type: 'Point',\r\n          coordinates: [coordinates.longitude, coordinates.latitude],\r\n        },\r\n        speed,\r\n        heading,\r\n        altitude,\r\n        accuracy,\r\n        satellites,\r\n        acceleration,\r\n        seatbeltStatus,\r\n        engineRunning,\r\n      });\r\n\r\n      // التحقق من انتهاكات\r\n      const violations = this.checkViolations(location);\r\n\r\n      // إضافة التنبيهات\r\n      if (violations.length > 0) {\r\n        location.alerts = violations;\r\n      }\r\n\r\n      // حفظ الموقع\r\n      await location.save();\r\n\r\n      // تحديث آخر موقع معروف للسائق\r\n      driver.lastKnownLocation = {\r\n        coordinates: [coordinates.longitude, coordinates.latitude],\r\n        timestamp: new Date(),\r\n        speed,\r\n      };\r\n\r\n      await driver.save();\r\n\r\n      return location;\r\n    } catch (error) {\r\n      console.error('خطأ في تسجيل الموقع:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * التحقق من الانتهاكات والتنبيهات\r\n   */\r\n  static checkViolations(location) {\r\n    const violations = [];\r\n\r\n    // 1. فحص انتهاك السرعة\r\n    if (location.speed > location.maxSpeedAllowed) {\r\n      violations.push({\r\n        type: 'speeding',\r\n        severity: location.speed > location.maxSpeedAllowed * 1.5 ? 'critical' : 'high',\r\n        message: `تجاوز السرعة: ${location.speed} كم/س (الحد: ${location.maxSpeedAllowed} كم/س)`,\r\n      });\r\n    }\r\n\r\n    // 2. فحص التسارع الحاد\r\n    if (location.acceleration) {\r\n      const totalAccel = Math.sqrt(\r\n        location.acceleration.x ** 2 +\r\n          location.acceleration.y ** 2 +\r\n          location.acceleration.z ** 2\r\n      );\r\n\r\n      if (totalAccel > 0.5) {\r\n        violations.push({\r\n          type: 'harsh_acceleration',\r\n          severity: 'medium',\r\n          message: `تسارع حاد: ${totalAccel.toFixed(2)} G`,\r\n        });\r\n      }\r\n    }\r\n\r\n    // 3. فحص حزام الأمان\r\n    if (location.seatbeltStatus === 'unfastened' && location.engineRunning) {\r\n      violations.push({\r\n        type: 'seatbelt_unbuckled',\r\n        severity: 'high',\r\n        message: 'حزام الأمان غير مثبت',\r\n      });\r\n    }\r\n\r\n    return violations;\r\n  }\r\n\r\n  /**\r\n   * الحصول على الموقع الحالي\r\n   */\r\n  static async getCurrentLocation(driverId) {\r\n    try {\r\n      return await GPSLocation.getLatestLocation(driverId);\r\n    } catch (error) {\r\n      console.error('خطأ في جلب الموقع الحالي:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على خريطة المسار\r\n   */\r\n  static async getRouteMap(driverId, startTime, endTime) {\r\n    try {\r\n      const locations = await GPSLocation.getLocationsInTimeRange(\r\n        driverId,\r\n        startTime,\r\n        endTime\r\n      );\r\n\r\n      if (locations.length === 0) {\r\n        return null;\r\n      }\r\n\r\n      // حساب المسافة الكلية\r\n      let totalDistance = 0;\r\n      for (let i = 0; i < locations.length - 1; i++) {\r\n        totalDistance += locations[i].getDistanceTo(locations[i + 1]);\r\n      }\r\n\r\n      // حساب متوسط السرعة\r\n      const avgSpeed = locations.reduce((acc, loc) => acc + loc.speed, 0) / locations.length;\r\n\r\n      return {\r\n        locations: locations.map((loc) => ({\r\n          lat: loc.lat,\r\n          lon: loc.lon,\r\n          speed: loc.speed,\r\n          timestamp: loc.timestamp,\r\n        })),\r\n        stats: {\r\n          totalDistance: totalDistance.toFixed(2),\r\n          averageSpeed: avgSpeed.toFixed(2),\r\n          maxSpeed: Math.max(...locations.map((l) => l.speed)),\r\n          duration: (locations[locations.length - 1].timestamp - locations[0].timestamp) / 1000 / 60,\r\n          pointCount: locations.length,\r\n        },\r\n      };\r\n    } catch (error) {\r\n      console.error('خطأ في جلب خريطة المسار:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على تقرير السلوك\r\n   */\r\n  static async getBehaviorReport(driverId, startTime, endTime) {\r\n    try {\r\n      const locations = await GPSLocation.getLocationsInTimeRange(\r\n        driverId,\r\n        startTime,\r\n        endTime\r\n      );\r\n\r\n      if (locations.length === 0) {\r\n        throw new Error('لا توجد بيانات علمية');\r\n      }\r\n\r\n      // حساب الإحصائيات\r\n      const speedViolations = locations.filter((l) => l.speedLimitViolation).length;\r\n      const harshAccelerations = locations.filter((l) => l.harshAcceleration).length;\r\n      const harshBrakings = locations.filter((l) => l.harshBraking).length;\r\n      const sharpTurns = locations.filter((l) => l.sharpTurn).length;\r\n\r\n      // حساب درجة السلوك\r\n      const baseScore = 100;\r\n      const penalties = {\r\n        speedViolation: speedViolations * 2,\r\n        harshAcceleration: harshAccelerations * 1,\r\n        harshBraking: harshBrakings * 1,\r\n        sharpTurn: sharpTurns * 1.5,\r\n      };\r\n\r\n      const totalPenalty = Object.values(penalties).reduce((a, b) => a + b, 0);\r\n      const behaviorScore = Math.max(0, 100 - totalPenalty);\r\n\r\n      return {\r\n        score: behaviorScore,\r\n        grading: this.getGradeFromScore(behaviorScore),\r\n        violations: {\r\n          speeding: speedViolations,\r\n          harshAcceleration: harshAccelerations,\r\n          harshBraking: harshBrakings,\r\n          sharpTurn: sharpTurns,\r\n        },\r\n        recommendations: this.generateRecommendations(behaviorScore, penalties),\r\n        summary: `السائق لديه سلوك ${this.getGradeFromScore(behaviorScore)} على الطريق`,\r\n      };\r\n    } catch (error) {\r\n      console.error('خطأ في جلب تقرير السلوك:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على درجة من النقاط\r\n   */\r\n  static getGradeFromScore(score) {\r\n    if (score >= 90) return 'ممتاز';\r\n    if (score >= 80) return 'جيد جداً';\r\n    if (score >= 70) return 'جيد';\r\n    if (score >= 60) return 'مقبول';\r\n    return 'ضعيف';\r\n  }\r\n\r\n  /**\r\n   * توليد توصيات التحسين\r\n   */\r\n  static generateRecommendations(score, penalties) {\r\n    const recommendations = [];\r\n\r\n    if (penalties.speedViolation > 0) {\r\n      recommendations.push('التزم بحدود السرعة المقررة');\r\n    }\r\n    if (penalties.harshAcceleration > 0) {\r\n      recommendations.push('تجنب التسارع المفاجئ');\r\n    }\r\n    if (penalties.harshBraking > 0) {\r\n      recommendations.push('قم بالكبح بسلاسة وتدرج');\r\n    }\r\n    if (penalties.sharpTurn > 0) {\r\n      recommendations.push('خذ المنعطفات بحذر وببطء');\r\n    }\r\n\r\n    if (score < 60) {\r\n      recommendations.push('يُنصح بحضور برنامج تدريب السلامة');\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  /**\r\n   * البحث عن السائقين بالقرب من موقع\r\n   */\r\n  static async findNearbyDrivers(longitude, latitude, maxDistance = 1000) {\r\n    try {\r\n      return await GPSLocation.findNearby(longitude, latitude, maxDistance);\r\n    } catch (error) {\r\n      console.error('خطأ في البحث عن السائقين:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على إحصائيات الأسطول\r\n   */\r\n  static async getFleetStatistics(driverId = null, timeRange = 'today') {\r\n    try {\r\n      const now = new Date();\r\n      let startTime = new Date();\r\n\r\n      // تحديد نطاق الوقت\r\n      if (timeRange === 'today') {\r\n        startTime.setHours(0, 0, 0, 0);\r\n      } else if (timeRange === 'week') {\r\n        startTime.setDate(now.getDate() - 7);\r\n      } else if (timeRange === 'month') {\r\n        startTime.setMonth(now.getMonth() - 1);\r\n      }\r\n\r\n      let query = { timestamp: { $gte: startTime, $lte: now } };\r\n      if (driverId) {\r\n        query.driver = driverId;\r\n      }\r\n\r\n      // حساب الإحصائيات\r\n      const locations = await GPSLocation.find(query);\r\n      const avgSpeed = await GPSLocation.getAverageSpeed(driverId, startTime, now);\r\n\r\n      return {\r\n        totalLocationsTracked: locations.length,\r\n        totalActiveDrivers: new Set(locations.map((l) => l.driver)).size,\r\n        averageSpeed: avgSpeed?.averageSpeed?.toFixed(2) || 0,\r\n        maxSpeed: avgSpeed?.maxSpeed || 0,\r\n        speedViolations: locations.filter((l) => l.speedLimitViolation).length,\r\n        totalDistance: locations.reduce((acc, loc) => acc + (loc.distanceDriven || 0), 0).toFixed(2),\r\n        timeRange,\r\n      };\r\n    } catch (error) {\r\n      console.error('خطأ في جلب إحصائيات الأسطول:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = GPSTrackingService;\r\n"],"mappings":"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","ignoreList":[]}