7e15127240556ad0fd26501318cebc54
/**
 * =====================================================
 * ADVANCED VALIDATION MIDDLEWARE - Phase 6
 * =====================================================
 * Comprehensive input validation for all endpoints
 */

const {
  ApiError
} = require('../utils/apiResponse');

// ==================== VALIDATORS ====================

/**
 * Email validation
 */
const isEmail = value => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(value || '');
};

/**
 * Password strength validation
 */
const isStrongPassword = password => {
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
  return passwordRegex.test(password);
};

/**
 * Phone number validation
 */
const isPhoneNumber = phone => {
  const phoneRegex = /^[\d\s\-\+\(\)]+$/;
  return phoneRegex.test(phone) && phone.replace(/\D/g, '').length >= 10;
};

/**
 * URL validation
 */
const isValidUrl = url => {
  try {
    return Boolean(new URL(url));
  } catch (_e) {
    return false;
  }
};

/**
 * ID validation (MongoDB ObjectId)
 */
const isValidObjectId = id => {
  return /^[0-9a-f]{24}$/.test(id);
};

// ==================== SANITIZERS ====================

/**
 * Sanitize string input
 */
const sanitizeString = str => {
  if (!str) return '';
  return String(str).trim().replace(/[<>\"'&]/g, char => {
    const escape = {
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '&': '&amp;'
    };
    return escape[char];
  });
};

/**
 * Sanitize email
 */
const sanitizeEmail = email => {
  return String(email || '').toLowerCase().trim();
};

/**
 * Sanitize request body
 */
const sanitizeBody = obj => {
  const sanitized = {};
  for (const [key, value] of Object.entries(obj)) {
    if (typeof value === 'string') {
      sanitized[key] = sanitizeString(value);
    } else if (typeof value === 'object' && value !== null) {
      sanitized[key] = sanitizeBody(value);
    } else {
      sanitized[key] = value;
    }
  }
  return sanitized;
};

// ==================== VALIDATION MIDDLEWARE ====================

/**
 * Registration validation
 */
const validateRegistration = (req, res, next) => {
  try {
    const {
      name,
      email,
      password,
      confirmPassword
    } = req.body || {};

    // Required fields
    if (!name || !email || !password) {
      return res.status(400).json({
        success: false,
        error: 'name, email, and password are required',
        errors: {
          name: !name ? 'Name is required' : undefined,
          email: !email ? 'Email is required' : undefined,
          password: !password ? 'Password is required' : undefined
        }
      });
    }

    // Email validation
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format',
        errors: {
          email: 'Please provide a valid email address'
        }
      });
    }

    // Password length
    if (String(password).length < 8) {
      return res.status(400).json({
        success: false,
        error: 'Password must be at least 8 characters',
        errors: {
          password: 'Password must have at least 8 characters'
        }
      });
    }

    // Confirm password
    if (confirmPassword && password !== confirmPassword) {
      return res.status(400).json({
        success: false,
        error: 'Passwords do not match',
        errors: {
          confirmPassword: 'Passwords must match'
        }
      });
    }

    // Sanitize inputs
    req.body.name = sanitizeString(name);
    req.body.email = sanitizeEmail(email);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Login validation
 */
const validateLogin = (req, res, next) => {
  try {
    const {
      email,
      password
    } = req.body || {};
    if (!email || !password) {
      return res.status(400).json({
        success: false,
        error: 'email and password are required',
        errors: {
          email: !email ? 'Email is required' : undefined,
          password: !password ? 'Password is required' : undefined
        }
      });
    }
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format',
        errors: {
          email: 'Please provide a valid email address'
        }
      });
    }

    // Sanitize
    req.body.email = sanitizeEmail(email);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Create user validation
 */
const validateCreateUser = (req, res, next) => {
  try {
    const {
      name,
      email,
      role,
      department
    } = req.body || {};
    if (!name || !email || !role) {
      return res.status(400).json({
        success: false,
        error: 'name, email, and role are required'
      });
    }
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format'
      });
    }
    const validRoles = ['admin', 'manager', 'employee', 'viewer'];
    if (!validRoles.includes(role)) {
      return res.status(400).json({
        success: false,
        error: `Invalid role. Must be one of: ${validRoles.join(', ')}`
      });
    }

    // Sanitize
    req.body.name = sanitizeString(name);
    req.body.email = sanitizeEmail(email);
    if (department) req.body.department = sanitizeString(department);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Validate ID parameter
 */
const validateId = (req, res, next) => {
  const {
    id
  } = req.params;
  if (!id) {
    return res.status(400).json({
      success: false,
      error: 'ID parameter is required'
    });
  }
  if (!isValidObjectId(id)) {
    return res.status(400).json({
      success: false,
      error: 'Invalid ID format'
    });
  }
  next();
};

/**
 * Validate pagination
 */
const validatePagination = (req, res, next) => {
  const {
    page = 1,
    limit = 10
  } = req.query;
  const pageNum = parseInt(page);
  const limitNum = parseInt(limit);
  if (isNaN(pageNum) || pageNum < 1) {
    return res.status(400).json({
      success: false,
      error: 'Invalid page number'
    });
  }
  if (isNaN(limitNum) || limitNum < 1 || limitNum > 100) {
    return res.status(400).json({
      success: false,
      error: 'Invalid limit. Must be between 1 and 100'
    });
  }
  req.pagination = {
    page: pageNum,
    limit: limitNum,
    skip: (pageNum - 1) * limitNum
  };
  next();
};
module.exports = {
  // Validators
  isEmail,
  isStrongPassword,
  isPhoneNumber,
  isValidUrl,
  isValidObjectId,
  // Sanitizers
  sanitizeString,
  sanitizeEmail,
  sanitizeBody,
  // Middleware
  validateRegistration,
  validateLogin,
  validateCreateUser,
  validateId,
  validatePagination
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcGlFcnJvciIsInJlcXVpcmUiLCJpc0VtYWlsIiwidmFsdWUiLCJlbWFpbFJlZ2V4IiwidGVzdCIsImlzU3Ryb25nUGFzc3dvcmQiLCJwYXNzd29yZCIsInBhc3N3b3JkUmVnZXgiLCJpc1Bob25lTnVtYmVyIiwicGhvbmUiLCJwaG9uZVJlZ2V4IiwicmVwbGFjZSIsImxlbmd0aCIsImlzVmFsaWRVcmwiLCJ1cmwiLCJCb29sZWFuIiwiVVJMIiwiX2UiLCJpc1ZhbGlkT2JqZWN0SWQiLCJpZCIsInNhbml0aXplU3RyaW5nIiwic3RyIiwiU3RyaW5nIiwidHJpbSIsImNoYXIiLCJlc2NhcGUiLCJzYW5pdGl6ZUVtYWlsIiwiZW1haWwiLCJ0b0xvd2VyQ2FzZSIsInNhbml0aXplQm9keSIsIm9iaiIsInNhbml0aXplZCIsImtleSIsIk9iamVjdCIsImVudHJpZXMiLCJ2YWxpZGF0ZVJlZ2lzdHJhdGlvbiIsInJlcSIsInJlcyIsIm5leHQiLCJuYW1lIiwiY29uZmlybVBhc3N3b3JkIiwiYm9keSIsInN0YXR1cyIsImpzb24iLCJzdWNjZXNzIiwiZXJyb3IiLCJlcnJvcnMiLCJ1bmRlZmluZWQiLCJtZXNzYWdlIiwidmFsaWRhdGVMb2dpbiIsInZhbGlkYXRlQ3JlYXRlVXNlciIsInJvbGUiLCJkZXBhcnRtZW50IiwidmFsaWRSb2xlcyIsImluY2x1ZGVzIiwiam9pbiIsInZhbGlkYXRlSWQiLCJwYXJhbXMiLCJ2YWxpZGF0ZVBhZ2luYXRpb24iLCJwYWdlIiwibGltaXQiLCJxdWVyeSIsInBhZ2VOdW0iLCJwYXJzZUludCIsImxpbWl0TnVtIiwiaXNOYU4iLCJwYWdpbmF0aW9uIiwic2tpcCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJ2YWxpZGF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiBBRFZBTkNFRCBWQUxJREFUSU9OIE1JRERMRVdBUkUgLSBQaGFzZSA2XHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqIENvbXByZWhlbnNpdmUgaW5wdXQgdmFsaWRhdGlvbiBmb3IgYWxsIGVuZHBvaW50c1xyXG4gKi9cclxuXHJcbmNvbnN0IHsgQXBpRXJyb3IgfSA9IHJlcXVpcmUoJy4uL3V0aWxzL2FwaVJlc3BvbnNlJyk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PSBWQUxJREFUT1JTID09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogRW1haWwgdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgaXNFbWFpbCA9ICh2YWx1ZSkgPT4ge1xyXG4gIGNvbnN0IGVtYWlsUmVnZXggPSAvXlteXFxzQF0rQFteXFxzQF0rXFwuW15cXHNAXSskLztcclxuICByZXR1cm4gZW1haWxSZWdleC50ZXN0KHZhbHVlIHx8ICcnKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBQYXNzd29yZCBzdHJlbmd0aCB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCBpc1N0cm9uZ1Bhc3N3b3JkID0gKHBhc3N3b3JkKSA9PiB7XHJcbiAgY29uc3QgcGFzc3dvcmRSZWdleCA9IC9eKD89LipbYS16XSkoPz0uKltBLVpdKSg/PS4qXFxkKSg/PS4qW0AkISUqPyZdKVtBLVphLXpcXGRAJCElKj8mXXs4LH0kLztcclxuICByZXR1cm4gcGFzc3dvcmRSZWdleC50ZXN0KHBhc3N3b3JkKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBQaG9uZSBudW1iZXIgdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgaXNQaG9uZU51bWJlciA9IChwaG9uZSkgPT4ge1xyXG4gIGNvbnN0IHBob25lUmVnZXggPSAvXltcXGRcXHNcXC1cXCtcXChcXCldKyQvO1xyXG4gIHJldHVybiBwaG9uZVJlZ2V4LnRlc3QocGhvbmUpICYmIHBob25lLnJlcGxhY2UoL1xcRC9nLCAnJykubGVuZ3RoID49IDEwO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVSTCB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCBpc1ZhbGlkVXJsID0gKHVybCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gQm9vbGVhbihuZXcgVVJMKHVybCkpO1xyXG4gIH0gY2F0Y2ggKF9lKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIElEIHZhbGlkYXRpb24gKE1vbmdvREIgT2JqZWN0SWQpXHJcbiAqL1xyXG5jb25zdCBpc1ZhbGlkT2JqZWN0SWQgPSAoaWQpID0+IHtcclxuICByZXR1cm4gL15bMC05YS1mXXsyNH0kLy50ZXN0KGlkKTtcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09IFNBTklUSVpFUlMgPT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBTYW5pdGl6ZSBzdHJpbmcgaW5wdXRcclxuICovXHJcbmNvbnN0IHNhbml0aXplU3RyaW5nID0gKHN0cikgPT4ge1xyXG4gIGlmICghc3RyKSByZXR1cm4gJyc7XHJcbiAgcmV0dXJuIFN0cmluZyhzdHIpLnRyaW0oKS5yZXBsYWNlKC9bPD5cXFwiJyZdL2csIChjaGFyKSA9PiB7XHJcbiAgICBjb25zdCBlc2NhcGUgPSB7ICc8JzogJyZsdDsnLCAnPic6ICcmZ3Q7JywgJ1wiJzogJyZxdW90OycsIFwiJ1wiOiAnJiN4Mjc7JywgJyYnOiAnJmFtcDsnIH07XHJcbiAgICByZXR1cm4gZXNjYXBlW2NoYXJdO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNhbml0aXplIGVtYWlsXHJcbiAqL1xyXG5jb25zdCBzYW5pdGl6ZUVtYWlsID0gKGVtYWlsKSA9PiB7XHJcbiAgcmV0dXJuIFN0cmluZyhlbWFpbCB8fCAnJykudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2FuaXRpemUgcmVxdWVzdCBib2R5XHJcbiAqL1xyXG5jb25zdCBzYW5pdGl6ZUJvZHkgPSAob2JqKSA9PiB7XHJcbiAgY29uc3Qgc2FuaXRpemVkID0ge307XHJcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMob2JqKSkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZVN0cmluZyh2YWx1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUJvZHkodmFsdWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHNhbml0aXplZDtcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09IFZBTElEQVRJT04gTUlERExFV0FSRSA9PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFJlZ2lzdHJhdGlvbiB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZVJlZ2lzdHJhdGlvbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwYXNzd29yZCwgY29uZmlybVBhc3N3b3JkIH0gPSByZXEuYm9keSB8fCB7fTtcclxuXHJcbiAgICAvLyBSZXF1aXJlZCBmaWVsZHNcclxuICAgIGlmICghbmFtZSB8fCAhZW1haWwgfHwgIXBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICduYW1lLCBlbWFpbCwgYW5kIHBhc3N3b3JkIGFyZSByZXF1aXJlZCcsXHJcbiAgICAgICAgZXJyb3JzOiB7XHJcbiAgICAgICAgICBuYW1lOiAhbmFtZSA/ICdOYW1lIGlzIHJlcXVpcmVkJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIGVtYWlsOiAhZW1haWwgPyAnRW1haWwgaXMgcmVxdWlyZWQnIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgcGFzc3dvcmQ6ICFwYXNzd29yZCA/ICdQYXNzd29yZCBpcyByZXF1aXJlZCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW1haWwgdmFsaWRhdGlvblxyXG4gICAgaWYgKCFpc0VtYWlsKGVtYWlsKSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCBlbWFpbCBmb3JtYXQnLFxyXG4gICAgICAgIGVycm9yczogeyBlbWFpbDogJ1BsZWFzZSBwcm92aWRlIGEgdmFsaWQgZW1haWwgYWRkcmVzcycgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGFzc3dvcmQgbGVuZ3RoXHJcbiAgICBpZiAoU3RyaW5nKHBhc3N3b3JkKS5sZW5ndGggPCA4KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycycsXHJcbiAgICAgICAgZXJyb3JzOiB7IHBhc3N3b3JkOiAnUGFzc3dvcmQgbXVzdCBoYXZlIGF0IGxlYXN0IDggY2hhcmFjdGVycycgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29uZmlybSBwYXNzd29yZFxyXG4gICAgaWYgKGNvbmZpcm1QYXNzd29yZCAmJiBwYXNzd29yZCAhPT0gY29uZmlybVBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQYXNzd29yZHMgZG8gbm90IG1hdGNoJyxcclxuICAgICAgICBlcnJvcnM6IHsgY29uZmlybVBhc3N3b3JkOiAnUGFzc3dvcmRzIG11c3QgbWF0Y2gnIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNhbml0aXplIGlucHV0c1xyXG4gICAgcmVxLmJvZHkubmFtZSA9IHNhbml0aXplU3RyaW5nKG5hbWUpO1xyXG4gICAgcmVxLmJvZHkuZW1haWwgPSBzYW5pdGl6ZUVtYWlsKGVtYWlsKTtcclxuXHJcbiAgICBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBlcnJvcicsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogTG9naW4gdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgdmFsaWRhdGVMb2dpbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHkgfHwge307XHJcblxyXG4gICAgaWYgKCFlbWFpbCB8fCAhcGFzc3dvcmQpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ2VtYWlsIGFuZCBwYXNzd29yZCBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICAgIGVycm9yczoge1xyXG4gICAgICAgICAgZW1haWw6ICFlbWFpbCA/ICdFbWFpbCBpcyByZXF1aXJlZCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBwYXNzd29yZDogIXBhc3N3b3JkID8gJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzRW1haWwoZW1haWwpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIGZvcm1hdCcsXHJcbiAgICAgICAgZXJyb3JzOiB7IGVtYWlsOiAnUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTYW5pdGl6ZVxyXG4gICAgcmVxLmJvZHkuZW1haWwgPSBzYW5pdGl6ZUVtYWlsKGVtYWlsKTtcclxuXHJcbiAgICBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBlcnJvcicsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHVzZXIgdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgdmFsaWRhdGVDcmVhdGVVc2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgbmFtZSwgZW1haWwsIHJvbGUsIGRlcGFydG1lbnQgfSA9IHJlcS5ib2R5IHx8IHt9O1xyXG5cclxuICAgIGlmICghbmFtZSB8fCAhZW1haWwgfHwgIXJvbGUpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ25hbWUsIGVtYWlsLCBhbmQgcm9sZSBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzRW1haWwoZW1haWwpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIGZvcm1hdCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHZhbGlkUm9sZXMgPSBbJ2FkbWluJywgJ21hbmFnZXInLCAnZW1wbG95ZWUnLCAndmlld2VyJ107XHJcbiAgICBpZiAoIXZhbGlkUm9sZXMuaW5jbHVkZXMocm9sZSkpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogYEludmFsaWQgcm9sZS4gTXVzdCBiZSBvbmUgb2Y6ICR7dmFsaWRSb2xlcy5qb2luKCcsICcpfWAsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNhbml0aXplXHJcbiAgICByZXEuYm9keS5uYW1lID0gc2FuaXRpemVTdHJpbmcobmFtZSk7XHJcbiAgICByZXEuYm9keS5lbWFpbCA9IHNhbml0aXplRW1haWwoZW1haWwpO1xyXG4gICAgaWYgKGRlcGFydG1lbnQpIHJlcS5ib2R5LmRlcGFydG1lbnQgPSBzYW5pdGl6ZVN0cmluZyhkZXBhcnRtZW50KTtcclxuXHJcbiAgICBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBlcnJvcicsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgSUQgcGFyYW1ldGVyXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZUlkID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICBcclxuICBpZiAoIWlkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdJRCBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlzVmFsaWRPYmplY3RJZChpZCkpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludmFsaWQgSUQgZm9ybWF0JyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbmV4dCgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHBhZ2luYXRpb25cclxuICovXHJcbmNvbnN0IHZhbGlkYXRlUGFnaW5hdGlvbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IHsgcGFnZSA9IDEsIGxpbWl0ID0gMTAgfSA9IHJlcS5xdWVyeTtcclxuXHJcbiAgY29uc3QgcGFnZU51bSA9IHBhcnNlSW50KHBhZ2UpO1xyXG4gIGNvbnN0IGxpbWl0TnVtID0gcGFyc2VJbnQobGltaXQpO1xyXG5cclxuICBpZiAoaXNOYU4ocGFnZU51bSkgfHwgcGFnZU51bSA8IDEpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludmFsaWQgcGFnZSBudW1iZXInLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoaXNOYU4obGltaXROdW0pIHx8IGxpbWl0TnVtIDwgMSB8fCBsaW1pdE51bSA+IDEwMCkge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnSW52YWxpZCBsaW1pdC4gTXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDEwMCcsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlcS5wYWdpbmF0aW9uID0ge1xyXG4gICAgcGFnZTogcGFnZU51bSxcclxuICAgIGxpbWl0OiBsaW1pdE51bSxcclxuICAgIHNraXA6IChwYWdlTnVtIC0gMSkgKiBsaW1pdE51bSxcclxuICB9O1xyXG5cclxuICBuZXh0KCk7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAvLyBWYWxpZGF0b3JzXHJcbiAgaXNFbWFpbCxcclxuICBpc1N0cm9uZ1Bhc3N3b3JkLFxyXG4gIGlzUGhvbmVOdW1iZXIsXHJcbiAgaXNWYWxpZFVybCxcclxuICBpc1ZhbGlkT2JqZWN0SWQsXHJcblxyXG4gIC8vIFNhbml0aXplcnNcclxuICBzYW5pdGl6ZVN0cmluZyxcclxuICBzYW5pdGl6ZUVtYWlsLFxyXG4gIHNhbml0aXplQm9keSxcclxuXHJcbiAgLy8gTWlkZGxld2FyZVxyXG4gIHZhbGlkYXRlUmVnaXN0cmF0aW9uLFxyXG4gIHZhbGlkYXRlTG9naW4sXHJcbiAgdmFsaWRhdGVDcmVhdGVVc2VyLFxyXG4gIHZhbGlkYXRlSWQsXHJcbiAgdmFsaWRhdGVQYWdpbmF0aW9uLFxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNO0VBQUVBO0FBQVMsQ0FBQyxHQUFHQyxPQUFPLENBQUMsc0JBQXNCLENBQUM7O0FBRXBEOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU1DLE9BQU8sR0FBSUMsS0FBSyxJQUFLO0VBQ3pCLE1BQU1DLFVBQVUsR0FBRyw0QkFBNEI7RUFDL0MsT0FBT0EsVUFBVSxDQUFDQyxJQUFJLENBQUNGLEtBQUssSUFBSSxFQUFFLENBQUM7QUFDckMsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxNQUFNRyxnQkFBZ0IsR0FBSUMsUUFBUSxJQUFL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