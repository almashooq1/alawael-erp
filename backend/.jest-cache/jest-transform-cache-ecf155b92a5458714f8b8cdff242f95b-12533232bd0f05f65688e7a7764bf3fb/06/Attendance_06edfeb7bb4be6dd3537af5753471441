200c235920b0ab443ffb0f345a47dabd
/**
 * Attendance Model (HR)
 * Modular, extensible attendance record for HR system
 */
const mongoose = require('mongoose');
const AttendanceSchema = new mongoose.Schema({
  employeeId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Employee',
    required: true,
    index: true
  },
  checkInTime: {
    type: Date,
    required: true
  },
  checkOutTime: Date,
  checkInLocation: {
    latitude: Number,
    longitude: Number,
    address: String,
    accuracy: Number
  },
  checkOutLocation: {
    latitude: Number,
    longitude: Number,
    address: String,
    accuracy: Number
  },
  checkInPhoto: String,
  checkOutPhoto: String,
  status: {
    type: String,
    enum: ['حاضر', 'غياب', 'متأخر', 'إجازة', 'عطلة', 'مرض', 'وقت مرن'],
    default: 'حاضر',
    index: true
  },
  latenessMinutes: {
    type: Number,
    default: 0
  },
  overtimeMinutes: {
    type: Number,
    default: 0
  },
  notes: String,
  date: {
    type: Date,
    required: true,
    index: true
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  updatedAt: {
    type: Date,
    default: Date.now
  }
});
AttendanceSchema.index({
  employeeId: 1,
  date: -1
});
AttendanceSchema.index({
  date: -1,
  status: 1
});
AttendanceSchema.index({
  employeeId: 1,
  checkInTime: -1
});
module.exports = mongoose.model('Attendance', AttendanceSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJBdHRlbmRhbmNlU2NoZW1hIiwiU2NoZW1hIiwiZW1wbG95ZWVJZCIsInR5cGUiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwicmVxdWlyZWQiLCJpbmRleCIsImNoZWNrSW5UaW1lIiwiRGF0ZSIsImNoZWNrT3V0VGltZSIsImNoZWNrSW5Mb2NhdGlvbiIsImxhdGl0dWRlIiwiTnVtYmVyIiwibG9uZ2l0dWRlIiwiYWRkcmVzcyIsIlN0cmluZyIsImFjY3VyYWN5IiwiY2hlY2tPdXRMb2NhdGlvbiIsImNoZWNrSW5QaG90byIsImNoZWNrT3V0UGhvdG8iLCJzdGF0dXMiLCJlbnVtIiwiZGVmYXVsdCIsImxhdGVuZXNzTWludXRlcyIsIm92ZXJ0aW1lTWludXRlcyIsIm5vdGVzIiwiZGF0ZSIsImNyZWF0ZWRBdCIsIm5vdyIsInVwZGF0ZWRBdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VzIjpbIkF0dGVuZGFuY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEF0dGVuZGFuY2UgTW9kZWwgKEhSKVxyXG4gKiBNb2R1bGFyLCBleHRlbnNpYmxlIGF0dGVuZGFuY2UgcmVjb3JkIGZvciBIUiBzeXN0ZW1cclxuICovXHJcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuXHJcbmNvbnN0IEF0dGVuZGFuY2VTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBlbXBsb3llZUlkOiB7XHJcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICByZWY6ICdFbXBsb3llZScsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIGluZGV4OiB0cnVlLFxyXG4gIH0sXHJcbiAgY2hlY2tJblRpbWU6IHsgdHlwZTogRGF0ZSwgcmVxdWlyZWQ6IHRydWUgfSxcclxuICBjaGVja091dFRpbWU6IERhdGUsXHJcbiAgY2hlY2tJbkxvY2F0aW9uOiB7XHJcbiAgICBsYXRpdHVkZTogTnVtYmVyLFxyXG4gICAgbG9uZ2l0dWRlOiBOdW1iZXIsXHJcbiAgICBhZGRyZXNzOiBTdHJpbmcsXHJcbiAgICBhY2N1cmFjeTogTnVtYmVyLFxyXG4gIH0sXHJcbiAgY2hlY2tPdXRMb2NhdGlvbjoge1xyXG4gICAgbGF0aXR1ZGU6IE51bWJlcixcclxuICAgIGxvbmdpdHVkZTogTnVtYmVyLFxyXG4gICAgYWRkcmVzczogU3RyaW5nLFxyXG4gICAgYWNjdXJhY3k6IE51bWJlcixcclxuICB9LFxyXG4gIGNoZWNrSW5QaG90bzogU3RyaW5nLFxyXG4gIGNoZWNrT3V0UGhvdG86IFN0cmluZyxcclxuICBzdGF0dXM6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIGVudW06IFsn2K3Yp9i22LEnLCAn2LrZitin2KgnLCAn2YXYqtij2K7YsScsICfYpdis2KfYstipJywgJ9i52LfZhNipJywgJ9mF2LHYticsICfZiNmC2Kog2YXYsdmGJ10sXHJcbiAgICBkZWZhdWx0OiAn2K3Yp9i22LEnLFxyXG4gICAgaW5kZXg6IHRydWUsXHJcbiAgfSxcclxuICBsYXRlbmVzc01pbnV0ZXM6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH0sXHJcbiAgb3ZlcnRpbWVNaW51dGVzOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxyXG4gIG5vdGVzOiBTdHJpbmcsXHJcbiAgZGF0ZTogeyB0eXBlOiBEYXRlLCByZXF1aXJlZDogdHJ1ZSwgaW5kZXg6IHRydWUgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxuICB1cGRhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxufSk7XHJcblxyXG5BdHRlbmRhbmNlU2NoZW1hLmluZGV4KHsgZW1wbG95ZWVJZDogMSwgZGF0ZTogLTEgfSk7XHJcbkF0dGVuZGFuY2VTY2hlbWEuaW5kZXgoeyBkYXRlOiAtMSwgc3RhdHVzOiAxIH0pO1xyXG5BdHRlbmRhbmNlU2NoZW1hLmluZGV4KHsgZW1wbG95ZWVJZDogMSwgY2hlY2tJblRpbWU6IC0xIH0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbCgnQXR0ZW5kYW5jZScsIEF0dGVuZGFuY2VTY2hlbWEpO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBRXBDLE1BQU1DLGdCQUFnQixHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBTSxDQUFDO0VBQzNDQyxVQUFVLEVBQUU7SUFDVkMsSUFBSSxFQUFFTCxRQUFRLENBQUNHLE1BQU0sQ0FBQ0csS0FBSyxDQUFDQyxRQUFRO0lBQ3BDQyxHQUFHLEVBQUUsVUFBVTtJQUNmQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxLQUFLLEVBQUU7RUFDVCxDQUFDO0VBQ0RDLFdBQVcsRUFBRTtJQUFFTixJQUFJLEVBQUVPLElBQUk7SUFBRUgsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUMzQ0ksWUFBWSxFQUFFRCxJQUFJO0VBQ2xCRSxlQUFlLEVBQUU7SUFDZkMsUUFBUSxFQUFFQyxNQUFNO0lBQ2hCQyxTQUFTLEVBQUVELE1BQU07SUFDakJFLE9BQU8sRUFBRUMsTUFBTTtJQUNmQyxRQUFRLEVBQUVKO0VBQ1osQ0FBQztFQUNESyxnQkFBZ0IsRUFBRTtJQUNoQk4sUUFBUSxFQUFFQyxNQUFNO0lBQ2hCQyxTQUFTLEVBQUVELE1BQU07SUFDakJFLE9BQU8sRUFBRUMsTUFBTTtJQUNmQyxRQUFRLEVBQUVKO0VBQ1osQ0FBQztFQUNETSxZQUFZLEVBQUVILE1BQU07RUFDcEJJLGFBQWEsRUFBRUosTUFBTTtFQUNyQkssTUFBTSxFQUFFO0lBQ05uQixJQUFJLEVBQUVjLE1BQU07SUFDWk0sSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsU0FBUyxDQUFDO0lBQ2xFQyxPQUFPLEVBQUUsTUFBTTtJQUNmaEIsS0FBSyxFQUFFO0VBQ1QsQ0FBQztFQUNEaUIsZUFBZSxFQUFFO0lBQUV0QixJQUFJLEVBQUVXLE1BQU07SUFBRVUsT0FBTyxFQUFFO0VBQUUsQ0FBQztFQUM3Q0UsZUFBZSxFQUFFO0lBQUV2QixJQUFJLEVBQUVXLE1BQU07SUFBRVUsT0FBTyxFQUFFO0VBQUUsQ0FBQztFQUM3Q0csS0FBSyxFQUFFVixNQUFNO0VBQ2JXLElBQUksRUFBRTtJQUFFekIsSUFBSSxFQUFFTyxJQUFJO0lBQUVILFFBQVEsRUFBRSxJQUFJO0lBQUVDLEtBQUssRUFBRTtFQUFLLENBQUM7RUFDakRxQixTQUFTLEVBQUU7SUFBRTFCLElBQUksRUFBRU8sSUFBSTtJQUFFYyxPQUFPLEVBQUVkLElBQUksQ0FBQ29CO0VBQUksQ0FBQztFQUM1Q0MsU0FBUyxFQUFFO0lBQUU1QixJQUFJLEVBQUVPLElBQUk7SUFBRWMsT0FBTyxFQUFFZCxJQUFJLENBQUNvQjtFQUFJO0FBQzdDLENBQUMsQ0FBQztBQUVGOUIsZ0JBQWdCLENBQUNRLEtBQUssQ0FBQztFQUFFTixVQUFVLEVBQUUsQ0FBQztFQUFFMEIsSUFBSSxFQUFFLENBQUM7QUFBRSxDQUFDLENBQUM7QUFDbkQ1QixnQkFBZ0IsQ0FBQ1EsS0FBSyxDQUFDO0VBQUVvQixJQUFJLEVBQUUsQ0FBQyxDQUFDO0VBQUVOLE1BQU0sRUFBRTtBQUFFLENBQUMsQ0FBQztBQUMvQ3RCLGdCQUFnQixDQUFDUSxLQUFLLENBQUM7RUFBRU4sVUFBVSxFQUFFLENBQUM7RUFBRU8sV0FBVyxFQUFFLENBQUM7QUFBRSxDQUFDLENBQUM7QUFFMUR1QixNQUFNLENBQUNDLE9BQU8sR0FBR25DLFFBQVEsQ0FBQ29DLEtBQUssQ0FBQyxZQUFZLEVBQUVsQyxnQkFBZ0IsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==