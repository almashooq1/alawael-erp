{"version":3,"names":["logger","require","ResponseFormatter","constructor","statusCodes","OK","CREATED","ACCEPTED","BAD_REQUEST","UNAUTHORIZED","FORBIDDEN","NOT_FOUND","CONFLICT","INTERNAL_ERROR","SERVICE_UNAVAILABLE","success","data","message","statusCode","timestamp","Date","toISOString","error","errorCode","details","paginated","items","total","page","limit","totalPages","Math","ceil","pagination","hasNextPage","hasPrevPage","list","count","length","created","updated","deleted","validationError","errors","Array","isArray","notFound","resource","unauthorized","forbidden","conflict","serverError","serviceUnavailable","batchOperation","results","failedCount","successful","failed","searchResults","query","analytics","period","getStreamHeaders","filename","formatErrorLog","context","stack","code","module","exports"],"sources":["responseFormatter.js"],"sourcesContent":["/**\n * Response Formatter Service\n * Standardized API responses with consistent formatting\n * Phase 10: Advanced Features\n */\n\nconst logger = require('../utils/logger');\n\nclass ResponseFormatter {\n  constructor() {\n    this.statusCodes = {\n      OK: 200,\n      CREATED: 201,\n      ACCEPTED: 202,\n      BAD_REQUEST: 400,\n      UNAUTHORIZED: 401,\n      FORBIDDEN: 403,\n      NOT_FOUND: 404,\n      CONFLICT: 409,\n      INTERNAL_ERROR: 500,\n      SERVICE_UNAVAILABLE: 503,\n    };\n  }\n\n  /**\n   * Success response\n   */\n  success(data, message = 'Success', statusCode = 200) {\n    return {\n      success: true,\n      statusCode,\n      message,\n      data,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Error response\n   */\n  error(message, errorCode = null, statusCode = 400, details = null) {\n    return {\n      success: false,\n      statusCode,\n      message,\n      errorCode,\n      details,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Paginated response\n   */\n  paginated(items, total, page = 1, limit = 20, message = 'Data retrieved') {\n    const totalPages = Math.ceil(total / limit);\n\n    return {\n      success: true,\n      statusCode: 200,\n      message,\n      data: {\n        items,\n        pagination: {\n          total,\n          page,\n          limit,\n          totalPages,\n          hasNextPage: page < totalPages,\n          hasPrevPage: page > 1,\n        },\n      },\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * List response\n   */\n  list(items, message = 'Items retrieved') {\n    return {\n      success: true,\n      statusCode: 200,\n      message,\n      data: {\n        items,\n        count: items.length,\n      },\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Created response\n   */\n  created(data, message = 'Resource created') {\n    return {\n      success: true,\n      statusCode: 201,\n      message,\n      data,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Updated response\n   */\n  updated(data, message = 'Resource updated') {\n    return {\n      success: true,\n      statusCode: 200,\n      message,\n      data,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Deleted response\n   */\n  deleted(message = 'Resource deleted') {\n    return {\n      success: true,\n      statusCode: 200,\n      message,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Validation error response\n   */\n  validationError(errors, message = 'Validation failed') {\n    return {\n      success: false,\n      statusCode: 400,\n      message,\n      errorCode: 'VALIDATION_ERROR',\n      errors: Array.isArray(errors) ? errors : [errors],\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Not found response\n   */\n  notFound(resource = 'Resource', message = null) {\n    return {\n      success: false,\n      statusCode: 404,\n      message: message || `${resource} not found`,\n      errorCode: 'NOT_FOUND',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Unauthorized response\n   */\n  unauthorized(message = 'Unauthorized access') {\n    return {\n      success: false,\n      statusCode: 401,\n      message,\n      errorCode: 'UNAUTHORIZED',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Forbidden response\n   */\n  forbidden(message = 'Access forbidden') {\n    return {\n      success: false,\n      statusCode: 403,\n      message,\n      errorCode: 'FORBIDDEN',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Conflict response\n   */\n  conflict(message = 'Resource conflict') {\n    return {\n      success: false,\n      statusCode: 409,\n      message,\n      errorCode: 'CONFLICT',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Server error response\n   */\n  serverError(message = 'Internal server error', error = null) {\n    if (error) {\n      logger.error('Server error:', error);\n    }\n\n    return {\n      success: false,\n      statusCode: 500,\n      message,\n      errorCode: 'INTERNAL_ERROR',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Service unavailable response\n   */\n  serviceUnavailable(message = 'Service temporarily unavailable') {\n    return {\n      success: false,\n      statusCode: 503,\n      message,\n      errorCode: 'SERVICE_UNAVAILABLE',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Batch operation response\n   */\n  batchOperation(results, failedCount = 0, message = 'Batch operation completed') {\n    return {\n      success: failedCount === 0,\n      statusCode: failedCount === 0 ? 200 : 207,\n      message,\n      data: {\n        successful: results.length - failedCount,\n        failed: failedCount,\n        total: results.length,\n        results,\n      },\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Search results response\n   */\n  searchResults(results, query, total, message = 'Search completed') {\n    return {\n      success: true,\n      statusCode: 200,\n      message,\n      data: {\n        query,\n        results,\n        count: results.length,\n        total,\n      },\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Analytics response\n   */\n  analytics(data, period = 'unknown', message = 'Analytics data retrieved') {\n    return {\n      success: true,\n      statusCode: 200,\n      message,\n      data: {\n        period,\n        ...data,\n      },\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Stream response headers\n   */\n  getStreamHeaders(filename = 'export') {\n    return {\n      'Content-Type': 'application/octet-stream',\n      'Content-Disposition': `attachment; filename=\"${filename}\"`,\n      'Cache-Control': 'no-cache, no-store, must-revalidate',\n    };\n  }\n\n  /**\n   * Format error for logging\n   */\n  formatErrorLog(error, context = {}) {\n    return {\n      message: error.message,\n      stack: error.stack,\n      code: error.code,\n      context,\n      timestamp: new Date().toISOString(),\n    };\n  }\n}\n\nmodule.exports = new ResponseFormatter();\n"],"mappings":"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","ignoreList":[]}