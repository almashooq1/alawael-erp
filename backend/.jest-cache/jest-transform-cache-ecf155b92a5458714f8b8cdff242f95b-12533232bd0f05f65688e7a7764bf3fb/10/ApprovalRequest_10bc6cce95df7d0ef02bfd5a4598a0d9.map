{"version":3,"names":["mongoose","require","approvalRequestSchema","Schema","requestType","type","String","required","requestRefId","Types","ObjectId","requester","ref","status","enum","default","steps","approver","action","actedAt","Date","comment","currentStep","Number","comments","user","text","createdAt","now","updatedAt","module","exports","model"],"sources":["ApprovalRequest.js"],"sourcesContent":["// ApprovalRequest.js\r\n// نموذج موافقة ذكي للطلبات\r\nconst mongoose = require('mongoose');\r\n\r\nconst approvalRequestSchema = new mongoose.Schema({\r\n  requestType: { type: String, required: true }, // مثال: \"إجازة\"، \"صرف مالي\"، \"تعديل بيانات\"\r\n  requestRefId: { type: mongoose.Schema.Types.ObjectId }, // مرجع للطلب الأصلي\r\n  requester: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: true },\r\n  status: {\r\n    type: String,\r\n    enum: ['pending', 'approved', 'rejected', 'cancelled'],\r\n    default: 'pending',\r\n  },\r\n  steps: [\r\n    {\r\n      approver: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },\r\n      action: { type: String, enum: ['pending', 'approved', 'rejected'], default: 'pending' },\r\n      actedAt: Date,\r\n      comment: String,\r\n    },\r\n  ],\r\n  currentStep: { type: Number, default: 0 },\r\n  comments: [\r\n    {\r\n      user: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },\r\n      text: String,\r\n      createdAt: { type: Date, default: Date.now },\r\n    },\r\n  ],\r\n  createdAt: { type: Date, default: Date.now },\r\n  updatedAt: { type: Date, default: Date.now },\r\n});\r\n\r\nmodule.exports = mongoose.model('ApprovalRequest', approvalRequestSchema);\r\n"],"mappings":"AAAA;AACA;AACA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,qBAAqB,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EAChDC,WAAW,EAAE;IAAEC,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAK,CAAC;EAAE;EAC/CC,YAAY,EAAE;IAAEH,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACM,KAAK,CAACC;EAAS,CAAC;EAAE;EACxDC,SAAS,EAAE;IAAEN,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACM,KAAK,CAACC,QAAQ;IAAEE,GAAG,EAAE,MAAM;IAAEL,QAAQ,EAAE;EAAK,CAAC;EAChFM,MAAM,EAAE;IACNR,IAAI,EAAEC,MAAM;IACZQ,IAAI,EAAE,CAAC,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,WAAW,CAAC;IACtDC,OAAO,EAAE;EACX,CAAC;EACDC,KAAK,EAAE,CACL;IACEC,QAAQ,EAAE;MAAEZ,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACM,KAAK,CAACC,QAAQ;MAAEE,GAAG,EAAE;IAAO,CAAC;IAC/DM,MAAM,EAAE;MAAEb,IAAI,EAAEC,MAAM;MAAEQ,IAAI,EAAE,CAAC,SAAS,EAAE,UAAU,EAAE,UAAU,CAAC;MAAEC,OAAO,EAAE;IAAU,CAAC;IACvFI,OAAO,EAAEC,IAAI;IACbC,OAAO,EAAEf;EACX,CAAC,CACF;EACDgB,WAAW,EAAE;IAAEjB,IAAI,EAAEkB,MAAM;IAAER,OAAO,EAAE;EAAE,CAAC;EACzCS,QAAQ,EAAE,CACR;IACEC,IAAI,EAAE;MAAEpB,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACM,KAAK,CAACC,QAAQ;MAAEE,GAAG,EAAE;IAAO,CAAC;IAC3Dc,IAAI,EAAEpB,MAAM;IACZqB,SAAS,EAAE;MAAEtB,IAAI,EAAEe,IAAI;MAAEL,OAAO,EAAEK,IAAI,CAACQ;IAAI;EAC7C,CAAC,CACF;EACDD,SAAS,EAAE;IAAEtB,IAAI,EAAEe,IAAI;IAAEL,OAAO,EAAEK,IAAI,CAACQ;EAAI,CAAC;EAC5CC,SAAS,EAAE;IAAExB,IAAI,EAAEe,IAAI;IAAEL,OAAO,EAAEK,IAAI,CAACQ;EAAI;AAC7C,CAAC,CAAC;AAEFE,MAAM,CAACC,OAAO,GAAG/B,QAAQ,CAACgC,KAAK,CAAC,iBAAiB,EAAE9B,qBAAqB,CAAC","ignoreList":[]}