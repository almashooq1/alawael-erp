{"version":3,"names":["mongoose","require","transportRouteSchema","Schema","routeName","type","String","required","unique","routeCode","enum","status","default","stops","stopNumber","Number","name","location","coordinates","address","scheduledTime","estimatedDuration","waitTime","passengers","Types","ObjectId","ref","notes","path","totalDistance","averageSpeed","assignedVehicle","assignedDriver","schedule","startDate","Date","endDate","operatingDays","startTime","frequency","optimization","lastOptimized","optimizationScore","suggestedChanges","description","estimatedImprovement","factors","trafficConditions","Boolean","passengerDemand","fuelEfficiency","timeEfficiency","user","pickupStop","dropoffStop","preferences","specialNeeds","seatPreference","capacity","total","current","available","tripStatistics","totalTrips","completedTrips","cancelledTrips","averageDelayMinutes","onTimePercentage","totalPassengersServed","ratings","averageRating","min","max","totalRatings","reviews","rating","comment","date","alerts","severity","message","timestamp","resolved","resolvedAt","isActive","timestamps","index","virtual","get","length","methods","calculateAvailableCapacity","addPassenger","userId","Error","push","pickup","find","s","includes","save","removePassenger","filter","p","equals","forEach","stop","updateTripStatus","delayMinutes","onTimeTrips","Math","floor","totalDelay","set","virtuals","addRating","totalRating","reduce","sum","r","statics","findNearbyRoutes","longitude","latitude","maxDistance","$near","$geometry","$maxDistance","findAvailable","dayOfWeek","getDay","$exists","$gt","module","exports","model"],"sources":["TransportRoute.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst transportRouteSchema = new mongoose.Schema(\r\n  {\r\n    // معلومات أساسية\r\n    routeName: {\r\n      type: String,\r\n      required: true,\r\n      unique: true,\r\n    },\r\n    routeCode: {\r\n      type: String,\r\n      required: true,\r\n      unique: true,\r\n    },\r\n\r\n    // نوع المسار\r\n    type: {\r\n      type: String,\r\n      enum: ['morning', 'afternoon', 'special', 'emergency'],\r\n      required: true,\r\n    },\r\n\r\n    // حالة المسار\r\n    status: {\r\n      type: String,\r\n      enum: ['active', 'inactive', 'suspended', 'maintenance'],\r\n      default: 'active',\r\n    },\r\n\r\n    // نقاط التوقف (محطات)\r\n    stops: [\r\n      {\r\n        stopNumber: {\r\n          type: Number,\r\n          required: true,\r\n        },\r\n        name: {\r\n          type: String,\r\n          required: true,\r\n        },\r\n        location: {\r\n          type: {\r\n            type: String,\r\n            enum: ['Point'],\r\n            default: 'Point',\r\n          },\r\n          coordinates: {\r\n            type: [Number], // [longitude, latitude]\r\n            required: true,\r\n          },\r\n          address: String,\r\n        },\r\n        scheduledTime: String, // HH:mm\r\n        estimatedDuration: Number, // دقائق من المحطة السابقة\r\n        waitTime: {\r\n          type: Number,\r\n          default: 2,\r\n        }, // دقائق\r\n        passengers: [\r\n          {\r\n            type: mongoose.Schema.Types.ObjectId,\r\n            ref: 'User',\r\n          },\r\n        ],\r\n        notes: String,\r\n      },\r\n    ],\r\n\r\n    // المسار الكامل (خط السير)\r\n    path: {\r\n      type: {\r\n        type: String,\r\n        enum: ['LineString'],\r\n        default: 'LineString',\r\n      },\r\n      coordinates: [[Number]], // مصفوفة من [longitude, latitude]\r\n    },\r\n\r\n    // معلومات المسافة والوقت\r\n    totalDistance: Number, // كم\r\n    estimatedDuration: Number, // دقائق\r\n    averageSpeed: {\r\n      type: Number,\r\n      default: 40,\r\n    }, // km/h\r\n\r\n    // المركبة المخصصة\r\n    assignedVehicle: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'Vehicle',\r\n    },\r\n\r\n    // السائق المخصص\r\n    assignedDriver: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'User',\r\n    },\r\n\r\n    // جدول التشغيل\r\n    schedule: {\r\n      startDate: Date,\r\n      endDate: Date,\r\n      operatingDays: [\r\n        {\r\n          type: String,\r\n          enum: ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'],\r\n        },\r\n      ],\r\n      startTime: String, // HH:mm\r\n      frequency: {\r\n        type: String,\r\n        enum: ['daily', 'weekly', 'monthly', 'special'],\r\n        default: 'daily',\r\n      },\r\n    },\r\n\r\n    // تحسين المسار\r\n    optimization: {\r\n      lastOptimized: Date,\r\n      optimizationScore: Number, // 0-100\r\n      suggestedChanges: [\r\n        {\r\n          type: String,\r\n          description: String,\r\n          estimatedImprovement: Number, // نسبة مئوية\r\n          status: {\r\n            type: String,\r\n            enum: ['pending', 'approved', 'rejected', 'implemented'],\r\n            default: 'pending',\r\n          },\r\n        },\r\n      ],\r\n      factors: {\r\n        trafficConditions: Boolean,\r\n        passengerDemand: Boolean,\r\n        fuelEfficiency: Boolean,\r\n        timeEfficiency: Boolean,\r\n      },\r\n    },\r\n\r\n    // الركاب المسجلين\r\n    passengers: [\r\n      {\r\n        user: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'User',\r\n        },\r\n        pickupStop: Number, // رقم المحطة\r\n        dropoffStop: Number,\r\n        preferences: {\r\n          specialNeeds: String,\r\n          seatPreference: String,\r\n        },\r\n      },\r\n    ],\r\n\r\n    // السعة\r\n    capacity: {\r\n      total: Number,\r\n      current: Number,\r\n      available: Number,\r\n    },\r\n\r\n    // إحصائيات الرحلات\r\n    tripStatistics: {\r\n      totalTrips: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      completedTrips: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      cancelledTrips: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      averageDelayMinutes: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      onTimePercentage: {\r\n        type: Number,\r\n        default: 100,\r\n      },\r\n      totalPassengersServed: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n    },\r\n\r\n    // تقييمات الركاب\r\n    ratings: {\r\n      averageRating: {\r\n        type: Number,\r\n        default: 5,\r\n        min: 0,\r\n        max: 5,\r\n      },\r\n      totalRatings: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      reviews: [\r\n        {\r\n          user: {\r\n            type: mongoose.Schema.Types.ObjectId,\r\n            ref: 'User',\r\n          },\r\n          rating: {\r\n            type: Number,\r\n            min: 1,\r\n            max: 5,\r\n          },\r\n          comment: String,\r\n          date: Date,\r\n        },\r\n      ],\r\n    },\r\n\r\n    // تنبيهات ومشاكل\r\n    alerts: [\r\n      {\r\n        type: {\r\n          type: String,\r\n          enum: ['delay', 'deviation', 'accident', 'weather', 'maintenance', 'other'],\r\n        },\r\n        severity: {\r\n          type: String,\r\n          enum: ['low', 'medium', 'high', 'critical'],\r\n        },\r\n        message: String,\r\n        timestamp: Date,\r\n        resolved: {\r\n          type: Boolean,\r\n          default: false,\r\n        },\r\n        resolvedAt: Date,\r\n      },\r\n    ],\r\n\r\n    // معلومات إضافية\r\n    notes: String,\r\n    isActive: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n  }\r\n);\r\n\r\n// Indexes\r\ntransportRouteSchema.index({ status: 1, isActive: 1 });\r\ntransportRouteSchema.index({ assignedVehicle: 1 });\r\ntransportRouteSchema.index({ assignedDriver: 1 });\r\ntransportRouteSchema.index({ 'stops.location.coordinates': '2dsphere' });\r\n\r\n// Virtual للحصول على عدد المحطات\r\ntransportRouteSchema.virtual('stopCount').get(function () {\r\n  return this.stops ? this.stops.length : 0;\r\n});\r\n\r\n// Virtual للحصول على عدد الركاب\r\ntransportRouteSchema.virtual('passengerCount').get(function () {\r\n  return this.passengers ? this.passengers.length : 0;\r\n});\r\n\r\n// Method لحساب السعة المتاحة\r\ntransportRouteSchema.methods.calculateAvailableCapacity = function () {\r\n  if (this.capacity.total) {\r\n    this.capacity.current = this.passengers.length;\r\n    this.capacity.available = this.capacity.total - this.capacity.current;\r\n  }\r\n  return this.capacity;\r\n};\r\n\r\n// Method لإضافة راكب\r\ntransportRouteSchema.methods.addPassenger = function (\r\n  userId,\r\n  pickupStop,\r\n  dropoffStop,\r\n  preferences\r\n) {\r\n  if (this.capacity.available <= 0) {\r\n    throw new Error('No available capacity');\r\n  }\r\n\r\n  this.passengers.push({\r\n    user: userId,\r\n    pickupStop,\r\n    dropoffStop,\r\n    preferences,\r\n  });\r\n\r\n  // إضافة الراكب للمحطة\r\n  const pickup = this.stops.find(s => s.stopNumber === pickupStop);\r\n  if (pickup && !pickup.passengers.includes(userId)) {\r\n    pickup.passengers.push(userId);\r\n  }\r\n\r\n  this.calculateAvailableCapacity();\r\n  return this.save();\r\n};\r\n\r\n// Method لإزالة راكب\r\ntransportRouteSchema.methods.removePassenger = function (userId) {\r\n  this.passengers = this.passengers.filter(p => !p.user.equals(userId));\r\n\r\n  // إزالة الراكب من جميع المحطات\r\n  this.stops.forEach(stop => {\r\n    stop.passengers = stop.passengers.filter(p => !p.equals(userId));\r\n  });\r\n\r\n  this.calculateAvailableCapacity();\r\n  return this.save();\r\n};\r\n\r\n// Method لتحديث حالة الرحلة\r\ntransportRouteSchema.methods.updateTripStatus = function (status, delayMinutes = 0) {\r\n  this.tripStatistics.totalTrips += 1;\r\n\r\n  if (status === 'completed') {\r\n    this.tripStatistics.completedTrips += 1;\r\n\r\n    // حساب نسبة الالتزام بالمواعيد\r\n    if (delayMinutes <= 5) {\r\n      const onTimeTrips =\r\n        this.tripStatistics.completedTrips -\r\n        Math.floor(\r\n          this.tripStatistics.completedTrips * (1 - this.tripStatistics.onTimePercentage / 100)\r\n        );\r\n      this.tripStatistics.onTimePercentage =\r\n        (onTimeTrips / this.tripStatistics.completedTrips) * 100;\r\n    }\r\n\r\n    // تحديث متوسط التأخير\r\n    const totalDelay =\r\n      this.tripStatistics.averageDelayMinutes * (this.tripStatistics.completedTrips - 1) +\r\n      delayMinutes;\r\n    this.tripStatistics.averageDelayMinutes = totalDelay / this.tripStatistics.completedTrips;\r\n  } else if (status === 'cancelled') {\r\n    this.tripStatistics.cancelledTrips += 1;\r\n  }\r\n\r\n  return this.save();\r\n};\r\n\r\n// Virtual للحصول على name من routeName\r\ntransportRouteSchema.virtual('name').get(function () {\r\n  return this.routeName;\r\n});\r\n\r\n// جعل Virtuals تُدرج في toJSON\r\ntransportRouteSchema.set('toJSON', { virtuals: true });\r\n\r\n// Method لإضافة تقييم\r\ntransportRouteSchema.methods.addRating = function (userId, rating, comment) {\r\n  this.ratings.reviews.push({\r\n    user: userId,\r\n    rating,\r\n    comment,\r\n    date: new Date(),\r\n  });\r\n\r\n  this.ratings.totalRatings += 1;\r\n\r\n  // حساب متوسط التقييم\r\n  const totalRating = this.ratings.reviews.reduce((sum, r) => sum + r.rating, 0);\r\n  this.ratings.averageRating = totalRating / this.ratings.totalRatings;\r\n\r\n  return this.save();\r\n};\r\n\r\n// Static method للبحث عن مسارات قريبة من موقع\r\ntransportRouteSchema.statics.findNearbyRoutes = function (longitude, latitude, maxDistance = 1000) {\r\n  return this.find({\r\n    'stops.location.coordinates': {\r\n      $near: {\r\n        $geometry: {\r\n          type: 'Point',\r\n          coordinates: [longitude, latitude],\r\n        },\r\n        $maxDistance: maxDistance,\r\n      },\r\n    },\r\n    status: 'active',\r\n    isActive: true,\r\n  });\r\n};\r\n\r\n// Static method للحصول على المسارات المتاحة\r\ntransportRouteSchema.statics.findAvailable = function (date, type) {\r\n  const dayOfWeek = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'][\r\n    date.getDay()\r\n  ];\r\n\r\n  return this.find({\r\n    status: 'active',\r\n    isActive: true,\r\n    type: type || { $exists: true },\r\n    'schedule.operatingDays': dayOfWeek,\r\n    'capacity.available': { $gt: 0 },\r\n  });\r\n};\r\n\r\nmodule.exports = mongoose.model('TransportRoute', transportRouteSchema);\r\n"],"mappings":"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","ignoreList":[]}