{"version":3,"names":["router","post","req","res","url","method","data","headers","body","axios","require","response","json","success","err","status","error","message","received","express","IntegrationService","ApiResponse","ApiError","Router","next","result","integratePaymentGateway","sendEmailIntegration","sendSMSIntegration","uploadToCloudStorage","syncWithCRM","trackAnalytics","get","_req","getIntegrationStatus","integrations","getAvailableIntegrations","handleWebhook","rateLimit","checkRateLimit","params","apiKey","module","exports"],"sources":["integrations.js"],"sourcesContent":["// إرسال بيانات إلى نظام خارجي (عام)\r\nrouter.post('/send', async (req, res) => {\r\n  try {\r\n    const { url, method, data, headers } = req.body;\r\n    const axios = require('axios');\r\n    const response = await axios({ url, method: method || 'post', data, headers });\r\n    res.json({ success: true, response: response.data });\r\n  } catch (err) {\r\n    res.status(500).json({ success: false, error: err.message });\r\n  }\r\n});\r\n\r\n// استقبال Webhook من نظام خارجي\r\nrouter.post('/webhook/:source', async (req, res) => {\r\n  // يمكن تخصيص المعالجة حسب المصدر\r\n  // مثال: req.params.source === 'erp' أو 'pay'\r\n  // حفظ البيانات أو تنفيذ منطق معين\r\n  res.json({ success: true, received: req.body });\r\n});\r\n// Integration Routes\r\nconst express = require('express');\r\nconst IntegrationService = require('../services/integrationService');\r\nconst { ApiResponse, ApiError } = require('../utils/apiResponse');\r\n\r\nconst router = express.Router();\r\n\r\n// Payment integration\r\nrouter.post('/payments/process', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.integratePaymentGateway(req.body);\r\n    return res.status(201).json(new ApiResponse(201, result, 'Payment processed'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to process payment', [error.message]));\r\n  }\r\n});\r\n\r\n// Email integration\r\nrouter.post('/email/send', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.sendEmailIntegration(req.body);\r\n    return res.status(201).json(new ApiResponse(201, result, 'Email sent'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to send email', [error.message]));\r\n  }\r\n});\r\n\r\n// SMS integration\r\nrouter.post('/sms/send', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.sendSMSIntegration(req.body);\r\n    return res.status(201).json(new ApiResponse(201, result, 'SMS sent'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to send SMS', [error.message]));\r\n  }\r\n});\r\n\r\n// Cloud storage integration\r\nrouter.post('/storage/upload', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.uploadToCloudStorage(req.body);\r\n    return res.status(201).json(new ApiResponse(201, result, 'File uploaded'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to upload file', [error.message]));\r\n  }\r\n});\r\n\r\n// CRM sync\r\nrouter.post('/crm/sync', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.syncWithCRM(req.body);\r\n    return res.status(201).json(new ApiResponse(201, result, 'CRM synced'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to sync with CRM', [error.message]));\r\n  }\r\n});\r\n\r\n// Analytics tracking\r\nrouter.post('/analytics/track', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.trackAnalytics(req.body);\r\n    return res.status(201).json(new ApiResponse(201, result, 'Analytics tracked'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to track analytics', [error.message]));\r\n  }\r\n});\r\n\r\n// Get integration status\r\nrouter.get('/status', (_req, res, next) => {\r\n  try {\r\n    const status = IntegrationService.getIntegrationStatus();\r\n    return res.json(new ApiResponse(200, status, 'Integration status fetched'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to fetch integration status', [error.message]));\r\n  }\r\n});\r\n\r\n// Get available integrations\r\nrouter.get('/available', (_req, res, next) => {\r\n  try {\r\n    const integrations = IntegrationService.getAvailableIntegrations();\r\n    return res.json(new ApiResponse(200, integrations, 'Available integrations fetched'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to fetch available integrations', [error.message]));\r\n  }\r\n});\r\n\r\n// Webhook handler\r\nrouter.post('/webhooks/handle', (req, res, next) => {\r\n  try {\r\n    const result = IntegrationService.handleWebhook(req.body);\r\n    return res.status(200).json(new ApiResponse(200, result, 'Webhook handled'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to handle webhook', [error.message]));\r\n  }\r\n});\r\n\r\n// Check rate limit\r\nrouter.get('/rate-limit/:apiKey', (req, res, next) => {\r\n  try {\r\n    const rateLimit = IntegrationService.checkRateLimit(req.params.apiKey);\r\n    return res.json(new ApiResponse(200, rateLimit, 'Rate limit checked'));\r\n  } catch (error) {\r\n    return next(new ApiError(500, 'Failed to check rate limit', [error.message]));\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}