{"version":3,"names":["EventEmitter","require","Logger","IntegrationHubService","constructor","connectors","Map","workflows","webhooks","marketplaceApps","subscriptions","executionLogs","credentials","_initializeDefaultConnectors","defaultConnectors","id","name","provider","status","config","baseUrl","rateLimit","forEach","conn","set","createdAt","Date","updatedAt","authStatus","info","registerConnector","connectorId","connectorConfig","has","Error","connector","metadata","emit","success","message","authenticateConnector","get","credentialId","now","apiKey","apiSecret","accessToken","refreshToken","webhookUrl","expiresAt","getAllConnectors","Array","from","values","map","isAuthenticated","getConnector","createWorkflow","workflowData","workflowId","Math","random","toString","substring","workflow","description","tenantId","trigger","actions","conditions","enabled","executeCount","lastExecutedAt","createdBy","executeWorkflow","triggerData","executionId","steps","action","stepResult","_executeAction","push","actionId","result","executedAt","error","execution","actionType","type","data","registerWebhook","events","webhookId","webhook","url","secret","deliveryCount","failureCount","triggerWebhook","deliveryId","createMarketplaceApp","appData","appId","app","icon","author","version","category","rating","reviews","downloads","pricing","features","documentation","subscribeToApp","plan","subscriptionId","subscription","appName","renewalDate","getSubscription","getMarketplaceApps","filters","apps","filter","a","search","toLowerCase","includes","sort","b","getStatistics","total","size","authenticated","c","length","w","totalExecutions","reduce","sum","active","totalDeliveries","marketplace","totalApps","totalSubscriptions","module","exports"],"sources":["integrationHub.service.js"],"sourcesContent":["/**\r\n * Integration Hub Service - مركز التكاملات المتقدم\r\n * Advanced Integrations Hub: Zapier, Workflows, Marketplace, Custom Connectors\r\n */\r\n\r\nconst EventEmitter = require('events');\r\nconst Logger = require('../utils/logger');\r\n\r\nclass IntegrationHubService extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    this.connectors = new Map();\r\n    this.workflows = new Map();\r\n    this.webhooks = new Map();\r\n    this.marketplaceApps = new Map();\r\n    this.subscriptions = new Map();\r\n    this.executionLogs = new Map();\r\n    this.credentials = new Map();\r\n    this._initializeDefaultConnectors();\r\n  }\r\n\r\n  /**\r\n   * Initialize default integrations\r\n   */\r\n  _initializeDefaultConnectors() {\r\n    const defaultConnectors = [\r\n      {\r\n        id: 'zapier',\r\n        name: 'Zapier Integration',\r\n        provider: 'zapier',\r\n        status: 'active',\r\n        config: { baseUrl: 'https://api.zapier.com/v1', rateLimit: 1000 },\r\n      },\r\n      {\r\n        id: 'slack',\r\n        name: 'Slack Integration',\r\n        provider: 'slack',\r\n        status: 'active',\r\n        config: { baseUrl: 'https://slack.com/api', rateLimit: 500 },\r\n      },\r\n      {\r\n        id: 'teams',\r\n        name: 'Microsoft Teams Integration',\r\n        provider: 'teams',\r\n        status: 'active',\r\n        config: { baseUrl: 'https://graph.microsoft.com/v1.0', rateLimit: 500 },\r\n      },\r\n      {\r\n        id: 'shopify',\r\n        name: 'Shopify Integration',\r\n        provider: 'shopify',\r\n        status: 'active',\r\n        config: { baseUrl: 'https://shopify.api/v2022-10', rateLimit: 2000 },\r\n      },\r\n      {\r\n        id: 'salesforce',\r\n        name: 'Salesforce Integration',\r\n        provider: 'salesforce',\r\n        status: 'active',\r\n        config: { baseUrl: 'https://api.salesforce.com/v57.0', rateLimit: 1500 },\r\n      },\r\n    ];\r\n\r\n    defaultConnectors.forEach((conn) => {\r\n      this.connectors.set(conn.id, {\r\n        ...conn,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n        authStatus: 'not_configured',\r\n      });\r\n    });\r\n\r\n    Logger.info('IntegrationHub: Initialized 5 default connectors');\r\n  }\r\n\r\n  /**\r\n   * Register new connector\r\n   */\r\n  registerConnector(connectorId, connectorConfig) {\r\n    if (this.connectors.has(connectorId)) {\r\n      throw new Error(`Connector ${connectorId} already exists`);\r\n    }\r\n\r\n    const connector = {\r\n      id: connectorId,\r\n      name: connectorConfig.name,\r\n      provider: connectorConfig.provider,\r\n      baseUrl: connectorConfig.baseUrl,\r\n      status: connectorConfig.status || 'active',\r\n      config: connectorConfig.config || {},\r\n      authStatus: 'not_configured',\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n      metadata: connectorConfig.metadata || {},\r\n    };\r\n\r\n    this.connectors.set(connectorId, connector);\r\n    this.emit('connector:registered', { connectorId, connector });\r\n\r\n    return {\r\n      success: true,\r\n      connector,\r\n      message: `Connector ${connectorId} registered successfully`,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Authenticate connector with credentials\r\n   */\r\n  async authenticateConnector(connectorId, credentials) {\r\n    if (!this.connectors.has(connectorId)) {\r\n      throw new Error(`Connector ${connectorId} not found`);\r\n    }\r\n\r\n    const connector = this.connectors.get(connectorId);\r\n    const credentialId = `cred_${connectorId}_${Date.now()}`;\r\n\r\n    this.credentials.set(credentialId, {\r\n      id: credentialId,\r\n      connectorId,\r\n      apiKey: credentials.apiKey,\r\n      apiSecret: credentials.apiSecret,\r\n      accessToken: credentials.accessToken,\r\n      refreshToken: credentials.refreshToken,\r\n      webhookUrl: credentials.webhookUrl,\r\n      expiresAt: credentials.expiresAt || new Date(Date.now() + 86400000),\r\n      createdAt: new Date(),\r\n      status: 'active',\r\n    });\r\n\r\n    connector.authStatus = 'configured';\r\n    connector.credentialId = credentialId;\r\n    connector.updatedAt = new Date();\r\n\r\n    this.emit('connector:authenticated', { connectorId, credentialId });\r\n\r\n    return {\r\n      success: true,\r\n      credentialId,\r\n      message: `Connector ${connectorId} authenticated successfully`,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get all connectors\r\n   */\r\n  getAllConnectors() {\r\n    return Array.from(this.connectors.values()).map((conn) => ({\r\n      ...conn,\r\n      isAuthenticated: conn.authStatus === 'configured',\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Get connector by ID\r\n   */\r\n  getConnector(connectorId) {\r\n    if (!this.connectors.has(connectorId)) {\r\n      return null;\r\n    }\r\n\r\n    const connector = this.connectors.get(connectorId);\r\n    return {\r\n      ...connector,\r\n      isAuthenticated: connector.authStatus === 'configured',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create workflow\r\n   */\r\n  createWorkflow(workflowData) {\r\n    const workflowId = `wf_${Date.now()}_${Math.random().toString(36).substring(7)}`;\r\n\r\n    const workflow = {\r\n      id: workflowId,\r\n      name: workflowData.name,\r\n      description: workflowData.description,\r\n      tenantId: workflowData.tenantId,\r\n      trigger: workflowData.trigger, // event: connector.event\r\n      actions: workflowData.actions || [], // array of action steps\r\n      conditions: workflowData.conditions || [],\r\n      status: 'draft',\r\n      enabled: false,\r\n      executeCount: 0,\r\n      lastExecutedAt: null,\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n      createdBy: workflowData.createdBy,\r\n    };\r\n\r\n    this.workflows.set(workflowId, workflow);\r\n    this.emit('workflow:created', { workflowId, workflow });\r\n\r\n    return {\r\n      success: true,\r\n      workflow,\r\n      message: `Workflow ${workflowId} created successfully`,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Execute workflow\r\n   */\r\n  async executeWorkflow(workflowId, triggerData = {}) {\r\n    if (!this.workflows.has(workflowId)) {\r\n      throw new Error(`Workflow ${workflowId} not found`);\r\n    }\r\n\r\n    const workflow = this.workflows.get(workflowId);\r\n\r\n    if (!workflow.enabled) {\r\n      throw new Error(`Workflow ${workflowId} is disabled`);\r\n    }\r\n\r\n    const executionId = `exec_${Date.now()}_${Math.random().toString(36).substring(7)}`;\r\n    const steps = [];\r\n    let success = true;\r\n\r\n    try {\r\n      // Execute each action in the workflow\r\n      for (const action of workflow.actions) {\r\n        const stepResult = await this._executeAction(action, triggerData);\r\n        steps.push({\r\n          actionId: action.id,\r\n          status: stepResult.success ? 'success' : 'failed',\r\n          result: stepResult,\r\n          executedAt: new Date(),\r\n        });\r\n\r\n        if (!stepResult.success) {\r\n          success = false;\r\n          break; // Stop on first failure\r\n        }\r\n      }\r\n\r\n      workflow.executeCount += 1;\r\n      workflow.lastExecutedAt = new Date();\r\n    } catch (error) {\r\n      success = false;\r\n      Logger.error(`Workflow execution error: ${error.message}`);\r\n    }\r\n\r\n    const execution = {\r\n      id: executionId,\r\n      workflowId,\r\n      status: success ? 'completed' : 'failed',\r\n      steps,\r\n      triggerData,\r\n      createdAt: new Date(),\r\n    };\r\n\r\n    this.executionLogs.set(executionId, execution);\r\n    this.emit('workflow:executed', { workflowId, executionId, execution });\r\n\r\n    return execution;\r\n  }\r\n\r\n  /**\r\n   * Private: Execute single action\r\n   */\r\n  async _executeAction(action, triggerData) {\r\n    try {\r\n      // Get connector\r\n      const connector = this.connectors.get(action.connectorId);\r\n      if (!connector) {\r\n        return { success: false, error: 'Connector not found' };\r\n      }\r\n\r\n      // Mock action execution\r\n      const result = {\r\n        success: true,\r\n        connectorId: action.connectorId,\r\n        actionType: action.type,\r\n        data: action.data,\r\n        executedAt: new Date(),\r\n      };\r\n\r\n      return result;\r\n    } catch (error) {\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Register webhook\r\n   */\r\n  registerWebhook(connectorId, webhookUrl, events = []) {\r\n    const webhookId = `wh_${Date.now()}_${Math.random().toString(36).substring(7)}`;\r\n\r\n    const webhook = {\r\n      id: webhookId,\r\n      connectorId,\r\n      url: webhookUrl,\r\n      events,\r\n      status: 'active',\r\n      secret: Math.random().toString(36).substring(7),\r\n      createdAt: new Date(),\r\n      deliveryCount: 0,\r\n      failureCount: 0,\r\n    };\r\n\r\n    this.webhooks.set(webhookId, webhook);\r\n    this.emit('webhook:registered', { webhookId, webhook });\r\n\r\n    return {\r\n      success: true,\r\n      webhook,\r\n      message: `Webhook ${webhookId} registered successfully`,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Trigger webhook\r\n   */\r\n  async triggerWebhook(webhookId, data) {\r\n    if (!this.webhooks.has(webhookId)) {\r\n      return { success: false, error: 'Webhook not found' };\r\n    }\r\n\r\n    const webhook = this.webhooks.get(webhookId);\r\n\r\n    try {\r\n      // Mock webhook delivery\r\n      webhook.deliveryCount += 1;\r\n\r\n      return {\r\n        success: true,\r\n        webhookId,\r\n        deliveryId: `del_${Date.now()}`,\r\n        status: '200 OK',\r\n        data,\r\n      };\r\n    } catch (error) {\r\n      webhook.failureCount += 1;\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add app to marketplace\r\n   */\r\n  createMarketplaceApp(appData) {\r\n    const appId = `app_${Date.now()}_${Math.random().toString(36).substring(7)}`;\r\n\r\n    const app = {\r\n      id: appId,\r\n      name: appData.name,\r\n      description: appData.description,\r\n      icon: appData.icon,\r\n      author: appData.author,\r\n      version: appData.version || '1.0.0',\r\n      category: appData.category,\r\n      rating: 0,\r\n      reviews: [],\r\n      downloads: 0,\r\n      pricing: appData.pricing, // free, premium, etc\r\n      features: appData.features || [],\r\n      documentation: appData.documentation,\r\n      status: 'published',\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    };\r\n\r\n    this.marketplaceApps.set(appId, app);\r\n    this.emit('app:published', { appId, app });\r\n\r\n    return {\r\n      success: true,\r\n      app,\r\n      message: `App ${appId} published to marketplace`,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to marketplace app\r\n   */\r\n  subscribeToApp(tenantId, appId, plan = 'free') {\r\n    if (!this.marketplaceApps.has(appId)) {\r\n      throw new Error(`App ${appId} not found`);\r\n    }\r\n\r\n    const subscriptionId = `sub_${Date.now()}_${Math.random().toString(36).substring(7)}`;\r\n    const app = this.marketplaceApps.get(appId);\r\n\r\n    const subscription = {\r\n      id: subscriptionId,\r\n      tenantId,\r\n      appId,\r\n      appName: app.name,\r\n      plan,\r\n      status: 'active',\r\n      apiKey: Math.random().toString(36).substring(2, 15),\r\n      webhookUrl: null,\r\n      createdAt: new Date(),\r\n      renewalDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days\r\n    };\r\n\r\n    this.subscriptions.set(subscriptionId, subscription);\r\n    this.emit('app:subscribed', { subscriptionId, subscription });\r\n\r\n    return {\r\n      success: true,\r\n      subscription,\r\n      message: `Subscribed to ${app.name} successfully`,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get subscription\r\n   */\r\n  getSubscription(subscriptionId) {\r\n    return this.subscriptions.get(subscriptionId) || null;\r\n  }\r\n\r\n  /**\r\n   * Get all marketplace apps\r\n   */\r\n  getMarketplaceApps(filters = {}) {\r\n    let apps = Array.from(this.marketplaceApps.values());\r\n\r\n    if (filters.category) {\r\n      apps = apps.filter((a) => a.category === filters.category);\r\n    }\r\n\r\n    if (filters.pricing) {\r\n      apps = apps.filter((a) => a.pricing === filters.pricing);\r\n    }\r\n\r\n    if (filters.search) {\r\n      const search = filters.search.toLowerCase();\r\n      apps = apps.filter((a) => a.name.toLowerCase().includes(search));\r\n    }\r\n\r\n    // Sort by rating and downloads\r\n    apps.sort((a, b) => b.rating - a.rating || b.downloads - a.downloads);\r\n\r\n    return apps;\r\n  }\r\n\r\n  /**\r\n   * Get statistics\r\n   */\r\n  getStatistics() {\r\n    return {\r\n      connectors: {\r\n        total: this.connectors.size,\r\n        authenticated: Array.from(this.connectors.values()).filter(\r\n          (c) => c.authStatus === 'configured'\r\n        ).length,\r\n      },\r\n      workflows: {\r\n        total: this.workflows.size,\r\n        enabled: Array.from(this.workflows.values()).filter((w) => w.enabled).length,\r\n        totalExecutions: Array.from(this.workflows.values()).reduce((sum, w) => sum + w.executeCount, 0),\r\n      },\r\n      webhooks: {\r\n        total: this.webhooks.size,\r\n        active: Array.from(this.webhooks.values()).filter((w) => w.status === 'active').length,\r\n        totalDeliveries: Array.from(this.webhooks.values()).reduce(\r\n          (sum, w) => sum + w.deliveryCount,\r\n          0\r\n        ),\r\n      },\r\n      marketplace: {\r\n        totalApps: this.marketplaceApps.size,\r\n        totalSubscriptions: this.subscriptions.size,\r\n      },\r\n      credentials: {\r\n        total: this.credentials.size,\r\n      },\r\n    };\r\n  }\r\n}\r\n\r\nmodule.exports = new IntegrationHubService();\r\n"],"mappings":"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","ignoreList":[]}