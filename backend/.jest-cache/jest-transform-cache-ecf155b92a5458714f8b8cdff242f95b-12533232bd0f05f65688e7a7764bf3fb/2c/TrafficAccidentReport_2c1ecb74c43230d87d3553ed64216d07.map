{"version":3,"names":["mongoose","require","attachmentSchema","Schema","fileName","String","fileUrl","fileType","type","enum","uploadedAt","Date","default","now","uploadedBy","Types","ObjectId","ref","witnessSchema","name","phone","email","address","identityNumber","relationship","statement","contactedAt","interviewedAt","statementVerified","Boolean","damageSchema","vehicleId","required","estimatedCost","Number","damageDescription","damagePhotos","assessedBy","assessmentDate","repairEstimate","repairs","started","completed","cost","injurySchema","personId","personName","role","bodyParts","description","treatmentRequired","hospitalized","hospitalName","medicalReport","treatmentCost","recoveryStatus","trafficAccidentReportSchema","reportNumber","unique","status","priority","severity","reportedAt","reportedBy","accidentInfo","accidentDateTime","location","city","region","coordinates","index","roadsideDescription","nearbyLandmarks","weather","visibility","lightingConditions","roadConditions","roadType","speedLimit","vehicles","driverId","driverName","driverLicense","driverPhone","plateNumber","vehicleType","make","model","year","color","insurer","policyNumber","engineNumber","chasisNumber","speedAtImpact","vehicleRole","damage","insurance","companyName","expiryDate","claimNumber","claimStatus","people","drivers","license","violations","injuryStatus","breathalyzerResult","drugTestResult","statementRecorded","passengers","pedestrians","injuries","deaths","count","details","age","witnesses","statements","recordedAt","recordedBy","verified","investigation","investigatingOfficer","startDate","completedDate","findings","rootCause","causeFactor","primaryCause","contributingFactors","analysisNotes","recommendations","violationType","fineAmount","points","licenseAction","liability","primaryResponsibleParty","responsibilityPercentage","determination","attachments","documentation","policereport","filed","filedAt","insuranceClaim","responseDate","claimAmount","medicalReports","policeStatements","expertReports","courtDocuments","financialImpact","totalDamageEstimate","medicalCosts","repairCosts","otherCosts","insuranceCoverageAmount","outOfPocketCost","finesAmount","totalLoss","followUp","nextFollowUpDate","notes","reminders","date","comments","userId","userName","comment","timestamp","archived","archivedAt","archivedBy","archivedReason","auditInfo","createdBy","createdAt","lastModifiedBy","lastModifiedAt","viewHistory","viewedAt","timestamps","toJSON","virtuals","toObject","virtual","get","length","Math","floor","days","daysSinceAccident","methods","generateReportNumber","getFullYear","month","getMonth","padStart","random","toString","substr","toUpperCase","markAsUnderInvestigation","investigatingOfficerId","completeInvestigation","approve","close","archive","reason","calculateTotalLoss","medical","repair","other","fines","addComment","push","recordView","statics","getStatistics","filters","matchStage","endDate","$gte","$lte","aggregate","$match","$group","_id","totalReports","$sum","totalInjured","$size","totalDeaths","totalFinancialLoss","averageFinancialLoss","$avg","criticalSeverity","$cond","$eq","severeSeverity","getStatusDistribution","$sort","getSeverityDistribution","TrafficAccidentReport","module","exports"],"sources":["TrafficAccidentReport.js"],"sourcesContent":["/**\r\n * Traffic Accident Report Model - نموذج تقرير الحادثة المرورية\r\n * نموذج شامل ومتكامل لتقارير الحوادث المرورية\r\n */\r\n\r\nconst mongoose = require('mongoose');\r\n\r\n// ========================================\r\n// Schema للمرفقات\r\n// ========================================\r\nconst attachmentSchema = new mongoose.Schema({\r\n  fileName: String,\r\n  fileUrl: String,\r\n  fileType: {\r\n    type: String,\r\n    enum: ['photo', 'video', 'document', 'audio', 'other']\r\n  },\r\n  uploadedAt: {\r\n    type: Date,\r\n    default: Date.now\r\n  },\r\n  uploadedBy: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'User'\r\n  }\r\n});\r\n\r\n// ========================================\r\n// Schema للشهود\r\n// ========================================\r\nconst witnessSchema = new mongoose.Schema({\r\n  name: String,\r\n  phone: String,\r\n  email: String,\r\n  address: String,\r\n  identityNumber: String,\r\n  relationship: {\r\n    type: String,\r\n    enum: ['witness', 'third_party', 'passenger', 'bystander'],\r\n    default: 'witness'\r\n  },\r\n  statement: String,\r\n  contactedAt: Date,\r\n  interviewedAt: Date,\r\n  statementVerified: Boolean\r\n});\r\n\r\n// ========================================\r\n// Schema للأضرار\r\n// ========================================\r\nconst damageSchema = new mongoose.Schema({\r\n  vehicleId: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'Vehicle'\r\n  },\r\n  type: {\r\n    type: String,\r\n    enum: ['total_loss', 'major', 'moderate', 'minor', 'no_damage'],\r\n    required: true\r\n  },\r\n  estimatedCost: Number,\r\n  damageDescription: String,\r\n  damagePhotos: [String],\r\n  assessedBy: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'User'\r\n  },\r\n  assessmentDate: Date,\r\n  repairEstimate: String,\r\n  repairs: {\r\n    started: Date,\r\n    completed: Date,\r\n    cost: Number\r\n  }\r\n});\r\n\r\n// ========================================\r\n// Schema للإصابات\r\n// ========================================\r\nconst injurySchema = new mongoose.Schema({\r\n  personId: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'User'\r\n  },\r\n  personName: String,\r\n  role: {\r\n    type: String,\r\n    enum: ['driver', 'passenger', 'pedestrian', 'cyclist', 'motorcyclist'],\r\n    required: true\r\n  },\r\n  type: {\r\n    type: String,\r\n    enum: ['fatal', 'serious', 'moderate', 'minor', 'uninjured'],\r\n    required: true\r\n  },\r\n  bodyParts: [String],\r\n  description: String,\r\n  treatmentRequired: Boolean,\r\n  hospitalized: Boolean,\r\n  hospitalName: String,\r\n  medicalReport: String,\r\n  treatmentCost: Number,\r\n  recoveryStatus: {\r\n    type: String,\r\n    enum: ['recovering', 'full_recovery', 'permanent_disability', 'fatal'],\r\n    default: 'recovering'\r\n  }\r\n});\r\n\r\n// ========================================\r\n// Schema الرئيسي لتقرير الحادثة المرورية\r\n// ========================================\r\nconst trafficAccidentReportSchema = new mongoose.Schema(\r\n  {\r\n    // ===== معلومات التقرير الأساسية =====\r\n    reportNumber: {\r\n      type: String,\r\n      unique: true,\r\n      required: true\r\n    },\r\n    status: {\r\n      type: String,\r\n      enum: [\r\n        'draft',\r\n        'submitted',\r\n        'under_investigation',\r\n        'under_review',\r\n        'approved',\r\n        'appeal_pending',\r\n        'resolved',\r\n        'closed',\r\n        'archived'\r\n      ],\r\n      default: 'draft'\r\n    },\r\n    priority: {\r\n      type: String,\r\n      enum: ['low', 'medium', 'high', 'critical'],\r\n      default: 'medium'\r\n    },\r\n    severity: {\r\n      type: String,\r\n      enum: ['minor', 'moderate', 'severe', 'critical', 'fatal'],\r\n      required: true\r\n    },\r\n    reportedAt: {\r\n      type: Date,\r\n      default: Date.now\r\n    },\r\n    reportedBy: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'User',\r\n      required: true\r\n    },\r\n\r\n    // ===== معلومات الحادثة =====\r\n    accidentInfo: {\r\n      accidentDateTime: {\r\n        type: Date,\r\n        required: true\r\n      },\r\n      location: {\r\n        address: String,\r\n        city: String,\r\n        region: String,\r\n        coordinates: {\r\n          type: {\r\n            type: String,\r\n            enum: ['Point'],\r\n            default: 'Point'\r\n          },\r\n          coordinates: {\r\n            type: [Number], // [longitude, latitude]\r\n            index: '2dsphere'\r\n          }\r\n        },\r\n        roadsideDescription: String,\r\n        nearbyLandmarks: String\r\n      },\r\n      weather: {\r\n        type: String,\r\n        enum: ['clear', 'rainy', 'foggy', 'snowy', 'windy', 'sandstorm', 'unknown'],\r\n        default: 'unknown'\r\n      },\r\n      visibility: {\r\n        type: String,\r\n        enum: ['good', 'moderate', 'poor', 'very_poor'],\r\n        default: 'good'\r\n      },\r\n      lightingConditions: {\r\n        type: String,\r\n        enum: ['daylight', 'dusk', 'dawn', 'night_lit', 'night_unlit'],\r\n        required: true\r\n      },\r\n      roadConditions: {\r\n        type: String,\r\n        enum: ['dry', 'wet', 'slippery', 'muddy', 'icy', 'poor'],\r\n        default: 'dry'\r\n      },\r\n      roadType: {\r\n        type: String,\r\n        enum: ['highway', 'main_road', 'secondary_road', 'urban_road', 'residential'],\r\n        required: true\r\n      },\r\n      speedLimit: Number,\r\n      description: {\r\n        type: String,\r\n        required: true\r\n      }\r\n    },\r\n\r\n    // ===== معلومات المركبات المتورطة =====\r\n    vehicles: [\r\n      {\r\n        vehicleId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'Vehicle'\r\n        },\r\n        driverId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'Driver'\r\n        },\r\n        driverName: String,\r\n        driverLicense: String,\r\n        driverPhone: String,\r\n        plateNumber: {\r\n          type: String\r\n        },\r\n        vehicleType: String,\r\n        make: String,\r\n        model: String,\r\n        year: Number,\r\n        color: String,\r\n        insurer: String,\r\n        policyNumber: String,\r\n        engineNumber: String,\r\n        chasisNumber: String,\r\n        speedAtImpact: Number,\r\n        vehicleRole: {\r\n          type: String,\r\n          enum: ['primary', 'secondary', 'additional'],\r\n          default: 'primary'\r\n        },\r\n        damage: damageSchema,\r\n        insurance: {\r\n          companyName: String,\r\n          policyNumber: String,\r\n          expiryDate: Date,\r\n          claimNumber: String,\r\n          claimStatus: {\r\n            type: String,\r\n            enum: ['pending', 'approved', 'rejected', 'paid'],\r\n            default: 'pending'\r\n          }\r\n        }\r\n      }\r\n    ],\r\n\r\n    // ===== معلومات الأشخاص المتأثرين =====\r\n    people: {\r\n      drivers: [\r\n        {\r\n          driverId: {\r\n            type: mongoose.Schema.Types.ObjectId,\r\n            ref: 'Driver'\r\n          },\r\n          name: String,\r\n          license: String,\r\n          violations: [String],\r\n          injuryStatus: injurySchema,\r\n          breathalyzerResult: Number,\r\n          drugTestResult: String,\r\n          statementRecorded: Boolean\r\n        }\r\n      ],\r\n      passengers: [injurySchema],\r\n      pedestrians: [injurySchema],\r\n      injuries: [injurySchema],\r\n      deaths: {\r\n        count: { type: Number, default: 0 },\r\n        details: [\r\n          {\r\n            name: String,\r\n            age: Number,\r\n            role: String,\r\n            description: String\r\n          }\r\n        ]\r\n      }\r\n    },\r\n\r\n    // ===== الشهود والإفادات =====\r\n    witnesses: [witnessSchema],\r\n    statements: [\r\n      {\r\n        personId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'User'\r\n        },\r\n        personName: String,\r\n        statement: String,\r\n        recordedAt: {\r\n          type: Date,\r\n          default: Date.now\r\n        },\r\n        recordedBy: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'User'\r\n        },\r\n        verified: Boolean\r\n      }\r\n    ],\r\n\r\n    // ===== التحقيق والتحليل =====\r\n    investigation: {\r\n      investigatingOfficer: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: 'User'\r\n      },\r\n      startDate: Date,\r\n      completedDate: Date,\r\n      status: {\r\n        type: String,\r\n        enum: ['not_started', 'in_progress', 'completed', 'on_hold'],\r\n        default: 'not_started'\r\n      },\r\n      findings: String,\r\n      rootCause: {\r\n        type: String,\r\n        enum: [\r\n          'human_error',\r\n          'mechanical_failure',\r\n          'environmental',\r\n          'pedestrian_violation',\r\n          'unknown'\r\n        ]\r\n      },\r\n      causeFactor: String,\r\n      primaryCause: String,\r\n      contributingFactors: [String],\r\n      analysisNotes: String,\r\n      recommendations: [String]\r\n    },\r\n\r\n    // ===== المخالفات والتحميل =====\r\n    violations: [\r\n      {\r\n        violationType: {\r\n          type: String,\r\n          enum: [\r\n            'speeding',\r\n            'reckless_driving',\r\n            'drunk_driving',\r\n            'traffic_light_violation',\r\n            'wrong_direction',\r\n            'no_license',\r\n            'expired_license',\r\n            'uninsured',\r\n            'mechanical_failure',\r\n            'drug_driving',\r\n            'negligent_driving',\r\n            'hit_and_run',\r\n            'other'\r\n          ]\r\n        },\r\n        severity: {\r\n          type: String,\r\n          enum: ['minor', 'moderate', 'serious'],\r\n          default: 'moderate'\r\n        },\r\n        driverId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'Driver'\r\n        },\r\n        driverName: String,\r\n        description: String,\r\n        fineAmount: Number,\r\n        points: Number,\r\n        licenseAction: {\r\n          type: String,\r\n          enum: [\r\n            'none',\r\n            'suspension',\r\n            'revocation',\r\n            'warning',\r\n            'mandatory_training'\r\n          ],\r\n          default: 'none'\r\n        }\r\n      }\r\n    ],\r\n    liability: {\r\n      primaryResponsibleParty: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: 'Driver'\r\n      },\r\n      responsibilityPercentage: Number,\r\n      determination: {\r\n        type: String,\r\n        enum: ['full', 'partial', 'no_fault', 'undetermined'],\r\n        default: 'undetermined'\r\n      }\r\n    },\r\n\r\n    // ===== المرفقات والوثائق =====\r\n    attachments: [attachmentSchema],\r\n    documentation: {\r\n      policereport: {\r\n        filed: Boolean,\r\n        reportNumber: String,\r\n        filedAt: Date\r\n      },\r\n      insuranceClaim: {\r\n        filed: Boolean,\r\n        claimNumber: String,\r\n        filedAt: Date,\r\n        responseDate: Date,\r\n        claimAmount: Number\r\n      },\r\n      medicalReports: [String],\r\n      policeStatements: [String],\r\n      expertReports: [String],\r\n      courtDocuments: [String]\r\n    },\r\n\r\n    // ===== الخسائر المالية =====\r\n    financialImpact: {\r\n      totalDamageEstimate: Number,\r\n      medicalCosts: Number,\r\n      repairCosts: Number,\r\n      otherCosts: Number,\r\n      insuranceCoverageAmount: Number,\r\n      outOfPocketCost: Number,\r\n      finesAmount: Number,\r\n      totalLoss: {\r\n        type: Number,\r\n        required: true,\r\n        default: 0\r\n      }\r\n    },\r\n\r\n    // ===== المتابعة والتحديثات =====\r\n    followUp: {\r\n      nextFollowUpDate: Date,\r\n      status: {\r\n        type: String,\r\n        enum: ['pending', 'in_progress', 'resolved'],\r\n        default: 'pending'\r\n      },\r\n      notes: String,\r\n      reminders: [\r\n        {\r\n          date: Date,\r\n          description: String,\r\n          completed: Boolean\r\n        }\r\n      ]\r\n    },\r\n\r\n    // ===== التعليقات والملاحظات =====\r\n    comments: [\r\n      {\r\n        userId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'User'\r\n        },\r\n        userName: String,\r\n        comment: String,\r\n        timestamp: {\r\n          type: Date,\r\n          default: Date.now\r\n        },\r\n        attachments: [String]\r\n      }\r\n    ],\r\n\r\n    // ===== الأرشفة والحذف =====\r\n    archived: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    archivedAt: Date,\r\n    archivedBy: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'User'\r\n    },\r\n    archivedReason: String,\r\n\r\n    // ===== معلومات التدقيق =====\r\n    auditInfo: {\r\n      createdBy: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: 'User'\r\n      },\r\n      createdAt: {\r\n        type: Date,\r\n        default: Date.now\r\n      },\r\n      lastModifiedBy: {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: 'User'\r\n      },\r\n      lastModifiedAt: Date,\r\n      viewHistory: [\r\n        {\r\n          userId: {\r\n            type: mongoose.Schema.Types.ObjectId,\r\n            ref: 'User'\r\n          },\r\n          viewedAt: Date\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  {\r\n    timestamps: true,\r\n    toJSON: { virtuals: true },\r\n    toObject: { virtuals: true }\r\n  }\r\n);\r\n\r\n// ========================================\r\n// Virtual Fields\r\n// ========================================\r\ntrafficAccidentReportSchema.virtual('totalInjured').get(function () {\r\n  return (\r\n    (this.people?.injuries?.length || 0) +\r\n    (this.people?.pedestrians?.length || 0)\r\n  );\r\n});\r\n\r\ntrafficAccidentReportSchema.virtual('totalDeaths').get(function () {\r\n  return this.people?.deaths?.count || 0;\r\n});\r\n\r\ntrafficAccidentReportSchema.virtual('daysSinceAccident').get(function () {\r\n  return Math.floor(\r\n    (Date.now() - this.accidentInfo.accidentDateTime) / (1000 * 60 * 60 * 24)\r\n  );\r\n});\r\n\r\ntrafficAccidentReportSchema.virtual('caseAge').get(function () {\r\n  const days = this.daysSinceAccident;\r\n  if (days === 0) return 'Same Day';\r\n  if (days === 1) return '1 Day';\r\n  if (days < 7) return `${days} Days`;\r\n  if (days < 30) return `${Math.floor(days / 7)} Weeks`;\r\n  if (days < 365) return `${Math.floor(days / 30)} Months`;\r\n  return `${Math.floor(days / 365)} Years`;\r\n});\r\n\r\n// ========================================\r\n// Indexes\r\n// ========================================\r\ntrafficAccidentReportSchema.index({ status: 1 });\r\ntrafficAccidentReportSchema.index({ severity: 1 });\r\ntrafficAccidentReportSchema.index({ 'accidentInfo.accidentDateTime': -1 });\r\ntrafficAccidentReportSchema.index({ 'reportedBy': 1 });\r\ntrafficAccidentReportSchema.index({ archived: 1 });\r\ntrafficAccidentReportSchema.index({\r\n  'accidentInfo.location.coordinates': '2dsphere'\r\n});\r\ntrafficAccidentReportSchema.index({\r\n  status: 1,\r\n  severity: 1,\r\n  'accidentInfo.accidentDateTime': -1\r\n});\r\n\r\n// ========================================\r\n// Methods\r\n// ========================================\r\ntrafficAccidentReportSchema.methods.generateReportNumber = function () {\r\n  const date = new Date();\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n  const random = Math.random().toString(36).substr(2, 6).toUpperCase();\r\n  this.reportNumber = `TAR-${year}${month}-${random}`;\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.markAsUnderInvestigation = function (\r\n  investigatingOfficerId\r\n) {\r\n  this.status = 'under_investigation';\r\n  this.investigation.status = 'in_progress';\r\n  this.investigation.investigatingOfficer = investigatingOfficerId;\r\n  this.investigation.startDate = new Date();\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.completeInvestigation = function (\r\n  findings,\r\n  rootCause,\r\n  recommendations\r\n) {\r\n  this.investigation.status = 'completed';\r\n  this.investigation.completedDate = new Date();\r\n  this.investigation.findings = findings;\r\n  this.investigation.rootCause = rootCause;\r\n  this.investigation.recommendations = recommendations;\r\n  this.status = 'under_review';\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.approve = function () {\r\n  this.status = 'approved';\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.close = function () {\r\n  this.status = 'closed';\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.archive = function (userId, reason) {\r\n  this.archived = true;\r\n  this.archivedAt = new Date();\r\n  this.archivedBy = userId;\r\n  this.archivedReason = reason;\r\n  this.status = 'archived';\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.calculateTotalLoss = function () {\r\n  const medical = this.financialImpact.medicalCosts || 0;\r\n  const repair = this.financialImpact.repairCosts || 0;\r\n  const other = this.financialImpact.otherCosts || 0;\r\n  const fines = this.financialImpact.finesAmount || 0;\r\n  this.financialImpact.totalLoss = medical + repair + other + fines;\r\n  return this.financialImpact.totalLoss;\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.addComment = function (\r\n  userId,\r\n  userName,\r\n  comment\r\n) {\r\n  this.comments.push({\r\n    userId,\r\n    userName,\r\n    comment,\r\n    timestamp: new Date()\r\n  });\r\n};\r\n\r\ntrafficAccidentReportSchema.methods.recordView = function (userId) {\r\n  this.auditInfo.viewHistory.push({\r\n    userId,\r\n    viewedAt: new Date()\r\n  });\r\n};\r\n\r\n// ========================================\r\n// Statics\r\n// ========================================\r\ntrafficAccidentReportSchema.statics.getStatistics = async function (\r\n  filters = {}\r\n) {\r\n  const matchStage = { archived: false };\r\n\r\n  if (filters.startDate || filters.endDate) {\r\n    matchStage['accidentInfo.accidentDateTime'] = {};\r\n    if (filters.startDate) {\r\n      matchStage['accidentInfo.accidentDateTime'].$gte = new Date(\r\n        filters.startDate\r\n      );\r\n    }\r\n    if (filters.endDate) {\r\n      matchStage['accidentInfo.accidentDateTime'].$lte = new Date(\r\n        filters.endDate\r\n      );\r\n    }\r\n  }\r\n\r\n  if (filters.city) {\r\n    matchStage['accidentInfo.location.city'] = filters.city;\r\n  }\r\n\r\n  if (filters.severity) {\r\n    matchStage.severity = filters.severity;\r\n  }\r\n\r\n  return this.aggregate([\r\n    { $match: matchStage },\r\n    {\r\n      $group: {\r\n        _id: null,\r\n        totalReports: { $sum: 1 },\r\n        totalInjured: { $sum: { $size: '$people.injuries' } },\r\n        totalDeaths: { $sum: '$people.deaths.count' },\r\n        totalFinancialLoss: { $sum: '$financialImpact.totalLoss' },\r\n        averageFinancialLoss: { $avg: '$financialImpact.totalLoss' },\r\n        criticalSeverity: {\r\n          $sum: { $cond: [{ $eq: ['$severity', 'critical'] }, 1, 0] }\r\n        },\r\n        severeSeverity: {\r\n          $sum: { $cond: [{ $eq: ['$severity', 'severe'] }, 1, 0] }\r\n        }\r\n      }\r\n    }\r\n  ]);\r\n};\r\n\r\ntrafficAccidentReportSchema.statics.getStatusDistribution = async function (\r\n  filters = {}\r\n) {\r\n  const matchStage = { archived: false };\r\n\r\n  if (filters.startDate || filters.endDate) {\r\n    matchStage['accidentInfo.accidentDateTime'] = {};\r\n    if (filters.startDate) {\r\n      matchStage['accidentInfo.accidentDateTime'].$gte = new Date(\r\n        filters.startDate\r\n      );\r\n    }\r\n    if (filters.endDate) {\r\n      matchStage['accidentInfo.accidentDateTime'].$lte = new Date(\r\n        filters.endDate\r\n      );\r\n    }\r\n  }\r\n\r\n  return this.aggregate([\r\n    { $match: matchStage },\r\n    {\r\n      $group: {\r\n        _id: '$status',\r\n        count: { $sum: 1 }\r\n      }\r\n    },\r\n    { $sort: { _id: 1 } }\r\n  ]);\r\n};\r\n\r\ntrafficAccidentReportSchema.statics.getSeverityDistribution =\r\n  async function (filters = {}) {\r\n    const matchStage = { archived: false };\r\n\r\n    if (filters.startDate || filters.endDate) {\r\n      matchStage['accidentInfo.accidentDateTime'] = {};\r\n      if (filters.startDate) {\r\n        matchStage['accidentInfo.accidentDateTime'].$gte = new Date(\r\n          filters.startDate\r\n        );\r\n      }\r\n      if (filters.endDate) {\r\n        matchStage['accidentInfo.accidentDateTime'].$lte = new Date(\r\n          filters.endDate\r\n        );\r\n      }\r\n    }\r\n\r\n    return this.aggregate([\r\n      { $match: matchStage },\r\n      {\r\n        $group: {\r\n          _id: '$severity',\r\n          count: { $sum: 1 }\r\n        }\r\n      },\r\n      { $sort: { _id: 1 } }\r\n    ]);\r\n  };\r\n\r\n// Create the model\r\nconst TrafficAccidentReport = mongoose.model(\r\n  'TrafficAccidentReport',\r\n  trafficAccidentReportSchema\r\n);\r\n\r\nmodule.exports = TrafficAccidentReport;\r\n"],"mappings":"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","ignoreList":[]}