0d38033ca54c0ca5f2c8f97cc543536d
/**
 * Migration Routes
 * API endpoints for managing data migrations
 */

const express = require('express');
const router = express.Router();
const MigrationManager = require('../services/migration/MigrationManager');
const CSVProcessor = require('../services/migration/CSVProcessor');
const DatabaseMigration = require('../services/migration/DatabaseMigration');

// Initialize migration manager (would be instantiated in app.js with actual DB connections)
let migrationManager = null;

/**
 * Initialize migration manager
 * POST /api/migrations/initialize
 */
router.post('/initialize', (req, res) => {
  try {
    const {
      sourceDB,
      targetDB
    } = req.body;
    if (!sourceDB || !targetDB) {
      return res.status(400).json({
        success: false,
        error: 'Source and target databases are required'
      });
    }
    migrationManager = new MigrationManager({
      sourceDB,
      targetDB,
      csvProcessor: new CSVProcessor(),
      logger: console
    });
    res.json({
      success: true,
      message: 'Migration manager initialized'
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Create migration plan
 * POST /api/migrations/plan
 */
router.post('/plan', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized. Call /initialize first.'
      });
    }
    const {
      tables,
      options
    } = req.body;
    if (!Array.isArray(tables) || tables.length === 0) {
      return res.status(400).json({
        success: false,
        error: 'Tables array is required and cannot be empty'
      });
    }
    const plan = migrationManager.createMigrationPlan(tables, options);
    res.json({
      success: true,
      plan
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get migration plan
 * GET /api/migrations/plan
 */
router.get('/plan', (req, res) => {
  try {
    if (!migrationManager || !migrationManager.migrationPlan) {
      return res.status(400).json({
        success: false,
        error: 'No migration plan created'
      });
    }
    res.json({
      success: true,
      plan: migrationManager.migrationPlan
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Execute migration plan
 * POST /api/migrations/execute
 */
router.post('/execute', async (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const options = req.body;
    const summary = await migrationManager.executeMigrationPlan(options);
    res.json({
      success: true,
      ...summary
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get execution summary
 * GET /api/migrations/summary
 */
router.get('/summary', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const summary = migrationManager.getExecutionSummary();
    res.json({
      success: true,
      ...summary
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get migration log
 * GET /api/migrations/log
 */
router.get('/log', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const log = migrationManager.getExecutionLog();
    res.json({
      success: true,
      log,
      totalEntries: log.length
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Clear migration log
 * DELETE /api/migrations/log
 */
router.delete('/log', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    migrationManager.clearLog();
    res.json({
      success: true,
      message: 'Migration log cleared'
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Import CSV and migrate to database
 * POST /api/migrations/import-csv
 */
router.post('/import-csv', async (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const {
      csvPath,
      tableName,
      options
    } = req.body;
    if (!csvPath || !tableName) {
      return res.status(400).json({
        success: false,
        error: 'CSV path and table name are required'
      });
    }
    const result = await migrationManager.migrateFromCSV(csvPath, tableName, options);
    res.json({
      success: result.status === 'completed',
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Export table to CSV
 * POST /api/migrations/export-csv
 */
router.post('/export-csv', async (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const {
      tableName,
      csvPath,
      options
    } = req.body;
    if (!tableName || !csvPath) {
      return res.status(400).json({
        success: false,
        error: 'Table name and CSV path are required'
      });
    }
    const result = await migrationManager.exportTableToCSV(tableName, csvPath, options);
    res.json({
      success: result.status === 'completed',
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Sample CSV file
 * POST /api/migrations/sample-csv
 */
router.post('/sample-csv', async (req, res) => {
  try {
    const {
      csvPath,
      sampleSize
    } = req.body;
    if (!csvPath) {
      return res.status(400).json({
        success: false,
        error: 'CSV path is required'
      });
    }
    const csvProcessor = new CSVProcessor();
    const result = await csvProcessor.sampleCSV(csvPath, sampleSize || 10);
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get CSV info
 * GET /api/migrations/csv-info
 */
router.get('/csv-info', async (req, res) => {
  try {
    const {
      csvPath
    } = req.query;
    if (!csvPath) {
      return res.status(400).json({
        success: false,
        error: 'CSV path is required as query parameter'
      });
    }
    const csvProcessor = new CSVProcessor();
    const info = await csvProcessor.getCSVInfo(csvPath);
    res.json({
      success: true,
      info
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Validate CSV structure
 * POST /api/migrations/validate-csv
 */
router.post('/validate-csv', async (req, res) => {
  try {
    const {
      csvPath,
      expectedColumns
    } = req.body;
    if (!csvPath) {
      return res.status(400).json({
        success: false,
        error: 'CSV path is required'
      });
    }
    const csvProcessor = new CSVProcessor();
    const result = await csvProcessor.validateCSVStructure(csvPath, expectedColumns);
    res.json({
      success: result.valid,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Pause migration
 * POST /api/migrations/pause
 */
router.post('/pause', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const result = migrationManager.pauseMigration();
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Resume migration
 * POST /api/migrations/resume
 */
router.post('/resume', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const result = migrationManager.resumeMigration();
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Set migration manager instance
 * Called during app initialization
 */
function setMigrationManager(manager) {
  migrationManager = manager;
}
module.exports = router;
module.exports.setMigrationManager = setMigrationManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIk1pZ3JhdGlvbk1hbmFnZXIiLCJDU1ZQcm9jZXNzb3IiLCJEYXRhYmFzZU1pZ3JhdGlvbiIsIm1pZ3JhdGlvbk1hbmFnZXIiLCJwb3N0IiwicmVxIiwicmVzIiwic291cmNlREIiLCJ0YXJnZXREQiIsImJvZHkiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwiY3N2UHJvY2Vzc29yIiwibG9nZ2VyIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJ0YWJsZXMiLCJvcHRpb25zIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwicGxhbiIsImNyZWF0ZU1pZ3JhdGlvblBsYW4iLCJnZXQiLCJtaWdyYXRpb25QbGFuIiwic3VtbWFyeSIsImV4ZWN1dGVNaWdyYXRpb25QbGFuIiwiZ2V0RXhlY3V0aW9uU3VtbWFyeSIsImxvZyIsImdldEV4ZWN1dGlvbkxvZyIsInRvdGFsRW50cmllcyIsImRlbGV0ZSIsImNsZWFyTG9nIiwiY3N2UGF0aCIsInRhYmxlTmFtZSIsInJlc3VsdCIsIm1pZ3JhdGVGcm9tQ1NWIiwiZXhwb3J0VGFibGVUb0NTViIsInNhbXBsZVNpemUiLCJzYW1wbGVDU1YiLCJxdWVyeSIsImluZm8iLCJnZXRDU1ZJbmZvIiwiZXhwZWN0ZWRDb2x1bW5zIiwidmFsaWRhdGVDU1ZTdHJ1Y3R1cmUiLCJ2YWxpZCIsInBhdXNlTWlncmF0aW9uIiwicmVzdW1lTWlncmF0aW9uIiwic2V0TWlncmF0aW9uTWFuYWdlciIsIm1hbmFnZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsibWlncmF0aW9ucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTWlncmF0aW9uIFJvdXRlc1xyXG4gKiBBUEkgZW5kcG9pbnRzIGZvciBtYW5hZ2luZyBkYXRhIG1pZ3JhdGlvbnNcclxuICovXHJcblxyXG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBNaWdyYXRpb25NYW5hZ2VyID0gcmVxdWlyZSgnLi4vc2VydmljZXMvbWlncmF0aW9uL01pZ3JhdGlvbk1hbmFnZXInKTtcclxuY29uc3QgQ1NWUHJvY2Vzc29yID0gcmVxdWlyZSgnLi4vc2VydmljZXMvbWlncmF0aW9uL0NTVlByb2Nlc3NvcicpO1xyXG5jb25zdCBEYXRhYmFzZU1pZ3JhdGlvbiA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL21pZ3JhdGlvbi9EYXRhYmFzZU1pZ3JhdGlvbicpO1xyXG5cclxuLy8gSW5pdGlhbGl6ZSBtaWdyYXRpb24gbWFuYWdlciAod291bGQgYmUgaW5zdGFudGlhdGVkIGluIGFwcC5qcyB3aXRoIGFjdHVhbCBEQiBjb25uZWN0aW9ucylcclxubGV0IG1pZ3JhdGlvbk1hbmFnZXIgPSBudWxsO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbWlncmF0aW9uIG1hbmFnZXJcclxuICogUE9TVCAvYXBpL21pZ3JhdGlvbnMvaW5pdGlhbGl6ZVxyXG4gKi9cclxucm91dGVyLnBvc3QoJy9pbml0aWFsaXplJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgc291cmNlREIsIHRhcmdldERCIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICBpZiAoIXNvdXJjZURCIHx8ICF0YXJnZXREQikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnU291cmNlIGFuZCB0YXJnZXQgZGF0YWJhc2VzIGFyZSByZXF1aXJlZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG1pZ3JhdGlvbk1hbmFnZXIgPSBuZXcgTWlncmF0aW9uTWFuYWdlcih7XHJcbiAgICAgIHNvdXJjZURCLFxyXG4gICAgICB0YXJnZXREQixcclxuICAgICAgY3N2UHJvY2Vzc29yOiBuZXcgQ1NWUHJvY2Vzc29yKCksXHJcbiAgICAgIGxvZ2dlcjogY29uc29sZSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogJ01pZ3JhdGlvbiBtYW5hZ2VyIGluaXRpYWxpemVkJyxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogQ3JlYXRlIG1pZ3JhdGlvbiBwbGFuXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL3BsYW5cclxuICovXHJcbnJvdXRlci5wb3N0KCcvcGxhbicsIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01pZ3JhdGlvbiBtYW5hZ2VyIG5vdCBpbml0aWFsaXplZC4gQ2FsbCAvaW5pdGlhbGl6ZSBmaXJzdC4nLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IHRhYmxlcywgb3B0aW9ucyB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHRhYmxlcykgfHwgdGFibGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnVGFibGVzIGFycmF5IGlzIHJlcXVpcmVkIGFuZCBjYW5ub3QgYmUgZW1wdHknLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwbGFuID0gbWlncmF0aW9uTWFuYWdlci5jcmVhdGVNaWdyYXRpb25QbGFuKHRhYmxlcywgb3B0aW9ucyk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBwbGFuLFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgbWlncmF0aW9uIHBsYW5cclxuICogR0VUIC9hcGkvbWlncmF0aW9ucy9wbGFuXHJcbiAqL1xyXG5yb3V0ZXIuZ2V0KCcvcGxhbicsIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIgfHwgIW1pZ3JhdGlvbk1hbmFnZXIubWlncmF0aW9uUGxhbikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnTm8gbWlncmF0aW9uIHBsYW4gY3JlYXRlZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgcGxhbjogbWlncmF0aW9uTWFuYWdlci5taWdyYXRpb25QbGFuLFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBFeGVjdXRlIG1pZ3JhdGlvbiBwbGFuXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL2V4ZWN1dGVcclxuICovXHJcbnJvdXRlci5wb3N0KCcvZXhlY3V0ZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01pZ3JhdGlvbiBtYW5hZ2VyIG5vdCBpbml0aWFsaXplZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSByZXEuYm9keTtcclxuICAgIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCBtaWdyYXRpb25NYW5hZ2VyLmV4ZWN1dGVNaWdyYXRpb25QbGFuKG9wdGlvbnMpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgLi4uc3VtbWFyeSxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogR2V0IGV4ZWN1dGlvbiBzdW1tYXJ5XHJcbiAqIEdFVCAvYXBpL21pZ3JhdGlvbnMvc3VtbWFyeVxyXG4gKi9cclxucm91dGVyLmdldCgnL3N1bW1hcnknLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gbWlncmF0aW9uTWFuYWdlci5nZXRFeGVjdXRpb25TdW1tYXJ5KCk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAuLi5zdW1tYXJ5LFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgbWlncmF0aW9uIGxvZ1xyXG4gKiBHRVQgL2FwaS9taWdyYXRpb25zL2xvZ1xyXG4gKi9cclxucm91dGVyLmdldCgnL2xvZycsIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01pZ3JhdGlvbiBtYW5hZ2VyIG5vdCBpbml0aWFsaXplZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGxvZyA9IG1pZ3JhdGlvbk1hbmFnZXIuZ2V0RXhlY3V0aW9uTG9nKCk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBsb2csXHJcbiAgICAgIHRvdGFsRW50cmllczogbG9nLmxlbmd0aCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogQ2xlYXIgbWlncmF0aW9uIGxvZ1xyXG4gKiBERUxFVEUgL2FwaS9taWdyYXRpb25zL2xvZ1xyXG4gKi9cclxucm91dGVyLmRlbGV0ZSgnL2xvZycsIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01pZ3JhdGlvbiBtYW5hZ2VyIG5vdCBpbml0aWFsaXplZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG1pZ3JhdGlvbk1hbmFnZXIuY2xlYXJMb2coKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICdNaWdyYXRpb24gbG9nIGNsZWFyZWQnLFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBJbXBvcnQgQ1NWIGFuZCBtaWdyYXRlIHRvIGRhdGFiYXNlXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL2ltcG9ydC1jc3ZcclxuICovXHJcbnJvdXRlci5wb3N0KCcvaW1wb3J0LWNzdicsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01pZ3JhdGlvbiBtYW5hZ2VyIG5vdCBpbml0aWFsaXplZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgY3N2UGF0aCwgdGFibGVOYW1lLCBvcHRpb25zIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICBpZiAoIWNzdlBhdGggfHwgIXRhYmxlTmFtZSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ1NWIHBhdGggYW5kIHRhYmxlIG5hbWUgYXJlIHJlcXVpcmVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbWlncmF0aW9uTWFuYWdlci5taWdyYXRlRnJvbUNTVihjc3ZQYXRoLCB0YWJsZU5hbWUsIG9wdGlvbnMpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogcmVzdWx0LnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcsXHJcbiAgICAgIC4uLnJlc3VsdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogRXhwb3J0IHRhYmxlIHRvIENTVlxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9leHBvcnQtY3N2XHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL2V4cG9ydC1jc3YnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IHRhYmxlTmFtZSwgY3N2UGF0aCwgb3B0aW9ucyB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgaWYgKCF0YWJsZU5hbWUgfHwgIWNzdlBhdGgpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1RhYmxlIG5hbWUgYW5kIENTViBwYXRoIGFyZSByZXF1aXJlZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbk1hbmFnZXIuZXhwb3J0VGFibGVUb0NTVih0YWJsZU5hbWUsIGNzdlBhdGgsIG9wdGlvbnMpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogcmVzdWx0LnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcsXHJcbiAgICAgIC4uLnJlc3VsdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogU2FtcGxlIENTViBmaWxlXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL3NhbXBsZS1jc3ZcclxuICovXHJcbnJvdXRlci5wb3N0KCcvc2FtcGxlLWNzdicsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNzdlBhdGgsIHNhbXBsZVNpemUgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIGlmICghY3N2UGF0aCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ1NWIHBhdGggaXMgcmVxdWlyZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjc3ZQcm9jZXNzb3IgPSBuZXcgQ1NWUHJvY2Vzc29yKCk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjc3ZQcm9jZXNzb3Iuc2FtcGxlQ1NWKGNzdlBhdGgsIHNhbXBsZVNpemUgfHwgMTApO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgLi4ucmVzdWx0LFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgQ1NWIGluZm9cclxuICogR0VUIC9hcGkvbWlncmF0aW9ucy9jc3YtaW5mb1xyXG4gKi9cclxucm91dGVyLmdldCgnL2Nzdi1pbmZvJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY3N2UGF0aCB9ID0gcmVxLnF1ZXJ5O1xyXG5cclxuICAgIGlmICghY3N2UGF0aCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ1NWIHBhdGggaXMgcmVxdWlyZWQgYXMgcXVlcnkgcGFyYW1ldGVyJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY3N2UHJvY2Vzc29yID0gbmV3IENTVlByb2Nlc3NvcigpO1xyXG4gICAgY29uc3QgaW5mbyA9IGF3YWl0IGNzdlByb2Nlc3Nvci5nZXRDU1ZJbmZvKGNzdlBhdGgpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgaW5mbyxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgQ1NWIHN0cnVjdHVyZVxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy92YWxpZGF0ZS1jc3ZcclxuICovXHJcbnJvdXRlci5wb3N0KCcvdmFsaWRhdGUtY3N2JywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgY3N2UGF0aCwgZXhwZWN0ZWRDb2x1bW5zIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICBpZiAoIWNzdlBhdGgpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0NTViBwYXRoIGlzIHJlcXVpcmVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY3N2UHJvY2Vzc29yID0gbmV3IENTVlByb2Nlc3NvcigpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLnZhbGlkYXRlQ1NWU3RydWN0dXJlKGNzdlBhdGgsIGV4cGVjdGVkQ29sdW1ucyk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiByZXN1bHQudmFsaWQsXHJcbiAgICAgIC4uLnJlc3VsdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogUGF1c2UgbWlncmF0aW9uXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL3BhdXNlXHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL3BhdXNlJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghbWlncmF0aW9uTWFuYWdlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnTWlncmF0aW9uIG1hbmFnZXIgbm90IGluaXRpYWxpemVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gbWlncmF0aW9uTWFuYWdlci5wYXVzZU1pZ3JhdGlvbigpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgLi4ucmVzdWx0LFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBSZXN1bWUgbWlncmF0aW9uXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL3Jlc3VtZVxyXG4gKi9cclxucm91dGVyLnBvc3QoJy9yZXN1bWUnLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBtaWdyYXRpb25NYW5hZ2VyLnJlc3VtZU1pZ3JhdGlvbigpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgLi4ucmVzdWx0LFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgbWlncmF0aW9uIG1hbmFnZXIgaW5zdGFuY2VcclxuICogQ2FsbGVkIGR1cmluZyBhcHAgaW5pdGlhbGl6YXRpb25cclxuICovXHJcbmZ1bmN0aW9uIHNldE1pZ3JhdGlvbk1hbmFnZXIobWFuYWdlcikge1xyXG4gIG1pZ3JhdGlvbk1hbmFnZXIgPSBtYW5hZ2VyO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcclxubW9kdWxlLmV4cG9ydHMuc2V0TWlncmF0aW9uTWFuYWdlciA9IHNldE1pZ3JhdGlvbk1hbmFnZXI7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNQyxnQkFBZ0IsR0FBR0gsT0FBTyxDQUFDLHdDQUF3QyxDQUFDO0FBQzFFLE1BQU1JLFlBQVksR0FBR0osT0FBTyxDQUFDLG9DQUFvQyxDQUFDO0FBQ2xFLE1BQU1LLGlCQUFpQixHQUFHTCxPQUFPLENBQUMseUNBQXlDLENBQUM7O0FBRTVFO0FBQ0EsSUFBSU0sZ0JBQWdCLEdBQUcsSUFBSTs7QUFFM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQUwsTUFBTSxDQUFDTSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ3ZDLElBQUk7SUFDRixNQUFNO01BQUVDLFFBQVE7TUFBRUM7SUFBUyxDQUFDLEdBQUdILEdBQUcs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