{"version":3,"names":["Product","Cart","Checkout","Coupon","Wishlist","InventoryLog","require","EcommerceService","getProducts","options","page","limit","category","search","minPrice","maxPrice","sortBy","sortOrder","skip","filter","isActive","$or","name","$regex","$options","description","finalPrice","$gte","$lte","products","find","sort","select","total","countDocuments","pagination","pages","Math","ceil","error","Error","message","getProductDetails","productId","product","findById","searchProducts","query","collection","createIndex","results","$text","$search","score","$meta","lean","addToCart","userId","quantity","variant","totalStock","cart","findOne","items","existingItem","item","toString","JSON","stringify","push","price","save","success","getCart","populate","updateCartItem","i","removeFromCart","clearCart","applyCoupon","couponCode","coupon","code","toUpperCase","validFrom","Date","validUntil","maxUses","usedCount","subtotal","minPurchaseAmount","discount","discountType","discountValue","maxDiscount","min","createCheckoutSession","shippingData","length","sessionId","now","random","substr","checkout","shippingAddress","tax","shipping","status","expiresAt","updateCheckoutPayment","paymentData","paymentMethod","method","paymentStatus","getCheckout","addToWishlist","wishlist","removeFromWishlist","getWishlist","logInventoryChange","action","reference","log","createdAt","getSimilarProducts","similar","_id","$ne","getFeaturedProducts","featured","isFeatured","getNewProducts","days","since","newProducts","addProductReview","rating","title","comment","existingReview","reviews","r","totalRating","reduce","sum","average","toFixed","count","updateProductStock","quantitySold","module","exports"],"sources":["EcommerceService.js"],"sourcesContent":["/**\r\n * E-Commerce Service\r\n * Handles shopping cart, checkout, and product management\r\n */\r\n\r\nconst {\r\n  Product,\r\n  Cart,\r\n  Checkout,\r\n  Coupon,\r\n  Wishlist,\r\n  InventoryLog,\r\n} = require('../models/ecommerce.models');\r\n\r\nclass EcommerceService {\r\n  /**\r\n   * GET PRODUCTS\r\n   * Retrieve products with filtering, sorting, and pagination\r\n   */\r\n  static async getProducts(options = {}) {\r\n    const {\r\n      page = 1,\r\n      limit = 20,\r\n      category,\r\n      search,\r\n      minPrice,\r\n      maxPrice,\r\n      sortBy = 'createdAt',\r\n      sortOrder = 'desc',\r\n    } = options;\r\n\r\n    try {\r\n      const skip = (page - 1) * limit;\r\n\r\n      // Build filter\r\n      const filter = { isActive: true };\r\n      if (category) filter.category = category;\r\n      if (search) {\r\n        filter.$or = [\r\n          { name: { $regex: search, $options: 'i' } },\r\n          { description: { $regex: search, $options: 'i' } },\r\n        ];\r\n      }\r\n      if (minPrice || maxPrice) {\r\n        filter.finalPrice = {};\r\n        if (minPrice) filter.finalPrice.$gte = minPrice;\r\n        if (maxPrice) filter.finalPrice.$lte = maxPrice;\r\n      }\r\n\r\n      // Query\r\n      const products = await Product.find(filter)\r\n        .sort({ [sortBy]: sortOrder === 'desc' ? -1 : 1 })\r\n        .skip(skip)\r\n        .limit(limit)\r\n        .select('-reviews -variants'); // Exclude heavy data\r\n\r\n      const total = await Product.countDocuments(filter);\r\n\r\n      return {\r\n        products,\r\n        pagination: {\r\n          page,\r\n          limit,\r\n          total,\r\n          pages: Math.ceil(total / limit),\r\n        },\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to get products: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET PRODUCT DETAILS\r\n   * Get single product with full details\r\n   */\r\n  static async getProductDetails(productId) {\r\n    try {\r\n      const product = await Product.findById(productId);\r\n      if (!product) throw new Error('Product not found');\r\n\r\n      return product;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get product: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * SEARCH PRODUCTS\r\n   * Full-text search with relevance scoring\r\n   */\r\n  static async searchProducts(query, limit = 20) {\r\n    try {\r\n      // Create text index if not exists\r\n      await Product.collection.createIndex({\r\n        name: 'text',\r\n        description: 'text',\r\n      });\r\n\r\n      const results = await Product.find(\r\n        { $text: { $search: query }, isActive: true },\r\n        { score: { $meta: 'textScore' } }\r\n      )\r\n        .sort({ score: { $meta: 'textScore' } })\r\n        .limit(limit)\r\n        .lean();\r\n\r\n      return results;\r\n    } catch (error) {\r\n      // Fallback to regex search\r\n      return await Product.find({\r\n        $or: [\r\n          { name: { $regex: query, $options: 'i' } },\r\n          { description: { $regex: query, $options: 'i' } },\r\n        ],\r\n        isActive: true,\r\n      })\r\n        .limit(limit)\r\n        .lean();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ADD TO CART\r\n   * Add product to shopping cart\r\n   */\r\n  static async addToCart(userId, productId, quantity, variant) {\r\n    try {\r\n      const product = await Product.findById(productId);\r\n      if (!product) throw new Error('Product not found');\r\n\r\n      // Check stock\r\n      if (product.totalStock < quantity) {\r\n        throw new Error(`Only ${product.totalStock} items in stock`);\r\n      }\r\n\r\n      // Get or create cart\r\n      let cart = await Cart.findOne({ userId });\r\n      if (!cart) {\r\n        cart = new Cart({ userId, items: [] });\r\n      }\r\n\r\n      // Check if product already in cart\r\n      const existingItem = cart.items.find(\r\n        item =>\r\n          item.productId.toString() === productId &&\r\n          JSON.stringify(item.variant) === JSON.stringify(variant)\r\n      );\r\n\r\n      if (existingItem) {\r\n        existingItem.quantity += quantity;\r\n      } else {\r\n        cart.items.push({\r\n          productId,\r\n          quantity,\r\n          price: product.finalPrice,\r\n          variant,\r\n        });\r\n      }\r\n\r\n      await cart.save();\r\n\r\n      return {\r\n        success: true,\r\n        cart,\r\n        message: 'Product added to cart',\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to add to cart: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET CART\r\n   * Retrieve user's shopping cart\r\n   */\r\n  static async getCart(userId) {\r\n    try {\r\n      let cart = await Cart.findOne({ userId }).populate(\r\n        'items.productId',\r\n        'name price finalPrice images'\r\n      );\r\n\r\n      if (!cart) {\r\n        cart = new Cart({ userId });\r\n        await cart.save();\r\n      }\r\n\r\n      return cart;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get cart: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * UPDATE CART ITEM\r\n   * Update quantity for item in cart\r\n   */\r\n  static async updateCartItem(userId, productId, quantity) {\r\n    try {\r\n      const cart = await Cart.findOne({ userId });\r\n      if (!cart) throw new Error('Cart not found');\r\n\r\n      const item = cart.items.find(i => i.productId.toString() === productId);\r\n      if (!item) throw new Error('Item not found in cart');\r\n\r\n      if (quantity <= 0) {\r\n        // Remove item\r\n        cart.items = cart.items.filter(\r\n          i => i.productId.toString() !== productId\r\n        );\r\n      } else {\r\n        item.quantity = quantity;\r\n      }\r\n\r\n      await cart.save();\r\n      return cart;\r\n    } catch (error) {\r\n      throw new Error(`Failed to update cart: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * REMOVE FROM CART\r\n   * Remove item from cart\r\n   */\r\n  static async removeFromCart(userId, productId) {\r\n    try {\r\n      const cart = await Cart.findOne({ userId });\r\n      if (!cart) throw new Error('Cart not found');\r\n\r\n      cart.items = cart.items.filter(\r\n        i => i.productId.toString() !== productId\r\n      );\r\n\r\n      await cart.save();\r\n      return cart;\r\n    } catch (error) {\r\n      throw new Error(`Failed to remove from cart: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * CLEAR CART\r\n   * Empty all items from cart\r\n   */\r\n  static async clearCart(userId) {\r\n    try {\r\n      const cart = await Cart.findOne({ userId });\r\n      if (cart) {\r\n        cart.items = [];\r\n        await cart.save();\r\n      }\r\n      return cart;\r\n    } catch (error) {\r\n      throw new Error(`Failed to clear cart: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * APPLY COUPON\r\n   * Apply discount coupon to cart\r\n   */\r\n  static async applyCoupon(userId, couponCode) {\r\n    try {\r\n      const cart = await Cart.findOne({ userId });\r\n      if (!cart) throw new Error('Cart not found');\r\n\r\n      const coupon = await Coupon.findOne({\r\n        code: couponCode.toUpperCase(),\r\n        isActive: true,\r\n        validFrom: { $lte: new Date() },\r\n        validUntil: { $gte: new Date() },\r\n      });\r\n\r\n      if (!coupon) throw new Error('Invalid or expired coupon');\r\n\r\n      // Check usage\r\n      if (coupon.maxUses && coupon.usedCount >= coupon.maxUses) {\r\n        throw new Error('Coupon usage limit reached');\r\n      }\r\n\r\n      // Check minimum purchase\r\n      if (cart.subtotal < coupon.minPurchaseAmount) {\r\n        throw new Error(\r\n          `Minimum purchase ${coupon.minPurchaseAmount} required`\r\n        );\r\n      }\r\n\r\n      // Calculate discount\r\n      let discount = 0;\r\n      if (coupon.discountType === 'percentage') {\r\n        discount = (cart.subtotal * coupon.discountValue) / 100;\r\n        if (coupon.maxDiscount) {\r\n          discount = Math.min(discount, coupon.maxDiscount);\r\n        }\r\n      } else {\r\n        discount = coupon.discountValue;\r\n      }\r\n\r\n      cart.coupon = couponCode;\r\n      cart.discount = discount;\r\n      await cart.save();\r\n\r\n      return {\r\n        success: true,\r\n        cart,\r\n        discount,\r\n        message: 'Coupon applied',\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to apply coupon: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * CREATE CHECKOUT SESSION\r\n   * Initialize checkout process\r\n   */\r\n  static async createCheckoutSession(userId, shippingData) {\r\n    try {\r\n      const cart = await Cart.findOne({ userId });\r\n      if (!cart || cart.items.length === 0) {\r\n        throw new Error('Cart is empty');\r\n      }\r\n\r\n      const sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n      const checkout = new Checkout({\r\n        userId,\r\n        sessionId,\r\n        items: cart.items,\r\n        shippingAddress: shippingData,\r\n        subtotal: cart.subtotal,\r\n        tax: cart.tax,\r\n        shipping: cart.shipping,\r\n        discount: cart.discount,\r\n        total: cart.total,\r\n        status: 'checkout',\r\n        expiresAt: new Date(Date.now() + 30 * 60 * 1000), // 30 min expiry\r\n      });\r\n\r\n      await checkout.save();\r\n\r\n      return {\r\n        success: true,\r\n        sessionId: checkout.sessionId,\r\n        checkout,\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to create checkout session: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * UPDATE CHECKOUT PAYMENT\r\n   * Update payment method and process payment\r\n   */\r\n  static async updateCheckoutPayment(sessionId, paymentData) {\r\n    try {\r\n      const checkout = await Checkout.findOne({ sessionId });\r\n      if (!checkout) throw new Error('Checkout session not found');\r\n\r\n      if (checkout.expiresAt < new Date()) {\r\n        throw new Error('Checkout session expired');\r\n      }\r\n\r\n      checkout.paymentMethod = paymentData.method;\r\n      checkout.paymentStatus = 'processing';\r\n      checkout.status = 'payment_pending';\r\n\r\n      // TODO: Integrate with payment gateway (Stripe, PayPal, etc.)\r\n      // For now, simulate successful payment\r\n      checkout.paymentStatus = 'completed';\r\n      checkout.status = 'confirmed';\r\n\r\n      await checkout.save();\r\n\r\n      return {\r\n        success: true,\r\n        checkout,\r\n        message: 'Payment processed successfully',\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to process payment: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET CHECKOUT DETAILS\r\n   * Retrieve checkout session details\r\n   */\r\n  static async getCheckout(sessionId) {\r\n    try {\r\n      const checkout = await Checkout.findOne({ sessionId });\r\n      if (!checkout) throw new Error('Checkout session not found');\r\n\r\n      return checkout;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get checkout: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ADD TO WISHLIST\r\n   * Add product to wishlist\r\n   */\r\n  static async addToWishlist(userId, productId) {\r\n    try {\r\n      let wishlist = await Wishlist.findOne({ userId });\r\n      if (!wishlist) {\r\n        wishlist = new Wishlist({ userId });\r\n      }\r\n\r\n      // Check if already in wishlist\r\n      if (!wishlist.items.find(i => i.productId.toString() === productId)) {\r\n        wishlist.items.push({ productId });\r\n      }\r\n\r\n      await wishlist.save();\r\n      return wishlist;\r\n    } catch (error) {\r\n      throw new Error(`Failed to add to wishlist: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * REMOVE FROM WISHLIST\r\n   * Remove product from wishlist\r\n   */\r\n  static async removeFromWishlist(userId, productId) {\r\n    try {\r\n      const wishlist = await Wishlist.findOne({ userId });\r\n      if (wishlist) {\r\n        wishlist.items = wishlist.items.filter(\r\n          i => i.productId.toString() !== productId\r\n        );\r\n        await wishlist.save();\r\n      }\r\n      return wishlist;\r\n    } catch (error) {\r\n      throw new Error(`Failed to remove from wishlist: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET WISHLIST\r\n   * Retrieve user's wishlist\r\n   */\r\n  static async getWishlist(userId) {\r\n    try {\r\n      let wishlist = await Wishlist.findOne({ userId }).populate(\r\n        'items.productId',\r\n        'name price finalPrice images rating'\r\n      );\r\n\r\n      if (!wishlist) {\r\n        wishlist = new Wishlist({ userId });\r\n        await wishlist.save();\r\n      }\r\n\r\n      return wishlist;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get wishlist: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * LOG INVENTORY\r\n   * Track inventory changes\r\n   */\r\n  static async logInventoryChange(productId, action, quantity, reference) {\r\n    try {\r\n      const log = new InventoryLog({\r\n        productId,\r\n        action,\r\n        quantity,\r\n        reference,\r\n        createdAt: new Date(),\r\n      });\r\n\r\n      await log.save();\r\n      return log;\r\n    } catch (error) {\r\n      throw new Error(`Failed to log inventory: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET SIMILAR PRODUCTS\r\n   * Get products similar to given product\r\n   */\r\n  static async getSimilarProducts(productId, limit = 5) {\r\n    try {\r\n      const product = await Product.findById(productId);\r\n      if (!product) throw new Error('Product not found');\r\n\r\n      const similar = await Product.find({\r\n        category: product.category,\r\n        _id: { $ne: productId },\r\n        isActive: true,\r\n      })\r\n        .limit(limit)\r\n        .lean();\r\n\r\n      return similar;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get similar products: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET FEATURED PRODUCTS\r\n   * Get featured products for homepage\r\n   */\r\n  static async getFeaturedProducts(limit = 10) {\r\n    try {\r\n      const featured = await Product.find({\r\n        isFeatured: true,\r\n        isActive: true,\r\n      })\r\n        .limit(limit)\r\n        .lean();\r\n\r\n      return featured;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get featured products: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * GET NEW PRODUCTS\r\n   * Get recently added products\r\n   */\r\n  static async getNewProducts(limit = 10, days = 30) {\r\n    try {\r\n      const since = new Date(Date.now() - days * 24 * 60 * 60 * 1000);\r\n\r\n      const newProducts = await Product.find({\r\n        createdAt: { $gte: since },\r\n        isActive: true,\r\n      })\r\n        .sort({ createdAt: -1 })\r\n        .limit(limit)\r\n        .lean();\r\n\r\n      return newProducts;\r\n    } catch (error) {\r\n      throw new Error(`Failed to get new products: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ADD PRODUCT REVIEW\r\n   * Add review and rating to product\r\n   */\r\n  static async addProductReview(productId, userId, rating, title, comment) {\r\n    try {\r\n      if (rating < 1 || rating > 5) {\r\n        throw new Error('Rating must be between 1 and 5');\r\n      }\r\n\r\n      const product = await Product.findById(productId);\r\n      if (!product) throw new Error('Product not found');\r\n\r\n      // Check for duplicate review\r\n      const existingReview = product.reviews.find(\r\n        r => r.userId.toString() === userId\r\n      );\r\n      if (existingReview) {\r\n        throw new Error('You have already reviewed this product');\r\n      }\r\n\r\n      // Add review\r\n      product.reviews.push({\r\n        userId,\r\n        rating,\r\n        title,\r\n        comment,\r\n      });\r\n\r\n      // Recalculate average rating\r\n      const totalRating = product.reviews.reduce((sum, r) => sum + r.rating, 0);\r\n      product.rating.average = (totalRating / product.reviews.length).toFixed(2);\r\n      product.rating.count = product.reviews.length;\r\n\r\n      await product.save();\r\n\r\n      return {\r\n        success: true,\r\n        product,\r\n        message: 'Review added successfully',\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to add review: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * UPDATE PRODUCT STOCK\r\n   * Update product stock after order\r\n   */\r\n  static async updateProductStock(productId, quantitySold) {\r\n    try {\r\n      const product = await Product.findById(productId);\r\n      if (!product) throw new Error('Product not found');\r\n\r\n      if (product.totalStock < quantitySold) {\r\n        throw new Error('Insufficient stock');\r\n      }\r\n\r\n      product.totalStock -= quantitySold;\r\n      await product.save();\r\n\r\n      // Log the change\r\n      await this.logInventoryChange(\r\n        productId,\r\n        'stock_out',\r\n        quantitySold,\r\n        'order'\r\n      );\r\n\r\n      return product;\r\n    } catch (error) {\r\n      throw new Error(`Failed to update stock: ${error.message}`);\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = EcommerceService;\r\n"],"mappings":"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","ignoreList":[]}