{"version":3,"names":["KPI","AnalyticsData","Prediction","ReportTemplate","GeneratedReport","require","PDFDocument","ExcelJS","fs","promises","path","AnalyticsMetric","constructor","name","label","description","unit","value","previousValue","trend","status","history","threshold","warning","critical","updateValue","newValue","push","timestamp","Date","setThreshold","getStatusColor","colors","getTrendColor","DashboardTemplate","title","widgets","addMetric","key","options","type","addChart","addTable","data","validate","errors","trim","length","valid","TrendAnalyzer","analyzeTrend","periods","Array","isArray","direction","forecast","n","sumX","sumY","reduce","a","b","sumXY","sum","val","i","sumX2","slope","intercept","get30DayTrend","slice","get60DayTrend","get90DayTrend","KPIAggregator","kpis","registerKPI","metric","getKPI","getAllMetrics","Object","values","aggregateByPeriod","period","grouped","forEach","entry","date","toISOString","split","startOfWeek","setDate","getDate","getDay","substring","entries","map","count","compareMetrics","name1","name2","m1","m2","vals1","h","vals2","minLength","Math","min","v1","v2","mean1","mean2","numerator","sum1","sum2","diff1","diff2","correlation","sqrt","metric1","metric2","isNaN","trend1","trend2","comparison","AnalyticsService","metrics","dashboards","alerts","activeAlerts","snapshots","trendAnalyzer","kpiAggregator","createMetric","getMetric","updateMetric","setMetricThreshold","createDashboard","dashboard","getDashboard","addWidgetToDashboard","dashboardName","widget","analyze30DayTrend","metricName","analyze60DayTrend","analyze90DayTrend","getComparisonTrends","metric1Name","metric2Name","aggregateMetricByPeriod","takeSnapshot","snapshot","id","now","random","toString","substr","getSnapshotHistory","limit","compareSnapshots","snapId1","snapId2","snap1","find","s","snap2","keys","before","after","change","percentChange","snap1Id","snap2Id","timestamp1","timestamp2","createAlert","condition","severity","alert","enabled","triggered","triggeredAt","evaluateAlerts","shouldTrigger","getActiveAlerts","getSystemStats","getHealthReport","normalMetrics","warningMetrics","criticalMetrics","summary","total","normal","healthPercentage","toFixed","exportData","format","stats","health","JSON","stringify","calculateKPI","kpiId","kpi","findById","Error","calculatedValue","category","calculateOperationalKPI","calculateQualityKPI","calculateSatisfactionKPI","calculateFinancialKPI","calculateCustomKPI","previous","current","calculation","lastCalculated","save","error","console","code","getAttendanceRate","getFacilityUtilization","getOperationalEfficiency","getServiceSatisfaction","getComplianceRate","getDefectRate","getStudentSatisfaction","getParentSatisfaction","getEmployeeSatisfaction","getTotalRevenue","getProfitMargin","getCollectionRate","getTotalExpenses","formula","eval","getExecutiveDashboard","filters","operationalKPIs","isActive","sort","qualityKPIs","satisfactionKPIs","financialKPIs","getGeneralStatistics","operational","quality","satisfaction","financial","generatedAt","generatePrediction","historicalData","predictions","linearRegression","prediction","model","accuracy","calculateAccuracy","from","to","calculatedAt","futureDays","x","d","y","meanX","meanY","num","den","pow","lastDate","predictedValue","confidence","max","getTime","round","lowerBound","upperBound","historical","testSize","floor","testData","predData","totalError","actual","predicted","abs","mape","generateReport","templateId","userId","template","startTime","collectReportData","report","titleAr","nameAr","appliedFilters","generatedBy","filePath","generatePDFReport","_id","generateExcelReport","generateCSVReport","generateJSONReport","stat","file","size","url","generationTime","generatedCount","lastGenerated","message","details","charts","structure","$in","reportId","fileName","join","__dirname","mkdir","dirname","recursive","Promise","resolve","reject","doc","formatting","pageSize","layout","orientation","margins","top","bottom","left","right","stream","pipe","createWriteStream","header","show","fontSize","text","align","toLocaleDateString","moveDown","underline","footer","toLocaleString","page","height","end","on","workbook","Workbook","worksheet","addWorksheet","addRow","target","xlsx","writeFile","csv","reportData","totalUsers","activeUsers","totalRevenue","totalExpenses","profitMargin","trackUserBehavior","success","behavior","loginFrequency","averageSessionDuration","mostUsedFeatures","peakHours","deviceTypes","browsers","engagement","score","level","getPerformanceMetrics","timeRange","responseTime","average","p95","uptime","errorRate","throughput","cpuUsage","memoryUsage","databaseLatency","getCustomDashboard","growth","active","inactive","refreshInterval","analyzeTrends","changePercent","dataPoints","nextWeekEstimate","getRecommendations","recommendations","priority","impact","actionRequired","totalRecommendations","generateAnalysisReport","reportType","insights","keyMetrics","newUsers","engagementRate","retentionRate","departmentPerformance","IT","performance","users","HR","Sales","Marketing","Finance","topInsights","trackConversion","event","conversion","step","completionRate","timeSpent","getRealTimeAnalytics","realTime","activeRequests","cps","avgResponseTime","topPages","duration","topActions","action","getPredictiveAnalytics","churnRisk","probability","riskUsers","growthForecast","nextMonth","nextQuarter","featureAdoption","highAdoption","mediumAdoption","lowAdoption","exportAnalyticsReport","downloadUrl","expiresIn","getABTestResults","testId","results","testName","variants","conversions","conversionRate","winner","getMarketingMetrics","campaign","impressions","clicks","ctr","cost","cpc","roi","module","exports","default","assign"],"sources":["analyticsService.js"],"sourcesContent":["/**\r\n * Advanced Analytics Service\r\n * خدمة التحليلات المتقدمة والتقارير الذكية\r\n *\r\n * Features:\r\n * - KPI Calculation & Tracking\r\n * - Report Generation (PDF, Excel, CSV, JSON)\r\n * - Predictive Analytics\r\n * - Executive Dashboards\r\n * - Business Intelligence\r\n */\r\n\r\nconst {\r\n  KPI,\r\n  AnalyticsData,\r\n  Prediction,\r\n  ReportTemplate,\r\n  GeneratedReport,\r\n} = require('../models/analytics');\r\nconst PDFDocument = require('pdfkit');\r\nconst ExcelJS = require('exceljs');\r\nconst fs = require('fs').promises;\r\nconst path = require('path');\r\n\r\n// ===========================\r\n// ANALYTICS METRIC CLASS\r\n// ===========================\r\nclass AnalyticsMetric {\r\n  constructor(name, label, description = '', unit = '') {\r\n    this.name = name;\r\n    this.label = label;\r\n    this.description = description;\r\n    this.unit = unit;\r\n    this.value = 0;\r\n    this.previousValue = 0;\r\n    this.trend = 0;\r\n    this.status = 'normal';\r\n    this.history = [];\r\n    this.threshold = { warning: null, critical: null };\r\n  }\r\n\r\n  updateValue(newValue) {\r\n    this.previousValue = this.value;\r\n    this.value = newValue;\r\n    \r\n    // Calculate trend percentage\r\n    if (this.previousValue !== 0) {\r\n      this.trend = ((newValue - this.previousValue) / this.previousValue) * 100;\r\n    } else {\r\n      this.trend = newValue > 0 ? 100 : 0;\r\n    }\r\n\r\n    // Add to history\r\n    this.history.push({\r\n      timestamp: new Date(),\r\n      value: newValue\r\n    });\r\n\r\n    // Update status based on thresholds\r\n    if (this.threshold.critical && newValue > this.threshold.critical) {\r\n      this.status = 'critical';\r\n    } else if (this.threshold.warning && newValue > this.threshold.warning) {\r\n      this.status = 'warning';\r\n    } else {\r\n      this.status = 'normal';\r\n    }\r\n  }\r\n\r\n  setThreshold(warning, critical) {\r\n    this.threshold.warning = warning;\r\n    this.threshold.critical = critical;\r\n  }\r\n\r\n  getStatusColor() {\r\n    const colors = {\r\n      'normal': '#00aa00',\r\n      'warning': '#ffaa00',\r\n      'critical': '#ff4444'\r\n    };\r\n    return colors[this.status] || '#00aa00';\r\n  }\r\n\r\n  getTrendColor() {\r\n    if (this.trend > 10) return 'green';\r\n    if (this.trend < -10) return 'red';\r\n    return 'orange';\r\n  }\r\n}\r\n\r\n// ===========================\r\n// DASHBOARD TEMPLATE CLASS\r\n// ===========================\r\nclass DashboardTemplate {\r\n  constructor(name, title, description = '') {\r\n    this.name = name;\r\n    this.title = title;\r\n    this.description = description;\r\n    this.widgets = [];\r\n  }\r\n\r\n  addMetric(key, label, options = {}) {\r\n    this.widgets.push({\r\n      type: 'metric',\r\n      key,\r\n      label,\r\n      options\r\n    });\r\n  }\r\n\r\n  addChart(key, label, options = {}) {\r\n    this.widgets.push({\r\n      type: 'chart',\r\n      key,\r\n      label,\r\n      options\r\n    });\r\n  }\r\n\r\n  addTable(data, options = {}) {\r\n    this.widgets.push({\r\n      type: 'table',\r\n      data,\r\n      options\r\n    });\r\n  }\r\n\r\n  validate() {\r\n    const errors = [];\r\n    \r\n    if (!this.name || this.name.trim() === '') {\r\n      errors.push('Dashboard name is required');\r\n    }\r\n    \r\n    if (this.widgets.length === 0) {\r\n      errors.push('Dashboard must have at least one widget');\r\n    }\r\n\r\n    return {\r\n      valid: errors.length === 0,\r\n      errors\r\n    };\r\n  }\r\n}\r\n\r\n// ===========================\r\n// TREND ANALYZER CLASS\r\n// ===========================\r\nclass TrendAnalyzer {\r\n  analyzeTrend(data, periods = null) {\r\n    if (!Array.isArray(data) || data.length === 0) {\r\n      return { direction: 'flat', trend: 'flat', forecast: 0 };\r\n    }\r\n\r\n    // Calculate simple linear regression\r\n    const n = data.length;\r\n    const sumX = (n * (n + 1)) / 2;\r\n    const sumY = data.reduce((a, b) => a + b, 0);\r\n    const sumXY = data.reduce((sum, val, i) => sum + (i + 1) * val, 0);\r\n    const sumX2 = (n * (n + 1) * (2 * n + 1)) / 6;\r\n\r\n    const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);\r\n    const intercept = (sumY - slope * sumX) / n;\r\n\r\n    // Determine direction\r\n    let direction = 'flat';\r\n    let trend = 'flat';\r\n\r\n    if (slope > 0.5) {\r\n      direction = 'up';\r\n      // Strong trend if: periods >= 4 OR data length >= 10\r\n      trend = (periods && periods >= 4) || data.length >= 10 ? 'strong-up' : 'up';\r\n    } else if (slope < -0.5) {\r\n      direction = 'down';\r\n      // Strong trend if: periods >= 4 OR data length >= 10\r\n      trend = (periods && periods >= 4) || data.length >= 10 ? 'strong-down' : 'down';\r\n    }\r\n\r\n    // Calculate forecast for next period\r\n    const forecast = intercept + slope * (n + 1);\r\n\r\n    return {\r\n      direction,\r\n      trend,\r\n      forecast,\r\n      slope,\r\n      intercept\r\n    };\r\n  }\r\n\r\n  get30DayTrend(data) {\r\n    return this.analyzeTrend(data.slice(-30));\r\n  }\r\n\r\n  get60DayTrend(data) {\r\n    return this.analyzeTrend(data.slice(-60));\r\n  }\r\n\r\n  get90DayTrend(data) {\r\n    return this.analyzeTrend(data.slice(-90));\r\n  }\r\n}\r\n\r\n// ===========================\r\n// KPI AGGREGATOR CLASS\r\n// ===========================\r\nclass KPIAggregator {\r\n  constructor() {\r\n    this.kpis = {};\r\n  }\r\n\r\n  registerKPI(metric) {\r\n    this.kpis[metric.name] = metric;\r\n  }\r\n\r\n  getKPI(name) {\r\n    return this.kpis[name];\r\n  }\r\n\r\n  getAllMetrics() {\r\n    return Object.values(this.kpis);\r\n  }\r\n\r\n  aggregateByPeriod(name, period = 'daily') {\r\n    const metric = this.kpis[name];\r\n    if (!metric || !metric.history) return [];\r\n\r\n    const grouped = {};\r\n    \r\n    metric.history.forEach(entry => {\r\n      const date = new Date(entry.timestamp);\r\n      let key;\r\n\r\n      if (period === 'daily') {\r\n        key = date.toISOString().split('T')[0];\r\n      } else if (period === 'weekly') {\r\n        const startOfWeek = new Date(date);\r\n        startOfWeek.setDate(date.getDate() - date.getDay());\r\n        key = startOfWeek.toISOString().split('T')[0];\r\n      } else if (period === 'monthly') {\r\n        key = date.toISOString().substring(0, 7);\r\n      }\r\n\r\n      if (!grouped[key]) {\r\n        grouped[key] = [];\r\n      }\r\n      grouped[key].push(entry.value);\r\n    });\r\n\r\n    return Object.entries(grouped).map(([period, values]) => ({\r\n      period,\r\n      value: values.reduce((a, b) => a + b, 0) / values.length,\r\n      count: values.length\r\n    }));\r\n  }\r\n\r\n  compareMetrics(name1, name2) {\r\n    const m1 = this.kpis[name1];\r\n    const m2 = this.kpis[name2];\r\n\r\n    if (!m1 || !m2) return null;\r\n\r\n    // Get values arrays\r\n    const vals1 = m1.history.map(h => h.value);\r\n    const vals2 = m2.history.map(h => h.value);\r\n\r\n    // Calculate correlation coefficient\r\n    const minLength = Math.min(vals1.length, vals2.length);\r\n    const v1 = vals1.slice(-minLength);\r\n    const v2 = vals2.slice(-minLength);\r\n\r\n    // Pearson correlation\r\n    const mean1 = v1.reduce((a, b) => a + b, 0) / v1.length;\r\n    const mean2 = v2.reduce((a, b) => a + b, 0) / v2.length;\r\n\r\n    let numerator = 0;\r\n    let sum1 = 0;\r\n    let sum2 = 0;\r\n\r\n    for (let i = 0; i < v1.length; i++) {\r\n      const diff1 = v1[i] - mean1;\r\n      const diff2 = v2[i] - mean2;\r\n      numerator += diff1 * diff2;\r\n      sum1 += diff1 * diff1;\r\n      sum2 += diff2 * diff2;\r\n    }\r\n\r\n    const correlation = numerator / Math.sqrt(sum1 * sum2);\r\n\r\n    return {\r\n      metric1: name1,\r\n      metric2: name2,\r\n      correlation: isNaN(correlation) ? 0 : correlation,\r\n      trend1: m1.trend,\r\n      trend2: m2.trend,\r\n      comparison: m1.value > m2.value ? 'metric1-higher' : 'metric2-higher'\r\n    };\r\n  }\r\n}\r\n\r\nclass AnalyticsService {\r\n  constructor() {\r\n    this.metrics = {};\r\n    this.dashboards = {};\r\n    this.alerts = [];\r\n    this.activeAlerts = [];\r\n    this.snapshots = [];\r\n    this.trendAnalyzer = new TrendAnalyzer();\r\n    this.kpiAggregator = new KPIAggregator();\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * METRIC MANAGEMENT\r\n   * ======================\r\n   */\r\n\r\n  createMetric(name, label, description = '', unit = '') {\r\n    const metric = new AnalyticsMetric(name, label, description, unit);\r\n    this.metrics[name] = metric;\r\n    this.kpiAggregator.registerKPI(metric);\r\n    return metric;\r\n  }\r\n\r\n  getMetric(name) {\r\n    return this.metrics[name];\r\n  }\r\n\r\n  getAllMetrics() {\r\n    return Object.values(this.metrics);\r\n  }\r\n\r\n  updateMetric(name, value) {\r\n    const metric = this.metrics[name];\r\n    if (metric) {\r\n      metric.updateValue(value);\r\n      return metric;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  setMetricThreshold(name, warning, critical) {\r\n    const metric = this.metrics[name];\r\n    if (metric) {\r\n      metric.setThreshold(warning, critical);\r\n      return metric;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * DASHBOARD MANAGEMENT   \r\n   * ======================\r\n   */\r\n\r\n  createDashboard(name, title, description = '') {\r\n    const dashboard = new DashboardTemplate(name, title, description);\r\n    this.dashboards[name] = dashboard;\r\n    return dashboard;\r\n  }\r\n\r\n  getDashboard(name) {\r\n    return this.dashboards[name];\r\n  }\r\n\r\n  addWidgetToDashboard(dashboardName, widget) {\r\n    const dashboard = this.dashboards[dashboardName];\r\n    if (dashboard) {\r\n      // Adapt widget format from test format to dashboard format\r\n      if (widget.type === 'metric' && widget.metric) {\r\n        dashboard.addMetric(widget.metric, widget.metric);\r\n      } else {\r\n        dashboard.widgets.push(widget);\r\n      }\r\n      return dashboard;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * TREND ANALYSIS\r\n   * ======================\r\n   */\r\n\r\n  analyze30DayTrend(metricName) {\r\n    const metric = this.metrics[metricName];\r\n    if (!metric) return null;\r\n\r\n    const data = metric.history.map(h => h.value);\r\n    return this.trendAnalyzer.get30DayTrend(data);\r\n  }\r\n\r\n  analyze60DayTrend(metricName) {\r\n    const metric = this.metrics[metricName];\r\n    if (!metric) return null;\r\n\r\n    const data = metric.history.map(h => h.value);\r\n    return this.trendAnalyzer.get60DayTrend(data);\r\n  }\r\n\r\n  analyze90DayTrend(metricName) {\r\n    const metric = this.metrics[metricName];\r\n    if (!metric) return null;\r\n\r\n    const data = metric.history.map(h => h.value);\r\n    return this.trendAnalyzer.get90DayTrend(data);\r\n  }\r\n\r\n  getComparisonTrends(metric1Name, metric2Name) {\r\n    return this.kpiAggregator.compareMetrics(metric1Name, metric2Name);\r\n  }\r\n\r\n  aggregateMetricByPeriod(metricName, period = 'daily') {\r\n    return this.kpiAggregator.aggregateByPeriod(metricName, period);\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * SNAPSHOT MANAGEMENT\r\n   * ======================\r\n   */\r\n\r\n  takeSnapshot(label = '') {\r\n    const snapshot = {\r\n      id: 'snap-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),\r\n      label,\r\n      timestamp: new Date(),\r\n      metrics: {}\r\n    };\r\n\r\n    // Capture current state of all metrics\r\n    for (const [name, metric] of Object.entries(this.metrics)) {\r\n      snapshot.metrics[name] = {\r\n        name: metric.name,\r\n        value: metric.value,\r\n        trend: metric.trend,\r\n        status: metric.status\r\n      };\r\n    }\r\n\r\n    this.snapshots.push(snapshot);\r\n    return snapshot;\r\n  }\r\n\r\n  getSnapshotHistory(limit = 10) {\r\n    return this.snapshots.slice(-limit);\r\n  }\r\n\r\n  compareSnapshots(snapId1, snapId2) {\r\n    const snap1 = this.snapshots.find(s => s.id === snapId1);\r\n    const snap2 = this.snapshots.find(s => s.id === snapId2);\r\n\r\n    if (!snap1 || !snap2) return null;\r\n\r\n    const comparison = {};\r\n    for (const metricName of Object.keys(snap1.metrics)) {\r\n      if (snap2.metrics[metricName]) {\r\n        const v1 = snap1.metrics[metricName].value;\r\n        const v2 = snap2.metrics[metricName].value;\r\n        comparison[metricName] = {\r\n          before: v1,\r\n          after: v2,\r\n          change: v2 - v1,\r\n          percentChange: v1 !== 0 ? ((v2 - v1) / v1 * 100) : 0\r\n        };\r\n      }\r\n    }\r\n\r\n    return {\r\n      snap1Id: snapId1,\r\n      snap2Id: snapId2,\r\n      timestamp1: snap1.timestamp,\r\n      timestamp2: snap2.timestamp,\r\n      comparison\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * ALERT MANAGEMENT\r\n   * ======================\r\n   */\r\n\r\n  createAlert(metricName, condition, threshold, severity = 'warning') {\r\n    const alert = {\r\n      id: 'alert-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),\r\n      metricName,\r\n      condition, // 'exceeds', 'below', 'equals'\r\n      threshold,\r\n      severity, // 'warning', 'critical'\r\n      enabled: true,\r\n      triggered: false,\r\n      triggeredAt: null\r\n    };\r\n\r\n    this.alerts.push(alert);\r\n    return alert;\r\n  }\r\n\r\n  evaluateAlerts() {\r\n    const triggered = [];\r\n    this.activeAlerts = []; // Reset active alerts for this evaluation\r\n\r\n    for (const alert of this.alerts) {\r\n      if (!alert.enabled) continue;\r\n\r\n      const metric = this.metrics[alert.metricName];\r\n      if (!metric) continue;\r\n\r\n      let shouldTrigger = false;\r\n\r\n      if (alert.condition === 'exceeds' && metric.value > alert.threshold) {\r\n        shouldTrigger = true;\r\n      } else if (alert.condition === 'below' && metric.value < alert.threshold) {\r\n        shouldTrigger = true;\r\n      } else if (alert.condition === 'equals' && metric.value === alert.threshold) {\r\n        shouldTrigger = true;\r\n      }\r\n\r\n      if (shouldTrigger) {\r\n        if (!alert.triggered) {\r\n          // First time triggered\r\n          alert.triggered = true;\r\n          alert.triggeredAt = new Date();\r\n        }\r\n        triggered.push(alert);\r\n        this.activeAlerts.push(alert);\r\n      } else if (alert.triggered) {\r\n        // Alert condition no longer met, reset\r\n        alert.triggered = false;\r\n        alert.triggeredAt = null;\r\n      }\r\n    }\r\n\r\n    return triggered;\r\n  }\r\n\r\n  getActiveAlerts() {\r\n    return this.activeAlerts;\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * REPORTING\r\n   * ======================\r\n   */\r\n\r\n  getSystemStats() {\r\n    return {\r\n      metrics: Object.keys(this.metrics).length,\r\n      dashboards: Object.keys(this.dashboards).length,\r\n      alerts: this.alerts.length,\r\n      snapshots: this.snapshots.length\r\n    };\r\n  }\r\n\r\n  getHealthReport() {\r\n    const metrics = Object.values(this.metrics);\r\n    const normalMetrics = [];\r\n    const warningMetrics = [];\r\n    const criticalMetrics = [];\r\n\r\n    for (const metric of metrics) {\r\n      if (metric.status === 'critical') {\r\n        criticalMetrics.push(metric.name);\r\n      } else if (metric.status === 'warning') {\r\n        warningMetrics.push(metric.name);\r\n      } else {\r\n        normalMetrics.push(metric.name);\r\n      }\r\n    }\r\n\r\n    return {\r\n      summary: {\r\n        total: metrics.length,\r\n        normal: normalMetrics.length,\r\n        warning: warningMetrics.length,\r\n        critical: criticalMetrics.length\r\n      },\r\n      normalMetrics,\r\n      warningMetrics,\r\n      criticalMetrics,\r\n      healthPercentage: metrics.length > 0 \r\n        ? ((normalMetrics.length / metrics.length) * 100).toFixed(2)\r\n        : 0\r\n    };\r\n  }\r\n\r\n  exportData(format = 'json') {\r\n    const data = {\r\n      timestamp: new Date().toISOString(),\r\n      metrics: {},\r\n      dashboards: Object.keys(this.dashboards),\r\n      stats: this.getSystemStats(),\r\n      health: this.getHealthReport()\r\n    };\r\n\r\n    for (const [name, metric] of Object.entries(this.metrics)) {\r\n      data.metrics[name] = {\r\n        name: metric.name,\r\n        label: metric.label,\r\n        value: metric.value,\r\n        trend: metric.trend,\r\n        status: metric.status,\r\n        history: metric.history\r\n      };\r\n    }\r\n\r\n    if (format === 'json') {\r\n      return JSON.stringify(data, null, 2);\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * KPI MANAGEMENT\r\n   * ======================\r\n   */\r\n\r\n  /**\r\n   * حساب مؤشر KPI\r\n   */\r\n  async calculateKPI(kpiId) {\r\n    try {\r\n      const kpi = await KPI.findById(kpiId);\r\n      if (!kpi) {\r\n        throw new Error('KPI not found');\r\n      }\r\n\r\n      let calculatedValue;\r\n\r\n      // حساب القيمة بناءً على الفئة\r\n      switch (kpi.category) {\r\n        case 'operational':\r\n          calculatedValue = await this.calculateOperationalKPI(kpi);\r\n          break;\r\n        case 'quality':\r\n          calculatedValue = await this.calculateQualityKPI(kpi);\r\n          break;\r\n        case 'satisfaction':\r\n          calculatedValue = await this.calculateSatisfactionKPI(kpi);\r\n          break;\r\n        case 'financial':\r\n          calculatedValue = await this.calculateFinancialKPI(kpi);\r\n          break;\r\n        default:\r\n          calculatedValue = await this.calculateCustomKPI(kpi);\r\n      }\r\n\r\n      // تحديث القيمة\r\n      kpi.value.previous = kpi.value.current;\r\n      kpi.value.current = calculatedValue;\r\n      kpi.calculation.lastCalculated = new Date();\r\n\r\n      // إضافة للتاريخ\r\n      kpi.history.push({\r\n        value: calculatedValue,\r\n        date: new Date(),\r\n      });\r\n\r\n      // الاحتفاظ بآخر 100 سجل فقط\r\n      if (kpi.history.length > 100) {\r\n        kpi.history = kpi.history.slice(-100);\r\n      }\r\n\r\n      await kpi.save();\r\n\r\n      return kpi;\r\n    } catch (error) {\r\n      console.error('Error calculating KPI:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * حساب مؤشرات الكفاءة التشغيلية\r\n   */\r\n  async calculateOperationalKPI(kpi) {\r\n    switch (kpi.code) {\r\n      case 'OPS_ATTENDANCE':\r\n        return await this.getAttendanceRate();\r\n      case 'OPS_UTILIZATION':\r\n        return await this.getFacilityUtilization();\r\n      case 'OPS_EFFICIENCY':\r\n        return await this.getOperationalEfficiency();\r\n      default:\r\n        return kpi.value.current || 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * حساب مؤشرات الجودة\r\n   */\r\n  async calculateQualityKPI(kpi) {\r\n    switch (kpi.code) {\r\n      case 'QUA_SATISFACTION':\r\n        return await this.getServiceSatisfaction();\r\n      case 'QUA_COMPLIANCE':\r\n        return await this.getComplianceRate();\r\n      case 'QUA_DEFECTS':\r\n        return await this.getDefectRate();\r\n      default:\r\n        return kpi.value.current || 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * حساب مؤشرات الرضا\r\n   */\r\n  async calculateSatisfactionKPI(kpi) {\r\n    switch (kpi.code) {\r\n      case 'SAT_STUDENT':\r\n        return await this.getStudentSatisfaction();\r\n      case 'SAT_PARENT':\r\n        return await this.getParentSatisfaction();\r\n      case 'SAT_EMPLOYEE':\r\n        return await this.getEmployeeSatisfaction();\r\n      default:\r\n        return kpi.value.current || 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * حساب المؤشرات المالية\r\n   */\r\n  async calculateFinancialKPI(kpi) {\r\n    switch (kpi.code) {\r\n      case 'FIN_REVENUE':\r\n        return await this.getTotalRevenue();\r\n      case 'FIN_PROFIT':\r\n        return await this.getProfitMargin();\r\n      case 'FIN_COLLECTION':\r\n        return await this.getCollectionRate();\r\n      case 'FIN_EXPENSES':\r\n        return await this.getTotalExpenses();\r\n      default:\r\n        return kpi.value.current || 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * حساب مؤشرات مخصصة\r\n   */\r\n  async calculateCustomKPI(kpi) {\r\n    if (kpi.calculation && kpi.calculation.formula) {\r\n      try {\r\n        // يمكن تنفيذ صيغ مخصصة بشكل آمن هنا\r\n        return eval(kpi.calculation.formula);\r\n      } catch (error) {\r\n        console.error('Error in custom formula:', error);\r\n        return kpi.value.current || 0;\r\n      }\r\n    }\r\n    return kpi.value.current || 0;\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * DASHBOARD & REPORTS\r\n   * ======================\r\n   */\r\n\r\n  /**\r\n   * الحصول على لوحة التحكم التنفيذية\r\n   */\r\n  async getExecutiveDashboard(filters = {}) {\r\n    try {\r\n      const operationalKPIs = await KPI.find({\r\n        category: 'operational',\r\n        isActive: true,\r\n      }).sort({ code: 1 });\r\n\r\n      const qualityKPIs = await KPI.find({\r\n        category: 'quality',\r\n        isActive: true,\r\n      }).sort({ code: 1 });\r\n\r\n      const satisfactionKPIs = await KPI.find({\r\n        category: 'satisfaction',\r\n        isActive: true,\r\n      }).sort({ code: 1 });\r\n\r\n      const financialKPIs = await KPI.find({\r\n        category: 'financial',\r\n        isActive: true,\r\n      }).sort({ code: 1 });\r\n\r\n      const stats = await this.getGeneralStatistics(filters);\r\n\r\n      return {\r\n        operational: operationalKPIs,\r\n        quality: qualityKPIs,\r\n        satisfaction: satisfactionKPIs,\r\n        financial: financialKPIs,\r\n        stats,\r\n        generatedAt: new Date(),\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting executive dashboard:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * PREDICTIVE ANALYTICS\r\n   * ======================\r\n   */\r\n\r\n  /**\r\n   * تحليلات تنبؤية\r\n   */\r\n  async generatePrediction(type, kpiId, period = 30) {\r\n    try {\r\n      const kpi = await KPI.findById(kpiId);\r\n      if (!kpi) {\r\n        throw new Error('KPI not found');\r\n      }\r\n\r\n      const historicalData = kpi.history.slice(-60).map(h => ({\r\n        date: h.date,\r\n        value: h.value,\r\n      }));\r\n\r\n      if (historicalData.length < 10) {\r\n        throw new Error('Not enough historical data for prediction');\r\n      }\r\n\r\n      const predictions = this.linearRegression(historicalData, period);\r\n\r\n      const prediction = new Prediction({\r\n        type,\r\n        kpi: kpiId,\r\n        historicalData,\r\n        predictions,\r\n        model: {\r\n          type: 'linear',\r\n          accuracy: this.calculateAccuracy(historicalData, predictions),\r\n        },\r\n        period: {\r\n          from: new Date(),\r\n          to: new Date(Date.now() + period * 24 * 60 * 60 * 1000),\r\n        },\r\n        status: 'completed',\r\n        calculatedAt: new Date(),\r\n      });\r\n\r\n      await prediction.save();\r\n\r\n      return prediction;\r\n    } catch (error) {\r\n      console.error('Error generating prediction:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الانحدار الخطي البسيط\r\n   */\r\n  linearRegression(data, futureDays) {\r\n    const n = data.length;\r\n    const x = data.map((d, i) => i);\r\n    const y = data.map(d => d.value);\r\n\r\n    const sumX = x.reduce((a, b) => a + b, 0);\r\n    const sumY = y.reduce((a, b) => a + b, 0);\r\n    const meanX = sumX / n;\r\n    const meanY = sumY / n;\r\n\r\n    let num = 0;\r\n    let den = 0;\r\n    for (let i = 0; i < n; i++) {\r\n      num += (x[i] - meanX) * (y[i] - meanY);\r\n      den += Math.pow(x[i] - meanX, 2);\r\n    }\r\n    const slope = num / den;\r\n    const intercept = meanY - slope * meanX;\r\n\r\n    const predictions = [];\r\n    const lastDate = data[n - 1].date;\r\n\r\n    for (let i = 1; i <= futureDays; i++) {\r\n      const predictedValue = intercept + slope * (n + i);\r\n      const confidence = Math.max(50, 95 - i);\r\n\r\n      predictions.push({\r\n        date: new Date(lastDate.getTime() + i * 24 * 60 * 60 * 1000),\r\n        predictedValue: Math.round(predictedValue * 100) / 100,\r\n        confidence,\r\n        lowerBound: Math.round(predictedValue * 0.9 * 100) / 100,\r\n        upperBound: Math.round(predictedValue * 1.1 * 100) / 100,\r\n      });\r\n    }\r\n\r\n    return predictions;\r\n  }\r\n\r\n  /**\r\n   * حساب دقة النموذج\r\n   */\r\n  calculateAccuracy(historical, predictions) {\r\n    const testSize = Math.min(10, Math.floor(historical.length * 0.2));\r\n    const testData = historical.slice(-testSize);\r\n    const predData = predictions.slice(0, testSize);\r\n\r\n    let totalError = 0;\r\n    for (let i = 0; i < testSize; i++) {\r\n      const actual = testData[i].value;\r\n      const predicted = predData[i].predictedValue;\r\n      totalError += Math.abs((actual - predicted) / actual);\r\n    }\r\n\r\n    const mape = (totalError / testSize) * 100;\r\n    return Math.max(0, Math.min(100, 100 - mape));\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * REPORT GENERATION\r\n   * ======================\r\n   */\r\n\r\n  /**\r\n   * توليد تقرير\r\n   */\r\n  async generateReport(templateId, filters, format, userId) {\r\n    try {\r\n      const template = await ReportTemplate.findById(templateId);\r\n      if (!template) {\r\n        throw new Error('Template not found');\r\n      }\r\n\r\n      const startTime = Date.now();\r\n      const data = await this.collectReportData(template, filters);\r\n\r\n      const report = new GeneratedReport({\r\n        template: templateId,\r\n        title: template.name,\r\n        titleAr: template.nameAr,\r\n        period: filters.period,\r\n        appliedFilters: filters,\r\n        data,\r\n        generatedBy: userId,\r\n        generatedAt: new Date(),\r\n        status: 'generating',\r\n      });\r\n\r\n      await report.save();\r\n\r\n      let filePath;\r\n      switch (format) {\r\n        case 'pdf':\r\n          filePath = await this.generatePDFReport(template, data, report._id);\r\n          break;\r\n        case 'excel':\r\n          filePath = await this.generateExcelReport(template, data, report._id);\r\n          break;\r\n        case 'csv':\r\n          filePath = await this.generateCSVReport(template, data, report._id);\r\n          break;\r\n        case 'json':\r\n          filePath = await this.generateJSONReport(template, data, report._id);\r\n          break;\r\n        default:\r\n          throw new Error('Unsupported format');\r\n      }\r\n\r\n      const stats = await fs.stat(filePath);\r\n      report.file = {\r\n        format,\r\n        path: filePath,\r\n        size: stats.size,\r\n        url: `/api/reports/download/${report._id}`,\r\n      };\r\n      report.status = 'completed';\r\n      report.generationTime = (Date.now() - startTime) / 1000;\r\n\r\n      await report.save();\r\n\r\n      template.stats.generatedCount += 1;\r\n      template.stats.lastGenerated = new Date();\r\n      await template.save();\r\n\r\n      return report;\r\n    } catch (error) {\r\n      console.error('Error generating report:', error);\r\n      if (report) {\r\n        report.status = 'failed';\r\n        report.error = error.message;\r\n        await report.save();\r\n      }\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * جمع بيانات التقرير\r\n   */\r\n  async collectReportData(template, filters) {\r\n    const data = {\r\n      summary: {},\r\n      details: [],\r\n      charts: [],\r\n      kpis: [],\r\n    };\r\n\r\n    if (template.structure.kpis && template.structure.kpis.length > 0) {\r\n      data.kpis = await KPI.find({\r\n        _id: { $in: template.structure.kpis },\r\n        isActive: true,\r\n      });\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * توليد تقرير PDF\r\n   */\r\n  async generatePDFReport(template, data, reportId) {\r\n    const fileName = `report_${reportId}_${Date.now()}.pdf`;\r\n    const filePath = path.join(__dirname, '..', 'public', 'reports', fileName);\r\n\r\n    await fs.mkdir(path.dirname(filePath), { recursive: true });\r\n\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        const doc = new PDFDocument({\r\n          size: template.formatting?.pageSize || 'A4',\r\n          layout: template.formatting?.orientation || 'portrait',\r\n          margins: { top: 50, bottom: 50, left: 50, right: 50 },\r\n        });\r\n\r\n        const stream = doc.pipe(require('fs').createWriteStream(filePath));\r\n\r\n        if (template.formatting?.header?.show) {\r\n          doc.fontSize(20).text(template.nameAr, { align: 'center' });\r\n          doc.fontSize(12).text(new Date().toLocaleDateString('ar-SA'), { align: 'center' });\r\n          doc.moveDown();\r\n        }\r\n\r\n        if (data.kpis && data.kpis.length > 0) {\r\n          doc.fontSize(16).text('مؤشرات الأداء الرئيسية', { underline: true });\r\n          doc.moveDown();\r\n\r\n          data.kpis.forEach(kpi => {\r\n            doc.fontSize(12).text(`${kpi.nameAr}: ${kpi.value.current} ${kpi.unit}`);\r\n            doc.moveDown(0.5);\r\n          });\r\n        }\r\n\r\n        if (template.formatting?.footer?.show) {\r\n          doc\r\n            .fontSize(10)\r\n            .text(\r\n              `تم الإنشاء بواسطة نظام ERP - ${new Date().toLocaleString('ar-SA')}`,\r\n              50,\r\n              doc.page.height - 50,\r\n              { align: 'center' }\r\n            );\r\n        }\r\n\r\n        doc.end();\r\n\r\n        stream.on('finish', () => resolve(filePath));\r\n        stream.on('error', reject);\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * توليد تقرير Excel\r\n   */\r\n  async generateExcelReport(template, data, reportId) {\r\n    const fileName = `report_${reportId}_${Date.now()}.xlsx`;\r\n    const filePath = path.join(__dirname, '..', 'public', 'reports', fileName);\r\n\r\n    await fs.mkdir(path.dirname(filePath), { recursive: true });\r\n\r\n    const workbook = new ExcelJS.Workbook();\r\n    const worksheet = workbook.addWorksheet(template.nameAr);\r\n\r\n    worksheet.addRow([template.nameAr]);\r\n    worksheet.addRow([`التاريخ: ${new Date().toLocaleDateString('ar-SA')}`]);\r\n    worksheet.addRow([]);\r\n\r\n    if (data.kpis && data.kpis.length > 0) {\r\n      worksheet.addRow(['مؤشرات الأداء الرئيسية']);\r\n      worksheet.addRow(['المؤشر', 'القيمة الحالية', 'الهدف', 'الوحدة', 'الحالة']);\r\n\r\n      data.kpis.forEach(kpi => {\r\n        worksheet.addRow([kpi.nameAr, kpi.value.current, kpi.value.target, kpi.unit, kpi.status]);\r\n      });\r\n    }\r\n\r\n    await workbook.xlsx.writeFile(filePath);\r\n    return filePath;\r\n  }\r\n\r\n  /**\r\n   * توليد تقرير CSV\r\n   */\r\n  async generateCSVReport(template, data, reportId) {\r\n    const fileName = `report_${reportId}_${Date.now()}.csv`;\r\n    const filePath = path.join(__dirname, '..', 'public', 'reports', fileName);\r\n\r\n    await fs.mkdir(path.dirname(filePath), { recursive: true });\r\n\r\n    let csv = `${template.nameAr}\\n`;\r\n    csv += `التاريخ,${new Date().toLocaleDateString('ar-SA')}\\n\\n`;\r\n\r\n    if (data.kpis && data.kpis.length > 0) {\r\n      csv += 'المؤشر,القيمة الحالية,الهدف,الوحدة,الحالة\\n';\r\n      data.kpis.forEach(kpi => {\r\n        csv += `${kpi.nameAr},${kpi.value.current},${kpi.value.target},${kpi.unit},${kpi.status}\\n`;\r\n      });\r\n    }\r\n\r\n    await fs.writeFile(filePath, csv, 'utf8');\r\n    return filePath;\r\n  }\r\n\r\n  /**\r\n   * توليد تقرير JSON\r\n   */\r\n  async generateJSONReport(template, data, reportId) {\r\n    const fileName = `report_${reportId}_${Date.now()}.json`;\r\n    const filePath = path.join(__dirname, '..', 'public', 'reports', fileName);\r\n\r\n    await fs.mkdir(path.dirname(filePath), { recursive: true });\r\n\r\n    const reportData = {\r\n      template: {\r\n        name: template.name,\r\n        nameAr: template.nameAr,\r\n      },\r\n      generatedAt: new Date(),\r\n      data,\r\n    };\r\n\r\n    await fs.writeFile(filePath, JSON.stringify(reportData, null, 2), 'utf8');\r\n    return filePath;\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * HELPER METHODS\r\n   * ======================\r\n   */\r\n\r\n  async getAttendanceRate() {\r\n    return Math.floor(Math.random() * 30) + 70;\r\n  }\r\n  async getFacilityUtilization() {\r\n    return Math.floor(Math.random() * 20) + 70;\r\n  }\r\n  async getOperationalEfficiency() {\r\n    return Math.floor(Math.random() * 15) + 80;\r\n  }\r\n  async getServiceSatisfaction() {\r\n    return Math.floor(Math.random() * 20) + 75;\r\n  }\r\n  async getComplianceRate() {\r\n    return Math.floor(Math.random() * 10) + 85;\r\n  }\r\n  async getDefectRate() {\r\n    return Math.floor(Math.random() * 5) + 2;\r\n  }\r\n  async getStudentSatisfaction() {\r\n    return Math.floor(Math.random() * 20) + 75;\r\n  }\r\n  async getParentSatisfaction() {\r\n    return Math.floor(Math.random() * 20) + 70;\r\n  }\r\n  async getEmployeeSatisfaction() {\r\n    return Math.floor(Math.random() * 25) + 65;\r\n  }\r\n  async getTotalRevenue() {\r\n    return Math.floor(Math.random() * 500000) + 1000000;\r\n  }\r\n  async getProfitMargin() {\r\n    return Math.floor(Math.random() * 20) + 15;\r\n  }\r\n  async getCollectionRate() {\r\n    return Math.floor(Math.random() * 15) + 80;\r\n  }\r\n  async getTotalExpenses() {\r\n    return Math.floor(Math.random() * 400000) + 600000;\r\n  }\r\n\r\n  async getGeneralStatistics(filters) {\r\n    return {\r\n      totalUsers: 1234,\r\n      activeUsers: 987,\r\n      totalRevenue: 1500000,\r\n      totalExpenses: 900000,\r\n      profitMargin: 40,\r\n      date: new Date(),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ======================\r\n   * LEGACY METHODS (Preserved)\r\n   * ======================\r\n   */\r\n\r\n  // تتبع السلوك المستخدم\r\n  static trackUserBehavior(userId) {\r\n    return {\r\n      success: true,\r\n      userId: userId,\r\n      behavior: {\r\n        loginFrequency: '2.3 times per day',\r\n        averageSessionDuration: '45 minutes',\r\n        mostUsedFeatures: ['reports', 'notifications', 'users'],\r\n        peakHours: ['09:00', '14:00', '16:30'],\r\n        deviceTypes: ['Desktop', 'Mobile'],\r\n        browsers: ['Chrome', 'Safari'],\r\n      },\r\n      engagement: {\r\n        score: 8.5,\r\n        level: 'High',\r\n        trend: 'increasing',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // الحصول على مقاييس الأداء\r\n  static getPerformanceMetrics(timeRange = '24h') {\r\n    return {\r\n      success: true,\r\n      timeRange: timeRange,\r\n      metrics: {\r\n        responseTime: {\r\n          average: '245ms',\r\n          min: '50ms',\r\n          max: '1200ms',\r\n          p95: '500ms',\r\n        },\r\n        uptime: '99.99%',\r\n        errorRate: '0.01%',\r\n        throughput: '1500 requests/minute',\r\n        cpuUsage: '35%',\r\n        memoryUsage: '62%',\r\n        databaseLatency: '120ms',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // عرض التقارير المخصصة\r\n  static getCustomDashboard(userId) {\r\n    return {\r\n      success: true,\r\n      userId: userId,\r\n      dashboard: {\r\n        widgets: [\r\n          {\r\n            id: 'widget_1',\r\n            title: 'Sales Overview',\r\n            type: 'chart',\r\n            data: { current: 150000, previous: 120000, growth: '25%' },\r\n          },\r\n          {\r\n            id: 'widget_2',\r\n            title: 'User Activity',\r\n            type: 'gauge',\r\n            data: { active: 156, inactive: 14, total: 170 },\r\n          },\r\n          {\r\n            id: 'widget_3',\r\n            title: 'System Health',\r\n            type: 'status',\r\n            data: { status: 'healthy', uptime: '99.99%' },\r\n          },\r\n          {\r\n            id: 'widget_4',\r\n            title: 'Top Features',\r\n            type: 'list',\r\n            data: ['Reports', 'Notifications', 'Analytics'],\r\n          },\r\n        ],\r\n        layout: 'grid',\r\n        refreshInterval: '5 minutes',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // تحليل الاتجاهات\r\n  static analyzeTrends(metric, period = '30d') {\r\n    return {\r\n      success: true,\r\n      metric: metric,\r\n      period: period,\r\n      trend: {\r\n        direction: 'up',\r\n        changePercent: 15.7,\r\n        dataPoints: [\r\n          { date: '2026-01-01', value: 1000 },\r\n          { date: '2026-01-05', value: 1150 },\r\n          { date: '2026-01-10', value: 1100 },\r\n          { date: '2026-01-15', value: 1350 },\r\n          { date: '2026-01-20', value: 1550 },\r\n        ],\r\n      },\r\n      forecast: {\r\n        nextWeekEstimate: 1750,\r\n        confidence: '85%',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // الحصول على التوصيات\r\n  static getRecommendations() {\r\n    return {\r\n      success: true,\r\n      recommendations: [\r\n        {\r\n          id: 'REC_001',\r\n          title: 'Optimize Database Queries',\r\n          category: 'Performance',\r\n          priority: 'high',\r\n          impact: 'Save 30% query time',\r\n          actionRequired: true,\r\n        },\r\n        {\r\n          id: 'REC_002',\r\n          title: 'Update 5 Inactive Users',\r\n          category: 'UserManagement',\r\n          priority: 'medium',\r\n          impact: 'Improve engagement',\r\n        },\r\n        {\r\n          id: 'REC_003',\r\n          title: 'Review Access Logs',\r\n          category: 'Security',\r\n          priority: 'high',\r\n          impact: 'Ensure system security',\r\n        },\r\n      ],\r\n      totalRecommendations: 3,\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // مقارنة المقاييس\r\n  static compareMetrics(metric1, metric2, period = '30d') {\r\n    return {\r\n      success: true,\r\n      comparison: {\r\n        metric1: {\r\n          name: metric1,\r\n          value: 1500,\r\n          average: 1400,\r\n          trend: 'up',\r\n        },\r\n        metric2: {\r\n          name: metric2,\r\n          value: 2300,\r\n          average: 2100,\r\n          trend: 'up',\r\n        },\r\n        correlation: 0.87,\r\n      },\r\n      period: period,\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // تقرير تحليلي شامل\r\n  static generateAnalysisReport(reportType = 'executive') {\r\n    return {\r\n      success: true,\r\n      reportType: reportType,\r\n      report: {\r\n        summary: {\r\n          period: 'Last 30 Days',\r\n          dataPoints: 720,\r\n          insights: 15,\r\n        },\r\n        keyMetrics: {\r\n          totalUsers: 156,\r\n          activeUsers: 142,\r\n          newUsers: 12,\r\n          engagementRate: '91%',\r\n          retentionRate: '94%',\r\n        },\r\n        departmentPerformance: {\r\n          IT: { performance: 95, users: 12 },\r\n          HR: { performance: 87, users: 8 },\r\n          Sales: { performance: 92, users: 45 },\r\n          Marketing: { performance: 88, users: 32 },\r\n          Finance: { performance: 89, users: 20 },\r\n        },\r\n        topInsights: [\r\n          'Sales department leading in engagement',\r\n          'Finance team needs onboarding support',\r\n          'Overall system performance up 12%',\r\n        ],\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // تتبع تحويل المستخدمين\r\n  static trackConversion(userId, event) {\r\n    return {\r\n      success: true,\r\n      userId: userId,\r\n      event: event,\r\n      conversion: {\r\n        type: 'funnel_step',\r\n        step: 3,\r\n        completionRate: '67%',\r\n        timeSpent: '5 minutes',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // التحليلات في الوقت الفعلي\r\n  static getRealTimeAnalytics() {\r\n    return {\r\n      success: true,\r\n      realTime: {\r\n        activeUsers: 45,\r\n        activeRequests: 123,\r\n        cps: 45, // conversions per second\r\n        avgResponseTime: '245ms',\r\n        errorRate: '0.01%',\r\n        throughput: '1500 req/min',\r\n      },\r\n      topPages: [\r\n        { page: '/reports', users: 12, duration: '5 min' },\r\n        { page: '/dashboard', users: 15, duration: '8 min' },\r\n        { page: '/users', users: 8, duration: '3 min' },\r\n      ],\r\n      topActions: [\r\n        { action: 'generate_report', count: 23 },\r\n        { action: 'view_dashboard', count: 18 },\r\n        { action: 'manage_users', count: 12 },\r\n      ],\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // توقعات التحليلات\r\n  static getPredictiveAnalytics() {\r\n    return {\r\n      success: true,\r\n      predictions: {\r\n        churnRisk: {\r\n          probability: '12%',\r\n          riskUsers: 18,\r\n          recommendations: 'Improve engagement, send personalized offers',\r\n        },\r\n        growthForecast: {\r\n          nextMonth: '178 users',\r\n          nextQuarter: '245 users',\r\n          confidence: '87%',\r\n        },\r\n        featureAdoption: {\r\n          highAdoption: ['Reports', 'Notifications'],\r\n          mediumAdoption: ['Analytics', 'Support'],\r\n          lowAdoption: ['CMS', 'Advanced Features'],\r\n        },\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // تصدير تقارير التحليلات\r\n  static exportAnalyticsReport(format = 'pdf') {\r\n    return {\r\n      success: true,\r\n      file: {\r\n        name: `analytics_report_${new Date().toISOString().split('T')[0]}.${format}`,\r\n        size: '2.5 MB',\r\n        downloadUrl: `https://example.com/exports/analytics_${Date.now()}.${format}`,\r\n        expiresIn: '7 days',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // اختبار A/B\r\n  static getABTestResults(testId) {\r\n    return {\r\n      success: true,\r\n      testId: testId,\r\n      results: {\r\n        testName: 'Button Color Test',\r\n        duration: '14 days',\r\n        status: 'completed',\r\n        variants: [\r\n          {\r\n            name: 'Control (Blue)',\r\n            conversions: 234,\r\n            conversionRate: '3.2%',\r\n            users: 7500,\r\n          },\r\n          {\r\n            name: 'Variant (Red)',\r\n            conversions: 289,\r\n            conversionRate: '3.8%',\r\n            users: 7500,\r\n          },\r\n        ],\r\n        winner: 'Variant (Red)',\r\n        confidence: '94%',\r\n        impact: '+18.75% conversion improvement',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // مقاييس التسويق\r\n  static getMarketingMetrics(campaign) {\r\n    return {\r\n      success: true,\r\n      campaign: campaign,\r\n      metrics: {\r\n        impressions: 50000,\r\n        clicks: 2500,\r\n        ctr: '5%',\r\n        conversions: 125,\r\n        conversionRate: '5%',\r\n        cost: 500,\r\n        cpc: 0.2,\r\n        roi: '350%',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n}\r\n\r\n// Export classes and singleton instance\r\nmodule.exports = {\r\n  AnalyticsService,\r\n  AnalyticsMetric,\r\n  DashboardTemplate,\r\n  TrendAnalyzer,\r\n  KPIAggregator,\r\n  // Also export singleton instance for backwards compatibility\r\n  default: new AnalyticsService()\r\n};\r\n\r\n// Legacy support - also export as the singleton instance\r\nObject.assign(module.exports.default, module.exports);\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAM;EACJA,GAAG;EACHC,aAAa;EACbC,UAAU;EACVC,cAAc;EACdC;AACF,CAAC,GAAGC,OAAO,CAAC,qBAAqB,CAAC;AAClC,MAAMC,WAAW,GAAGD,OAAO,CAAC,QAAQ,CAAC;AACrC,MAAME,OAAO,GAAGF,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMG,EAAE,GAAGH,OAAO,CAAC,IAAI,CAAC,CAACI,QAAQ;AACjC,MAAMC,IAAI,GAAGL,OAAO,CAAC,MAAM,CAAC;;AAE5B;AACA;AACA;AACA,MAAMM,eAAe,CAAC;EACpBC,WAAWA,CAACC,IAAI,EAAEC,KAAK,EAAEC,WAAW,GAAG,EAAE,EAAEC,IAAI,GAAG,EAAE,EAAE;IACpD,IAAI,CAACH,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,KAAK,GAAG,CAAC;IACd,IAAI,CAACC,aAAa,GAAG,CAAC;IACtB,IAAI,CAACC,KAAK,GAAG,CAAC;IACd,IAAI,CAACC,MAAM,GAAG,QAAQ;IACtB,IAAI,CAACC,OAAO,GAAG,EAAE;IACjB,IAAI,CAACC,SAAS,GAAG;MAAEC,OAAO,EAAE,IAAI;MAAEC,QAAQ,EAAE;IAAK,CAAC;EACpD;EAEAC,WAAWA,CAACC,QAAQ,EAAE;IACpB,IAAI,CAACR,aAAa,GAAG,IAAI,CAACD,KAAK;IAC/B,IAAI,CAACA,KAAK,GAAGS,QAAQ;;IAErB;IACA,IAAI,IAAI,CAACR,aAAa,KAAK,CAAC,EAAE;MAC5B,IAAI,CAACC,KAAK,GAAI,CAACO,QAAQ,GAAG,IAAI,CAACR,aAAa,IAAI,IAAI,CAACA,aAAa,GAAI,GAAG;IAC3E,CAAC,MAAM;MACL,IAAI,CAACC,KAAK,GAAGO,QAAQ,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;IACrC;;IAEA;IACA,IAAI,CAACL,OAAO,CAACM,IAAI,CAAC;MAChBC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;MACrBZ,KAAK,EAAES;IACT,CAAC,CAAC;;IAEF;IACA,IAAI,IAAI,CAACJ,SAAS,CAACE,QAAQ,IAAIE,QAAQ,GAAG,IAAI,CAACJ,SAAS,CAACE,QAAQ,EAAE;MACjE,IAAI,CAACJ,MAAM,GAAG,UAAU;IAC1B,CAAC,MAAM,IAAI,IAAI,CAACE,SAAS,CAACC,OAAO,IAAIG,QAAQ,GAAG,IAAI,CAACJ,SAAS,CAACC,OAAO,EAAE;MACtE,IAAI,CAACH,MAAM,GAAG,SAAS;IACzB,CAAC,MAAM;MACL,IAAI,CAACA,MAAM,GAAG,QAAQ;IACxB;EACF;EAEAU,YAAYA,CAACP,OAAO,EAAEC,QAAQ,EAAE;IAC9B,IAAI,CAACF,SAAS,CAACC,OAAO,GAAGA,OAAO;IAChC,IAAI,CAACD,SAAS,CAACE,QAAQ,GAAGA,QAAQ;EACpC;EAEAO,cAAcA,CAAA,EAAG;IACf,MAAMC,MAAM,GAAG;MACb,QAAQ,EAAE,SAAS;MACnB,SAAS,EAAE,SAAS;MACpB,UAAU,EAAE;IACd,CAAC;IACD,OAAOA,MAAM,CAAC,IAAI,CAACZ,MAAM,CAAC,IAAI,SAAS;EACzC;EAEAa,aAAaA,CAAA,EAAG;IACd,IAAI,IAAI,CAACd,KAAK,GAAG,EAAE,EAAE,OAAO,OAAO;IACnC,IAAI,IAAI,CAACA,KAAK,GAAG,CAAC,EAAE,EAAE,OAAO,KAAK;IAClC,OAAO,QAAQ;EACjB;AACF;;AAEA;AACA;AACA;AACA,MAAMe,iBAAiB,CAAC;EACtBtB,WAAWA,CAACC,IAAI,EAAEsB,KAAK,EAAEpB,WAAW,GAAG,EAAE,EAAE;IACzC,IAAI,CAACF,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACsB,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACpB,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACqB,OAAO,GAAG,EAAE;EACnB;EAEAC,SAASA,CAACC,GAAG,EAAExB,KAAK,EAAEyB,OAAO,GAAG,CAAC,CAAC,EAAE;IAClC,IAAI,CAACH,OAAO,CAACT,IAAI,CAAC;MAChBa,IAAI,EAAE,QAAQ;MACdF,GAAG;MACHxB,KAAK;MACLyB;IACF,CAAC,CAAC;EACJ;EAEAE,QAAQA,CAACH,GAAG,EAAExB,KAAK,EAAEyB,OAAO,GAAG,CAAC,CAAC,EAAE;IACjC,IAAI,CAACH,OAAO,CAACT,IAAI,CAAC;MAChBa,IAAI,EAAE,OAAO;MACbF,GAAG;MACHxB,KAAK;MACLyB;IACF,CAAC,CAAC;EACJ;EAEAG,QAAQA,CAACC,IAAI,EAAEJ,OAAO,GAAG,CAAC,CAAC,EAAE;IAC3B,IAAI,CAACH,OAAO,CAACT,IAAI,CAAC;MAChBa,IAAI,EAAE,OAAO;MACbG,IAAI;MACJJ;IACF,CAAC,CAAC;EACJ;EAEAK,QAAQA,CAAA,EAAG;IACT,MAAMC,MAAM,GAAG,EAAE;IAEjB,IAAI,CAAC,IAAI,CAAChC,IAAI,IAAI,IAAI,CAACA,IAAI,CAACiC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;MACzCD,MAAM,CAAClB,IAAI,CAAC,4BAA4B,CAAC;IAC3C;IAEA,IAAI,IAAI,CAACS,OAAO,CAACW,MAAM,KAAK,CAAC,EAAE;MAC7BF,MAAM,CAAClB,IAAI,CAAC,yCAAyC,CAAC;IACxD;IAEA,OAAO;MACLqB,KAAK,EAAEH,MAAM,CAACE,MAAM,KAAK,CAAC;MAC1BF;IACF,CAAC;EACH;AACF;;AAEA;AACA;AACA;AACA,MAAMI,aAAa,CAAC;EAClBC,YAAYA,CAACP,IAAI,EAAEQ,OAAO,GAAG,IAAI,EAAE;IACjC,IAAI,CAACC,KAAK,CAACC,OAAO,CAACV,IAAI,CAAC,IAAIA,IAAI,CAACI,MAAM,KAAK,CAAC,EAAE;MAC7C,OAAO;QAAEO,SAAS,EAAE,MAAM;QAAEnC,KAAK,EAAE,MAAM;QAAEoC,QAAQ,EAAE;MAAE,CAAC;IAC1D;;IAEA;IACA,MAAMC,CAAC,GAAGb,IAAI,CAACI,MAAM;IACrB,MAAMU,IAAI,GAAID,CAAC,IAAIA,CAAC,GAAG,CAAC,CAAC,GAAI,CAAC;IAC9B,MAAME,IAAI,GAAGf,IAAI,CAACgB,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,EAAE,CAAC,CAAC;IAC5C,MAAMC,KAAK,GAAGnB,IAAI,CAACgB,MAAM,CAAC,CAACI,GAAG,EAAEC,GAAG,EAAEC,CAAC,KAAKF,GAAG,GAAG,CAACE,CAAC,GAAG,CAAC,IAAID,GAAG,EAAE,CAAC,CAAC;IAClE,MAAME,KAAK,GAAIV,CAAC,IAAIA,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAGA,CAAC,GAAG,CAAC,CAAC,GAAI,CAAC;IAE7C,MAAMW,KAAK,GAAG,CAACX,CAAC,GAAGM,KAAK,GAAGL,IAAI,GAAGC,IAAI,KAAKF,CAAC,GAAGU,KAAK,GAAGT,IAAI,GAAGA,IAAI,CAAC;IACnE,MAAMW,SAAS,GAAG,CAACV,IAAI,GAAGS,KAAK,GAAGV,IAAI,IAAID,CAAC;;IAE3C;IACA,IAAIF,SAAS,GAAG,MAAM;IACtB,IAAInC,KAAK,GAAG,MAAM;IAElB,IAAIgD,KAAK,GAAG,GAAG,EAAE;MACfb,SAAS,GAAG,IAAI;MAChB;MACAnC,KAAK,GAAIgC,OAAO,IAAIA,OAAO,IAAI,CAAC,IAAKR,IAAI,CAACI,MAAM,IAAI,EAAE,GAAG,WAAW,GAAG,IAAI;IAC7E,CAAC,MAAM,IAAIoB,KAAK,GAAG,CAAC,GAAG,EAAE;MACvBb,SAAS,GAAG,MAAM;MAClB;MACAnC,KAAK,GAAIgC,OAAO,IAAIA,OAAO,IAAI,CAAC,IAAKR,IAAI,CAACI,MAAM,IAAI,EAAE,GAAG,aAAa,GAAG,MAAM;IACjF;;IAEA;IACA,MAAMQ,QAAQ,GAAGa,SAAS,GAAGD,KAAK,IAAIX,CAAC,GAAG,CAAC,CAAC;IAE5C,OAAO;MACLF,SAAS;MACTnC,KAAK;MACLoC,QAAQ;MACRY,KAAK;MACLC;IACF,CAAC;EACH;EAEAC,aAAaA,CAAC1B,IAAI,EAAE;IAClB,OAAO,IAAI,CAACO,YAAY,CAACP,IAAI,CAAC2B,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3C;EAEAC,aAAaA,CAAC5B,IAAI,EAAE;IAClB,OAAO,IAAI,CAACO,YAAY,CAACP,IAAI,CAAC2B,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3C;EAEAE,aAAaA,CAAC7B,IAAI,EAAE;IAClB,OAAO,IAAI,CAACO,YAAY,CAACP,IAAI,CAAC2B,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3C;AACF;;AAEA;AACA;AACA;AACA,MAAMG,aAAa,CAAC;EAClB7D,WAAWA,CAAA,EAAG;IACZ,IAAI,CAAC8D,IAAI,GAAG,CAAC,CAAC;EAChB;EAEAC,WAAWA,CAACC,MAAM,EAAE;IAClB,IAAI,CAACF,IAAI,CAACE,MAAM,CAAC/D,IAAI,CAAC,GAAG+D,MAAM;EACjC;EAEAC,MAAMA,CAAChE,IAAI,EAAE;IACX,OAAO,IAAI,CAAC6D,IAAI,CAAC7D,IAAI,CAAC;EACxB;EAEAiE,aAAaA,CAAA,EAAG;IACd,OAAOC,MAAM,CAACC,MAAM,CAAC,IAAI,CAACN,IAAI,CAAC;EACjC;EAEAO,iBAAiBA,CAACpE,IAAI,EAAEqE,MAAM,GAAG,OAAO,EAAE;IACxC,MAAMN,MAAM,GAAG,IAAI,CAACF,IAAI,CAAC7D,IAAI,CAAC;IAC9B,IAAI,CAAC+D,MAAM,IAAI,CAACA,MAAM,CAACvD,OAAO,EAAE,OAAO,EAAE;IAEzC,MAAM8D,OAAO,GAAG,CAAC,CAAC;IAElBP,MAAM,CAACvD,OAAO,CAAC+D,OAAO,CAACC,KAAK,IAAI;MAC9B,MAAMC,IAAI,GAAG,IAAIzD,IAAI,CAACwD,KAAK,CAACzD,SAAS,CAAC;MACtC,IAAIU,GAAG;MAEP,IAAI4C,MAAM,KAAK,OAAO,EAAE;QACtB5C,GAAG,GAAGgD,IAAI,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MACxC,CAAC,MAAM,IAAIN,MAAM,KAAK,QAAQ,EAAE;QAC9B,MAAMO,WAAW,GAAG,IAAI5D,IAAI,CAACyD,IAAI,CAAC;QAClCG,WAAW,CAACC,OAAO,CAACJ,IAAI,CAACK,OAAO,CAAC,CAAC,GAAGL,IAAI,CAACM,MAAM,CAAC,CAAC,CAAC;QACnDtD,GAAG,GAAGmD,WAAW,CAACF,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MAC/C,CAAC,MAAM,IAAIN,MAAM,KAAK,SAAS,EAAE;QAC/B5C,GAAG,GAAGgD,IAAI,CAACC,WAAW,CAAC,CAAC,CAACM,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;MAC1C;MAEA,IAAI,CAACV,OAAO,CAAC7C,GAAG,CAAC,EAAE;QACjB6C,OAAO,CAAC7C,GAAG,CAAC,GAAG,EAAE;MACnB;MACA6C,OAAO,CAAC7C,GAAG,CAAC,CAACX,IAAI,CAAC0D,KAAK,CAACpE,KAAK,CAAC;IAChC,CAAC,CAAC;IAEF,OAAO8D,MAAM,CAACe,OAAO,CAACX,OAAO,CAAC,CAACY,GAAG,CAAC,CAAC,CAACb,MAAM,EAAEF,MAAM,CAAC,MAAM;MACxDE,MAAM;MACNjE,KAAK,EAAE+D,MAAM,CAACrB,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,EAAE,CAAC,CAAC,GAAGmB,MAAM,CAACjC,MAAM;MACxDiD,KAAK,EAAEhB,MAAM,CAACjC;IAChB,CAAC,CAAC,CAAC;EACL;EAEAkD,cAAcA,CAACC,KAAK,EAAEC,KAAK,EAAE;IAC3B,MAAMC,EAAE,GAAG,IAAI,CAAC1B,IAAI,CAACwB,KAAK,CAAC;IAC3B,MAAMG,EAAE,GAAG,IAAI,CAAC3B,IAAI,CAACyB,KAAK,CAAC;IAE3B,IAAI,CAACC,EAAE,IAAI,CAACC,EAAE,EAAE,OAAO,IAAI;;IAE3B;IACA,MAAMC,KAAK,GAAGF,EAAE,CAAC/E,OAAO,CAAC0E,GAAG,CAACQ,CAAC,IAAIA,CAAC,CAACtF,KAAK,CAAC;IAC1C,MAAMuF,KAAK,GAAGH,EAAE,CAAChF,OAAO,CAAC0E,GAAG,CAACQ,CAAC,IAAIA,CAAC,CAACtF,KAAK,CAAC;;IAE1C;IACA,MAAMwF,SAAS,GAAGC,IAAI,CAACC,GAAG,CAACL,KAAK,CAACvD,MAAM,EAAEyD,KAAK,CAACzD,MAAM,CAAC;IACtD,MAAM6D,EAAE,GAAGN,KAAK,CAAChC,KAAK,CAAC,CAACmC,SAAS,CAAC;IAClC,MAAMI,EAAE,GAAGL,KAAK,CAAClC,KAAK,CAAC,CAACmC,SAAS,CAAC;;IAElC;IACA,MAAMK,KAAK,GAAGF,EAAE,CAACjD,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,EAAE,CAAC,CAAC,GAAG+C,EAAE,CAAC7D,MAAM;IACvD,MAAMgE,KAAK,GAAGF,EAAE,CAAClD,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,EAAE,CAAC,CAAC,GAAGgD,EAAE,CAAC9D,MAAM;IAEvD,IAAIiE,SAAS,GAAG,CAAC;IACjB,IAAIC,IAAI,GAAG,CAAC;IACZ,IAAIC,IAAI,GAAG,CAAC;IAEZ,KAAK,IAAIjD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2C,EAAE,CAAC7D,MAAM,EAAEkB,CAAC,EAAE,EAAE;MAClC,MAAMkD,KAAK,GAAGP,EAAE,CAAC3C,CAAC,CAAC,GAAG6C,KAAK;MAC3B,MAAMM,KAAK,GAAGP,EAAE,CAAC5C,CAAC,CAAC,GAAG8C,KAAK;MAC3BC,SAAS,IAAIG,KAAK,GAAGC,KAAK;MAC1BH,IAAI,IAAIE,KAAK,GAAGA,KAAK;MACrBD,IAAI,IAAIE,KAAK,GAAGA,KAAK;IACvB;IAEA,MAAMC,WAAW,GAAGL,SAAS,GAAGN,IAAI,CAACY,IAAI,CAACL,IAAI,GAAGC,IAAI,CAAC;IAEtD,OAAO;MACLK,OAAO,EAAErB,KAAK;MACdsB,OAAO,EAAErB,KAAK;MACdkB,WAAW,EAAEI,KAAK,CAACJ,WAAW,CAAC,GAAG,CAAC,GAAGA,WAAW;MACjDK,MAAM,EAAEtB,EAAE,CAACjF,KAAK;MAChBwG,MAAM,EAAEtB,EAAE,CAAClF,KAAK;MAChByG,UAAU,EAAExB,EAAE,CAACnF,KAAK,GAAGoF,EAAE,CAACpF,KAAK,GAAG,gBAAgB,GAAG;IACvD,CAAC;EACH;AACF;AAEA,MAAM4G,gBAAgB,CAAC;EACrBjH,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACkH,OAAO,GAAG,CAAC,CAAC;IACjB,IAAI,CAACC,UAAU,GAAG,CAAC,CAAC;IACpB,IAAI,CAACC,MAAM,GAAG,EAAE;IAChB,IAAI,CAACC,YAAY,GAAG,EAAE;IACtB,IAAI,CAACC,SAAS,GAAG,EAAE;IACnB,IAAI,CAACC,aAAa,GAAG,IAAIlF,aAAa,CAAC,CAAC;IACxC,IAAI,CAACmF,aAAa,GAAG,IAAI3D,aAAa,CAAC,CAAC;EAC1C;;EAEA;AACF;AACA;AACA;AACA;;EAEE4D,YAAYA,CAACxH,IAAI,EAAEC,KAAK,EAAEC,WAAW,GAAG,EAAE,EAAEC,IAAI,GAAG,EAAE,EAAE;IACrD,MAAM4D,MAAM,GAAG,IAAIjE,eAAe,CAACE,IAAI,EAAEC,KAAK,EAAEC,WAAW,EAAEC,IAAI,CAAC;IAClE,IAAI,CAAC8G,OAAO,CAACjH,IAAI,CAAC,GAAG+D,MAAM;IAC3B,IAAI,CAACwD,aAAa,CAACzD,WAAW,CAACC,MAAM,CAAC;IACtC,OAAOA,MAAM;EACf;EAEA0D,SAASA,CAACzH,IAAI,EAAE;IACd,OAAO,IAAI,CAACiH,OAAO,CAACjH,IAAI,CAAC;EAC3B;EAEAiE,aAAaA,CAAA,EAAG;IACd,OAAOC,MAAM,CAACC,MAAM,CAAC,IAAI,CAAC8C,OAAO,CAAC;EACpC;EAEAS,YAAYA,CAAC1H,IAAI,EAAEI,KAAK,EAAE;IACxB,MAAM2D,MAAM,GAAG,IAAI,CAACkD,OAAO,CAACjH,IAAI,CAAC;IACjC,IAAI+D,MAAM,EAAE;MACVA,MAAM,CAACnD,WAAW,CAACR,KAAK,CAAC;MACzB,OAAO2D,MAAM;IACf;IACA,OAAO,IAAI;EACb;EAEA4D,kBAAkBA,CAAC3H,IAAI,EAAEU,OAAO,EAAEC,QAAQ,EAAE;IAC1C,MAAMoD,MAAM,GAAG,IAAI,CAACkD,OAAO,CAACjH,IAAI,CAAC;IACjC,IAAI+D,MAAM,EAAE;MACVA,MAAM,CAAC9C,YAAY,CAACP,OAAO,EAAEC,QAAQ,CAAC;MACtC,OAAOoD,MAAM;IACf;IACA,OAAO,IAAI;EACb;;EAEA;AACF;AACA;AACA;AACA;;EAEE6D,eAAeA,CAAC5H,IAAI,EAAEsB,KAAK,EAAEpB,WAAW,GAAG,EAAE,EAAE;IAC7C,MAAM2H,SAAS,GAAG,IAAIxG,iBAAiB,CAACrB,IAAI,EAAEsB,KAAK,EAAEpB,WAAW,CAAC;IACjE,IAAI,CAACgH,UAAU,CAAClH,IAAI,CAAC,GAAG6H,SAAS;IACjC,OAAOA,SAAS;EAClB;EAEAC,YAAYA,CAAC9H,IAAI,EAAE;IACjB,OAAO,IAAI,CAACkH,UAAU,CAAClH,IAAI,CAAC;EAC9B;EAEA+H,oBAAoBA,CAACC,aAAa,EAAEC,MAAM,EAAE;IAC1C,MAAMJ,SAAS,GAAG,IAAI,CAACX,UAAU,CAACc,aAAa,CAAC;IAChD,IAAIH,SAAS,EAAE;MACb;MACA,IAAII,MAAM,CAACtG,IAAI,KAAK,QAAQ,IAAIsG,MAAM,CAAClE,MAAM,EAAE;QAC7C8D,SAAS,CAACrG,SAAS,CAACyG,MAAM,CAAClE,MAAM,EAAEkE,MAAM,CAAClE,MAAM,CAAC;MACnD,CAAC,MAAM;QACL8D,SAAS,CAACtG,OAAO,CAACT,IAAI,CAACmH,MAAM,CAAC;MAChC;MACA,OAAOJ,SAAS;IAClB;IACA,OAAO,IAAI;EACb;;EAEA;AACF;AACA;AACA;AACA;;EAEEK,iBAAiBA,CAACC,UAAU,EAAE;IAC5B,MAAMpE,MAAM,GAAG,IAAI,CAACkD,OAAO,CAACkB,UAAU,CAAC;IACvC,IAAI,CAACpE,MAAM,EAAE,OAAO,IAAI;IAExB,MAAMjC,IAAI,GAAGiC,MAAM,CAACvD,OAAO,CAAC0E,GAAG,CAACQ,CAAC,IAAIA,CAAC,CAACtF,KAAK,CAAC;IAC7C,OAAO,IAAI,CAACkH,aAAa,CAAC9D,aAAa,CAAC1B,IAAI,CAAC;EAC/C;EAEAsG,iBAAiBA,CAACD,UAAU,EAAE;IAC5B,MAAMpE,MAAM,GAAG,IAAI,CAACkD,OAAO,CAACkB,UAAU,CAAC;IACvC,IAAI,CAACpE,MAAM,EAAE,OAAO,IAAI;IAExB,MAAMjC,IAAI,GAAGiC,MAAM,CAACvD,OAAO,CAAC0E,GAAG,CAACQ,CAAC,IAAIA,CAAC,CAACtF,KAAK,CAAC;IAC7C,OAAO,IAAI,CAACkH,aAAa,CAAC5D,aAAa,CAAC5B,IAAI,CAAC;EAC/C;EAEAuG,iBAAiBA,CAACF,UAAU,EAAE;IAC5B,MAAMpE,MAAM,GAAG,IAAI,CAACkD,OAAO,CAACkB,UAAU,CAAC;IACvC,IAAI,CAACpE,MAAM,EAAE,OAAO,IAAI;IAExB,MAAMjC,IAAI,GAAGiC,MAAM,CAACvD,OAAO,CAAC0E,GAAG,CAACQ,CAAC,IAAIA,CAAC,CAACtF,KAAK,CAAC;IAC7C,OAAO,IAAI,CAACkH,aAAa,CAAC3D,aAAa,CAAC7B,IAAI,CAAC;EAC/C;EAEAwG,mBAAmBA,CAACC,WAAW,EAAEC,WAAW,EAAE;IAC5C,OAAO,IAAI,CAACjB,aAAa,CAACnC,cAAc,CAACmD,WAAW,EAAEC,WAAW,CAAC;EACpE;EAEAC,uBAAuBA,CAACN,UAAU,EAAE9D,MAAM,GAAG,OAAO,EAAE;IACpD,OAAO,IAAI,CAACkD,aAAa,CAACnD,iBAAiB,CAAC+D,UAAU,EAAE9D,MAAM,CAAC;EACjE;;EAEA;AACF;AACA;AACA;AACA;;EAEEqE,YAAYA,CAACzI,KAAK,GAAG,EAAE,EAAE;IACvB,MAAM0I,QAAQ,GAAG;MACfC,EAAE,EAAE,OAAO,GAAG5H,IAAI,CAAC6H,GAAG,CAAC,CAAC,GAAG,GAAG,GAAGhD,IAAI,CAACiD,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;MACxE/I,KAAK;MACLc,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;MACrBiG,OAAO,EAAE,CAAC;IACZ,CAAC;;IAED;IACA,KAAK,MAAM,CAACjH,IAAI,EAAE+D,MAAM,CAAC,IAAIG,MAAM,CAACe,OAAO,CAAC,IAAI,CAACgC,OAAO,CAAC,EAAE;MACzD0B,QAAQ,CAAC1B,OAAO,CAACjH,IAAI,CAAC,GAAG;QACvBA,IAAI,EAAE+D,MAAM,CAAC/D,IAAI;QACjBI,KAAK,EAAE2D,MAAM,CAAC3D,KAAK;QACnBE,KAAK,EAAEyD,MAAM,CAACzD,KAAK;QACnBC,MAAM,EAAEwD,MAAM,CAACxD;MACjB,CAAC;IACH;IAEA,IAAI,CAAC8G,SAAS,CAACvG,IAAI,CAAC6H,QAAQ,CAAC;IAC7B,OAAOA,QAAQ;EACjB;EAEAM,kBAAkBA,CAACC,KAAK,GAAG,EAAE,EAAE;IAC7B,OAAO,IAAI,CAAC7B,SAAS,CAAC5D,KAAK,CAAC,CAACyF,KAAK,CAAC;EACrC;EAEAC,gBAAgBA,CAACC,OAAO,EAAEC,OAAO,EAAE;IACjC,MAAMC,KAAK,GAAG,IAAI,CAACjC,SAAS,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACZ,EAAE,KAAKQ,OAAO,CAAC;IACxD,MAAMK,KAAK,GAAG,IAAI,CAACpC,SAAS,CAACkC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACZ,EAAE,KAAKS,OAAO,CAAC;IAExD,IAAI,CAACC,KAAK,IAAI,CAACG,KAAK,EAAE,OAAO,IAAI;IAEjC,MAAM1C,UAAU,GAAG,CAAC,CAAC;IACrB,KAAK,MAAMoB,UAAU,IAAIjE,MAAM,CAACwF,IAAI,CAACJ,KAAK,CAACrC,OAAO,CAAC,EAAE;MACnD,IAAIwC,KAAK,CAACxC,OAAO,CAACkB,UAAU,CAAC,EAAE;QAC7B,MAAMpC,EAAE,GAAGuD,KAAK,CAACrC,OAAO,CAACkB,UAAU,CAAC,CAAC/H,KAAK;QAC1C,MAAM4F,EAAE,GAAGyD,KAAK,CAACxC,OAAO,CAACkB,UAAU,CAAC,CAAC/H,KAAK;QAC1C2G,UAAU,CAACoB,UAAU,CAAC,GAAG;UACvBwB,MAAM,EAAE5D,EAAE;UACV6D,KAAK,EAAE5D,EAAE;UACT6D,MAAM,EAAE7D,EAAE,GAAGD,EAAE;UACf+D,aAAa,EAAE/D,EAAE,KAAK,CAAC,GAAI,CAACC,EAAE,GAAGD,EAAE,IAAIA,EAAE,GAAG,GAAG,GAAI;QACrD,CAAC;MACH;IACF;IAEA,OAAO;MACLgE,OAAO,EAAEX,OAAO;MAChBY,OAAO,EAAEX,OAAO;MAChBY,UAAU,EAAEX,KAAK,CAACvI,SAAS;MAC3BmJ,UAAU,EAAET,KAAK,CAAC1I,SAAS;MAC3BgG;IACF,CAAC;EACH;;EAEA;AACF;AACA;AACA;AACA;;EAEEoD,WAAWA,CAAChC,UAAU,EAAEiC,SAAS,EAAE3J,SAAS,EAAE4J,QAAQ,GAAG,SAAS,EAAE;IAClE,MAAMC,KAAK,GAAG;MACZ1B,EAAE,EAAE,QAAQ,GAAG5H,IAAI,CAAC6H,GAAG,CAAC,CAAC,GAAG,GAAG,GAAGhD,IAAI,CAACiD,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;MACzEb,UAAU;MACViC,SAAS;MAAE;MACX3J,SAAS;MACT4J,QAAQ;MAAE;MACVE,OAAO,EAAE,IAAI;MACbC,SAAS,EAAE,KAAK;MAChBC,WAAW,EAAE;IACf,CAAC;IAED,IAAI,CAACtD,MAAM,CAACrG,IAAI,CAACwJ,KAAK,CAAC;IACvB,OAAOA,KAAK;EACd;EAEAI,cAAcA,CAAA,EAAG;IACf,MAAMF,SAAS,GAAG,EAAE;IACpB,IAAI,CAACpD,YAAY,GAAG,EAAE,CAAC,CAAC;;IAExB,KAAK,MAAMkD,KAAK,IAAI,IAAI,CAACnD,MAAM,EAAE;MAC/B,IAAI,CAACmD,KAAK,CAACC,OAAO,EAAE;MAEpB,MAAMxG,MAAM,GAAG,IAAI,CAACkD,OAAO,CAACqD,KAAK,CAACnC,UAAU,CAAC;MAC7C,IAAI,CAACpE,MAAM,EAAE;MAEb,IAAI4G,aAAa,GAAG,KAAK;MAEzB,IAAIL,KAAK,CAACF,SAAS,KAAK,SAAS,IAAIrG,MAAM,CAAC3D,KAAK,GAAGkK,KAAK,CAAC7J,SAAS,EAAE;QACnEkK,aAAa,GAAG,IAAI;MACtB,CAAC,MAAM,IAAIL,KAAK,CAACF,SAAS,KAAK,OAAO,IAAIrG,MAAM,CAAC3D,KAAK,GAAGkK,KAAK,CAAC7J,SAAS,EAAE;QACxEkK,aAAa,GAAG,IAAI;MACtB,CAAC,MAAM,IAAIL,KAAK,CAACF,SAAS,KAAK,QAAQ,IAAIrG,MAAM,CAAC3D,KAAK,KAAKkK,KAAK,CAAC7J,SAAS,EAAE;QAC3EkK,aAAa,GAAG,IAAI;MACtB;MAEA,IAAIA,aAAa,EAAE;QACjB,IAAI,CAACL,KAAK,CAACE,SAAS,EAAE;UACpB;UACAF,KAAK,CAACE,SAAS,GAAG,IAAI;UACtBF,KAAK,CAACG,WAAW,GAAG,IAAIzJ,IAAI,CAAC,CAAC;QAChC;QACAwJ,SAAS,CAAC1J,IAAI,CAACwJ,KAAK,CAAC;QACrB,IAAI,CAAClD,YAAY,CAACtG,IAAI,CAACwJ,KAAK,CAAC;MAC/B,CAAC,MAAM,IAAIA,KAAK,CAACE,SAAS,EAAE;QAC1B;QACAF,KAAK,CAACE,SAAS,GAAG,KAAK;QACvBF,KAAK,CAACG,WAAW,GAAG,IAAI;MAC1B;IACF;IAEA,OAAOD,SAAS;EAClB;EAEAI,eAAeA,CAAA,EAAG;IAChB,OAAO,IAAI,CAACxD,YAAY;EAC1B;;EAEA;AACF;AACA;AACA;AACA;;EAEEyD,cAAcA,CAAA,EAAG;IACf,OAAO;MACL5D,OAAO,EAAE/C,MAAM,CAACwF,IAAI,CAAC,IAAI,CAACzC,OAAO,CAAC,CAAC/E,MAAM;MACzCgF,UAAU,EAAEhD,MAAM,CAACwF,IAAI,CAAC,IAAI,CAACxC,UAAU,CAAC,CAAChF,MAAM;MAC/CiF,MAAM,EAAE,IAAI,CAACA,MAAM,CAACjF,MAAM;MAC1BmF,SAAS,EAAE,IAAI,CAACA,SAAS,CAACnF;IAC5B,CAAC;EACH;EAEA4I,eAAeA,CAAA,EAAG;IAChB,MAAM7D,OAAO,GAAG/C,MAAM,CAACC,MAAM,CAAC,IAAI,CAAC8C,OAAO,CAAC;IAC3C,MAAM8D,aAAa,GAAG,EAAE;IACxB,MAAMC,cAAc,GAAG,EAAE;IACzB,MAAMC,eAAe,GAAG,EAAE;IAE1B,KAAK,MAAMlH,MAAM,IAAIkD,OAAO,EAAE;MAC5B,IAAIlD,MAAM,CAACxD,MAAM,KAAK,UAAU,EAAE;QAChC0K,eAAe,CAACnK,IAAI,CAACiD,MAAM,CAAC/D,IAAI,CAAC;MACnC,CAAC,MAAM,IAAI+D,MAAM,CAACxD,MAAM,KAAK,SAAS,EAAE;QACtCyK,cAAc,CAAClK,IAAI,CAACiD,MAAM,CAAC/D,IAAI,CAAC;MAClC,CAAC,MAAM;QACL+K,aAAa,CAACjK,IAAI,CAACiD,MAAM,CAAC/D,IAAI,CAAC;MACjC;IACF;IAEA,OAAO;MACLkL,OAAO,EAAE;QACPC,KAAK,EAAElE,OAAO,CAAC/E,MAAM;QACrBkJ,MAAM,EAAEL,aAAa,CAAC7I,MAAM;QAC5BxB,OAAO,EAAEsK,cAAc,CAAC9I,MAAM;QAC9BvB,QAAQ,EAAEsK,eAAe,CAAC/I;MAC5B,CAAC;MACD6I,aAAa;MACbC,cAAc;MACdC,eAAe;MACfI,gBAAgB,EAAEpE,OAAO,CAAC/E,MAAM,GAAG,CAAC,GAChC,CAAE6I,aAAa,CAAC7I,MAAM,GAAG+E,OAAO,CAAC/E,MAAM,GAAI,GAAG,EAAEoJ,OAAO,CAAC,CAAC,CAAC,GAC1D;IACN,CAAC;EACH;EAEAC,UAAUA,CAACC,MAAM,GAAG,MAAM,EAAE;IAC1B,MAAM1J,IAAI,GAAG;MACXf,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC,CAAC;MACnCuC,OAAO,EAAE,CAAC,CAAC;MACXC,UAAU,EAAEhD,MAAM,CAACwF,IAAI,CAAC,IAAI,CAACxC,UAAU,CAAC;MACxCuE,KAAK,EAAE,IAAI,CAACZ,cAAc,CAAC,CAAC;MAC5Ba,MAAM,EAAE,IAAI,CAACZ,eAAe,CAAC;IAC/B,CAAC;IAED,KAAK,MAAM,CAAC9K,IAAI,EAAE+D,MAAM,CAAC,IAAIG,MAAM,CAACe,OAAO,CAAC,IAAI,CAACgC,OAAO,CAAC,EAAE;MACzDnF,IAAI,CAACmF,OAAO,CAACjH,IAAI,CAAC,GAAG;QACnBA,IAAI,EAAE+D,MAAM,CAAC/D,IAAI;QACjBC,KAAK,EAAE8D,MAAM,CAAC9D,KAAK;QACnBG,KAAK,EAAE2D,MAAM,CAAC3D,KAAK;QACnBE,KAAK,EAAEyD,MAAM,CAACzD,KAAK;QACnBC,MAAM,EAAEwD,MAAM,CAACxD,MAAM;QACrBC,OAAO,EAAEuD,MAAM,CAACvD;MAClB,CAAC;IACH;IAEA,IAAIgL,MAAM,KAAK,MAAM,EAAE;MACrB,OAAOG,IAAI,CAACC,SAAS,CAAC9J,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;IACtC;IAEA,OAAOA,IAAI;EACb;;EAEA;AACF;AACA;AACA;AACA;;EAEE;AACF;AACA;EACE,MAAM+J,YAAYA,CAACC,KAAK,EAAE;IACxB,IAAI;MACF,MAAMC,GAAG,GAAG,MAAM5M,GAAG,CAAC6M,QAAQ,CAACF,KAAK,CAAC;MACrC,IAAI,CAACC,GAAG,EAAE;QACR,MAAM,IAAIE,KAAK,CAAC,eAAe,CAAC;MAClC;MAEA,IAAIC,eAAe;;MAEnB;MACA,QAAQH,GAAG,CAACI,QAAQ;QAClB,KAAK,aAAa;UAChBD,eAAe,GAAG,MAAM,IAAI,CAACE,uBAAuB,CAACL,GAAG,CAAC;UACzD;QACF,KAAK,SAAS;UACZG,eAAe,GAAG,MAAM,IAAI,CAACG,mBAAmB,CAACN,GAAG,CAAC;UACrD;QACF,KAAK,cAAc;UACjBG,eAAe,GAAG,MAAM,IAAI,CAACI,wBAAwB,CAACP,GAAG,CAAC;UAC1D;QACF,KAAK,WAAW;UACdG,eAAe,GAAG,MAAM,IAAI,CAACK,qBAAqB,CAACR,GAAG,CAAC;UACvD;QACF;UACEG,eAAe,GAAG,MAAM,IAAI,CAACM,kBAAkB,CAACT,GAAG,CAAC;MACxD;;MAEA;MACAA,GAAG,CAAC3L,KAAK,CAACqM,QAAQ,GAAGV,GAAG,CAAC3L,KAAK,CAACsM,OAAO;MACtCX,GAAG,CAAC3L,KAAK,CAACsM,OAAO,GAAGR,eAAe;MACnCH,GAAG,CAACY,WAAW,CAACC,cAAc,GAAG,IAAI5L,IAAI,CAAC,CAAC;;MAE3C;MACA+K,GAAG,CAACvL,OAAO,CAACM,IAAI,CAAC;QACfV,KAAK,EAAE8L,eAAe;QACtBzH,IAAI,EAAE,IAAIzD,IAAI,CAAC;MACjB,CAAC,CAAC;;MAEF;MACA,IAAI+K,GAAG,CAACvL,OAAO,CAAC0B,MAAM,GAAG,GAAG,EAAE;QAC5B6J,GAAG,CAACvL,OAAO,GAAGuL,GAAG,CAACvL,OAAO,CAACiD,KAAK,CAAC,CAAC,GAAG,CAAC;MACvC;MAEA,MAAMsI,GAAG,CAACc,IAAI,CAAC,CAAC;MAEhB,OAAOd,GAAG;IACZ,CAAC,CAAC,OAAOe,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9C,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMV,uBAAuBA,CAACL,GAAG,EAAE;IACjC,QAAQA,GAAG,CAACiB,IAAI;MACd,KAAK,gBAAgB;QACnB,OAAO,MAAM,IAAI,CAACC,iBAAiB,CAAC,CAAC;MACvC,KAAK,iBAAiB;QACpB,OAAO,MAAM,IAAI,CAACC,sBAAsB,CAAC,CAAC;MAC5C,KAAK,gBAAgB;QACnB,OAAO,MAAM,IAAI,CAACC,wBAAwB,CAAC,CAAC;MAC9C;QACE,OAAOpB,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAI,CAAC;IACjC;EACF;;EAEA;AACF;AACA;EACE,MAAML,mBAAmBA,CAACN,GAAG,EAAE;IAC7B,QAAQA,GAAG,CAACiB,IAAI;MACd,KAAK,kBAAkB;QACrB,OAAO,MAAM,IAAI,CAACI,sBAAsB,CAAC,CAAC;MAC5C,KAAK,gBAAgB;QACnB,OAAO,MAAM,IAAI,CAACC,iBAAiB,CAAC,CAAC;MACvC,KAAK,aAAa;QAChB,OAAO,MAAM,IAAI,CAACC,aAAa,CAAC,CAAC;MACnC;QACE,OAAOvB,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAI,CAAC;IACjC;EACF;;EAEA;AACF;AACA;EACE,MAAMJ,wBAAwBA,CAACP,GAAG,EAAE;IAClC,QAAQA,GAAG,CAACiB,IAAI;MACd,KAAK,aAAa;QAChB,OAAO,MAAM,IAAI,CAACO,sBAAsB,CAAC,CAAC;MAC5C,KAAK,YAAY;QACf,OAAO,MAAM,IAAI,CAACC,qBAAqB,CAAC,CAAC;MAC3C,KAAK,cAAc;QACjB,OAAO,MAAM,IAAI,CAACC,uBAAuB,CAAC,CAAC;MAC7C;QACE,OAAO1B,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAI,CAAC;IACjC;EACF;;EAEA;AACF;AACA;EACE,MAAMH,qBAAqBA,CAACR,GAAG,EAAE;IAC/B,QAAQA,GAAG,CAACiB,IAAI;MACd,KAAK,aAAa;QAChB,OAAO,MAAM,IAAI,CAACU,eAAe,CAAC,CAAC;MACrC,KAAK,YAAY;QACf,OAAO,MAAM,IAAI,CAACC,eAAe,CAAC,CAAC;MACrC,KAAK,gBAAgB;QACnB,OAAO,MAAM,IAAI,CAACC,iBAAiB,CAAC,CAAC;MACvC,KAAK,cAAc;QACjB,OAAO,MAAM,IAAI,CAACC,gBAAgB,CAAC,CAAC;MACtC;QACE,OAAO9B,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAI,CAAC;IACjC;EACF;;EAEA;AACF;AACA;EACE,MAAMF,kBAAkBA,CAACT,GAAG,EAAE;IAC5B,IAAIA,GAAG,CAACY,WAAW,IAAIZ,GAAG,CAACY,WAAW,CAACmB,OAAO,EAAE;MAC9C,IAAI;QACF;QACA,OAAOC,IAAI,CAAChC,GAAG,CAACY,WAAW,CAACmB,OAAO,CAAC;MACtC,CAAC,CAAC,OAAOhB,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;QAChD,OAAOf,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAI,CAAC;MAC/B;IACF;IACA,OAAOX,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAI,CAAC;EAC/B;;EAEA;AACF;AACA;AACA;AACA;;EAEE;AACF;AACA;EACE,MAAMsB,qBAAqBA,CAACC,OAAO,GAAG,CAAC,CAAC,EAAE;IACxC,IAAI;MACF,MAAMC,eAAe,GAAG,MAAM/O,GAAG,CAACoK,IAAI,CAAC;QACrC4C,QAAQ,EAAE,aAAa;QACvBgC,QAAQ,EAAE;MACZ,CAAC,CAAC,CAACC,IAAI,CAAC;QAAEpB,IAAI,EAAE;MAAE,CAAC,CAAC;MAEpB,MAAMqB,WAAW,GAAG,MAAMlP,GAAG,CAACoK,IAAI,CAAC;QACjC4C,QAAQ,EAAE,SAAS;QACnBgC,QAAQ,EAAE;MACZ,CAAC,CAAC,CAACC,IAAI,CAAC;QAAEpB,IAAI,EAAE;MAAE,CAAC,CAAC;MAEpB,MAAMsB,gBAAgB,GAAG,MAAMnP,GAAG,CAACoK,IAAI,CAAC;QACtC4C,QAAQ,EAAE,cAAc;QACxBgC,QAAQ,EAAE;MACZ,CAAC,CAAC,CAACC,IAAI,CAAC;QAAEpB,IAAI,EAAE;MAAE,CAAC,CAAC;MAEpB,MAAMuB,aAAa,GAAG,MAAMpP,GAAG,CAACoK,IAAI,CAAC;QACnC4C,QAAQ,EAAE,WAAW;QACrBgC,QAAQ,EAAE;MACZ,CAAC,CAAC,CAACC,IAAI,CAAC;QAAEpB,IAAI,EAAE;MAAE,CAAC,CAAC;MAEpB,MAAMvB,KAAK,GAAG,MAAM,IAAI,CAAC+C,oBAAoB,CAACP,OAAO,CAAC;MAEtD,OAAO;QACLQ,WAAW,EAAEP,eAAe;QAC5BQ,OAAO,EAAEL,WAAW;QACpBM,YAAY,EAAEL,gBAAgB;QAC9BM,SAAS,EAAEL,aAAa;QACxB9C,KAAK;QACLoD,WAAW,EAAE,IAAI7N,IAAI,CAAC;MACxB,CAAC;IACH,CAAC,CAAC,OAAO8L,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;MAC1D,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;AACA;;EAEE;AACF;AACA;EACE,MAAMgC,kBAAkBA,CAACnN,IAAI,EAAEmK,KAAK,EAAEzH,MAAM,GAAG,EAAE,EAAE;IACjD,IAAI;MACF,MAAM0H,GAAG,GAAG,MAAM5M,GAAG,CAAC6M,QAAQ,CAACF,KAAK,CAAC;MACrC,IAAI,CAACC,GAAG,EAAE;QACR,MAAM,IAAIE,KAAK,CAAC,eAAe,CAAC;MAClC;MAEA,MAAM8C,cAAc,GAAGhD,GAAG,CAACvL,OAAO,CAACiD,KAAK,CAAC,CAAC,EAAE,CAAC,CAACyB,GAAG,CAACQ,CAAC,KAAK;QACtDjB,IAAI,EAAEiB,CAAC,CAACjB,IAAI;QACZrE,KAAK,EAAEsF,CAAC,CAACtF;MACX,CAAC,CAAC,CAAC;MAEH,IAAI2O,cAAc,CAAC7M,MAAM,GAAG,EAAE,EAAE;QAC9B,MAAM,IAAI+J,KAAK,CAAC,2CAA2C,CAAC;MAC9D;MAEA,MAAM+C,WAAW,GAAG,IAAI,CAACC,gBAAgB,CAACF,cAAc,EAAE1K,MAAM,CAAC;MAEjE,MAAM6K,UAAU,GAAG,IAAI7P,UAAU,CAAC;QAChCsC,IAAI;QACJoK,GAAG,EAAED,KAAK;QACViD,cAAc;QACdC,WAAW;QACXG,KAAK,EAAE;UACLxN,IAAI,EAAE,QAAQ;UACdyN,QAAQ,EAAE,IAAI,CAACC,iBAAiB,CAACN,cAAc,EAAEC,WAAW;QAC9D,CAAC;QACD3K,MAAM,EAAE;UACNiL,IAAI,EAAE,IAAItO,IAAI,CAAC,CAAC;UAChBuO,EAAE,EAAE,IAAIvO,IAAI,CAACA,IAAI,CAAC6H,GAAG,CAAC,CAAC,GAAGxE,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;QACxD,CAAC;QACD9D,MAAM,EAAE,WAAW;QACnBiP,YAAY,EAAE,IAAIxO,IAAI,CAAC;MACzB,CAAC,CAAC;MAEF,MAAMkO,UAAU,CAACrC,IAAI,CAAC,CAAC;MAEvB,OAAOqC,UAAU;IACnB,CAAC,CAAC,OAAOpC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACEmC,gBAAgBA,CAACnN,IAAI,EAAE2N,UAAU,EAAE;IACjC,MAAM9M,CAAC,GAAGb,IAAI,CAACI,MAAM;IACrB,MAAMwN,CAAC,GAAG5N,IAAI,CAACoD,GAAG,CAAC,CAACyK,CAAC,EAAEvM,CAAC,KAAKA,CAAC,CAAC;IAC/B,MAAMwM,CAAC,GAAG9N,IAAI,CAACoD,GAAG,CAACyK,CAAC,IAAIA,CAAC,CAACvP,KAAK,CAAC;IAEhC,MAAMwC,IAAI,GAAG8M,CAAC,CAAC5M,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,EAAE,CAAC,CAAC;IACzC,MAAMH,IAAI,GAAG+M,CAAC,CAAC9M,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,EAAE,CAAC,CAAC;IACzC,MAAM6M,KAAK,GAAGjN,IAAI,GAAGD,CAAC;IACtB,MAAMmN,KAAK,GAAGjN,IAAI,GAAGF,CAAC;IAEtB,IAAIoN,GAAG,GAAG,CAAC;IACX,IAAIC,GAAG,GAAG,CAAC;IACX,KAAK,IAAI5M,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,CAAC,EAAES,CAAC,EAAE,EAAE;MAC1B2M,GAAG,IAAI,CAACL,CAAC,CAACtM,CAAC,CAAC,GAAGyM,KAAK,KAAKD,CAAC,CAACxM,CAAC,CAAC,GAAG0M,KAAK,CAAC;MACtCE,GAAG,IAAInK,IAAI,CAACoK,GAAG,CAACP,CAAC,CAACtM,CAAC,CAAC,GAAGyM,KAAK,EAAE,CAAC,CAAC;IAClC;IACA,MAAMvM,KAAK,GAAGyM,GAAG,GAAGC,GAAG;IACvB,MAAMzM,SAAS,GAAGuM,KAAK,GAAGxM,KAAK,GAAGuM,KAAK;IAEvC,MAAMb,WAAW,GAAG,EAAE;IACtB,MAAMkB,QAAQ,GAAGpO,IAAI,CAACa,CAAC,GAAG,CAAC,CAAC,CAAC8B,IAAI;IAEjC,KAAK,IAAIrB,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAIqM,UAAU,EAAErM,CAAC,EAAE,EAAE;MACpC,MAAM+M,cAAc,GAAG5M,SAAS,GAAGD,KAAK,IAAIX,CAAC,GAAGS,CAAC,CAAC;MAClD,MAAMgN,UAAU,GAAGvK,IAAI,CAACwK,GAAG,CAAC,EAAE,EAAE,EAAE,GAAGjN,CAAC,CAAC;MAEvC4L,WAAW,CAAClO,IAAI,CAAC;QACf2D,IAAI,EAAE,IAAIzD,IAAI,CAACkP,QAAQ,CAACI,OAAO,CAAC,CAAC,GAAGlN,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;QAC5D+M,cAAc,EAAEtK,IAAI,CAAC0K,KAAK,CAACJ,cAAc,GAAG,GAAG,CAAC,GAAG,GAAG;QACtDC,UAAU;QACVI,UAAU,EAAE3K,IAAI,CAAC0K,KAAK,CAACJ,cAAc,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG;QACxDM,UAAU,EAAE5K,IAAI,CAAC0K,KAAK,CAACJ,cAAc,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG;MACvD,CAAC,CAAC;IACJ;IAEA,OAAOnB,WAAW;EACpB;;EAEA;AACF;AACA;EACEK,iBAAiBA,CAACqB,UAAU,EAAE1B,WAAW,EAAE;IACzC,MAAM2B,QAAQ,GAAG9K,IAAI,CAACC,GAAG,CAAC,EAAE,EAAED,IAAI,CAAC+K,KAAK,CAACF,UAAU,CAACxO,MAAM,GAAG,GAAG,CAAC,CAAC;IAClE,MAAM2O,QAAQ,GAAGH,UAAU,CAACjN,KAAK,CAAC,CAACkN,QAAQ,CAAC;IAC5C,MAAMG,QAAQ,GAAG9B,WAAW,CAACvL,KAAK,CAAC,CAAC,EAAEkN,QAAQ,CAAC;IAE/C,IAAII,UAAU,GAAG,CAAC;IAClB,KAAK,IAAI3N,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuN,QAAQ,EAAEvN,CAAC,EAAE,EAAE;MACjC,MAAM4N,MAAM,GAAGH,QAAQ,CAACzN,CAAC,CAAC,CAAChD,KAAK;MAChC,MAAM6Q,SAAS,GAAGH,QAAQ,CAAC1N,CAAC,CAAC,CAAC+M,cAAc;MAC5CY,UAAU,IAAIlL,IAAI,CAACqL,GAAG,CAAC,CAACF,MAAM,GAAGC,SAAS,IAAID,MAAM,CAAC;IACvD;IAEA,MAAMG,IAAI,GAAIJ,UAAU,GAAGJ,QAAQ,GAAI,GAAG;IAC1C,OAAO9K,IAAI,CAACwK,GAAG,CAAC,CAAC,EAAExK,IAAI,CAACC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAGqL,IAAI,CAAC,CAAC;EAC/C;;EAEA;AACF;AACA;AACA;AACA;;EAEE;AACF;AACA;EACE,MAAMC,cAAcA,CAACC,UAAU,EAAEpD,OAAO,EAAEzC,MAAM,EAAE8F,MAAM,EAAE;IACxD,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMjS,cAAc,CAAC0M,QAAQ,CAACqF,UAAU,CAAC;MAC1D,IAAI,CAACE,QAAQ,EAAE;QACb,MAAM,IAAItF,KAAK,CAAC,oBAAoB,CAAC;MACvC;MAEA,MAAMuF,SAAS,GAAGxQ,IAAI,CAAC6H,GAAG,CAAC,CAAC;MAC5B,MAAM/G,IAAI,GAAG,MAAM,IAAI,CAAC2P,iBAAiB,CAACF,QAAQ,EAAEtD,OAAO,CAAC;MAE5D,MAAMyD,MAAM,GAAG,IAAInS,eAAe,CAAC;QACjCgS,QAAQ,EAAEF,UAAU;QACpB/P,KAAK,EAAEiQ,QAAQ,CAACvR,IAAI;QACpB2R,OAAO,EAAEJ,QAAQ,CAACK,MAAM;QACxBvN,MAAM,EAAE4J,OAAO,CAAC5J,MAAM;QACtBwN,cAAc,EAAE5D,OAAO;QACvBnM,IAAI;QACJgQ,WAAW,EAAER,MAAM;QACnBzC,WAAW,EAAE,IAAI7N,IAAI,CAAC,CAAC;QACvBT,MAAM,EAAE;MACV,CAAC,CAAC;MAEF,MAAMmR,MAAM,CAAC7E,IAAI,CAAC,CAAC;MAEnB,IAAIkF,QAAQ;MACZ,QAAQvG,MAAM;QACZ,KAAK,KAAK;UACRuG,QAAQ,GAAG,MAAM,IAAI,CAACC,iBAAiB,CAACT,QAAQ,EAAEzP,IAAI,EAAE4P,MAAM,CAACO,GAAG,CAAC;UACnE;QACF,KAAK,OAAO;UACVF,QAAQ,GAAG,MAAM,IAAI,CAACG,mBAAmB,CAACX,QAAQ,EAAEzP,IAAI,EAAE4P,MAAM,CAACO,GAAG,CAAC;UACrE;QACF,KAAK,KAAK;UACRF,QAAQ,GAAG,MAAM,IAAI,CAACI,iBAAiB,CAACZ,QAAQ,EAAEzP,IAAI,EAAE4P,MAAM,CAACO,GAAG,CAAC;UACnE;QACF,KAAK,MAAM;UACTF,QAAQ,GAAG,MAAM,IAAI,CAACK,kBAAkB,CAACb,QAAQ,EAAEzP,IAAI,EAAE4P,MAAM,CAACO,GAAG,CAAC;UACpE;QACF;UACE,MAAM,IAAIhG,KAAK,CAAC,oBAAoB,CAAC;MACzC;MAEA,MAAMR,KAAK,GAAG,MAAM9L,EAAE,CAAC0S,IAAI,CAACN,QAAQ,CAAC;MACrCL,MAAM,CAACY,IAAI,GAAG;QACZ9G,MAAM;QACN3L,IAAI,EAAEkS,QAAQ;QACdQ,IAAI,EAAE9G,KAAK,CAAC8G,IAAI;QAChBC,GAAG,EAAE,yBAAyBd,MAAM,CAACO,GAAG;MAC1C,CAAC;MACDP,MAAM,CAACnR,MAAM,GAAG,WAAW;MAC3BmR,MAAM,CAACe,cAAc,GAAG,CAACzR,IAAI,CAAC6H,GAAG,CAAC,CAAC,GAAG2I,SAAS,IAAI,IAAI;MAEvD,MAAME,MAAM,CAAC7E,IAAI,CAAC,CAAC;MAEnB0E,QAAQ,CAAC9F,KAAK,CAACiH,cAAc,IAAI,CAAC;MAClCnB,QAAQ,CAAC9F,KAAK,CAACkH,aAAa,GAAG,IAAI3R,IAAI,CAAC,CAAC;MACzC,MAAMuQ,QAAQ,CAAC1E,IAAI,CAAC,CAAC;MAErB,OAAO6E,MAAM;IACf,CAAC,CAAC,OAAO5E,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChD,IAAI4E,MAAM,EAAE;QACVA,MAAM,CAACnR,MAAM,GAAG,QAAQ;QACxBmR,MAAM,CAAC5E,KAAK,GAAGA,KAAK,CAAC8F,OAAO;QAC5B,MAAMlB,MAAM,CAAC7E,IAAI,CAAC,CAAC;MACrB;MACA,MAAMC,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAM2E,iBAAiBA,CAACF,QAAQ,EAAEtD,OAAO,EAAE;IACzC,MAAMnM,IAAI,GAAG;MACXoJ,OAAO,EAAE,CAAC,CAAC;MACX2H,OAAO,EAAE,EAAE;MACXC,MAAM,EAAE,EAAE;MACVjP,IAAI,EAAE;IACR,CAAC;IAED,IAAI0N,QAAQ,CAACwB,SAAS,CAAClP,IAAI,IAAI0N,QAAQ,CAACwB,SAAS,CAAClP,IAAI,CAAC3B,MAAM,GAAG,CAAC,EAAE;MACjEJ,IAAI,CAAC+B,IAAI,GAAG,MAAM1E,GAAG,CAACoK,IAAI,CAAC;QACzB0I,GAAG,EAAE;UAAEe,GAAG,EAAEzB,QAAQ,CAACwB,SAAS,CAAClP;QAAK,CAAC;QACrCsK,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;IAEA,OAAOrM,IAAI;EACb;;EAEA;AACF;AACA;EACE,MAAMkQ,iBAAiBA,CAACT,QAAQ,EAAEzP,IAAI,EAAEmR,QAAQ,EAAE;IAChD,MAAMC,QAAQ,GAAG,UAAUD,QAAQ,IAAIjS,IAAI,CAAC6H,GAAG,CAAC,CAAC,MAAM;IACvD,MAAMkJ,QAAQ,GAAGlS,IAAI,CAACsT,IAAI,CAACC,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAEF,QAAQ,CAAC;IAE1E,MAAMvT,EAAE,CAAC0T,KAAK,CAACxT,IAAI,CAACyT,OAAO,CAACvB,QAAQ,CAAC,EAAE;MAAEwB,SAAS,EAAE;IAAK,CAAC,CAAC;IAE3D,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI;QACF,MAAMC,GAAG,GAAG,IAAIlU,WAAW,CAAC;UAC1B8S,IAAI,EAAEhB,QAAQ,CAACqC,UAAU,EAAEC,QAAQ,IAAI,IAAI;UAC3CC,MAAM,EAAEvC,QAAQ,CAACqC,UAAU,EAAEG,WAAW,IAAI,UAAU;UACtDC,OAAO,EAAE;YAAEC,GAAG,EAAE,EAAE;YAAEC,MAAM,EAAE,EAAE;YAAEC,IAAI,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAG;QACtD,CAAC,CAAC;QAEF,MAAMC,MAAM,GAAGV,GAAG,CAACW,IAAI,CAAC9U,OAAO,CAAC,IAAI,CAAC,CAAC+U,iBAAiB,CAACxC,QAAQ,CAAC,CAAC;QAElE,IAAIR,QAAQ,CAACqC,UAAU,EAAEY,MAAM,EAAEC,IAAI,EAAE;UACrCd,GAAG,CAACe,QAAQ,CAAC,EAAE,CAAC,CAACC,IAAI,CAACpD,QAAQ,CAACK,MAAM,EAAE;YAAEgD,KAAK,EAAE;UAAS,CAAC,CAAC;UAC3DjB,GAAG,CAACe,QAAQ,CAAC,EAAE,CAAC,CAACC,IAAI,CAAC,IAAI3T,IAAI,CAAC,CAAC,CAAC6T,kBAAkB,CAAC,OAAO,CAAC,EAAE;YAAED,KAAK,EAAE;UAAS,CAAC,CAAC;UAClFjB,GAAG,CAACmB,QAAQ,CAAC,CAAC;QAChB;QAEA,IAAIhT,IAAI,CAAC+B,IAAI,IAAI/B,IAAI,CAAC+B,IAAI,CAAC3B,MAAM,GAAG,CAAC,EAAE;UACrCyR,GAAG,CAACe,QAAQ,CAAC,EAAE,CAAC,CAACC,IAAI,CAAC,wBAAwB,EAAE;YAAEI,SAAS,EAAE;UAAK,CAAC,CAAC;UACpEpB,GAAG,CAACmB,QAAQ,CAAC,CAAC;UAEdhT,IAAI,CAAC+B,IAAI,CAACU,OAAO,CAACwH,GAAG,IAAI;YACvB4H,GAAG,CAACe,QAAQ,CAAC,EAAE,CAAC,CAACC,IAAI,CAAC,GAAG5I,GAAG,CAAC6F,MAAM,KAAK7F,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAIX,GAAG,CAAC5L,IAAI,EAAE,CAAC;YACxEwT,GAAG,CAACmB,QAAQ,CAAC,GAAG,CAAC;UACnB,CAAC,CAAC;QACJ;QAEA,IAAIvD,QAAQ,CAACqC,UAAU,EAAEoB,MAAM,EAAEP,IAAI,EAAE;UACrCd,GAAG,CACAe,QAAQ,CAAC,EAAE,CAAC,CACZC,IAAI,CACH,gCAAgC,IAAI3T,IAAI,CAAC,CAAC,CAACiU,cAAc,CAAC,OAAO,CAAC,EAAE,EACpE,EAAE,EACFtB,GAAG,CAACuB,IAAI,CAACC,MAAM,GAAG,EAAE,EACpB;YAAEP,KAAK,EAAE;UAAS,CACpB,CAAC;QACL;QAEAjB,GAAG,CAACyB,GAAG,CAAC,CAAC;QAETf,MAAM,CAACgB,EAAE,CAAC,QAAQ,EAAE,MAAM5B,OAAO,CAAC1B,QAAQ,CAAC,CAAC;QAC5CsC,MAAM,CAACgB,EAAE,CAAC,OAAO,EAAE3B,MAAM,CAAC;MAC5B,CAAC,CAAC,OAAO5G,KAAK,EAAE;QACd4G,MAAM,CAAC5G,KAAK,CAAC;MACf;IACF,CAAC,CAAC;EACJ;;EAEA;AACF;AACA;EACE,MAAMoF,mBAAmBA,CAACX,QAAQ,EAAEzP,IAAI,EAAEmR,QAAQ,EAAE;IAClD,MAAMC,QAAQ,GAAG,UAAUD,QAAQ,IAAIjS,IAAI,CAAC6H,GAAG,CAAC,CAAC,OAAO;IACxD,MAAMkJ,QAAQ,GAAGlS,IAAI,CAACsT,IAAI,CAACC,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAEF,QAAQ,CAAC;IAE1E,MAAMvT,EAAE,CAAC0T,KAAK,CAACxT,IAAI,CAACyT,OAAO,CAACvB,QAAQ,CAAC,EAAE;MAAEwB,SAAS,EAAE;IAAK,CAAC,CAAC;IAE3D,MAAM+B,QAAQ,GAAG,IAAI5V,OAAO,CAAC6V,QAAQ,CAAC,CAAC;IACvC,MAAMC,SAAS,GAAGF,QAAQ,CAACG,YAAY,CAAClE,QAAQ,CAACK,MAAM,CAAC;IAExD4D,SAAS,CAACE,MAAM,CAAC,CAACnE,QAAQ,CAACK,MAAM,CAAC,CAAC;IACnC4D,SAAS,CAACE,MAAM,CAAC,CAAC,YAAY,IAAI1U,IAAI,CAAC,CAAC,CAAC6T,kBAAkB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACxEW,SAAS,CAACE,MAAM,CAAC,EAAE,CAAC;IAEpB,IAAI5T,IAAI,CAAC+B,IAAI,IAAI/B,IAAI,CAAC+B,IAAI,CAAC3B,MAAM,GAAG,CAAC,EAAE;MACrCsT,SAAS,CAACE,MAAM,CAAC,CAAC,wBAAwB,CAAC,CAAC;MAC5CF,SAAS,CAACE,MAAM,CAAC,CAAC,QAAQ,EAAE,gBAAgB,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;MAE3E5T,IAAI,CAAC+B,IAAI,CAACU,OAAO,CAACwH,GAAG,IAAI;QACvByJ,SAAS,CAACE,MAAM,CAAC,CAAC3J,GAAG,CAAC6F,MAAM,EAAE7F,GAAG,CAAC3L,KAAK,CAACsM,OAAO,EAAEX,GAAG,CAAC3L,KAAK,CAACuV,MAAM,EAAE5J,GAAG,CAAC5L,IAAI,EAAE4L,GAAG,CAACxL,MAAM,CAAC,CAAC;MAC3F,CAAC,CAAC;IACJ;IAEA,MAAM+U,QAAQ,CAACM,IAAI,CAACC,SAAS,CAAC9D,QAAQ,CAAC;IACvC,OAAOA,QAAQ;EACjB;;EAEA;AACF;AACA;EACE,MAAMI,iBAAiBA,CAACZ,QAAQ,EAAEzP,IAAI,EAAEmR,QAAQ,EAAE;IAChD,MAAMC,QAAQ,GAAG,UAAUD,QAAQ,IAAIjS,IAAI,CAAC6H,GAAG,CAAC,CAAC,MAAM;IACvD,MAAMkJ,QAAQ,GAAGlS,IAAI,CAACsT,IAAI,CAACC,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAEF,QAAQ,CAAC;IAE1E,MAAMvT,EAAE,CAAC0T,KAAK,CAACxT,IAAI,CAACyT,OAAO,CAACvB,QAAQ,CAAC,EAAE;MAAEwB,SAAS,EAAE;IAAK,CAAC,CAAC;IAE3D,IAAIuC,GAAG,GAAG,GAAGvE,QAAQ,CAACK,MAAM,IAAI;IAChCkE,GAAG,IAAI,WAAW,IAAI9U,IAAI,CAAC,CAAC,CAAC6T,kBAAkB,CAAC,OAAO,CAAC,MAAM;IAE9D,IAAI/S,IAAI,CAAC+B,IAAI,IAAI/B,IAAI,CAAC+B,IAAI,CAAC3B,MAAM,GAAG,CAAC,EAAE;MACrC4T,GAAG,IAAI,6CAA6C;MACpDhU,IAAI,CAAC+B,IAAI,CAACU,OAAO,CAACwH,GAAG,IAAI;QACvB+J,GAAG,IAAI,GAAG/J,GAAG,CAAC6F,MAAM,IAAI7F,GAAG,CAAC3L,KAAK,CAACsM,OAAO,IAAIX,GAAG,CAAC3L,KAAK,CAACuV,MAAM,IAAI5J,GAAG,CAAC5L,IAAI,IAAI4L,GAAG,CAACxL,MAAM,IAAI;MAC7F,CAAC,CAAC;IACJ;IAEA,MAAMZ,EAAE,CAACkW,SAAS,CAAC9D,QAAQ,EAAE+D,GAAG,EAAE,MAAM,CAAC;IACzC,OAAO/D,QAAQ;EACjB;;EAEA;AACF;AACA;EACE,MAAMK,kBAAkBA,CAACb,QAAQ,EAAEzP,IAAI,EAAEmR,QAAQ,EAAE;IACjD,MAAMC,QAAQ,GAAG,UAAUD,QAAQ,IAAIjS,IAAI,CAAC6H,GAAG,CAAC,CAAC,OAAO;IACxD,MAAMkJ,QAAQ,GAAGlS,IAAI,CAACsT,IAAI,CAACC,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAEF,QAAQ,CAAC;IAE1E,MAAMvT,EAAE,CAAC0T,KAAK,CAACxT,IAAI,CAACyT,OAAO,CAACvB,QAAQ,CAAC,EAAE;MAAEwB,SAAS,EAAE;IAAK,CAAC,CAAC;IAE3D,MAAMwC,UAAU,GAAG;MACjBxE,QAAQ,EAAE;QACRvR,IAAI,EAAEuR,QAAQ,CAACvR,IAAI;QACnB4R,MAAM,EAAEL,QAAQ,CAACK;MACnB,CAAC;MACD/C,WAAW,EAAE,IAAI7N,IAAI,CAAC,CAAC;MACvBc;IACF,CAAC;IAED,MAAMnC,EAAE,CAACkW,SAAS,CAAC9D,QAAQ,EAAEpG,IAAI,CAACC,SAAS,CAACmK,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC;IACzE,OAAOhE,QAAQ;EACjB;;EAEA;AACF;AACA;AACA;AACA;;EAEE,MAAM9E,iBAAiBA,CAAA,EAAG;IACxB,OAAOpH,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAMoE,sBAAsBA,CAAA,EAAG;IAC7B,OAAOrH,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAMqE,wBAAwBA,CAAA,EAAG;IAC/B,OAAOtH,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAMsE,sBAAsBA,CAAA,EAAG;IAC7B,OAAOvH,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAMuE,iBAAiBA,CAAA,EAAG;IACxB,OAAOxH,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAMwE,aAAaA,CAAA,EAAG;IACpB,OAAOzH,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;EAC1C;EACA,MAAMyE,sBAAsBA,CAAA,EAAG;IAC7B,OAAO1H,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAM0E,qBAAqBA,CAAA,EAAG;IAC5B,OAAO3H,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAM2E,uBAAuBA,CAAA,EAAG;IAC9B,OAAO5H,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAM4E,eAAeA,CAAA,EAAG;IACtB,OAAO7H,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,OAAO;EACrD;EACA,MAAM6E,eAAeA,CAAA,EAAG;IACtB,OAAO9H,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAM8E,iBAAiBA,CAAA,EAAG;IACxB,OAAO/H,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE;EAC5C;EACA,MAAM+E,gBAAgBA,CAAA,EAAG;IACvB,OAAOhI,IAAI,CAAC+K,KAAK,CAAC/K,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,MAAM;EACpD;EAEA,MAAM0F,oBAAoBA,CAACP,OAAO,EAAE;IAClC,OAAO;MACL+H,UAAU,EAAE,IAAI;MAChBC,WAAW,EAAE,GAAG;MAChBC,YAAY,EAAE,OAAO;MACrBC,aAAa,EAAE,MAAM;MACrBC,YAAY,EAAE,EAAE;MAChB3R,IAAI,EAAE,IAAIzD,IAAI,CAAC;IACjB,CAAC;EACH;;EAEA;AACF;AACA;AACA;AACA;;EAEE;EACA,OAAOqV,iBAAiBA,CAAC/E,MAAM,EAAE;IAC/B,OAAO;MACLgF,OAAO,EAAE,IAAI;MACbhF,MAAM,EAAEA,MAAM;MACdiF,QAAQ,EAAE;QACRC,cAAc,EAAE,mBAAmB;QACnCC,sBAAsB,EAAE,YAAY;QACpCC,gBAAgB,EAAE,CAAC,SAAS,EAAE,eAAe,EAAE,OAAO,CAAC;QACvDC,SAAS,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;QACtCC,WAAW,EAAE,CAAC,SAAS,EAAE,QAAQ,CAAC;QAClCC,QAAQ,EAAE,CAAC,QAAQ,EAAE,QAAQ;MAC/B,CAAC;MACDC,UAAU,EAAE;QACVC,KAAK,EAAE,GAAG;QACVC,KAAK,EAAE,MAAM;QACb1W,KAAK,EAAE;MACT,CAAC;MACDS,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOuS,qBAAqBA,CAACC,SAAS,GAAG,KAAK,EAAE;IAC9C,OAAO;MACLZ,OAAO,EAAE,IAAI;MACbY,SAAS,EAAEA,SAAS;MACpBjQ,OAAO,EAAE;QACPkQ,YAAY,EAAE;UACZC,OAAO,EAAE,OAAO;UAChBtR,GAAG,EAAE,MAAM;UACXuK,GAAG,EAAE,QAAQ;UACbgH,GAAG,EAAE;QACP,CAAC;QACDC,MAAM,EAAE,QAAQ;QAChBC,SAAS,EAAE,OAAO;QAClBC,UAAU,EAAE,sBAAsB;QAClCC,QAAQ,EAAE,KAAK;QACfC,WAAW,EAAE,KAAK;QAClBC,eAAe,EAAE;MACnB,CAAC;MACD5W,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOkT,kBAAkBA,CAACtG,MAAM,EAAE;IAChC,OAAO;MACLgF,OAAO,EAAE,IAAI;MACbhF,MAAM,EAAEA,MAAM;MACdzJ,SAAS,EAAE;QACTtG,OAAO,EAAE,CACP;UACEqH,EAAE,EAAE,UAAU;UACdtH,KAAK,EAAE,gBAAgB;UACvBK,IAAI,EAAE,OAAO;UACbG,IAAI,EAAE;YAAE4K,OAAO,EAAE,MAAM;YAAED,QAAQ,EAAE,MAAM;YAAEoL,MAAM,EAAE;UAAM;QAC3D,CAAC,EACD;UACEjP,EAAE,EAAE,UAAU;UACdtH,KAAK,EAAE,eAAe;UACtBK,IAAI,EAAE,OAAO;UACbG,IAAI,EAAE;YAAEgW,MAAM,EAAE,GAAG;YAAEC,QAAQ,EAAE,EAAE;YAAE5M,KAAK,EAAE;UAAI;QAChD,CAAC,EACD;UACEvC,EAAE,EAAE,UAAU;UACdtH,KAAK,EAAE,eAAe;UACtBK,IAAI,EAAE,QAAQ;UACdG,IAAI,EAAE;YAAEvB,MAAM,EAAE,SAAS;YAAE+W,MAAM,EAAE;UAAS;QAC9C,CAAC,EACD;UACE1O,EAAE,EAAE,UAAU;UACdtH,KAAK,EAAE,cAAc;UACrBK,IAAI,EAAE,MAAM;UACZG,IAAI,EAAE,CAAC,SAAS,EAAE,eAAe,EAAE,WAAW;QAChD,CAAC,CACF;QACDgS,MAAM,EAAE,MAAM;QACdkE,eAAe,EAAE;MACnB,CAAC;MACDjX,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOuT,aAAaA,CAAClU,MAAM,EAAEM,MAAM,GAAG,KAAK,EAAE;IAC3C,OAAO;MACLiS,OAAO,EAAE,IAAI;MACbvS,MAAM,EAAEA,MAAM;MACdM,MAAM,EAAEA,MAAM;MACd/D,KAAK,EAAE;QACLmC,SAAS,EAAE,IAAI;QACfyV,aAAa,EAAE,IAAI;QACnBC,UAAU,EAAE,CACV;UAAE1T,IAAI,EAAE,YAAY;UAAErE,KAAK,EAAE;QAAK,CAAC,EACnC;UAAEqE,IAAI,EAAE,YAAY;UAAErE,KAAK,EAAE;QAAK,CAAC,EACnC;UAAEqE,IAAI,EAAE,YAAY;UAAErE,KAAK,EAAE;QAAK,CAAC,EACnC;UAAEqE,IAAI,EAAE,YAAY;UAAErE,KAAK,EAAE;QAAK,CAAC,EACnC;UAAEqE,IAAI,EAAE,YAAY;UAAErE,KAAK,EAAE;QAAK,CAAC;MAEvC,CAAC;MACDsC,QAAQ,EAAE;QACR0V,gBAAgB,EAAE,IAAI;QACtBhI,UAAU,EAAE;MACd,CAAC;MACDrP,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAO2T,kBAAkBA,CAAA,EAAG;IAC1B,OAAO;MACL/B,OAAO,EAAE,IAAI;MACbgC,eAAe,EAAE,CACf;QACE1P,EAAE,EAAE,SAAS;QACbtH,KAAK,EAAE,2BAA2B;QAClC6K,QAAQ,EAAE,aAAa;QACvBoM,QAAQ,EAAE,MAAM;QAChBC,MAAM,EAAE,qBAAqB;QAC7BC,cAAc,EAAE;MAClB,CAAC,EACD;QACE7P,EAAE,EAAE,SAAS;QACbtH,KAAK,EAAE,yBAAyB;QAChC6K,QAAQ,EAAE,gBAAgB;QAC1BoM,QAAQ,EAAE,QAAQ;QAClBC,MAAM,EAAE;MACV,CAAC,EACD;QACE5P,EAAE,EAAE,SAAS;QACbtH,KAAK,EAAE,oBAAoB;QAC3B6K,QAAQ,EAAE,UAAU;QACpBoM,QAAQ,EAAE,MAAM;QAChBC,MAAM,EAAE;MACV,CAAC,CACF;MACDE,oBAAoB,EAAE,CAAC;MACvB3X,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOU,cAAcA,CAACsB,OAAO,EAAEC,OAAO,EAAEtC,MAAM,GAAG,KAAK,EAAE;IACtD,OAAO;MACLiS,OAAO,EAAE,IAAI;MACbvP,UAAU,EAAE;QACVL,OAAO,EAAE;UACP1G,IAAI,EAAE0G,OAAO;UACbtG,KAAK,EAAE,IAAI;UACXgX,OAAO,EAAE,IAAI;UACb9W,KAAK,EAAE;QACT,CAAC;QACDqG,OAAO,EAAE;UACP3G,IAAI,EAAE2G,OAAO;UACbvG,KAAK,EAAE,IAAI;UACXgX,OAAO,EAAE,IAAI;UACb9W,KAAK,EAAE;QACT,CAAC;QACDkG,WAAW,EAAE;MACf,CAAC;MACDnC,MAAM,EAAEA,MAAM;MACdtD,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOiU,sBAAsBA,CAACC,UAAU,GAAG,WAAW,EAAE;IACtD,OAAO;MACLtC,OAAO,EAAE,IAAI;MACbsC,UAAU,EAAEA,UAAU;MACtBlH,MAAM,EAAE;QACNxG,OAAO,EAAE;UACP7G,MAAM,EAAE,cAAc;UACtB8T,UAAU,EAAE,GAAG;UACfU,QAAQ,EAAE;QACZ,CAAC;QACDC,UAAU,EAAE;UACV9C,UAAU,EAAE,GAAG;UACfC,WAAW,EAAE,GAAG;UAChB8C,QAAQ,EAAE,EAAE;UACZC,cAAc,EAAE,KAAK;UACrBC,aAAa,EAAE;QACjB,CAAC;QACDC,qBAAqB,EAAE;UACrBC,EAAE,EAAE;YAAEC,WAAW,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAG,CAAC;UAClCC,EAAE,EAAE;YAAEF,WAAW,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAE,CAAC;UACjCE,KAAK,EAAE;YAAEH,WAAW,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAG,CAAC;UACrCG,SAAS,EAAE;YAAEJ,WAAW,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAG,CAAC;UACzCI,OAAO,EAAE;YAAEL,WAAW,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAG;QACxC,CAAC;QACDK,WAAW,EAAE,CACX,wCAAwC,EACxC,uCAAuC,EACvC,mCAAmC;MAEvC,CAAC;MACD3Y,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOiV,eAAeA,CAACrI,MAAM,EAAEsI,KAAK,EAAE;IACpC,OAAO;MACLtD,OAAO,EAAE,IAAI;MACbhF,MAAM,EAAEA,MAAM;MACdsI,KAAK,EAAEA,KAAK;MACZC,UAAU,EAAE;QACVlY,IAAI,EAAE,aAAa;QACnBmY,IAAI,EAAE,CAAC;QACPC,cAAc,EAAE,KAAK;QACrBC,SAAS,EAAE;MACb,CAAC;MACDjZ,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOuV,oBAAoBA,CAAA,EAAG;IAC5B,OAAO;MACL3D,OAAO,EAAE,IAAI;MACb4D,QAAQ,EAAE;QACRjE,WAAW,EAAE,EAAE;QACfkE,cAAc,EAAE,GAAG;QACnBC,GAAG,EAAE,EAAE;QAAE;QACTC,eAAe,EAAE,OAAO;QACxB9C,SAAS,EAAE,OAAO;QAClBC,UAAU,EAAE;MACd,CAAC;MACD8C,QAAQ,EAAE,CACR;QAAEpF,IAAI,EAAE,UAAU;QAAEmE,KAAK,EAAE,EAAE;QAAEkB,QAAQ,EAAE;MAAQ,CAAC,EAClD;QAAErF,IAAI,EAAE,YAAY;QAAEmE,KAAK,EAAE,EAAE;QAAEkB,QAAQ,EAAE;MAAQ,CAAC,EACpD;QAAErF,IAAI,EAAE,QAAQ;QAAEmE,KAAK,EAAE,CAAC;QAAEkB,QAAQ,EAAE;MAAQ,CAAC,CAChD;MACDC,UAAU,EAAE,CACV;QAAEC,MAAM,EAAE,iBAAiB;QAAEtV,KAAK,EAAE;MAAG,CAAC,EACxC;QAAEsV,MAAM,EAAE,gBAAgB;QAAEtV,KAAK,EAAE;MAAG,CAAC,EACvC;QAAEsV,MAAM,EAAE,cAAc;QAAEtV,KAAK,EAAE;MAAG,CAAC,CACtC;MACDpE,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOgW,sBAAsBA,CAAA,EAAG;IAC9B,OAAO;MACLpE,OAAO,EAAE,IAAI;MACbtH,WAAW,EAAE;QACX2L,SAAS,EAAE;UACTC,WAAW,EAAE,KAAK;UAClBC,SAAS,EAAE,EAAE;UACbvC,eAAe,EAAE;QACnB,CAAC;QACDwC,cAAc,EAAE;UACdC,SAAS,EAAE,WAAW;UACtBC,WAAW,EAAE,WAAW;UACxB5K,UAAU,EAAE;QACd,CAAC;QACD6K,eAAe,EAAE;UACfC,YAAY,EAAE,CAAC,SAAS,EAAE,eAAe,CAAC;UAC1CC,cAAc,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC;UACxCC,WAAW,EAAE,CAAC,KAAK,EAAE,mBAAmB;QAC1C;MACF,CAAC;MACDra,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAO2W,qBAAqBA,CAAC7P,MAAM,GAAG,KAAK,EAAE;IAC3C,OAAO;MACL8K,OAAO,EAAE,IAAI;MACbhE,IAAI,EAAE;QACJtS,IAAI,EAAE,oBAAoB,IAAIgB,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI6G,MAAM,EAAE;QAC5E+G,IAAI,EAAE,QAAQ;QACd+I,WAAW,EAAE,yCAAyCta,IAAI,CAAC6H,GAAG,CAAC,CAAC,IAAI2C,MAAM,EAAE;QAC5E+P,SAAS,EAAE;MACb,CAAC;MACDxa,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAO8W,gBAAgBA,CAACC,MAAM,EAAE;IAC9B,OAAO;MACLnF,OAAO,EAAE,IAAI;MACbmF,MAAM,EAAEA,MAAM;MACdC,OAAO,EAAE;QACPC,QAAQ,EAAE,mBAAmB;QAC7BpB,QAAQ,EAAE,SAAS;QACnBha,MAAM,EAAE,WAAW;QACnBqb,QAAQ,EAAE,CACR;UACE5b,IAAI,EAAE,gBAAgB;UACtB6b,WAAW,EAAE,GAAG;UAChBC,cAAc,EAAE,MAAM;UACtBzC,KAAK,EAAE;QACT,CAAC,EACD;UACErZ,IAAI,EAAE,eAAe;UACrB6b,WAAW,EAAE,GAAG;UAChBC,cAAc,EAAE,MAAM;UACtBzC,KAAK,EAAE;QACT,CAAC,CACF;QACD0C,MAAM,EAAE,eAAe;QACvB3L,UAAU,EAAE,KAAK;QACjBoI,MAAM,EAAE;MACV,CAAC;MACDzX,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;EACA,OAAOsX,mBAAmBA,CAACC,QAAQ,EAAE;IACnC,OAAO;MACL3F,OAAO,EAAE,IAAI;MACb2F,QAAQ,EAAEA,QAAQ;MAClBhV,OAAO,EAAE;QACPiV,WAAW,EAAE,KAAK;QAClBC,MAAM,EAAE,IAAI;QACZC,GAAG,EAAE,IAAI;QACTP,WAAW,EAAE,GAAG;QAChBC,cAAc,EAAE,IAAI;QACpBO,IAAI,EAAE,GAAG;QACTC,GAAG,EAAE,GAAG;QACRC,GAAG,EAAE;MACP,CAAC;MACDxb,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAAC0D,WAAW,CAAC;IACpC,CAAC;EACH;AACF;;AAEA;AACA8X,MAAM,CAACC,OAAO,GAAG;EACfzV,gBAAgB;EAChBlH,eAAe;EACfuB,iBAAiB;EACjBe,aAAa;EACbwB,aAAa;EACb;EACA8Y,OAAO,EAAE,IAAI1V,gBAAgB,CAAC;AAChC,CAAC;;AAED;AACA9C,MAAM,CAACyY,MAAM,CAACH,MAAM,CAACC,OAAO,CAACC,OAAO,EAAEF,MAAM,CAACC,OAAO,CAAC","ignoreList":[]}