177d2163189e4cf89ee6697596f92a7b
/**
 * =====================================================
 * ADVANCED VALIDATION MIDDLEWARE - Phase 6
 * =====================================================
 * Comprehensive input validation for all endpoints
 */

// ==================== VALIDATORS ====================

/**
 * Email validation
 */
const isEmail = value => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(value || '');
};

/**
 * Password strength validation
 */
const isStrongPassword = password => {
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
  return passwordRegex.test(password);
};

/**
 * Phone number validation
 */
const isPhoneNumber = phone => {
  const phoneRegex = /^[\d\s\-\+\(\)]+$/;
  return phoneRegex.test(phone) && phone.replace(/\D/g, '').length >= 10;
};

/**
 * URL validation
 */
const isValidUrl = url => {
  try {
    return Boolean(new URL(url));
  } catch (e) {
    return false;
  }
};

/**
 * ID validation (MongoDB ObjectId)
 */
const isValidObjectId = id => {
  return /^[0-9a-f]{24}$/.test(id);
};

// ==================== SANITIZERS ====================

/**
 * Sanitize string input
 */
const sanitizeString = str => {
  if (!str) return '';
  return String(str).trim().replace(/[<>\"'&]/g, char => {
    const escape = {
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '&': '&amp;'
    };
    return escape[char];
  });
};

/**
 * Sanitize email
 */
const sanitizeEmail = email => {
  return String(email || '').toLowerCase().trim();
};

/**
 * Sanitize request body
 */
const sanitizeBody = obj => {
  const sanitized = {};
  for (const [key, value] of Object.entries(obj)) {
    if (typeof value === 'string') {
      sanitized[key] = sanitizeString(value);
    } else if (typeof value === 'object' && value !== null) {
      sanitized[key] = sanitizeBody(value);
    } else {
      sanitized[key] = value;
    }
  }
  return sanitized;
};

// ==================== VALIDATION MIDDLEWARE ====================

/**
 * Registration validation
 */
const validateRegistration = (req, res, next) => {
  try {
    const {
      name,
      email,
      password,
      confirmPassword
    } = req.body || {};

    // Required fields
    if (!name || !email || !password) {
      return res.status(400).json({
        success: false,
        error: 'name, email, and password are required',
        errors: {
          name: !name ? 'Name is required' : undefined,
          email: !email ? 'Email is required' : undefined,
          password: !password ? 'Password is required' : undefined
        }
      });
    }

    // Email validation
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format',
        errors: {
          email: 'Please provide a valid email address'
        }
      });
    }

    // Password length
    if (String(password).length < 8) {
      return res.status(400).json({
        success: false,
        error: 'Password must be at least 8 characters',
        errors: {
          password: 'Password must have at least 8 characters'
        }
      });
    }

    // Confirm password
    if (confirmPassword && password !== confirmPassword) {
      return res.status(400).json({
        success: false,
        error: 'Passwords do not match',
        errors: {
          confirmPassword: 'Passwords must match'
        }
      });
    }

    // Sanitize inputs
    req.body.name = sanitizeString(name);
    req.body.email = sanitizeEmail(email);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Login validation
 */
const validateLogin = (req, res, next) => {
  try {
    const {
      email,
      password
    } = req.body || {};
    if (!email || !password) {
      return res.status(400).json({
        success: false,
        error: 'email and password are required',
        errors: {
          email: !email ? 'Email is required' : undefined,
          password: !password ? 'Password is required' : undefined
        }
      });
    }
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format',
        errors: {
          email: 'Please provide a valid email address'
        }
      });
    }

    // Sanitize
    req.body.email = sanitizeEmail(email);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Create user validation
 */
const validateCreateUser = (req, res, next) => {
  try {
    const {
      name,
      email,
      role,
      department
    } = req.body || {};
    if (!name || !email || !role) {
      return res.status(400).json({
        success: false,
        error: 'name, email, and role are required'
      });
    }
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format'
      });
    }
    const validRoles = ['admin', 'manager', 'employee', 'viewer'];
    if (!validRoles.includes(role)) {
      return res.status(400).json({
        success: false,
        error: `Invalid role. Must be one of: ${validRoles.join(', ')}`
      });
    }

    // Sanitize
    req.body.name = sanitizeString(name);
    req.body.email = sanitizeEmail(email);
    if (department) req.body.department = sanitizeString(department);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Validate ID parameter
 */
const validateId = (req, res, next) => {
  const {
    id
  } = req.params;
  if (!id) {
    return res.status(400).json({
      success: false,
      error: 'ID parameter is required'
    });
  }
  if (!isValidObjectId(id)) {
    return res.status(400).json({
      success: false,
      error: 'Invalid ID format'
    });
  }
  next();
};

/**
 * Validate pagination
 */
const validatePagination = (req, res, next) => {
  const {
    page = 1,
    limit = 10
  } = req.query;
  const pageNum = parseInt(page);
  const limitNum = parseInt(limit);
  if (isNaN(pageNum) || pageNum < 1) {
    return res.status(400).json({
      success: false,
      error: 'Invalid page number'
    });
  }
  if (isNaN(limitNum) || limitNum < 1 || limitNum > 100) {
    return res.status(400).json({
      success: false,
      error: 'Invalid limit. Must be between 1 and 100'
    });
  }
  req.pagination = {
    page: pageNum,
    limit: limitNum,
    skip: (pageNum - 1) * limitNum
  };
  next();
};
module.exports = {
  // Validators
  isEmail,
  isStrongPassword,
  isPhoneNumber,
  isValidUrl,
  isValidObjectId,
  // Sanitizers
  sanitizeString,
  sanitizeEmail,
  sanitizeBody,
  // Middleware
  validateRegistration,
  validateLogin,
  validateCreateUser,
  validateId,
  validatePagination
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpc0VtYWlsIiwidmFsdWUiLCJlbWFpbFJlZ2V4IiwidGVzdCIsImlzU3Ryb25nUGFzc3dvcmQiLCJwYXNzd29yZCIsInBhc3N3b3JkUmVnZXgiLCJpc1Bob25lTnVtYmVyIiwicGhvbmUiLCJwaG9uZVJlZ2V4IiwicmVwbGFjZSIsImxlbmd0aCIsImlzVmFsaWRVcmwiLCJ1cmwiLCJCb29sZWFuIiwiVVJMIiwiZSIsImlzVmFsaWRPYmplY3RJZCIsImlkIiwic2FuaXRpemVTdHJpbmciLCJzdHIiLCJTdHJpbmciLCJ0cmltIiwiY2hhciIsImVzY2FwZSIsInNhbml0aXplRW1haWwiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwic2FuaXRpemVCb2R5Iiwib2JqIiwic2FuaXRpemVkIiwia2V5IiwiT2JqZWN0IiwiZW50cmllcyIsInZhbGlkYXRlUmVnaXN0cmF0aW9uIiwicmVxIiwicmVzIiwibmV4dCIsIm5hbWUiLCJjb25maXJtUGFzc3dvcmQiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsImVycm9ycyIsInVuZGVmaW5lZCIsIm1lc3NhZ2UiLCJ2YWxpZGF0ZUxvZ2luIiwidmFsaWRhdGVDcmVhdGVVc2VyIiwicm9sZSIsImRlcGFydG1lbnQiLCJ2YWxpZFJvbGVzIiwiaW5jbHVkZXMiLCJqb2luIiwidmFsaWRhdGVJZCIsInBhcmFtcyIsInZhbGlkYXRlUGFnaW5hdGlvbiIsInBhZ2UiLCJsaW1pdCIsInF1ZXJ5IiwicGFnZU51bSIsInBhcnNlSW50IiwibGltaXROdW0iLCJpc05hTiIsInBhZ2luYXRpb24iLCJza2lwIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInZhbGlkYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqIEFEVkFOQ0VEIFZBTElEQVRJT04gTUlERExFV0FSRSAtIFBoYXNlIDZcclxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogQ29tcHJlaGVuc2l2ZSBpbnB1dCB2YWxpZGF0aW9uIGZvciBhbGwgZW5kcG9pbnRzXHJcbiAqL1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT0gVkFMSURBVE9SUyA9PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEVtYWlsIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IGlzRW1haWwgPSAodmFsdWUpID0+IHtcclxuICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XHJcbiAgcmV0dXJuIGVtYWlsUmVnZXgudGVzdCh2YWx1ZSB8fCAnJyk7XHJcbn07XHJcblxyXG4vKipcclxuICogUGFzc3dvcmQgc3RyZW5ndGggdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgaXNTdHJvbmdQYXNzd29yZCA9IChwYXNzd29yZCkgPT4ge1xyXG4gIGNvbnN0IHBhc3N3b3JkUmVnZXggPSAvXig/PS4qW2Etel0pKD89LipbQS1aXSkoPz0uKlxcZCkoPz0uKltAJCElKj8mXSlbQS1aYS16XFxkQCQhJSo/Jl17OCx9JC87XHJcbiAgcmV0dXJuIHBhc3N3b3JkUmVnZXgudGVzdChwYXNzd29yZCk7XHJcbn07XHJcblxyXG4vKipcclxuICogUGhvbmUgbnVtYmVyIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IGlzUGhvbmVOdW1iZXIgPSAocGhvbmUpID0+IHtcclxuICBjb25zdCBwaG9uZVJlZ2V4ID0gL15bXFxkXFxzXFwtXFwrXFwoXFwpXSskLztcclxuICByZXR1cm4gcGhvbmVSZWdleC50ZXN0KHBob25lKSAmJiBwaG9uZS5yZXBsYWNlKC9cXEQvZywgJycpLmxlbmd0aCA+PSAxMDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVUkwgdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgaXNWYWxpZFVybCA9ICh1cmwpID0+IHtcclxuICB0cnkge1xyXG4gICAgcmV0dXJuIEJvb2xlYW4obmV3IFVSTCh1cmwpKTtcclxuICB9IGNhdGNoIChlKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIElEIHZhbGlkYXRpb24gKE1vbmdvREIgT2JqZWN0SWQpXHJcbiAqL1xyXG5jb25zdCBpc1ZhbGlkT2JqZWN0SWQgPSAoaWQpID0+IHtcclxuICByZXR1cm4gL15bMC05YS1mXXsyNH0kLy50ZXN0KGlkKTtcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09IFNBTklUSVpFUlMgPT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBTYW5pdGl6ZSBzdHJpbmcgaW5wdXRcclxuICovXHJcbmNvbnN0IHNhbml0aXplU3RyaW5nID0gKHN0cikgPT4ge1xyXG4gIGlmICghc3RyKSByZXR1cm4gJyc7XHJcbiAgcmV0dXJuIFN0cmluZyhzdHIpLnRyaW0oKS5yZXBsYWNlKC9bPD5cXFwiJyZdL2csIChjaGFyKSA9PiB7XHJcbiAgICBjb25zdCBlc2NhcGUgPSB7ICc8JzogJyZsdDsnLCAnPic6ICcmZ3Q7JywgJ1wiJzogJyZxdW90OycsIFwiJ1wiOiAnJiN4Mjc7JywgJyYnOiAnJmFtcDsnIH07XHJcbiAgICByZXR1cm4gZXNjYXBlW2NoYXJdO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNhbml0aXplIGVtYWlsXHJcbiAqL1xyXG5jb25zdCBzYW5pdGl6ZUVtYWlsID0gKGVtYWlsKSA9PiB7XHJcbiAgcmV0dXJuIFN0cmluZyhlbWFpbCB8fCAnJykudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2FuaXRpemUgcmVxdWVzdCBib2R5XHJcbiAqL1xyXG5jb25zdCBzYW5pdGl6ZUJvZHkgPSAob2JqKSA9PiB7XHJcbiAgY29uc3Qgc2FuaXRpemVkID0ge307XHJcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMob2JqKSkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZVN0cmluZyh2YWx1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUJvZHkodmFsdWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHNhbml0aXplZDtcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09IFZBTElEQVRJT04gTUlERExFV0FSRSA9PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFJlZ2lzdHJhdGlvbiB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZVJlZ2lzdHJhdGlvbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwYXNzd29yZCwgY29uZmlybVBhc3N3b3JkIH0gPSByZXEuYm9keSB8fCB7fTtcclxuXHJcbiAgICAvLyBSZXF1aXJlZCBmaWVsZHNcclxuICAgIGlmICghbmFtZSB8fCAhZW1haWwgfHwgIXBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICduYW1lLCBlbWFpbCwgYW5kIHBhc3N3b3JkIGFyZSByZXF1aXJlZCcsXHJcbiAgICAgICAgZXJyb3JzOiB7XHJcbiAgICAgICAgICBuYW1lOiAhbmFtZSA/ICdOYW1lIGlzIHJlcXVpcmVkJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIGVtYWlsOiAhZW1haWwgPyAnRW1haWwgaXMgcmVxdWlyZWQnIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgcGFzc3dvcmQ6ICFwYXNzd29yZCA/ICdQYXNzd29yZCBpcyByZXF1aXJlZCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW1haWwgdmFsaWRhdGlvblxyXG4gICAgaWYgKCFpc0VtYWlsKGVtYWlsKSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCBlbWFpbCBmb3JtYXQnLFxyXG4gICAgICAgIGVycm9yczogeyBlbWFpbDogJ1BsZWFzZSBwcm92aWRlIGEgdmFsaWQgZW1haWwgYWRkcmVzcycgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGFzc3dvcmQgbGVuZ3RoXHJcbiAgICBpZiAoU3RyaW5nKHBhc3N3b3JkKS5sZW5ndGggPCA4KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycycsXHJcbiAgICAgICAgZXJyb3JzOiB7IHBhc3N3b3JkOiAnUGFzc3dvcmQgbXVzdCBoYXZlIGF0IGxlYXN0IDggY2hhcmFjdGVycycgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29uZmlybSBwYXNzd29yZFxyXG4gICAgaWYgKGNvbmZpcm1QYXNzd29yZCAmJiBwYXNzd29yZCAhPT0gY29uZmlybVBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQYXNzd29yZHMgZG8gbm90IG1hdGNoJyxcclxuICAgICAgICBlcnJvcnM6IHsgY29uZmlybVBhc3N3b3JkOiAnUGFzc3dvcmRzIG11c3QgbWF0Y2gnIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNhbml0aXplIGlucHV0c1xyXG4gICAgcmVxLmJvZHkubmFtZSA9IHNhbml0aXplU3RyaW5nKG5hbWUpO1xyXG4gICAgcmVxLmJvZHkuZW1haWwgPSBzYW5pdGl6ZUVtYWlsKGVtYWlsKTtcclxuXHJcbiAgICBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBlcnJvcicsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogTG9naW4gdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgdmFsaWRhdGVMb2dpbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHkgfHwge307XHJcblxyXG4gICAgaWYgKCFlbWFpbCB8fCAhcGFzc3dvcmQpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ2VtYWlsIGFuZCBwYXNzd29yZCBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICAgIGVycm9yczoge1xyXG4gICAgICAgICAgZW1haWw6ICFlbWFpbCA/ICdFbWFpbCBpcyByZXF1aXJlZCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBwYXNzd29yZDogIXBhc3N3b3JkID8gJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzRW1haWwoZW1haWwpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIGZvcm1hdCcsXHJcbiAgICAgICAgZXJyb3JzOiB7IGVtYWlsOiAnUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTYW5pdGl6ZVxyXG4gICAgcmVxLmJvZHkuZW1haWwgPSBzYW5pdGl6ZUVtYWlsKGVtYWlsKTtcclxuXHJcbiAgICBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBlcnJvcicsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHVzZXIgdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgdmFsaWRhdGVDcmVhdGVVc2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgbmFtZSwgZW1haWwsIHJvbGUsIGRlcGFydG1lbnQgfSA9IHJlcS5ib2R5IHx8IHt9O1xyXG5cclxuICAgIGlmICghbmFtZSB8fCAhZW1haWwgfHwgIXJvbGUpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ25hbWUsIGVtYWlsLCBhbmQgcm9sZSBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzRW1haWwoZW1haWwpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIGZvcm1hdCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHZhbGlkUm9sZXMgPSBbJ2FkbWluJywgJ21hbmFnZXInLCAnZW1wbG95ZWUnLCAndmlld2VyJ107XHJcbiAgICBpZiAoIXZhbGlkUm9sZXMuaW5jbHVkZXMocm9sZSkpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogYEludmFsaWQgcm9sZS4gTXVzdCBiZSBvbmUgb2Y6ICR7dmFsaWRSb2xlcy5qb2luKCcsICcpfWAsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNhbml0aXplXHJcbiAgICByZXEuYm9keS5uYW1lID0gc2FuaXRpemVTdHJpbmcobmFtZSk7XHJcbiAgICByZXEuYm9keS5lbWFpbCA9IHNhbml0aXplRW1haWwoZW1haWwpO1xyXG4gICAgaWYgKGRlcGFydG1lbnQpIHJlcS5ib2R5LmRlcGFydG1lbnQgPSBzYW5pdGl6ZVN0cmluZyhkZXBhcnRtZW50KTtcclxuXHJcbiAgICBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBlcnJvcicsXHJcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgSUQgcGFyYW1ldGVyXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZUlkID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICBcclxuICBpZiAoIWlkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdJRCBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlzVmFsaWRPYmplY3RJZChpZCkpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludmFsaWQgSUQgZm9ybWF0JyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbmV4dCgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHBhZ2luYXRpb25cclxuICovXHJcbmNvbnN0IHZhbGlkYXRlUGFnaW5hdGlvbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IHsgcGFnZSA9IDEsIGxpbWl0ID0gMTAgfSA9IHJlcS5xdWVyeTtcclxuXHJcbiAgY29uc3QgcGFnZU51bSA9IHBhcnNlSW50KHBhZ2UpO1xyXG4gIGNvbnN0IGxpbWl0TnVtID0gcGFyc2VJbnQobGltaXQpO1xyXG5cclxuICBpZiAoaXNOYU4ocGFnZU51bSkgfHwgcGFnZU51bSA8IDEpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludmFsaWQgcGFnZSBudW1iZXInLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoaXNOYU4obGltaXROdW0pIHx8IGxpbWl0TnVtIDwgMSB8fCBsaW1pdE51bSA+IDEwMCkge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnSW52YWxpZCBsaW1pdC4gTXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDEwMCcsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlcS5wYWdpbmF0aW9uID0ge1xyXG4gICAgcGFnZTogcGFnZU51bSxcclxuICAgIGxpbWl0OiBsaW1pdE51bSxcclxuICAgIHNraXA6IChwYWdlTnVtIC0gMSkgKiBsaW1pdE51bSxcclxuICB9O1xyXG5cclxuICBuZXh0KCk7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAvLyBWYWxpZGF0b3JzXHJcbiAgaXNFbWFpbCxcclxuICBpc1N0cm9uZ1Bhc3N3b3JkLFxyXG4gIGlzUGhvbmVOdW1iZXIsXHJcbiAgaXNWYWxpZFVybCxcclxuICBpc1ZhbGlkT2JqZWN0SWQsXHJcblxyXG4gIC8vIFNhbml0aXplcnNcclxuICBzYW5pdGl6ZVN0cmluZyxcclxuICBzYW5pdGl6ZUVtYWlsLFxyXG4gIHNhbml0aXplQm9keSxcclxuXHJcbiAgLy8gTWlkZGxld2FyZVxyXG4gIHZhbGlkYXRlUmVnaXN0cmF0aW9uLFxyXG4gIHZhbGlkYXRlTG9naW4sXHJcbiAgdmFsaWRhdGVDcmVhdGVVc2VyLFxyXG4gIHZhbGlkYXRlSWQsXHJcbiAgdmFsaWRhdGVQYWdpbmF0aW9uLFxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNQSxPQUFPLEdBQUlDLEtBQUssSUFBSztFQUN6QixNQUFNQyxVQUFVLEdBQUcsNEJBQTRCO0VBQy9DLE9BQU9BLFVBQVUsQ0FBQ0MsSUFBSSxDQUFDRixLQUFLLElBQUksRUFBRSxDQUFDO0FBQ3JDLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBTUcsZ0JBQWdCLEdBQUlDLFFBQVEsSUFBSztFQUNyQyxNQUFNQyxhQUFhLEdBQUcsc0VBQXNFO0VBQzVGLE9BQU9BLGFBQWEsQ0FBQ0gsSUFBSSxDQUFDRSxRQUFRLENBQUM7QUFDckMsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxNQUFNRSxhQUFhLEdBQUlDLEtBQUssSUFBSztFQUMvQixN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