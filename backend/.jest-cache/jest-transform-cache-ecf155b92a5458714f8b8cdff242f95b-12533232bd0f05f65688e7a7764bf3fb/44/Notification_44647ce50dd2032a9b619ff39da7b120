30d61888ba10359ba197a88302bfd31a
const mongoose = require('mongoose');
const notificationSchema = new mongoose.Schema({
  // المستخدم المستلم للإشعار
  userId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
    required: true
  },
  // نوع الإشعار
  type: {
    type: String,
    enum: ['info', 'success', 'warning', 'error', 'system', 'message', 'task', 'reminder'],
    default: 'info'
  },
  // عنوان الإشعار
  title: {
    type: String,
    required: true,
    trim: true
  },
  // محتوى الإشعار
  message: {
    type: String,
    required: true,
    trim: true
  },
  // أيقونة الإشعار (اختياري)
  icon: {
    type: String,
    default: 'NotificationsIcon'
  },
  // لون الإشعار (اختياري)
  color: {
    type: String,
    default: '#1976d2'
  },
  // رابط للإشعار (اختياري)
  link: {
    type: String,
    trim: true
  },
  // بيانات إضافية (JSON)
  metadata: {
    type: mongoose.Schema.Types.Mixed,
    default: {}
  },
  // حالة الأرشفة
  archiveStatus: {
    type: String,
    enum: ['pending', 'archived', 'failed'],
    default: 'pending'
  },
  archiveId: {
    type: String
  },
  // حالة التوقيع الإلكتروني
  signatureStatus: {
    type: String,
    enum: ['none', 'pending', 'signed', 'failed'],
    default: 'none'
  },
  signatureId: {
    type: String
  },
  // حالة الختم الإلكتروني
  stampStatus: {
    type: String,
    enum: ['none', 'pending', 'stamped', 'failed'],
    default: 'none'
  },
  stampId: {
    type: String
  },
  // حالة القراءة
  isRead: {
    type: Boolean,
    default: false
  },
  // تاريخ القراءة
  readAt: {
    type: Date
  },
  // الأولوية
  priority: {
    type: String,
    enum: ['low', 'normal', 'high', 'urgent'],
    default: 'normal'
  },
  // تاريخ الانتهاء (للإشعارات المؤقتة)
  expiresAt: {
    type: Date
  },
  // هل تم إرساله عبر WebSocket
  sentViaWebSocket: {
    type: Boolean,
    default: false
  },
  // المرسل (اختياري)
  senderId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User'
  },
  // الفئة
  category: {
    type: String,
    default: 'general'
  },
  // رقم تسلسلي مميز لكل خطاب/إشعار
  serialNumber: {
    type: String,
    unique: true,
    sparse: true
  },
  // باركود (Base64 أو نص)
  barcode: {
    type: String
  }
}, {
  timestamps: true
});

// Indexes للأداء
notificationSchema.index({
  userId: 1,
  isRead: 1
});
notificationSchema.index({
  userId: 1,
  createdAt: -1
});
notificationSchema.index({
  expiresAt: 1
}, {
  expireAfterSeconds: 0
});

// Virtual لعرض الوقت المنقضي
notificationSchema.virtual('timeAgo').get(function () {
  const now = new Date();
  const diff = now - this.createdAt;
  const seconds = Math.floor(diff / 1000);
  const minutes = Math.floor(seconds / 60);
  const hours = Math.floor(minutes / 60);
  const days = Math.floor(hours / 24);
  if (days > 0) return `منذ ${days} يوم`;
  if (hours > 0) return `منذ ${hours} ساعة`;
  if (minutes > 0) return `منذ ${minutes} دقيقة`;
  return 'الآن';
});

// Method لتحديد الإشعار كمقروء
notificationSchema.methods.markAsRead = async function () {
  this.isRead = true;
  this.readAt = new Date();
  return await this.save();
};

// Method لتحديد الإشعار كغير مقروء
notificationSchema.methods.markAsUnread = async function () {
  this.isRead = false;
  this.readAt = null;
  return await this.save();
};

// Static method لإنشاء إشعار جديد
notificationSchema.statics.createNotification = async function (data) {
  const notification = new this(data);
  return await notification.save();
};

// Static method لإنشاء إشعار لعدة مستخدمين
notificationSchema.statics.createBulkNotifications = async function (userIds, notificationData) {
  const notifications = userIds.map(userId => ({
    ...notificationData,
    userId
  }));
  return await this.insertMany(notifications);
};

// Static method لحذف الإشعارات القديمة
notificationSchema.statics.deleteOldNotifications = async function (days = 30) {
  const cutoffDate = new Date();
  cutoffDate.setDate(cutoffDate.getDate() - days);
  return await this.deleteMany({
    createdAt: {
      $lt: cutoffDate
    },
    isRead: true
  });
};

// Middleware قبل الحفظ
notificationSchema.pre('save', function (next) {
  // تعيين لون افتراضي حسب النوع
  if (!this.color) {
    const colorMap = {
      info: '#1976d2',
      success: '#2e7d32',
      warning: '#ed6c02',
      error: '#d32f2f',
      system: '#9c27b0',
      message: '#0288d1',
      task: '#f57c00',
      reminder: '#7b1fa2'
    };
    this.color = colorMap[this.type] || '#1976d2';
  }
  next();
});

// Prevent model recompilation in tests
const Notification = mongoose.models.Notification || mongoose.model('Notification', notificationSchema);
module.exports = Notification;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJub3RpZmljYXRpb25TY2hlbWEiLCJTY2hlbWEiLCJ1c2VySWQiLCJ0eXBlIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlZiIsInJlcXVpcmVkIiwiU3RyaW5nIiwiZW51bSIsImRlZmF1bHQiLCJ0aXRsZSIsInRyaW0iLCJtZXNzYWdlIiwiaWNvbiIsImNvbG9yIiwibGluayIsIm1ldGFkYXRhIiwiTWl4ZWQiLCJhcmNoaXZlU3RhdHVzIiwiYXJjaGl2ZUlkIiwic2lnbmF0dXJlU3RhdHVzIiwic2lnbmF0dXJlSWQiLCJzdGFtcFN0YXR1cyIsInN0YW1wSWQiLCJpc1JlYWQiLCJCb29sZWFuIiwicmVhZEF0IiwiRGF0ZSIsInByaW9yaXR5IiwiZXhwaXJlc0F0Iiwic2VudFZpYVdlYlNvY2tldCIsInNlbmRlcklkIiwiY2F0ZWdvcnkiLCJzZXJpYWxOdW1iZXIiLCJ1bmlxdWUiLCJzcGFyc2UiLCJiYXJjb2RlIiwidGltZXN0YW1wcyIsImluZGV4IiwiY3JlYXRlZEF0IiwiZXhwaXJlQWZ0ZXJTZWNvbmRzIiwidmlydHVhbCIsImdldCIsIm5vdyIsImRpZmYiLCJzZWNvbmRzIiwiTWF0aCIsImZsb29yIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsIm1ldGhvZHMiLCJtYXJrQXNSZWFkIiwic2F2ZSIsIm1hcmtBc1VucmVhZCIsInN0YXRpY3MiLCJjcmVhdGVOb3RpZmljYXRpb24iLCJkYXRhIiwibm90aWZpY2F0aW9uIiwiY3JlYXRlQnVsa05vdGlmaWNhdGlvbnMiLCJ1c2VySWRzIiwibm90aWZpY2F0aW9uRGF0YSIsIm5vdGlmaWNhdGlvbnMiLCJtYXAiLCJpbnNlcnRNYW55IiwiZGVsZXRlT2xkTm90aWZpY2F0aW9ucyIsImN1dG9mZkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRlbGV0ZU1hbnkiLCIkbHQiLCJwcmUiLCJuZXh0IiwiY29sb3JNYXAiLCJpbmZvIiwic3VjY2VzcyIsIndhcm5pbmciLCJlcnJvciIsInN5c3RlbSIsInRhc2siLCJyZW1pbmRlciIsIk5vdGlmaWNhdGlvbiIsIm1vZGVscyIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIk5vdGlmaWNhdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcblxyXG5jb25zdCBub3RpZmljYXRpb25TY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxyXG4gIHtcclxuICAgIC8vINin2YTZhdiz2KrYrtiv2YUg2KfZhNmF2LPYqtmE2YUg2YTZhNil2LTYudin2LFcclxuICAgIHVzZXJJZDoge1xyXG4gICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICAgIHJlZjogJ1VzZXInLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8g2YbZiNi5INin2YTYpdi02LnYp9ixXHJcbiAgICB0eXBlOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgZW51bTogWydpbmZvJywgJ3N1Y2Nlc3MnLCAnd2FybmluZycsICdlcnJvcicsICdzeXN0ZW0nLCAnbWVzc2FnZScsICd0YXNrJywgJ3JlbWluZGVyJ10sXHJcbiAgICAgIGRlZmF1bHQ6ICdpbmZvJyxcclxuICAgIH0sXHJcblxyXG4gICAgLy8g2LnZhtmI2KfZhiDYp9mE2KXYtNi52KfYsVxyXG4gICAgdGl0bGU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgdHJpbTogdHJ1ZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8g2YXYrdiq2YjZiSDYp9mE2KXYtNi52KfYsVxyXG4gICAgbWVzc2FnZToge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICB0cmltOiB0cnVlLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDYo9mK2YLZiNmG2Kkg2KfZhNil2LTYudin2LEgKNin2K7YqtmK2KfYsdmKKVxyXG4gICAgaWNvbjoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIGRlZmF1bHQ6ICdOb3RpZmljYXRpb25zSWNvbicsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vINmE2YjZhiDYp9mE2KXYtNi52KfYsSAo2KfYrtiq2YrYp9ix2YopXHJcbiAgICBjb2xvcjoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIGRlZmF1bHQ6ICcjMTk3NmQyJyxcclxuICAgIH0sXHJcblxyXG4gICAgLy8g2LHYp9io2Lcg2YTZhNil2LTYudin2LEgKNin2K7YqtmK2KfYsdmKKVxyXG4gICAgbGluazoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIHRyaW06IHRydWUsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vINio2YrYp9mG2KfYqiDYpdi22KfZgdmK2KkgKEpTT04pXHJcbiAgICBtZXRhZGF0YToge1xyXG4gICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuTWl4ZWQsXHJcbiAgICAgIGRlZmF1bHQ6IHt9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDYrdin2YTYqSDYp9mE2KPYsdi02YHYqVxyXG4gICAgYXJjaGl2ZVN0YXR1czoge1xyXG4gICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgIGVudW06IFsncGVuZGluZycsICdhcmNoaXZlZCcsICdmYWlsZWQnXSxcclxuICAgICAgZGVmYXVsdDogJ3BlbmRpbmcnLFxyXG4gICAgfSxcclxuICAgIGFyY2hpdmVJZDogeyB0eXBlOiBTdHJpbmcgfSxcclxuXHJcbiAgICAvLyDYrdin2YTYqSDYp9mE2KrZiNmC2YrYuSDYp9mE2KXZhNmD2KrYsdmI2YbZilxyXG4gICAgc2lnbmF0dXJlU3RhdHVzOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgZW51bTogWydub25lJywgJ3BlbmRpbmcnLCAnc2lnbmVkJywgJ2ZhaWxlZCddLFxyXG4gICAgICBkZWZhdWx0OiAnbm9uZScsXHJcbiAgICB9LFxyXG4gICAgc2lnbmF0dXJlSWQ6IHsgdHlwZTogU3RyaW5nIH0sXHJcblxyXG4gICAgLy8g2K3Yp9mE2Kkg2KfZhNiu2KrZhSDYp9mE2KXZhNmD2KrYsdmI2YbZilxyXG4gICAgc3RhbXBTdGF0dXM6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICBlbnVtOiBbJ25vbmUnLCAncGVuZGluZycsICdzdGFtcGVkJywgJ2ZhaWxlZCddLFxyXG4gICAgICBkZWZhdWx0OiAnbm9uZScsXHJcbiAgICB9LFxyXG4gICAgc3RhbXBJZDogeyB0eXBlOiBTdHJpbmcgfSxcclxuXHJcbiAgICAvLyDYrdin2YTYqSDYp9mE2YLYsdin2KHYqVxyXG4gICAgaXNSZWFkOiB7XHJcbiAgICAgIHR5cGU6IEJvb2xlYW4sXHJcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDYqtin2LHZitiuINin2YTZgtix2KfYodipXHJcbiAgICByZWFkQXQ6IHtcclxuICAgICAgdHlwZTogRGF0ZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8g2KfZhNij2YjZhNmI2YrYqVxyXG4gICAgcHJpb3JpdHk6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICBlbnVtOiBbJ2xvdycsICdub3JtYWwnLCAnaGlnaCcsICd1cmdlbnQnXSxcclxuICAgICAgZGVmYXVsdDogJ25vcm1hbCcsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vINiq2KfYsdmK2K4g2KfZhNin2YbYqtmH2KfYoSAo2YTZhNil2LTYudin2LHYp9iqINin2YTZhdik2YLYqtipKVxyXG4gICAgZXhwaXJlc0F0OiB7XHJcbiAgICAgIHR5cGU6IERhdGUsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vINmH2YQg2KrZhSDYpdix2LPYp9mE2Ycg2LnYqNixIFdlYlNvY2tldFxyXG4gICAgc2VudFZpYVdlYlNvY2tldDoge1xyXG4gICAgICB0eXBlOiBCb29sZWFuLFxyXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8g2KfZhNmF2LHYs9mEICjYp9iu2KrZitin2LHZiilcclxuICAgIHNlbmRlcklkOiB7XHJcbiAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgICAgcmVmOiAnVXNlcicsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vINin2YTZgdim2KlcclxuICAgIGNhdGVnb3J5OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgZGVmYXVsdDogJ2dlbmVyYWwnLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDYsdmC2YUg2KrYs9mE2LPZhNmKINmF2YXZitiyINmE2YPZhCDYrti32KfYqC/Ypdi02LnYp9ixXHJcbiAgICBzZXJpYWxOdW1iZXI6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICB1bmlxdWU6IHRydWUsXHJcbiAgICAgIHNwYXJzZTogdHJ1ZVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDYqNin2LHZg9mI2K8gKEJhc2U2NCDYo9mIINmG2LUpXHJcbiAgICBiYXJjb2RlOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgIH0sXHJcbiAgfSxcclxuICB7XHJcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxyXG4gIH1cclxuKTtcclxuXHJcbi8vIEluZGV4ZXMg2YTZhNij2K/Yp9ihXHJcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IHVzZXJJZDogMSwgaXNSZWFkOiAxIH0pO1xyXG5ub3RpZmljYXRpb25TY2hlbWEuaW5kZXgoeyB1c2VySWQ6IDEsIGNyZWF0ZWRBdDogLTEgfSk7XHJcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IGV4cGlyZXNBdDogMSB9LCB7IGV4cGlyZUFmdGVyU2Vjb25kczogMCB9KTtcclxuXHJcbi8vIFZpcnR1YWwg2YTYudix2LYg2KfZhNmI2YLYqiDYp9mE2YXZhtmC2LbZilxyXG5ub3RpZmljYXRpb25TY2hlbWEudmlydHVhbCgndGltZUFnbycpLmdldChmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICBjb25zdCBkaWZmID0gbm93IC0gdGhpcy5jcmVhdGVkQXQ7XHJcbiAgY29uc3Qgc2Vjb25kcyA9IE1hdGguZmxvb3IoZGlmZiAvIDEwMDApO1xyXG4gIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKHNlY29uZHMgLyA2MCk7XHJcbiAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyA2MCk7XHJcbiAgY29uc3QgZGF5cyA9IE1hdGguZmxvb3IoaG91cnMgLyAyNCk7XHJcblxyXG4gIGlmIChkYXlzID4gMCkgcmV0dXJuIGDZhdmG2LAgJHtkYXlzfSDZitmI2YVgO1xyXG4gIGlmIChob3VycyA+IDApIHJldHVybiBg2YXZhtiwICR7aG91cnN9INiz2KfYudipYDtcclxuICBpZiAobWludXRlcyA+IDApIHJldHVybiBg2YXZhtiwICR7bWludXRlc30g2K/ZgtmK2YLYqWA7XHJcbiAgcmV0dXJuICfYp9mE2KLZhic7XHJcbn0pO1xyXG5cclxuLy8gTWV0aG9kINmE2KrYrdiv2YrYryDYp9mE2KXYtNi52KfYsSDZg9mF2YLYsdmI2KFcclxubm90aWZpY2F0aW9uU2NoZW1hLm1ldGhvZHMubWFya0FzUmVhZCA9IGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLmlzUmVhZCA9IHRydWU7XHJcbiAgdGhpcy5yZWFkQXQgPSBuZXcgRGF0ZSgpO1xyXG4gIHJldHVybiBhd2FpdCB0aGlzLnNhdmUoKTtcclxufTtcclxuXHJcbi8vIE1ldGhvZCDZhNiq2K3Yr9mK2K8g2KfZhNil2LTYudin2LEg2YPYutmK2LEg2YXZgtix2YjYoVxyXG5ub3RpZmljYXRpb25TY2hlbWEubWV0aG9kcy5tYXJrQXNVbnJlYWQgPSBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy5pc1JlYWQgPSBmYWxzZTtcclxuICB0aGlzLnJlYWRBdCA9IG51bGw7XHJcbiAgcmV0dXJuIGF3YWl0IHRoaXMuc2F2ZSgpO1xyXG59O1xyXG5cclxuLy8gU3RhdGljIG1ldGhvZCDZhNil2YbYtNin2KEg2KXYtNi52KfYsSDYrNiv2YrYr1xyXG5ub3RpZmljYXRpb25TY2hlbWEuc3RhdGljcy5jcmVhdGVOb3RpZmljYXRpb24gPSBhc3luYyBmdW5jdGlvbiAoZGF0YSkge1xyXG4gIGNvbnN0IG5vdGlmaWNhdGlvbiA9IG5ldyB0aGlzKGRhdGEpO1xyXG4gIHJldHVybiBhd2FpdCBub3RpZmljYXRpb24uc2F2ZSgpO1xyXG59O1xyXG5cclxuLy8gU3RhdGljIG1ldGhvZCDZhNil2YbYtNin2KEg2KXYtNi52KfYsSDZhNi52K/YqSDZhdiz2KrYrtiv2YXZitmGXHJcbm5vdGlmaWNhdGlvblNjaGVtYS5zdGF0aWNzLmNyZWF0ZUJ1bGtOb3RpZmljYXRpb25zID0gYXN5bmMgZnVuY3Rpb24gKHVzZXJJZHMsIG5vdGlmaWNhdGlvbkRhdGEpIHtcclxuICBjb25zdCBub3RpZmljYXRpb25zID0gdXNlcklkcy5tYXAodXNlcklkID0+ICh7XHJcbiAgICAuLi5ub3RpZmljYXRpb25EYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gIH0pKTtcclxuICByZXR1cm4gYXdhaXQgdGhpcy5pbnNlcnRNYW55KG5vdGlmaWNhdGlvbnMpO1xyXG59O1xyXG5cclxuLy8gU3RhdGljIG1ldGhvZCDZhNit2LDZgSDYp9mE2KXYtNi52KfYsdin2Kog2KfZhNmC2K/ZitmF2Klcclxubm90aWZpY2F0aW9uU2NoZW1hLnN0YXRpY3MuZGVsZXRlT2xkTm90aWZpY2F0aW9ucyA9IGFzeW5jIGZ1bmN0aW9uIChkYXlzID0gMzApIHtcclxuICBjb25zdCBjdXRvZmZEYXRlID0gbmV3IERhdGUoKTtcclxuICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBkYXlzKTtcclxuXHJcbiAgcmV0dXJuIGF3YWl0IHRoaXMuZGVsZXRlTWFueSh7XHJcbiAgICBjcmVhdGVkQXQ6IHsgJGx0OiBjdXRvZmZEYXRlIH0sXHJcbiAgICBpc1JlYWQ6IHRydWUsXHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyBNaWRkbGV3YXJlINmC2KjZhCDYp9mE2K3Zgdi4XHJcbm5vdGlmaWNhdGlvblNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xyXG4gIC8vINiq2LnZitmK2YYg2YTZiNmGINin2YHYqtix2KfYttmKINit2LPYqCDYp9mE2YbZiNi5XHJcbiAgaWYgKCF0aGlzLmNvbG9yKSB7XHJcbiAgICBjb25zdCBjb2xvck1hcCA9IHtcclxuICAgICAgaW5mbzogJyMxOTc2ZDInLFxyXG4gICAgICBzdWNjZXNzOiAnIzJlN2QzMicsXHJcbiAgICAgIHdhcm5pbmc6ICcjZWQ2YzAyJyxcclxuICAgICAgZXJyb3I6ICcjZDMyZjJmJyxcclxuICAgICAgc3lzdGVtOiAnIzljMjdiMCcsXHJcbiAgICAgIG1lc3NhZ2U6ICcjMDI4OGQxJyxcclxuICAgICAgdGFzazogJyNmNTdjMDAnLFxyXG4gICAgICByZW1pbmRlcjogJyM3YjFmYTInLFxyXG4gICAgfTtcclxuICAgIHRoaXMuY29sb3IgPSBjb2xvck1hcFt0aGlzLnR5cGVdIHx8ICcjMTk3NmQyJztcclxuICB9XHJcbiAgbmV4dCgpO1xyXG59KTtcclxuXHJcbi8vIFByZXZlbnQgbW9kZWwgcmVjb21waWxhdGlvbiBpbiB0ZXN0c1xyXG5jb25zdCBOb3RpZmljYXRpb24gPSBtb25nb29zZS5tb2RlbHMuTm90aWZpY2F0aW9uIHx8IG1vbmdvb3NlLm1vZGVsKCdOb3RpZmljYXRpb24nLCBub3RpZmljYXRpb25TY2hlbWEpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBOb3RpZmljYXRpb247XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBRXBDLE1BQU1DLGtCQUFrQixHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBTSxDQUM1QztFQUNFO0VBQ0FDLE1BQU0sRUFBRTtJQUNOQyxJQUFJLEVBQUVMLFFBQVEsQ0FBQ0cs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