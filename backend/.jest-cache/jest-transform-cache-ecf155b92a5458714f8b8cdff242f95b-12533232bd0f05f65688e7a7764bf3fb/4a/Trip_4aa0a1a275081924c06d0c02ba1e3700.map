{"version":3,"names":["mongoose","require","tripSchema","Schema","tripNumber","type","String","required","unique","route","Types","ObjectId","ref","vehicle","driver","scheduledStartTime","Date","actualStartTime","scheduledEndTime","actualEndTime","status","enum","default","cancellationReason","passengers","capacity","Number","current","list","user","pickupStop","dropoffStop","boardedAt","alightedAt","stopProgress","stopNumber","scheduledArrival","actualArrival","scheduledDeparture","actualDeparture","passengersBoarded","passengersAlighted","delay","gpsTracking","timestamp","location","coordinates","speed","heading","driverBehavior","speedingIncidents","harshBrakingCount","harshAccelerationCount","idlingTime","maxSpeed","averageSpeed","score","min","max","fuelData","startLevel","endLevel","consumed","cost","efficiency","incidents","severity","description","resolved","Boolean","resolution","statistics","totalDistance","totalDuration","delayTime","passengersCount","completionRate","notes","rating","averageRating","totalRatings","feedback","comment","date","timestamps","index","methods","startTrip","push","longitude","latitude","save","completeTrip","Math","round","length","completedStops","filter","s","updateGPS","speeds","map","t","reduce","a","b","arriveAtStop","stop","find","departFromStop","boarded","alighted","addIncident","incident","calculateDriverScore","floor","statics","getActiveTrips","populate","sort","getTodayTrips","startOfDay","setHours","endOfDay","$gte","$lte","module","exports","model"],"sources":["Trip.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst tripSchema = new mongoose.Schema(\r\n  {\r\n    // معلومات أساسية\r\n    tripNumber: {\r\n      type: String,\r\n      required: true,\r\n      unique: true,\r\n    },\r\n\r\n    // المسار والمركبة\r\n    route: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'TransportRoute',\r\n      required: true,\r\n    },\r\n    vehicle: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'Vehicle',\r\n      required: true,\r\n    },\r\n    driver: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'User',\r\n      required: true,\r\n    },\r\n\r\n    // توقيت الرحلة\r\n    scheduledStartTime: {\r\n      type: Date,\r\n      required: true,\r\n    },\r\n    actualStartTime: Date,\r\n    scheduledEndTime: Date,\r\n    actualEndTime: Date,\r\n\r\n    // حالة الرحلة\r\n    status: {\r\n      type: String,\r\n      enum: ['scheduled', 'in_progress', 'completed', 'cancelled', 'delayed'],\r\n      default: 'scheduled',\r\n    },\r\n    cancellationReason: String,\r\n\r\n    // الركاب\r\n    passengers: {\r\n      capacity: {\r\n        type: Number,\r\n        default: 30,\r\n      },\r\n      current: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      list: [\r\n        {\r\n          user: {\r\n            type: mongoose.Schema.Types.ObjectId,\r\n            ref: 'User',\r\n          },\r\n          pickupStop: Number,\r\n          dropoffStop: Number,\r\n          boardedAt: Date,\r\n          alightedAt: Date,\r\n          status: {\r\n            type: String,\r\n            enum: ['boarded', 'missed', 'cancelled'],\r\n            default: 'boarded',\r\n          },\r\n        },\r\n      ],\r\n    },\r\n\r\n    // تتبع المحطات\r\n    stopProgress: [\r\n      {\r\n        stopNumber: Number,\r\n        scheduledArrival: Date,\r\n        actualArrival: Date,\r\n        scheduledDeparture: Date,\r\n        actualDeparture: Date,\r\n        passengersBoarded: Number,\r\n        passengersAlighted: Number,\r\n        delay: Number, // دقائق\r\n      },\r\n    ],\r\n\r\n    // تتبع GPS\r\n    gpsTracking: [\r\n      {\r\n        timestamp: Date,\r\n        location: {\r\n          type: {\r\n            type: String,\r\n            default: 'Point',\r\n          },\r\n          coordinates: [Number],\r\n        },\r\n        speed: Number,\r\n        heading: Number,\r\n      },\r\n    ],\r\n\r\n    // سلوك السائق\r\n    driverBehavior: {\r\n      speedingIncidents: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      harshBrakingCount: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      harshAccelerationCount: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      idlingTime: {\r\n        type: Number,\r\n        default: 0,\r\n      }, // دقائق\r\n      maxSpeed: Number,\r\n      averageSpeed: Number,\r\n      score: {\r\n        type: Number,\r\n        min: 0,\r\n        max: 100,\r\n        default: 100,\r\n      },\r\n    },\r\n\r\n    // استهلاك الوقود\r\n    fuelData: {\r\n      startLevel: Number,\r\n      endLevel: Number,\r\n      consumed: Number,\r\n      cost: Number,\r\n      efficiency: Number, // km/liter\r\n    },\r\n\r\n    // حوادث وتنبيهات\r\n    incidents: [\r\n      {\r\n        timestamp: Date,\r\n        type: {\r\n          type: String,\r\n          enum: ['accident', 'breakdown', 'delay', 'route_deviation', 'emergency', 'other'],\r\n        },\r\n        severity: {\r\n          type: String,\r\n          enum: ['low', 'medium', 'high', 'critical'],\r\n        },\r\n        location: {\r\n          type: {\r\n            type: String,\r\n            default: 'Point',\r\n          },\r\n          coordinates: [Number],\r\n        },\r\n        description: String,\r\n        resolved: {\r\n          type: Boolean,\r\n          default: false,\r\n        },\r\n        resolution: String,\r\n      },\r\n    ],\r\n\r\n    // إحصائيات\r\n    statistics: {\r\n      totalDistance: Number,\r\n      totalDuration: Number, // دقائق\r\n      averageSpeed: Number,\r\n      delayTime: Number, // دقائق\r\n      passengersCount: Number,\r\n      completionRate: Number, // نسبة مئوية\r\n    },\r\n\r\n    // ملاحظات\r\n    notes: String,\r\n\r\n    // تقييم الرحلة\r\n    rating: {\r\n      averageRating: Number,\r\n      totalRatings: Number,\r\n      feedback: [\r\n        {\r\n          user: {\r\n            type: mongoose.Schema.Types.ObjectId,\r\n            ref: 'User',\r\n          },\r\n          rating: {\r\n            type: Number,\r\n            min: 1,\r\n            max: 5,\r\n          },\r\n          comment: String,\r\n          date: Date,\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n  }\r\n);\r\n\r\n// Indexes\r\ntripSchema.index({ route: 1, scheduledStartTime: 1 });\r\ntripSchema.index({ vehicle: 1, status: 1 });\r\ntripSchema.index({ driver: 1, scheduledStartTime: 1 });\r\ntripSchema.index({ status: 1, scheduledStartTime: 1 });\r\n\r\n// Method لبدء الرحلة\r\ntripSchema.methods.startTrip = function (location) {\r\n  this.status = 'in_progress';\r\n  this.actualStartTime = new Date();\r\n\r\n  if (location) {\r\n    this.gpsTracking.push({\r\n      timestamp: new Date(),\r\n      location: {\r\n        type: 'Point',\r\n        coordinates: [location.longitude, location.latitude],\r\n      },\r\n      speed: 0,\r\n      heading: 0,\r\n    });\r\n  }\r\n\r\n  return this.save();\r\n};\r\n\r\n// Method لإنهاء الرحلة\r\ntripSchema.methods.completeTrip = function (location) {\r\n  this.status = 'completed';\r\n  this.actualEndTime = new Date();\r\n\r\n  // حساب الإحصائيات\r\n  if (this.actualStartTime) {\r\n    this.statistics.totalDuration = Math.round(\r\n      (this.actualEndTime - this.actualStartTime) / (1000 * 60)\r\n    );\r\n\r\n    if (this.scheduledEndTime) {\r\n      this.statistics.delayTime = Math.max(\r\n        0,\r\n        Math.round((this.actualEndTime - this.scheduledEndTime) / (1000 * 60))\r\n      );\r\n    }\r\n  }\r\n\r\n  this.statistics.passengersCount = this.passengers.length;\r\n\r\n  // حساب نسبة الإكمال\r\n  const completedStops = this.stopProgress.filter(s => s.actualDeparture).length;\r\n  this.statistics.completionRate = (completedStops / this.stopProgress.length) * 100;\r\n\r\n  if (location) {\r\n    this.gpsTracking.push({\r\n      timestamp: new Date(),\r\n      location: {\r\n        type: 'Point',\r\n        coordinates: [location.longitude, location.latitude],\r\n      },\r\n      speed: 0,\r\n      heading: 0,\r\n    });\r\n  }\r\n\r\n  return this.save();\r\n};\r\n\r\n// Method لتحديث موقع GPS\r\ntripSchema.methods.updateGPS = function (location) {\r\n  this.gpsTracking.push({\r\n    timestamp: new Date(),\r\n    location: {\r\n      type: 'Point',\r\n      coordinates: [location.longitude, location.latitude],\r\n    },\r\n    speed: location.speed || 0,\r\n    heading: location.heading || 0,\r\n  });\r\n\r\n  // تحديث سلوك السائق\r\n  if (location.speed > 100) {\r\n    // تجاوز السرعة\r\n    this.driverBehavior.speedingIncidents += 1;\r\n  }\r\n\r\n  if (location.speed > (this.driverBehavior.maxSpeed || 0)) {\r\n    this.driverBehavior.maxSpeed = location.speed;\r\n  }\r\n\r\n  // حساب متوسط السرعة\r\n  const speeds = this.gpsTracking.map(t => t.speed || 0);\r\n  this.driverBehavior.averageSpeed = speeds.reduce((a, b) => a + b, 0) / speeds.length;\r\n\r\n  return this.save();\r\n};\r\n\r\n// Method لتسجيل الوصول لمحطة\r\ntripSchema.methods.arriveAtStop = function (stopNumber) {\r\n  const stop = this.stopProgress.find(s => s.stopNumber === stopNumber);\r\n  if (stop) {\r\n    stop.actualArrival = new Date();\r\n\r\n    if (stop.scheduledArrival) {\r\n      stop.delay = Math.max(\r\n        0,\r\n        Math.round((stop.actualArrival - stop.scheduledArrival) / (1000 * 60))\r\n      );\r\n    }\r\n  }\r\n\r\n  return this.save();\r\n};\r\n\r\n// Method لتسجيل المغادرة من محطة\r\ntripSchema.methods.departFromStop = function (stopNumber, boarded, alighted) {\r\n  const stop = this.stopProgress.find(s => s.stopNumber === stopNumber);\r\n  if (stop) {\r\n    stop.actualDeparture = new Date();\r\n    stop.passengersBoarded = boarded || 0;\r\n    stop.passengersAlighted = alighted || 0;\r\n  }\r\n\r\n  return this.save();\r\n};\r\n\r\n// Method لإضافة حادث\r\ntripSchema.methods.addIncident = function (incident) {\r\n  this.incidents.push({\r\n    timestamp: new Date(),\r\n    type: incident.type,\r\n    severity: incident.severity,\r\n    location: incident.location,\r\n    description: incident.description,\r\n  });\r\n\r\n  // تحديث حالة الرحلة للحوادث الحرجة\r\n  if (incident.severity === 'critical') {\r\n    this.status = 'delayed';\r\n  }\r\n\r\n  return this.save();\r\n};\r\n\r\n// Method لحساب درجة سلوك السائق\r\ntripSchema.methods.calculateDriverScore = function () {\r\n  let score = 100;\r\n\r\n  // خصم نقاط لكل حادثة\r\n  score -= this.driverBehavior.speedingIncidents * 10;\r\n  score -= this.driverBehavior.harshBrakingCount * 5;\r\n  score -= this.driverBehavior.harshAccelerationCount * 5;\r\n\r\n  // خصم نقاط للتأخير\r\n  if (this.statistics.delayTime > 15) {\r\n    score -= Math.min(20, Math.floor(this.statistics.delayTime / 5));\r\n  }\r\n\r\n  // خصم نقاط للحوادث\r\n  score -= this.incidents.length * 15;\r\n\r\n  this.driverBehavior.score = Math.max(0, score);\r\n  return this.save();\r\n};\r\n\r\n// Static method للحصول على الرحلات الجارية\r\ntripSchema.statics.getActiveTrips = function () {\r\n  return this.find({\r\n    status: 'in_progress',\r\n  })\r\n    .populate('route vehicle driver')\r\n    .sort({ scheduledStartTime: 1 });\r\n};\r\n\r\n// Static method للحصول على رحلات اليوم\r\ntripSchema.statics.getTodayTrips = function () {\r\n  const startOfDay = new Date();\r\n  startOfDay.setHours(0, 0, 0, 0);\r\n\r\n  const endOfDay = new Date();\r\n  endOfDay.setHours(23, 59, 59, 999);\r\n\r\n  return this.find({\r\n    scheduledStartTime: {\r\n      $gte: startOfDay,\r\n      $lte: endOfDay,\r\n    },\r\n  })\r\n    .populate('route vehicle driver')\r\n    .sort({ scheduledStartTime: 1 });\r\n};\r\n\r\nmodule.exports = mongoose.model('Trip', tripSchema);\r\n"],"mappings":"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","ignoreList":[]}