6954f411ea2cd7e7208d420fecb747dc
/**
 * Integrated System Dashboard Service
 * Central monitoring and orchestration
 * Phase 11: System Integration
 */

const logger = require('../utils/logger');
const searchEngine = require('./searchEngine');
const validator = require('./validator');
class SystemDashboard {
  constructor() {
    this.metrics = {
      system: {
        startTime: new Date(),
        uptime: 0,
        status: 'initializing'
      },
      services: {},
      performance: {
        averageResponseTime: 0,
        requestsProcessed: 0,
        errorsEncountered: 0,
        cacheHitRate: 0
      },
      integrations: {
        mongodb: {
          status: 'disconnected',
          latency: 0
        },
        redis: {
          status: 'disconnected',
          latency: 0
        },
        elasticsearch: {
          status: 'disconnected',
          latency: 0
        },
        websocket: {
          status: 'disconnected',
          connections: 0
        }
      }
    };
    this.alerts = [];
    this.events = [];
  }

  /**
   * Initialize system components
   */
  async initialize() {
    try {
      logger.info('ðŸš€ System Dashboard: Initializing components...');

      // Initialize services
      this.metrics.services = {
        search: {
          status: 'active',
          endpoints: 6
        },
        validation: {
          status: 'active',
          endpoints: 7
        },
        response: {
          status: 'active',
          methods: 18
        },
        auth: {
          status: 'active',
          methods: 3
        },
        analytics: {
          status: 'active',
          metrics: 5
        }
      };
      this.metrics.system.status = 'ready';
      logger.info('âœ… System Dashboard: Initialization complete');
      return true;
    } catch (error) {
      logger.error('âŒ System Dashboard: Initialization failed', error);
      return false;
    }
  }

  /**
   * Get system health status
   */
  getSystemHealth() {
    const uptime = (Date.now() - this.metrics.system.startTime.getTime()) / 1000;
    return {
      status: this.metrics.system.status,
      timestamp: new Date().toISOString(),
      uptime: `${Math.floor(uptime)}s`,
      services: Object.entries(this.metrics.services).map(([name, data]) => ({
        name,
        ...data
      })),
      integrations: this.metrics.integrations,
      performance: this.metrics.performance,
      alerts: this.alerts.length,
      events: this.events.length
    };
  }

  /**
   * Check service status
   */
  checkServiceStatus(serviceName) {
    const service = this.metrics.services[serviceName];
    if (!service) {
      return {
        status: 'unknown',
        message: `Service ${serviceName} not found`
      };
    }
    return service;
  }

  /**
   * Update integration status
   */
  async updateIntegrationStatus(integrationName, status, latency = 0) {
    if (this.metrics.integrations[integrationName]) {
      this.metrics.integrations[integrationName] = {
        status,
        latency,
        lastChecked: new Date().toISOString()
      };
      const event = {
        timestamp: new Date().toISOString(),
        type: 'integration_update',
        integration: integrationName,
        status
      };
      this.events.push(event);
      if (this.events.length > 100) {
        this.events.shift();
      }
    }
  }

  /**
   * Record performance metric
   */
  recordMetric(responseTime, success = true) {
    this.metrics.performance.requestsProcessed++;
    if (!success) {
      this.metrics.performance.errorsEncountered++;
    }
    const total = this.metrics.performance.requestsProcessed;
    const avg = this.metrics.performance.averageResponseTime;
    this.metrics.performance.averageResponseTime = (avg + responseTime) / 2;
  }

  /**
   * Add system alert
   */
  addAlert(severity, message, details = {}) {
    const alert = {
      id: Date.now(),
      timestamp: new Date().toISOString(),
      severity,
      message,
      details
    };
    this.alerts.push(alert);
    logger.warn(`[${severity}] ${message}`);

    // Keep only last 50 alerts
    if (this.alerts.length > 50) {
      this.alerts.shift();
    }
    return alert;
  }

  /**
   * Get dashboard summary
   */
  getDashboardSummary() {
    const serviceCount = Object.keys(this.metrics.services).length;
    const activeServices = Object.values(this.metrics.services).filter(s => s.status === 'active').length;
    const integrationCount = Object.keys(this.metrics.integrations).length;
    const connectedIntegrations = Object.values(this.metrics.integrations).filter(i => i.status === 'connected').length;
    return {
      summary: {
        serviceHealth: `${activeServices}/${serviceCount} active`,
        integrationHealth: `${connectedIntegrations}/${integrationCount} connected`,
        systemStatus: this.metrics.system.status,
        criticalAlerts: this.alerts.filter(a => a.severity === 'critical').length,
        averageResponseTime: `${Math.round(this.metrics.performance.averageResponseTime)}ms`,
        errorRate: `${(this.metrics.performance.errorsEncountered / Math.max(1, this.metrics.performance.requestsProcessed) * 100).toFixed(2)}%`
      },
      services: this.metrics.services,
      integrations: this.metrics.integrations,
      recentAlerts: this.alerts.slice(-10),
      recentEvents: this.events.slice(-10)
    };
  }

  /**
   * Export metrics for monitoring systems
   */
  exportMetrics() {
    return {
      timestamp: new Date().toISOString(),
      metrics: {
        system: this.metrics.system,
        services: this.metrics.services,
        performance: this.metrics.performance,
        integrations: this.metrics.integrations
      },
      health: this.getSystemHealth(),
      summary: this.getDashboardSummary()
    };
  }
}
module.exports = new SystemDashboard();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXIiLCJyZXF1aXJlIiwic2VhcmNoRW5naW5lIiwidmFsaWRhdG9yIiwiU3lzdGVtRGFzaGJvYXJkIiwiY29uc3RydWN0b3IiLCJtZXRyaWNzIiwic3lzdGVtIiwic3RhcnRUaW1lIiwiRGF0ZSIsInVwdGltZSIsInN0YXR1cyIsInNlcnZpY2VzIiwicGVyZm9ybWFuY2UiLCJhdmVyYWdlUmVzcG9uc2VUaW1lIiwicmVxdWVzdHNQcm9jZXNzZWQiLCJlcnJvcnNFbmNvdW50ZXJlZCIsImNhY2hlSGl0UmF0ZSIsImludGVncmF0aW9ucyIsIm1vbmdvZGIiLCJsYXRlbmN5IiwicmVkaXMiLCJlbGFzdGljc2VhcmNoIiwid2Vic29ja2V0IiwiY29ubmVjdGlvbnMiLCJhbGVydHMiLCJldmVudHMiLCJpbml0aWFsaXplIiwiaW5mbyIsInNlYXJjaCIsImVuZHBvaW50cyIsInZhbGlkYXRpb24iLCJyZXNwb25zZSIsIm1ldGhvZHMiLCJhdXRoIiwiYW5hbHl0aWNzIiwiZXJyb3IiLCJnZXRTeXN0ZW1IZWFsdGgiLCJub3ciLCJnZXRUaW1lIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJNYXRoIiwiZmxvb3IiLCJPYmplY3QiLCJlbnRyaWVzIiwibWFwIiwibmFtZSIsImRhdGEiLCJsZW5ndGgiLCJjaGVja1NlcnZpY2VTdGF0dXMiLCJzZXJ2aWNlTmFtZSIsInNlcnZpY2UiLCJtZXNzYWdlIiwidXBkYXRlSW50ZWdyYXRpb25TdGF0dXMiLCJpbnRlZ3JhdGlvbk5hbWUiLCJsYXN0Q2hlY2tlZCIsImV2ZW50IiwidHlwZSIsImludGVncmF0aW9uIiwicHVzaCIsInNoaWZ0IiwicmVjb3JkTWV0cmljIiwicmVzcG9uc2VUaW1lIiwic3VjY2VzcyIsInRvdGFsIiwiYXZnIiwiYWRkQWxlcnQiLCJzZXZlcml0eSIsImRldGFpbHMiLCJhbGVydCIsImlkIiwid2FybiIsImdldERhc2hib2FyZFN1bW1hcnkiLCJzZXJ2aWNlQ291bnQiLCJrZXlzIiwiYWN0aXZlU2VydmljZXMiLCJ2YWx1ZXMiLCJmaWx0ZXIiLCJzIiwiaW50ZWdyYXRpb25Db3VudCIsImNvbm5lY3RlZEludGVncmF0aW9ucyIsImkiLCJzdW1tYXJ5Iiwic2VydmljZUhlYWx0aCIsImludGVncmF0aW9uSGVhbHRoIiwic3lzdGVtU3RhdHVzIiwiY3JpdGljYWxBbGVydHMiLCJhIiwicm91bmQiLCJlcnJvclJhdGUiLCJtYXgiLCJ0b0ZpeGVkIiwicmVjZW50QWxlcnRzIiwic2xpY2UiLCJyZWNlbnRFdmVudHMiLCJleHBvcnRNZXRyaWNzIiwiaGVhbHRoIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInN5c3RlbURhc2hib2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEludGVncmF0ZWQgU3lzdGVtIERhc2hib2FyZCBTZXJ2aWNlXG4gKiBDZW50cmFsIG1vbml0b3JpbmcgYW5kIG9yY2hlc3RyYXRpb25cbiAqIFBoYXNlIDExOiBTeXN0ZW0gSW50ZWdyYXRpb25cbiAqL1xuXG5jb25zdCBsb2dnZXIgPSByZXF1aXJlKCcuLi91dGlscy9sb2dnZXInKTtcbmNvbnN0IHNlYXJjaEVuZ2luZSA9IHJlcXVpcmUoJy4vc2VhcmNoRW5naW5lJyk7XG5jb25zdCB2YWxpZGF0b3IgPSByZXF1aXJlKCcuL3ZhbGlkYXRvcicpO1xuXG5jbGFzcyBTeXN0ZW1EYXNoYm9hcmQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm1ldHJpY3MgPSB7XG4gICAgICBzeXN0ZW06IHtcbiAgICAgICAgc3RhcnRUaW1lOiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cHRpbWU6IDAsXG4gICAgICAgIHN0YXR1czogJ2luaXRpYWxpemluZycsXG4gICAgICB9LFxuICAgICAgc2VydmljZXM6IHt9LFxuICAgICAgcGVyZm9ybWFuY2U6IHtcbiAgICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZTogMCxcbiAgICAgICAgcmVxdWVzdHNQcm9jZXNzZWQ6IDAsXG4gICAgICAgIGVycm9yc0VuY291bnRlcmVkOiAwLFxuICAgICAgICBjYWNoZUhpdFJhdGU6IDAsXG4gICAgICB9LFxuICAgICAgaW50ZWdyYXRpb25zOiB7XG4gICAgICAgIG1vbmdvZGI6IHsgc3RhdHVzOiAnZGlzY29ubmVjdGVkJywgbGF0ZW5jeTogMCB9LFxuICAgICAgICByZWRpczogeyBzdGF0dXM6ICdkaXNjb25uZWN0ZWQnLCBsYXRlbmN5OiAwIH0sXG4gICAgICAgIGVsYXN0aWNzZWFyY2g6IHsgc3RhdHVzOiAnZGlzY29ubmVjdGVkJywgbGF0ZW5jeTogMCB9LFxuICAgICAgICB3ZWJzb2NrZXQ6IHsgc3RhdHVzOiAnZGlzY29ubmVjdGVkJywgY29ubmVjdGlvbnM6IDAgfSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMuYWxlcnRzID0gW107XG4gICAgdGhpcy5ldmVudHMgPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHN5c3RlbSBjb21wb25lbnRzXG4gICAqL1xuICBhc3luYyBpbml0aWFsaXplKCkge1xuICAgIHRyeSB7XG4gICAgICBsb2dnZXIuaW5mbygn8J+agCBTeXN0ZW0gRGFzaGJvYXJkOiBJbml0aWFsaXppbmcgY29tcG9uZW50cy4uLicpO1xuXG4gICAgICAvLyBJbml0aWFsaXplIHNlcnZpY2VzXG4gICAgICB0aGlzLm1ldHJpY3Muc2VydmljZXMgPSB7XG4gICAgICAgIHNlYXJjaDogeyBzdGF0dXM6ICdhY3RpdmUnLCBlbmRwb2ludHM6IDYgfSxcbiAgICAgICAgdmFsaWRhdGlvbjogeyBzdGF0dXM6ICdhY3RpdmUnLCBlbmRwb2ludHM6IDcgfSxcbiAgICAgICAgcmVzcG9uc2U6IHsgc3RhdHVzOiAnYWN0aXZlJywgbWV0aG9kczogMTggfSxcbiAgICAgICAgYXV0aDogeyBzdGF0dXM6ICdhY3RpdmUnLCBtZXRob2RzOiAzIH0sXG4gICAgICAgIGFuYWx5dGljczogeyBzdGF0dXM6ICdhY3RpdmUnLCBtZXRyaWNzOiA1IH0sXG4gICAgICB9O1xuXG4gICAgICB0aGlzLm1ldHJpY3Muc3lzdGVtLnN0YXR1cyA9ICdyZWFkeSc7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCfinIUgU3lzdGVtIERhc2hib2FyZDogSW5pdGlhbGl6YXRpb24gY29tcGxldGUnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ+KdjCBTeXN0ZW0gRGFzaGJvYXJkOiBJbml0aWFsaXphdGlvbiBmYWlsZWQnLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzeXN0ZW0gaGVhbHRoIHN0YXR1c1xuICAgKi9cbiAgZ2V0U3lzdGVtSGVhbHRoKCkge1xuICAgIGNvbnN0IHVwdGltZSA9IChEYXRlLm5vdygpIC0gdGhpcy5tZXRyaWNzLnN5c3RlbS5zdGFydFRpbWUuZ2V0VGltZSgpKSAvIDEwMDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiB0aGlzLm1ldHJpY3Muc3lzdGVtLnN0YXR1cyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXB0aW1lOiBgJHtNYXRoLmZsb29yKHVwdGltZSl9c2AsXG4gICAgICBzZXJ2aWNlczogT2JqZWN0LmVudHJpZXModGhpcy5tZXRyaWNzLnNlcnZpY2VzKS5tYXAoKFtuYW1lLCBkYXRhXSkgPT4gKHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgLi4uZGF0YSxcbiAgICAgIH0pKSxcbiAgICAgIGludGVncmF0aW9uczogdGhpcy5tZXRyaWNzLmludGVncmF0aW9ucyxcbiAgICAgIHBlcmZvcm1hbmNlOiB0aGlzLm1ldHJpY3MucGVyZm9ybWFuY2UsXG4gICAgICBhbGVydHM6IHRoaXMuYWxlcnRzLmxlbmd0aCxcbiAgICAgIGV2ZW50czogdGhpcy5ldmVudHMubGVuZ3RoLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgc2VydmljZSBzdGF0dXNcbiAgICovXG4gIGNoZWNrU2VydmljZVN0YXR1cyhzZXJ2aWNlTmFtZSkge1xuICAgIGNvbnN0IHNlcnZpY2UgPSB0aGlzLm1ldHJpY3Muc2VydmljZXNbc2VydmljZU5hbWVdO1xuICAgIGlmICghc2VydmljZSkge1xuICAgICAgcmV0dXJuIHsgc3RhdHVzOiAndW5rbm93bicsIG1lc3NhZ2U6IGBTZXJ2aWNlICR7c2VydmljZU5hbWV9IG5vdCBmb3VuZGAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHNlcnZpY2U7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGludGVncmF0aW9uIHN0YXR1c1xuICAgKi9cbiAgYXN5bmMgdXBkYXRlSW50ZWdyYXRpb25TdGF0dXMoaW50ZWdyYXRpb25OYW1lLCBzdGF0dXMsIGxhdGVuY3kgPSAwKSB7XG4gICAgaWYgKHRoaXMubWV0cmljcy5pbnRlZ3JhdGlvbnNbaW50ZWdyYXRpb25OYW1lXSkge1xuICAgICAgdGhpcy5tZXRyaWNzLmludGVncmF0aW9uc1tpbnRlZ3JhdGlvbk5hbWVdID0ge1xuICAgICAgICBzdGF0dXMsXG4gICAgICAgIGxhdGVuY3ksXG4gICAgICAgIGxhc3RDaGVja2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBldmVudCA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHR5cGU6ICdpbnRlZ3JhdGlvbl91cGRhdGUnLFxuICAgICAgICBpbnRlZ3JhdGlvbjogaW50ZWdyYXRpb25OYW1lLFxuICAgICAgICBzdGF0dXMsXG4gICAgICB9O1xuICAgICAgdGhpcy5ldmVudHMucHVzaChldmVudCk7XG5cbiAgICAgIGlmICh0aGlzLmV2ZW50cy5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgdGhpcy5ldmVudHMuc2hpZnQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIHBlcmZvcm1hbmNlIG1ldHJpY1xuICAgKi9cbiAgcmVjb3JkTWV0cmljKHJlc3BvbnNlVGltZSwgc3VjY2VzcyA9IHRydWUpIHtcbiAgICB0aGlzLm1ldHJpY3MucGVyZm9ybWFuY2UucmVxdWVzdHNQcm9jZXNzZWQrKztcblxuICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgdGhpcy5tZXRyaWNzLnBlcmZvcm1hbmNlLmVycm9yc0VuY291bnRlcmVkKys7XG4gICAgfVxuXG4gICAgY29uc3QgdG90YWwgPSB0aGlzLm1ldHJpY3MucGVyZm9ybWFuY2UucmVxdWVzdHNQcm9jZXNzZWQ7XG4gICAgY29uc3QgYXZnID0gdGhpcy5tZXRyaWNzLnBlcmZvcm1hbmNlLmF2ZXJhZ2VSZXNwb25zZVRpbWU7XG4gICAgdGhpcy5tZXRyaWNzLnBlcmZvcm1hbmNlLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPSAoYXZnICsgcmVzcG9uc2VUaW1lKSAvIDI7XG4gIH1cblxuICAvKipcbiAgICogQWRkIHN5c3RlbSBhbGVydFxuICAgKi9cbiAgYWRkQWxlcnQoc2V2ZXJpdHksIG1lc3NhZ2UsIGRldGFpbHMgPSB7fSkge1xuICAgIGNvbnN0IGFsZXJ0ID0ge1xuICAgICAgaWQ6IERhdGUubm93KCksXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHNldmVyaXR5LFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGRldGFpbHMsXG4gICAgfTtcblxuICAgIHRoaXMuYWxlcnRzLnB1c2goYWxlcnQpO1xuICAgIGxvZ2dlci53YXJuKGBbJHtzZXZlcml0eX1dICR7bWVzc2FnZX1gKTtcblxuICAgIC8vIEtlZXAgb25seSBsYXN0IDUwIGFsZXJ0c1xuICAgIGlmICh0aGlzLmFsZXJ0cy5sZW5ndGggPiA1MCkge1xuICAgICAgdGhpcy5hbGVydHMuc2hpZnQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWxlcnQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRhc2hib2FyZCBzdW1tYXJ5XG4gICAqL1xuICBnZXREYXNoYm9hcmRTdW1tYXJ5KCkge1xuICAgIGNvbnN0IHNlcnZpY2VDb3VudCA9IE9iamVjdC5rZXlzKHRoaXMubWV0cmljcy5zZXJ2aWNlcykubGVuZ3RoO1xuICAgIGNvbnN0IGFjdGl2ZVNlcnZpY2VzID0gT2JqZWN0LnZhbHVlcyh0aGlzLm1ldHJpY3Muc2VydmljZXMpLmZpbHRlcihcbiAgICAgIHMgPT4gcy5zdGF0dXMgPT09ICdhY3RpdmUnXG4gICAgKS5sZW5ndGg7XG4gICAgY29uc3QgaW50ZWdyYXRpb25Db3VudCA9IE9iamVjdC5rZXlzKHRoaXMubWV0cmljcy5pbnRlZ3JhdGlvbnMpLmxlbmd0aDtcbiAgICBjb25zdCBjb25uZWN0ZWRJbnRlZ3JhdGlvbnMgPSBPYmplY3QudmFsdWVzKHRoaXMubWV0cmljcy5pbnRlZ3JhdGlvbnMpLmZpbHRlcihcbiAgICAgIGkgPT4gaS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnXG4gICAgKS5sZW5ndGg7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VtbWFyeToge1xuICAgICAgICBzZXJ2aWNlSGVhbHRoOiBgJHthY3RpdmVTZXJ2aWNlc30vJHtzZXJ2aWNlQ291bnR9IGFjdGl2ZWAsXG4gICAgICAgIGludGVncmF0aW9uSGVhbHRoOiBgJHtjb25uZWN0ZWRJbnRlZ3JhdGlvbnN9LyR7aW50ZWdyYXRpb25Db3VudH0gY29ubmVjdGVkYCxcbiAgICAgICAgc3lzdGVtU3RhdHVzOiB0aGlzLm1ldHJpY3Muc3lzdGVtLnN0YXR1cyxcbiAgICAgICAgY3JpdGljYWxBbGVydHM6IHRoaXMuYWxlcnRzLmZpbHRlcihhID0+IGEuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcpLmxlbmd0aCxcbiAgICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZTogYCR7TWF0aC5yb3VuZCh0aGlzLm1ldHJpY3MucGVyZm9ybWFuY2UuYXZlcmFnZVJlc3BvbnNlVGltZSl9bXNgLFxuICAgICAgICBlcnJvclJhdGU6IGAkeygodGhpcy5tZXRyaWNzLnBlcmZvcm1hbmNlLmVycm9yc0VuY291bnRlcmVkIC8gTWF0aC5tYXgoMSwgdGhpcy5tZXRyaWNzLnBlcmZvcm1hbmNlLnJlcXVlc3RzUHJvY2Vzc2VkKSkgKiAxMDApLnRvRml4ZWQoMil9JWAsXG4gICAgICB9LFxuICAgICAgc2VydmljZXM6IHRoaXMubWV0cmljcy5zZXJ2aWNlcyxcbiAgICAgIGludGVncmF0aW9uczogdGhpcy5tZXRyaWNzLmludGVncmF0aW9ucyxcbiAgICAgIHJlY2VudEFsZXJ0czogdGhpcy5hbGVydHMuc2xpY2UoLTEwKSxcbiAgICAgIHJlY2VudEV2ZW50czogdGhpcy5ldmVudHMuc2xpY2UoLTEwKSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9ydCBtZXRyaWNzIGZvciBtb25pdG9yaW5nIHN5c3RlbXNcbiAgICovXG4gIGV4cG9ydE1ldHJpY3MoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgbWV0cmljczoge1xuICAgICAgICBzeXN0ZW06IHRoaXMubWV0cmljcy5zeXN0ZW0sXG4gICAgICAgIHNlcnZpY2VzOiB0aGlzLm1ldHJpY3Muc2VydmljZXMsXG4gICAgICAgIHBlcmZvcm1hbmNlOiB0aGlzLm1ldHJpY3MucGVyZm9ybWFuY2UsXG4gICAgICAgIGludGVncmF0aW9uczogdGhpcy5tZXRyaWNzLmludGVncmF0aW9ucyxcbiAgICAgIH0sXG4gICAgICBoZWFsdGg6IHRoaXMuZ2V0U3lzdGVtSGVhbHRoKCksXG4gICAgICBzdW1tYXJ5OiB0aGlzLmdldERhc2hib2FyZFN1bW1hcnkoKSxcbiAgICB9O1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IFN5c3RlbURhc2hib2FyZCgpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0FBQ3pDLE1BQU1DLFlBQVksR0FBR0QsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQzlDLE1BQU1F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