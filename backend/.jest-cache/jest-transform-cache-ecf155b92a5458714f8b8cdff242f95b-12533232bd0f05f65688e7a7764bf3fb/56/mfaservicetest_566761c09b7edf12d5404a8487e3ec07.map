{"version":3,"names":["mfaService","require","describe","test","result","generateTOTPSecret","expect","secret","toBeDefined","qrCode","otpauth_url","manualEntryKey","toMatch","verifyTOTP","toBe","generateEmailOTP","code","expiresAt","expiresIn","generateSMSOTP","Date","now","verifyOTP","isValid","message","toContain","code1","code2","error","codes","generateBackupCodes","toHaveLength","forEach","hashed","hashBackupCode","not","verifyBackupCode","userId","session","createMFASession","sessionId","method","status","attempts","maxAttempts","validateMFASession","fingerprint","generateTrustedDeviceToken","token","createdAt","key","generateRecoveryKey","methods","totp","email","sms","backupCodes","score","calculateSecurityScore","toBeGreaterThanOrEqual","toBeLessThanOrEqual","toBeGreaterThan","log","createAuditLog","ipAddress","userAgent","action","timestamp","guide","getMFASetupGuide","name","description","steps","advantages","deviceName","metadata","start","duration","toBeLessThan","module","exports"],"sources":["mfa.service.test.js"],"sourcesContent":["/**\r\n * MFA Service Tests\r\n * اختبارات خدمة المصادقة متعددة العوامل\r\n */\r\n\r\nconst mfaService = require('../../services/mfaService');\r\n\r\ndescribe('MFA Service', () => {\r\n  describe('TOTP Functions', () => {\r\n    test('should generate TOTP secret', async () => {\r\n      const result = await mfaService.generateTOTPSecret('test@example.com');\r\n      \r\n      expect(result.secret).toBeDefined();\r\n      expect(result.qrCode).toBeDefined();\r\n      expect(result.otpauth_url).toBeDefined();\r\n      expect(result.manualEntryKey).toBeDefined();\r\n      expect(result.manualEntryKey).toMatch(/^[A-Z2-7]+$/);\r\n    });\r\n\r\n    test('should verify valid TOTP token', () => {\r\n      const secret = 'JBSWY3DPEBLW64TMMQ======';\r\n      // Note: In real tests, use a library that generates valid tokens\r\n      const result = mfaService.verifyTOTP('123456', secret);\r\n      \r\n      // This will be false with random numbers, but demonstrates the function call\r\n      expect(typeof result).toBe('boolean');\r\n    });\r\n\r\n    test('should reject invalid TOTP token', () => {\r\n      const secret = 'JBSWY3DPEBLW64TMMQ======';\r\n      const result = mfaService.verifyTOTP('000000', secret);\r\n      \r\n      expect(result).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('OTP Functions', () => {\r\n    test('should generate email OTP', () => {\r\n      const result = mfaService.generateEmailOTP();\r\n      \r\n      expect(result.code).toBeDefined();\r\n      expect(result.code).toMatch(/^\\d{6}$/);\r\n      expect(result.expiresAt).toBeDefined();\r\n      expect(result.expiresIn).toBe(300); // 5 minutes\r\n    });\r\n\r\n    test('should generate SMS OTP', () => {\r\n      const result = mfaService.generateSMSOTP();\r\n      \r\n      expect(result.code).toBeDefined();\r\n      expect(result.code).toMatch(/^\\d{6}$/);\r\n      expect(result.expiresAt).toBeDefined();\r\n    });\r\n\r\n    test('should verify valid OTP', () => {\r\n      const code = '123456';\r\n      const expiresAt = new Date(Date.now() + 300000);\r\n      \r\n      const result = mfaService.verifyOTP(code, code, expiresAt);\r\n      \r\n      expect(result.isValid).toBe(true);\r\n      expect(result.message).toContain('verified');\r\n    });\r\n\r\n    test('should reject invalid OTP', () => {\r\n      const code1 = '123456';\r\n      const code2 = '654321';\r\n      const expiresAt = new Date(Date.now() + 300000);\r\n      \r\n      const result = mfaService.verifyOTP(code1, code2, expiresAt);\r\n      \r\n      expect(result.isValid).toBe(false);\r\n      expect(result.error).toBe('INVALID_OTP');\r\n    });\r\n\r\n    test('should reject expired OTP', () => {\r\n      const code = '123456';\r\n      const expiresAt = new Date(Date.now() - 1000); // Expired\r\n      \r\n      const result = mfaService.verifyOTP(code, code, expiresAt);\r\n      \r\n      expect(result.isValid).toBe(false);\r\n      expect(result.error).toBe('EXPIRED');\r\n    });\r\n  });\r\n\r\n  describe('Backup Codes', () => {\r\n    test('should generate backup codes', () => {\r\n      const codes = mfaService.generateBackupCodes(10);\r\n      \r\n      expect(codes).toHaveLength(10);\r\n      codes.forEach(code => {\r\n        expect(code).toMatch(/^[A-F0-9]{4}-[A-F0-9]{4}$/);\r\n      });\r\n    });\r\n\r\n    test('should hash backup code', () => {\r\n      const code = '1234-5678';\r\n      const hashed = mfaService.hashBackupCode(code);\r\n      \r\n      expect(hashed).toBeDefined();\r\n      expect(hashed).toMatch(/^[a-f0-9]{64}$/); // SHA256 hex\r\n      expect(hashed).not.toBe(code);\r\n    });\r\n\r\n    test('should verify backup code', () => {\r\n      const code = '1234-5678';\r\n      const hashed = mfaService.hashBackupCode(code);\r\n      \r\n      const result = mfaService.verifyBackupCode(code, hashed);\r\n      expect(result).toBe(true);\r\n    });\r\n\r\n    test('should reject invalid backup code', () => {\r\n      const code = '1234-5678';\r\n      const hashed = mfaService.hashBackupCode(code);\r\n      \r\n      const result = mfaService.verifyBackupCode('9999-9999', hashed);\r\n      expect(result).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('MFA Session Management', () => {\r\n    test('should create MFA session', () => {\r\n      const userId = 'user123';\r\n      const session = mfaService.createMFASession(userId, 'totp');\r\n      \r\n      expect(session.sessionId).toBeDefined();\r\n      expect(session.userId).toBe(userId);\r\n      expect(session.method).toBe('totp');\r\n      expect(session.status).toBe('pending');\r\n      expect(session.expiresAt).toBeDefined();\r\n      expect(session.attempts).toBe(0);\r\n      expect(session.maxAttempts).toBe(5);\r\n    });\r\n\r\n    test('should validate active session', () => {\r\n      const session = mfaService.createMFASession('user123', 'totp');\r\n      \r\n      const result = mfaService.validateMFASession(session);\r\n      \r\n      expect(result.isValid).toBe(true);\r\n    });\r\n\r\n    test('should invalidate expired session', () => {\r\n      const session = mfaService.createMFASession('user123', 'totp');\r\n      session.expiresAt = new Date(Date.now() - 1000); // Expired\r\n      \r\n      const result = mfaService.validateMFASession(session);\r\n      \r\n      expect(result.isValid).toBe(false);\r\n    });\r\n\r\n    test('should invalidate session with max attempts exceeded', () => {\r\n      const session = mfaService.createMFASession('user123', 'totp');\r\n      session.attempts = 5; // Max attempts\r\n      \r\n      const result = mfaService.validateMFASession(session);\r\n      \r\n      expect(result.isValid).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Trusted Device Management', () => {\r\n    test('should generate device token', () => {\r\n      const userId = 'user123';\r\n      const fingerprint = 'device-fingerprint';\r\n      \r\n      const result = mfaService.generateTrustedDeviceToken(userId, fingerprint);\r\n      \r\n      expect(result.token).toBeDefined();\r\n      expect(result.createdAt).toBeDefined();\r\n      expect(result.expiresAt).toBeDefined();\r\n    });\r\n\r\n    test('should generate recovery key', () => {\r\n      const key = mfaService.generateRecoveryKey();\r\n      \r\n      expect(key).toBeDefined();\r\n      expect(key).toMatch(/^[A-F0-9]{32}$/);\r\n    });\r\n  });\r\n\r\n  describe('Security Scoring', () => {\r\n    test('should calculate security score', () => {\r\n      const methods = {\r\n        totp: true,\r\n        email: true,\r\n        sms: false,\r\n        backupCodes: [],\r\n      };\r\n      \r\n      const score = mfaService.calculateSecurityScore(methods);\r\n      \r\n      expect(score).toBeGreaterThanOrEqual(0);\r\n      expect(score).toBeLessThanOrEqual(100);\r\n      expect(score).toBeGreaterThan(0); // At least TOTP is enabled\r\n    });\r\n\r\n    test('should return maximum score with all methods', () => {\r\n      const methods = {\r\n        totp: true,\r\n        email: true,\r\n        sms: true,\r\n        backupCodes: ['CODE1', 'CODE2'],\r\n      };\r\n      \r\n      const score = mfaService.calculateSecurityScore(methods);\r\n      \r\n      expect(score).toBe(100);\r\n    });\r\n\r\n    test('should return zero with no methods', () => {\r\n      const methods = {\r\n        totp: false,\r\n        email: false,\r\n        sms: false,\r\n        backupCodes: [],\r\n      };\r\n      \r\n      const score = mfaService.calculateSecurityScore(methods);\r\n      \r\n      expect(score).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('Audit Logging', () => {\r\n    test('should create audit log entry', () => {\r\n      const userId = 'user123';\r\n      const log = mfaService.createAuditLog(userId, 'totp_setup', 'success', {\r\n        ipAddress: '192.168.1.1',\r\n        userAgent: 'Mozilla/5.0',\r\n      });\r\n      \r\n      expect(log.userId).toBe(userId);\r\n      expect(log.action).toBe('totp_setup');\r\n      expect(log.status).toBe('success');\r\n      expect(log.timestamp).toBeDefined();\r\n      expect(log.ipAddress).toBe('192.168.1.1');\r\n      expect(log.userAgent).toBe('Mozilla/5.0');\r\n    });\r\n  });\r\n\r\n  describe('Setup Guide', () => {\r\n    test('should return complete setup guide', () => {\r\n      const guide = mfaService.getMFASetupGuide();\r\n      \r\n      expect(guide.totp).toBeDefined();\r\n      expect(guide.email).toBeDefined();\r\n      expect(guide.sms).toBeDefined();\r\n      \r\n      expect(guide.totp.name).toBeDefined();\r\n      expect(guide.totp.description).toBeDefined();\r\n      expect(guide.totp.steps).toBeDefined();\r\n      expect(guide.totp.advantages).toBeDefined();\r\n    });\r\n  });\r\n});\r\n\r\ndescribe('MFA Edge Cases', () => {\r\n  test('should handle timing-safe comparison for OTP', () => {\r\n    // This ensures OTP validation is resistant to timing attacks\r\n    const code1 = '123456';\r\n    const code2 = '123456';\r\n    \r\n    const result = mfaService.verifyOTP(code1, code2, new Date(Date.now() + 300000));\r\n    expect(result.isValid).toBe(true);\r\n  });\r\n\r\n  test('should handle leading zeros in OTP codes', () => {\r\n    const code1 = '012345';\r\n    const code2 = '012345';\r\n    \r\n    const result = mfaService.verifyOTP(code1, code2, new Date(Date.now() + 300000));\r\n    expect(result.isValid).toBe(true);\r\n  });\r\n\r\n  test('should handle special characters in device names', () => {\r\n    const userId = 'user123';\r\n    const deviceName = \"John's iPhone 14 Pro Max ✨\";\r\n    const session = mfaService.createMFASession(userId, 'totp', { deviceName });\r\n    \r\n    expect(session.metadata.deviceName).toBe(deviceName);\r\n  });\r\n});\r\n\r\ndescribe('MFA Performance', () => {\r\n  test('should generate TOTP secret quickly', async () => {\r\n    const start = Date.now();\r\n    await mfaService.generateTOTPSecret('test@example.com');\r\n    const duration = Date.now() - start;\r\n    \r\n    expect(duration).toBeLessThan(1000); // Should complete in less than 1 second\r\n  });\r\n\r\n  test('should verify OTP quickly', () => {\r\n    const start = Date.now();\r\n    mfaService.verifyOTP('123456', '123456', new Date(Date.now() + 300000));\r\n    const duration = Date.now() - start;\r\n    \r\n    expect(duration).toBeLessThan(100); // Should complete in less than 100ms\r\n  });\r\n});\r\n\r\nmodule.exports = {};\r\n"],"mappings":"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","ignoreList":[]}