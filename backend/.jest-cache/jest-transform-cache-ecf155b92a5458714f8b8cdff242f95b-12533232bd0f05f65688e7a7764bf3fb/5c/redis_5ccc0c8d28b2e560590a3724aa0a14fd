3a21c1fd107eae436a09aa5a8c5c2777
const redis = require('redis');
const logger = require('../utils/logger');

// Allow running without a Redis instance in local/offline scenarios
if (process.env.USE_MOCK_CACHE === 'true') {
  const memoryStore = new Map();
  const cache = {
    async set(key, value) {
      memoryStore.set(key, value);
      return true;
    },
    async get(key) {
      return memoryStore.get(key) ?? null;
    },
    async delete(key) {
      memoryStore.delete(key);
      return true;
    },
    async deletePattern(pattern) {
      const regex = new RegExp(pattern.replace('*', '.*'));
      for (const key of memoryStore.keys()) {
        if (regex.test(key)) memoryStore.delete(key);
      }
      return true;
    },
    async clear() {
      memoryStore.clear();
      return true;
    },
    async stats() {
      return {
        items: memoryStore.size
      };
    }
  };
  const cacheMiddleware = () => (req, res, next) => next();
  module.exports = {
    redisClient: null,
    cache,
    cacheMiddleware
  };
  logger.warn('Redis is mocked (USE_MOCK_CACHE=true). No external cache connection required.');
} else {
  const redisClient = redis.createClient({
    socket: {
      host: process.env.REDIS_HOST || 'localhost',
      port: Number(process.env.REDIS_PORT || 6379)
    },
    password: process.env.REDIS_PASSWORD || undefined,
    database: Number(process.env.REDIS_DB || 0)
  });
  redisClient.on('error', err => {
    logger.error('Redis error:', err);
  });
  redisClient.on('connect', () => {
    logger.info('Redis connected successfully');
  });

  // Initiate connection (Redis v4 requires explicit connect)
  redisClient.connect().catch(err => logger.error('Redis connect error:', err));

  // Cache helper functions
  const cache = {
    // Set cache with TTL (Time To Live in seconds)
    async set(key, value, ttl = 3600) {
      try {
        const serialized = JSON.stringify(value);
        if (ttl) {
          await redisClient.setEx(key, ttl, serialized);
        } else {
          await redisClient.set(key, serialized);
        }
        return true;
      } catch (error) {
        logger.error('Cache set error:', error);
        return false;
      }
    },
    // Get cache
    async get(key) {
      try {
        const data = await redisClient.get(key);
        return data ? JSON.parse(data) : null;
      } catch (error) {
        logger.error('Cache get error:', error);
        return null;
      }
    },
    // Delete cache
    async delete(key) {
      try {
        await redisClient.del(key);
        return true;
      } catch (error) {
        logger.error('Cache delete error:', error);
        return false;
      }
    },
    // Delete by pattern
    async deletePattern(pattern) {
      try {
        const keys = await redisClient.keys(pattern);
        if (keys.length > 0) {
          await redisClient.del(...keys);
        }
        return true;
      } catch (error) {
        logger.error('Cache deletePattern error:', error);
        return false;
      }
    },
    // Clear all cache
    async clear() {
      try {
        await redisClient.flushdb();
        return true;
      } catch (error) {
        logger.error('Cache clear error:', error);
        return false;
      }
    },
    // Get cache statistics
    async stats() {
      try {
        const info = await redisClient.info('stats');
        return info;
      } catch (error) {
        logger.error('Cache stats error:', error);
        return null;
      }
    }
  };

  // Cache middleware
  const cacheMiddleware = (duration = 3600) => {
    return async (req, res, next) => {
      if (req.method !== 'GET') {
        return next();
      }
      const cacheKey = `route:${req.originalUrl}`;
      try {
        const cachedData = await cache.get(cacheKey);
        if (cachedData) {
          res.set('X-Cache', 'HIT');
          return res.json(cachedData);
        }
      } catch (error) {
        logger.error('Cache middleware error:', error);
      }

      // Override res.json to cache the response
      const originalJson = res.json.bind(res);
      res.json = body => {
        cache.set(cacheKey, body, duration).catch(err => {
          logger.error('Failed to cache response:', err);
        });
        res.set('X-Cache', 'MISS');
        return originalJson(body);
      };
      next();
    };
  };
  module.exports = {
    redisClient,
    cache,
    cacheMiddleware
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZWRpcyIsInJlcXVpcmUiLCJsb2dnZXIiLCJwcm9jZXNzIiwiZW52IiwiVVNFX01PQ0tfQ0FDSEUiLCJtZW1vcnlTdG9yZSIsIk1hcCIsImNhY2hlIiwic2V0Iiwia2V5IiwidmFsdWUiLCJnZXQiLCJkZWxldGUiLCJkZWxldGVQYXR0ZXJuIiwicGF0dGVybiIsInJlZ2V4IiwiUmVnRXhwIiwicmVwbGFjZSIsImtleXMiLCJ0ZXN0IiwiY2xlYXIiLCJzdGF0cyIsIml0ZW1zIiwic2l6ZSIsImNhY2hlTWlkZGxld2FyZSIsInJlcSIsInJlcyIsIm5leHQiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVkaXNDbGllbnQiLCJ3YXJuIiwiY3JlYXRlQ2xpZW50Iiwic29ja2V0IiwiaG9zdCIsIlJFRElTX0hPU1QiLCJwb3J0IiwiTnVtYmVyIiwiUkVESVNfUE9SVCIsInBhc3N3b3JkIiwiUkVESVNfUEFTU1dPUkQiLCJ1bmRlZmluZWQiLCJkYXRhYmFzZSIsIlJFRElTX0RCIiwib24iLCJlcnIiLCJlcnJvciIsImluZm8iLCJjb25uZWN0IiwiY2F0Y2giLCJ0dGwiLCJzZXJpYWxpemVkIiwiSlNPTiIsInN0cmluZ2lmeSIsInNldEV4IiwiZGF0YSIsInBhcnNlIiwiZGVsIiwibGVuZ3RoIiwiZmx1c2hkYiIsImR1cmF0aW9uIiwibWV0aG9kIiwiY2FjaGVLZXkiLCJvcmlnaW5hbFVybCIsImNhY2hlZERhdGEiLCJqc29uIiwib3JpZ2luYWxKc29uIiwiYmluZCIsImJvZHkiXSwic291cmNlcyI6WyJyZWRpcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCByZWRpcyA9IHJlcXVpcmUoJ3JlZGlzJyk7XHJcbmNvbnN0IGxvZ2dlciA9IHJlcXVpcmUoJy4uL3V0aWxzL2xvZ2dlcicpO1xyXG5cclxuLy8gQWxsb3cgcnVubmluZyB3aXRob3V0IGEgUmVkaXMgaW5zdGFuY2UgaW4gbG9jYWwvb2ZmbGluZSBzY2VuYXJpb3NcclxuaWYgKHByb2Nlc3MuZW52LlVTRV9NT0NLX0NBQ0hFID09PSAndHJ1ZScpIHtcclxuICBjb25zdCBtZW1vcnlTdG9yZSA9IG5ldyBNYXAoKTtcclxuXHJcbiAgY29uc3QgY2FjaGUgPSB7XHJcbiAgICBhc3luYyBzZXQoa2V5LCB2YWx1ZSkge1xyXG4gICAgICBtZW1vcnlTdG9yZS5zZXQoa2V5LCB2YWx1ZSk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuICAgIGFzeW5jIGdldChrZXkpIHtcclxuICAgICAgcmV0dXJuIG1lbW9yeVN0b3JlLmdldChrZXkpID8/IG51bGw7XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgZGVsZXRlKGtleSkge1xyXG4gICAgICBtZW1vcnlTdG9yZS5kZWxldGUoa2V5KTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgZGVsZXRlUGF0dGVybihwYXR0ZXJuKSB7XHJcbiAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChwYXR0ZXJuLnJlcGxhY2UoJyonLCAnLionKSk7XHJcbiAgICAgIGZvciAoY29uc3Qga2V5IG9mIG1lbW9yeVN0b3JlLmtleXMoKSkge1xyXG4gICAgICAgIGlmIChyZWdleC50ZXN0KGtleSkpIG1lbW9yeVN0b3JlLmRlbGV0ZShrZXkpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuICAgIGFzeW5jIGNsZWFyKCkge1xyXG4gICAgICBtZW1vcnlTdG9yZS5jbGVhcigpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBhc3luYyBzdGF0cygpIHtcclxuICAgICAgcmV0dXJuIHsgaXRlbXM6IG1lbW9yeVN0b3JlLnNpemUgfTtcclxuICAgIH0sXHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY2FjaGVNaWRkbGV3YXJlID0gKCkgPT4gKHJlcSwgcmVzLCBuZXh0KSA9PiBuZXh0KCk7XHJcblxyXG4gIG1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgcmVkaXNDbGllbnQ6IG51bGwsXHJcbiAgICBjYWNoZSxcclxuICAgIGNhY2hlTWlkZGxld2FyZSxcclxuICB9O1xyXG4gIGxvZ2dlci53YXJuKCdSZWRpcyBpcyBtb2NrZWQgKFVTRV9NT0NLX0NBQ0hFPXRydWUpLiBObyBleHRlcm5hbCBjYWNoZSBjb25uZWN0aW9uIHJlcXVpcmVkLicpO1xyXG59IGVsc2Uge1xyXG4gIGNvbnN0IHJlZGlzQ2xpZW50ID0gcmVkaXMuY3JlYXRlQ2xpZW50KHtcclxuICAgIHNvY2tldDoge1xyXG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5SRURJU19IT1NUIHx8ICdsb2NhbGhvc3QnLFxyXG4gICAgICBwb3J0OiBOdW1iZXIocHJvY2Vzcy5lbnYuUkVESVNfUE9SVCB8fCA2Mzc5KSxcclxuICAgIH0sXHJcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUkVESVNfUEFTU1dPUkQgfHwgdW5kZWZpbmVkLFxyXG4gICAgZGF0YWJhc2U6IE51bWJlcihwcm9jZXNzLmVudi5SRURJU19EQiB8fCAwKSxcclxuICB9KTtcclxuXHJcbiAgcmVkaXNDbGllbnQub24oJ2Vycm9yJywgZXJyID0+IHtcclxuICAgIGxvZ2dlci5lcnJvcignUmVkaXMgZXJyb3I6JywgZXJyKTtcclxuICB9KTtcclxuXHJcbiAgcmVkaXNDbGllbnQub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XHJcbiAgICBsb2dnZXIuaW5mbygnUmVkaXMgY29ubmVjdGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gIH0pO1xyXG5cclxuICAvLyBJbml0aWF0ZSBjb25uZWN0aW9uIChSZWRpcyB2NCByZXF1aXJlcyBleHBsaWNpdCBjb25uZWN0KVxyXG4gIHJlZGlzQ2xpZW50LmNvbm5lY3QoKS5jYXRjaChlcnIgPT4gbG9nZ2VyLmVycm9yKCdSZWRpcyBjb25uZWN0IGVycm9yOicsIGVycikpO1xyXG5cclxuICAvLyBDYWNoZSBoZWxwZXIgZnVuY3Rpb25zXHJcbiAgY29uc3QgY2FjaGUgPSB7XHJcbiAgICAvLyBTZXQgY2FjaGUgd2l0aCBUVEwgKFRpbWUgVG8gTGl2ZSBpbiBzZWNvbmRzKVxyXG4gICAgYXN5bmMgc2V0KGtleSwgdmFsdWUsIHR0bCA9IDM2MDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgICAgIGlmICh0dGwpIHtcclxuICAgICAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LnNldEV4KGtleSwgdHRsLCBzZXJpYWxpemVkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYXdhaXQgcmVkaXNDbGllbnQuc2V0KGtleSwgc2VyaWFsaXplZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGxvZ2dlci5lcnJvcignQ2FjaGUgc2V0IGVycm9yOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8gR2V0IGNhY2hlXHJcbiAgICBhc3luYyBnZXQoa2V5KSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlZGlzQ2xpZW50LmdldChrZXkpO1xyXG4gICAgICAgIHJldHVybiBkYXRhID8gSlNPTi5wYXJzZShkYXRhKSA6IG51bGw7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBnZXQgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIERlbGV0ZSBjYWNoZVxyXG4gICAgYXN5bmMgZGVsZXRlKGtleSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LmRlbChrZXkpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGxvZ2dlci5lcnJvcignQ2FjaGUgZGVsZXRlIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8gRGVsZXRlIGJ5IHBhdHRlcm5cclxuICAgIGFzeW5jIGRlbGV0ZVBhdHRlcm4ocGF0dGVybikge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGtleXMgPSBhd2FpdCByZWRpc0NsaWVudC5rZXlzKHBhdHRlcm4pO1xyXG4gICAgICAgIGlmIChrZXlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LmRlbCguLi5rZXlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBkZWxldGVQYXR0ZXJuIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ2xlYXIgYWxsIGNhY2hlXHJcbiAgICBhc3luYyBjbGVhcigpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCByZWRpc0NsaWVudC5mbHVzaGRiKCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBjbGVhciBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIEdldCBjYWNoZSBzdGF0aXN0aWNzXHJcbiAgICBhc3luYyBzdGF0cygpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpbmZvID0gYXdhaXQgcmVkaXNDbGllbnQuaW5mbygnc3RhdHMnKTtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBsb2dnZXIuZXJyb3IoJ0NhY2hlIHN0YXRzIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICB9O1xyXG5cclxuICAvLyBDYWNoZSBtaWRkbGV3YXJlXHJcbiAgY29uc3QgY2FjaGVNaWRkbGV3YXJlID0gKGR1cmF0aW9uID0gMzYwMCkgPT4ge1xyXG4gICAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gICAgICBpZiAocmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcclxuICAgICAgICByZXR1cm4gbmV4dCgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBjYWNoZUtleSA9IGByb3V0ZToke3JlcS5vcmlnaW5hbFVybH1gO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBjYWNoZWREYXRhID0gYXdhaXQgY2FjaGUuZ2V0KGNhY2hlS2V5KTtcclxuICAgICAgICBpZiAoY2FjaGVkRGF0YSkge1xyXG4gICAgICAgICAgcmVzLnNldCgnWC1DYWNoZScsICdISVQnKTtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbihjYWNoZWREYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdDYWNoZSBtaWRkbGV3YXJlIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gT3ZlcnJpZGUgcmVzLmpzb24gdG8gY2FjaGUgdGhlIHJlc3BvbnNlXHJcbiAgICAgIGNvbnN0IG9yaWdpbmFsSnNvbiA9IHJlcy5qc29uLmJpbmQocmVzKTtcclxuICAgICAgcmVzLmpzb24gPSBib2R5ID0+IHtcclxuICAgICAgICBjYWNoZS5zZXQoY2FjaGVLZXksIGJvZHksIGR1cmF0aW9uKS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gY2FjaGUgcmVzcG9uc2U6JywgZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXMuc2V0KCdYLUNhY2hlJywgJ01JU1MnKTtcclxuICAgICAgICByZXR1cm4gb3JpZ2luYWxKc29uKGJvZHkpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgbmV4dCgpO1xyXG4gICAgfTtcclxuICB9O1xyXG5cclxuICBtb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIHJlZGlzQ2xpZW50LFxyXG4gICAgY2FjaGUsXHJcbiAgICBjYWNoZU1pZGRsZXdhcmUsXHJcbiAgfTtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQU8sQ0FBQztBQUM5QixNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7QUFFekM7QUFDQSxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsY0FBYyxLQUFLLE1BQU0sRUFBRTtFQUN6QyxNQUFNQyxXQUFXLEdBQUcsSUFBSUMsR0FBRyxDQUFDLENBQUM7RUFFN0IsTUFBTUMsS0FBSyxHQUFHO0lBQ1osTUFBTUMsR0FBR0EsQ0FBQ0MsR0FBRyxFQUFFQyxLQUFLLEVBQUU7TUFDcEJMLFdBQVcsQ0FBQ0csR0FBRyxDQUFDQyxHQUFHLEVBQUVDLEtBQUssQ0FBQztNQUMzQixPQUFPLElBQUk7SUFDYixDQUFDO0lBQ0QsTUFBTUMsR0FBR0EsQ0FBQ0YsR0FBRyxFQUFFO01BQ2IsT0FBT0osV0FBVyxDQUFDTSxHQUFHLENBQUNGLEdBQUcsQ0FBQyxJQUFJLElBQUk7SUFDckMsQ0FBQztJQUNELE1BQU1HLE1BQU1BLENBQUNILEdBQUcsRUFBRTtNQUNoQkosV0FBVyxDQUFDTyxNQUFNLENBQUNILEdBQUcsQ0FBQztNQUN2QixPQUFPLElBQUk7SUFDYixDQUFDO0lBQ0QsTUFBTUksYUFBYUEsQ0FBQ0MsT0FBTyxFQUFFO01BQzNCLE1BQU1DLEtBQUssR0FBRyxJQUFJQyxNQUFN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