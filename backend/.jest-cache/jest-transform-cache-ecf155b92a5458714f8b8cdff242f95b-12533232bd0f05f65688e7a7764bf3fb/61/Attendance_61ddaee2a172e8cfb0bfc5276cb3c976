f426305b6437e59bacfec6b666121f0a
/**
 * Attendance Model (HR)
 * Modular, extensible attendance record for HR system
 */
const mongoose = require('mongoose');
const AttendanceSchema = new mongoose.Schema({
  employeeId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Employee',
    required: true
  },
  checkInTime: {
    type: Date,
    required: true
  },
  checkOutTime: Date,
  checkInLocation: {
    latitude: Number,
    longitude: Number,
    address: String,
    accuracy: Number
  },
  checkOutLocation: {
    latitude: Number,
    longitude: Number,
    address: String,
    accuracy: Number
  },
  checkInPhoto: String,
  checkOutPhoto: String,
  status: {
    type: String,
    enum: ['حاضر', 'غياب', 'متأخر', 'إجازة', 'عطلة', 'مرض', 'وقت مرن'],
    default: 'حاضر'
  },
  latenessMinutes: {
    type: Number,
    default: 0
  },
  overtimeMinutes: {
    type: Number,
    default: 0
  },
  notes: String,
  date: {
    type: Date,
    required: true
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  updatedAt: {
    type: Date,
    default: Date.now
  }
});
AttendanceSchema.index({
  employeeId: 1,
  date: -1
});
AttendanceSchema.index({
  date: -1,
  status: 1
});
AttendanceSchema.index({
  employeeId: 1,
  checkInTime: -1
});
module.exports = mongoose.model('Attendance', AttendanceSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJBdHRlbmRhbmNlU2NoZW1hIiwiU2NoZW1hIiwiZW1wbG95ZWVJZCIsInR5cGUiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwicmVxdWlyZWQiLCJjaGVja0luVGltZSIsIkRhdGUiLCJjaGVja091dFRpbWUiLCJjaGVja0luTG9jYXRpb24iLCJsYXRpdHVkZSIsIk51bWJlciIsImxvbmdpdHVkZSIsImFkZHJlc3MiLCJTdHJpbmciLCJhY2N1cmFjeSIsImNoZWNrT3V0TG9jYXRpb24iLCJjaGVja0luUGhvdG8iLCJjaGVja091dFBob3RvIiwic3RhdHVzIiwiZW51bSIsImRlZmF1bHQiLCJsYXRlbmVzc01pbnV0ZXMiLCJvdmVydGltZU1pbnV0ZXMiLCJub3RlcyIsImRhdGUiLCJjcmVhdGVkQXQiLCJub3ciLCJ1cGRhdGVkQXQiLCJpbmRleCIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VzIjpbIkF0dGVuZGFuY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEF0dGVuZGFuY2UgTW9kZWwgKEhSKVxyXG4gKiBNb2R1bGFyLCBleHRlbnNpYmxlIGF0dGVuZGFuY2UgcmVjb3JkIGZvciBIUiBzeXN0ZW1cclxuICovXHJcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuXHJcbmNvbnN0IEF0dGVuZGFuY2VTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBlbXBsb3llZUlkOiB7XHJcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICByZWY6ICdFbXBsb3llZScsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG4gIGNoZWNrSW5UaW1lOiB7IHR5cGU6IERhdGUsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgY2hlY2tPdXRUaW1lOiBEYXRlLFxyXG4gIGNoZWNrSW5Mb2NhdGlvbjoge1xyXG4gICAgbGF0aXR1ZGU6IE51bWJlcixcclxuICAgIGxvbmdpdHVkZTogTnVtYmVyLFxyXG4gICAgYWRkcmVzczogU3RyaW5nLFxyXG4gICAgYWNjdXJhY3k6IE51bWJlcixcclxuICB9LFxyXG4gIGNoZWNrT3V0TG9jYXRpb246IHtcclxuICAgIGxhdGl0dWRlOiBOdW1iZXIsXHJcbiAgICBsb25naXR1ZGU6IE51bWJlcixcclxuICAgIGFkZHJlc3M6IFN0cmluZyxcclxuICAgIGFjY3VyYWN5OiBOdW1iZXIsXHJcbiAgfSxcclxuICBjaGVja0luUGhvdG86IFN0cmluZyxcclxuICBjaGVja091dFBob3RvOiBTdHJpbmcsXHJcbiAgc3RhdHVzOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICBlbnVtOiBbJ9it2KfYttixJywgJ9i62YrYp9ioJywgJ9mF2KrYo9iu2LEnLCAn2KXYrNin2LLYqScsICfYudi32YTYqScsICfZhdix2LYnLCAn2YjZgtiqINmF2LHZhiddLFxyXG4gICAgZGVmYXVsdDogJ9it2KfYttixJyxcclxuICB9LFxyXG4gIGxhdGVuZXNzTWludXRlczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICBvdmVydGltZU1pbnV0ZXM6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH0sXHJcbiAgbm90ZXM6IFN0cmluZyxcclxuICBkYXRlOiB7IHR5cGU6IERhdGUsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgY3JlYXRlZEF0OiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IERhdGUubm93IH0sXHJcbiAgdXBkYXRlZEF0OiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IERhdGUubm93IH0sXHJcbn0pO1xyXG5cclxuQXR0ZW5kYW5jZVNjaGVtYS5pbmRleCh7IGVtcGxveWVlSWQ6IDEsIGRhdGU6IC0xIH0pO1xyXG5BdHRlbmRhbmNlU2NoZW1hLmluZGV4KHsgZGF0ZTogLTEsIHN0YXR1czogMSB9KTtcclxuQXR0ZW5kYW5jZVNjaGVtYS5pbmRleCh7IGVtcGxveWVlSWQ6IDEsIGNoZWNrSW5UaW1lOiAtMSB9KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoJ0F0dGVuZGFuY2UnLCBBdHRlbmRhbmNlU2NoZW1hKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQyxNQUFNQyxnQkFBZ0IsR0FBRyxJQUFJRixRQUFRLENBQUNHLE1BQU0sQ0FBQztFQUMzQ0MsVUFBVSxFQUFFO0lBQ1ZDLElBQUksRUFBRUwsUUFBUSxDQUFDRyxNQUFNLENBQUNHLEtBQUssQ0FBQ0MsUUFBUTtJQUNwQ0MsR0FBRyxFQUFFLFVBQVU7SUFDZkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxXQUFXLEVBQUU7SUFBRUwsSUFBSSxFQUFFTSxJQUFJO0lBQUVGLFFBQVEsRUFBRTtFQUFLLENBQUM7RUFDM0NHLFlBQVksRUFBRUQsSUFBSTtFQUNsQkUsZUFBZSxFQUFFO0lBQ2ZDLFFBQVEsRUFBRUMsTUFBTTtJQUNoQkMsU0FBUyxFQUFFRCxNQUFNO0lBQ2pCRSxPQUFPLEVBQUVDLE1BQU07SUFDZkMsUUFBUSxFQUFFSjtFQUNaLENBQUM7RUFDREssZ0JBQWdCLEVBQUU7SUFDaEJOLFFBQVEsRUFBRUMsTUFBTTtJQUNoQkMsU0FBUyxFQUFFRCxNQUFNO0lBQ2pCRSxPQUFPLEVBQUVDLE1BQU07SUFDZkMsUUFBUSxFQUFFSjtFQUNaLENBQUM7RUFDRE0sWUFBWSxFQUFFSCxNQUFNO0VBQ3BCSSxhQUFhLEVBQUVKLE1BQU07RUFDckJLLE1BQU0sRUFBRTtJQUNObEIsSUFBSSxFQUFFYSxNQUFNO0lBQ1pNLElBQUksRUFBRSxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFNBQVMsQ0FBQztJQUNsRUMsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEQyxlQUFlLEVBQUU7SUFBRXJCLElBQUksRUFBRVUsTUFBTTtJQUFFVSxPQUFPLEVBQUU7RUFBRSxDQUFDO0VBQzdDRSxlQUFlLEVBQUU7SUFBRXRCLElBQUksRUFBRVUsTUFBTTtJQUFFVSxPQUFPLEVBQUU7RUFBRSxDQUFDO0VBQzdDRyxLQUFLLEVBQUVWLE1BQU07RUFDYlcsSUFBSSxFQUFFO0lBQUV4QixJQUFJLEVBQUVNLElBQUk7SUFBRUYsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUNwQ3FCLFNBQVMsRUFBRTtJQUFFekIsSUFBSSxFQUFFTSxJQUFJO0lBQUVjLE9BQU8sRUFBRWQsSUFBSSxDQUFDb0I7RUFBSSxDQUFDO0VBQzVDQyxTQUFTLEVBQUU7SUFBRTNCLElBQUksRUFBRU0sSUFBSTtJQUFFYyxPQUFPLEVBQUVkLElBQUksQ0FBQ29CO0VBQUk7QUFDN0MsQ0FBQyxDQUFDO0FBRUY3QixnQkFBZ0IsQ0FBQytCLEtBQUssQ0FBQztFQUFFN0IsVUFBVSxFQUFFLENBQUM7RUFBRXlCLElBQUksRUFBRSxDQUFDO0FBQUUsQ0FBQyxDQUFDO0FBQ25EM0IsZ0JBQWdCLENBQUMrQixLQUFLLENBQUM7RUFBRUosSUFBSSxFQUFFLENBQUMsQ0FBQztFQUFFTixNQUFNLEVBQUU7QUFBRSxDQUFDLENBQUM7QUFDL0NyQixnQkFBZ0IsQ0FBQytCLEtBQUssQ0FBQztFQUFFN0IsVUFBVSxFQUFFLENBQUM7RUFBRU0sV0FBVyxFQUFFLENBQUM7QUFBRSxDQUFDLENBQUM7QUFFMUR3QixNQUFNLENBQUNDLE9BQU8sR0FBR25DLFFBQVEsQ0FBQ29DLEtBQUssQ0FBQyxZQUFZLEVBQUVsQyxnQkFBZ0IsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==