9ddfc6b6563fd2014bbad2565f8ae59a
/**
 * Migration Routes
 * API endpoints for managing data migrations
 */

const express = require('express');
const router = express.Router();
const MigrationManager = require('../services/migration/MigrationManager');
const CSVProcessor = require('../services/migration/CSVProcessor');

// Initialize migration manager (would be instantiated in app.js with actual DB connections)
let migrationManager = null;

/**
 * Initialize migration manager
 * POST /api/migrations/initialize
 */
router.post('/initialize', (req, res) => {
  try {
    const {
      sourceDB,
      targetDB
    } = req.body;
    if (!sourceDB || !targetDB) {
      return res.status(400).json({
        success: false,
        error: 'Source and target databases are required'
      });
    }
    migrationManager = new MigrationManager({
      sourceDB,
      targetDB,
      csvProcessor: new CSVProcessor(),
      logger: console
    });
    res.json({
      success: true,
      message: 'Migration manager initialized'
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Create migration plan
 * POST /api/migrations/plan
 */
router.post('/plan', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized. Call /initialize first.'
      });
    }
    const {
      tables,
      options
    } = req.body;
    if (!Array.isArray(tables) || tables.length === 0) {
      return res.status(400).json({
        success: false,
        error: 'Tables array is required and cannot be empty'
      });
    }
    const plan = migrationManager.createMigrationPlan(tables, options);
    res.json({
      success: true,
      plan
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get migration plan
 * GET /api/migrations/plan
 */
router.get('/plan', (req, res) => {
  try {
    if (!migrationManager || !migrationManager.migrationPlan) {
      return res.status(400).json({
        success: false,
        error: 'No migration plan created'
      });
    }
    res.json({
      success: true,
      plan: migrationManager.migrationPlan
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Execute migration plan
 * POST /api/migrations/execute
 */
router.post('/execute', async (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const options = req.body;
    const summary = await migrationManager.executeMigrationPlan(options);
    res.json({
      success: true,
      ...summary
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get execution summary
 * GET /api/migrations/summary
 */
router.get('/summary', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const summary = migrationManager.getExecutionSummary();
    res.json({
      success: true,
      ...summary
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get migration log
 * GET /api/migrations/log
 */
router.get('/log', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const log = migrationManager.getExecutionLog();
    res.json({
      success: true,
      log,
      totalEntries: log.length
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Clear migration log
 * DELETE /api/migrations/log
 */
router.delete('/log', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    migrationManager.clearLog();
    res.json({
      success: true,
      message: 'Migration log cleared'
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Import CSV and migrate to database
 * POST /api/migrations/import-csv
 */
router.post('/import-csv', async (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const {
      csvPath,
      tableName,
      options
    } = req.body;
    if (!csvPath || !tableName) {
      return res.status(400).json({
        success: false,
        error: 'CSV path and table name are required'
      });
    }
    const result = await migrationManager.migrateFromCSV(csvPath, tableName, options);
    res.json({
      success: result.status === 'completed',
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Export table to CSV
 * POST /api/migrations/export-csv
 */
router.post('/export-csv', async (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const {
      tableName,
      csvPath,
      options
    } = req.body;
    if (!tableName || !csvPath) {
      return res.status(400).json({
        success: false,
        error: 'Table name and CSV path are required'
      });
    }
    const result = await migrationManager.exportTableToCSV(tableName, csvPath, options);
    res.json({
      success: result.status === 'completed',
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Sample CSV file
 * POST /api/migrations/sample-csv
 */
router.post('/sample-csv', async (req, res) => {
  try {
    const {
      csvPath,
      sampleSize
    } = req.body;
    if (!csvPath) {
      return res.status(400).json({
        success: false,
        error: 'CSV path is required'
      });
    }
    const csvProcessor = new CSVProcessor();
    const result = await csvProcessor.sampleCSV(csvPath, sampleSize || 10);
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Get CSV info
 * GET /api/migrations/csv-info
 */
router.get('/csv-info', async (req, res) => {
  try {
    const {
      csvPath
    } = req.query;
    if (!csvPath) {
      return res.status(400).json({
        success: false,
        error: 'CSV path is required as query parameter'
      });
    }
    const csvProcessor = new CSVProcessor();
    const info = await csvProcessor.getCSVInfo(csvPath);
    res.json({
      success: true,
      info
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Validate CSV structure
 * POST /api/migrations/validate-csv
 */
router.post('/validate-csv', async (req, res) => {
  try {
    const {
      csvPath,
      expectedColumns
    } = req.body;
    if (!csvPath) {
      return res.status(400).json({
        success: false,
        error: 'CSV path is required'
      });
    }
    const csvProcessor = new CSVProcessor();
    const result = await csvProcessor.validateCSVStructure(csvPath, expectedColumns);
    res.json({
      success: result.valid,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Pause migration
 * POST /api/migrations/pause
 */
router.post('/pause', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const result = migrationManager.pauseMigration();
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Resume migration
 * POST /api/migrations/resume
 */
router.post('/resume', (req, res) => {
  try {
    if (!migrationManager) {
      return res.status(400).json({
        success: false,
        error: 'Migration manager not initialized'
      });
    }
    const result = migrationManager.resumeMigration();
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

/**
 * Set migration manager instance
 * Called during app initialization
 */
function setMigrationManager(manager) {
  migrationManager = manager;
}
module.exports = router;
module.exports.setMigrationManager = setMigrationManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIk1pZ3JhdGlvbk1hbmFnZXIiLCJDU1ZQcm9jZXNzb3IiLCJtaWdyYXRpb25NYW5hZ2VyIiwicG9zdCIsInJlcSIsInJlcyIsInNvdXJjZURCIiwidGFyZ2V0REIiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsImNzdlByb2Nlc3NvciIsImxvZ2dlciIsImNvbnNvbGUiLCJtZXNzYWdlIiwidGFibGVzIiwib3B0aW9ucyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInBsYW4iLCJjcmVhdGVNaWdyYXRpb25QbGFuIiwiZ2V0IiwibWlncmF0aW9uUGxhbiIsInN1bW1hcnkiLCJleGVjdXRlTWlncmF0aW9uUGxhbiIsImdldEV4ZWN1dGlvblN1bW1hcnkiLCJsb2ciLCJnZXRFeGVjdXRpb25Mb2ciLCJ0b3RhbEVudHJpZXMiLCJkZWxldGUiLCJjbGVhckxvZyIsImNzdlBhdGgiLCJ0YWJsZU5hbWUiLCJyZXN1bHQiLCJtaWdyYXRlRnJvbUNTViIsImV4cG9ydFRhYmxlVG9DU1YiLCJzYW1wbGVTaXplIiwic2FtcGxlQ1NWIiwicXVlcnkiLCJpbmZvIiwiZ2V0Q1NWSW5mbyIsImV4cGVjdGVkQ29sdW1ucyIsInZhbGlkYXRlQ1NWU3RydWN0dXJlIiwidmFsaWQiLCJwYXVzZU1pZ3JhdGlvbiIsInJlc3VtZU1pZ3JhdGlvbiIsInNldE1pZ3JhdGlvbk1hbmFnZXIiLCJtYW5hZ2VyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIm1pZ3JhdGlvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIE1pZ3JhdGlvbiBSb3V0ZXNcclxuICogQVBJIGVuZHBvaW50cyBmb3IgbWFuYWdpbmcgZGF0YSBtaWdyYXRpb25zXHJcbiAqL1xyXG5cclxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgTWlncmF0aW9uTWFuYWdlciA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL21pZ3JhdGlvbi9NaWdyYXRpb25NYW5hZ2VyJyk7XHJcbmNvbnN0IENTVlByb2Nlc3NvciA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL21pZ3JhdGlvbi9DU1ZQcm9jZXNzb3InKTtcclxuXHJcbi8vIEluaXRpYWxpemUgbWlncmF0aW9uIG1hbmFnZXIgKHdvdWxkIGJlIGluc3RhbnRpYXRlZCBpbiBhcHAuanMgd2l0aCBhY3R1YWwgREIgY29ubmVjdGlvbnMpXHJcbmxldCBtaWdyYXRpb25NYW5hZ2VyID0gbnVsbDtcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIG1pZ3JhdGlvbiBtYW5hZ2VyXHJcbiAqIFBPU1QgL2FwaS9taWdyYXRpb25zL2luaXRpYWxpemVcclxuICovXHJcbnJvdXRlci5wb3N0KCcvaW5pdGlhbGl6ZScsIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IHNvdXJjZURCLCB0YXJnZXREQiB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgaWYgKCFzb3VyY2VEQiB8fCAhdGFyZ2V0REIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1NvdXJjZSBhbmQgdGFyZ2V0IGRhdGFiYXNlcyBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtaWdyYXRpb25NYW5hZ2VyID0gbmV3IE1pZ3JhdGlvbk1hbmFnZXIoe1xyXG4gICAgICBzb3VyY2VEQixcclxuICAgICAgdGFyZ2V0REIsXHJcbiAgICAgIGNzdlByb2Nlc3NvcjogbmV3IENTVlByb2Nlc3NvcigpLFxyXG4gICAgICBsb2dnZXI6IGNvbnNvbGUsXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICdNaWdyYXRpb24gbWFuYWdlciBpbml0aWFsaXplZCcsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBtaWdyYXRpb24gcGxhblxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9wbGFuXHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL3BsYW4nLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQuIENhbGwgL2luaXRpYWxpemUgZmlyc3QuJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyB0YWJsZXMsIG9wdGlvbnMgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIGlmICghQXJyYXkuaXNBcnJheSh0YWJsZXMpIHx8IHRhYmxlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1RhYmxlcyBhcnJheSBpcyByZXF1aXJlZCBhbmQgY2Fubm90IGJlIGVtcHR5JyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcGxhbiA9IG1pZ3JhdGlvbk1hbmFnZXIuY3JlYXRlTWlncmF0aW9uUGxhbih0YWJsZXMsIG9wdGlvbnMpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgcGxhbixcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogR2V0IG1pZ3JhdGlvbiBwbGFuXHJcbiAqIEdFVCAvYXBpL21pZ3JhdGlvbnMvcGxhblxyXG4gKi9cclxucm91dGVyLmdldCgnL3BsYW4nLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyIHx8ICFtaWdyYXRpb25NYW5hZ2VyLm1pZ3JhdGlvblBsYW4pIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ05vIG1pZ3JhdGlvbiBwbGFuIGNyZWF0ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIHBsYW46IG1pZ3JhdGlvbk1hbmFnZXIubWlncmF0aW9uUGxhbixcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogRXhlY3V0ZSBtaWdyYXRpb24gcGxhblxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9leGVjdXRlXHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL2V4ZWN1dGUnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gcmVxLmJvZHk7XHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgbWlncmF0aW9uTWFuYWdlci5leGVjdXRlTWlncmF0aW9uUGxhbihvcHRpb25zKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIC4uLnN1bW1hcnksXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEdldCBleGVjdXRpb24gc3VtbWFyeVxyXG4gKiBHRVQgL2FwaS9taWdyYXRpb25zL3N1bW1hcnlcclxuICovXHJcbnJvdXRlci5nZXQoJy9zdW1tYXJ5JywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghbWlncmF0aW9uTWFuYWdlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnTWlncmF0aW9uIG1hbmFnZXIgbm90IGluaXRpYWxpemVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3VtbWFyeSA9IG1pZ3JhdGlvbk1hbmFnZXIuZ2V0RXhlY3V0aW9uU3VtbWFyeSgpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgLi4uc3VtbWFyeSxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogR2V0IG1pZ3JhdGlvbiBsb2dcclxuICogR0VUIC9hcGkvbWlncmF0aW9ucy9sb2dcclxuICovXHJcbnJvdXRlci5nZXQoJy9sb2cnLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsb2cgPSBtaWdyYXRpb25NYW5hZ2VyLmdldEV4ZWN1dGlvbkxvZygpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbG9nLFxyXG4gICAgICB0b3RhbEVudHJpZXM6IGxvZy5sZW5ndGgsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIENsZWFyIG1pZ3JhdGlvbiBsb2dcclxuICogREVMRVRFIC9hcGkvbWlncmF0aW9ucy9sb2dcclxuICovXHJcbnJvdXRlci5kZWxldGUoJy9sb2cnLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtaWdyYXRpb25NYW5hZ2VyLmNsZWFyTG9nKCk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBtZXNzYWdlOiAnTWlncmF0aW9uIGxvZyBjbGVhcmVkJyxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogSW1wb3J0IENTViBhbmQgbWlncmF0ZSB0byBkYXRhYmFzZVxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9pbXBvcnQtY3N2XHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL2ltcG9ydC1jc3YnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFtaWdyYXRpb25NYW5hZ2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdNaWdyYXRpb24gbWFuYWdlciBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGNzdlBhdGgsIHRhYmxlTmFtZSwgb3B0aW9ucyB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgaWYgKCFjc3ZQYXRoIHx8ICF0YWJsZU5hbWUpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0NTViBwYXRoIGFuZCB0YWJsZSBuYW1lIGFyZSByZXF1aXJlZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbk1hbmFnZXIubWlncmF0ZUZyb21DU1YoY3N2UGF0aCwgdGFibGVOYW1lLCBvcHRpb25zKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHJlc3VsdC5zdGF0dXMgPT09ICdjb21wbGV0ZWQnLFxyXG4gICAgICAuLi5yZXN1bHQsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEV4cG9ydCB0YWJsZSB0byBDU1ZcclxuICogUE9TVCAvYXBpL21pZ3JhdGlvbnMvZXhwb3J0LWNzdlxyXG4gKi9cclxucm91dGVyLnBvc3QoJy9leHBvcnQtY3N2JywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghbWlncmF0aW9uTWFuYWdlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnTWlncmF0aW9uIG1hbmFnZXIgbm90IGluaXRpYWxpemVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyB0YWJsZU5hbWUsIGNzdlBhdGgsIG9wdGlvbnMgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIGlmICghdGFibGVOYW1lIHx8ICFjc3ZQYXRoKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdUYWJsZSBuYW1lIGFuZCBDU1YgcGF0aCBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtaWdyYXRpb25NYW5hZ2VyLmV4cG9ydFRhYmxlVG9DU1YodGFibGVOYW1lLCBjc3ZQYXRoLCBvcHRpb25zKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHJlc3VsdC5zdGF0dXMgPT09ICdjb21wbGV0ZWQnLFxyXG4gICAgICAuLi5yZXN1bHQsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFNhbXBsZSBDU1YgZmlsZVxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9zYW1wbGUtY3N2XHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL3NhbXBsZS1jc3YnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBjc3ZQYXRoLCBzYW1wbGVTaXplIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICBpZiAoIWNzdlBhdGgpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0NTViBwYXRoIGlzIHJlcXVpcmVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY3N2UHJvY2Vzc29yID0gbmV3IENTVlByb2Nlc3NvcigpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLnNhbXBsZUNTVihjc3ZQYXRoLCBzYW1wbGVTaXplIHx8IDEwKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIC4uLnJlc3VsdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogR2V0IENTViBpbmZvXHJcbiAqIEdFVCAvYXBpL21pZ3JhdGlvbnMvY3N2LWluZm9cclxuICovXHJcbnJvdXRlci5nZXQoJy9jc3YtaW5mbycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNzdlBhdGggfSA9IHJlcS5xdWVyeTtcclxuXHJcbiAgICBpZiAoIWNzdlBhdGgpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0NTViBwYXRoIGlzIHJlcXVpcmVkIGFzIHF1ZXJ5IHBhcmFtZXRlcicsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNzdlByb2Nlc3NvciA9IG5ldyBDU1ZQcm9jZXNzb3IoKTtcclxuICAgIGNvbnN0IGluZm8gPSBhd2FpdCBjc3ZQcm9jZXNzb3IuZ2V0Q1NWSW5mbyhjc3ZQYXRoKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGluZm8sXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIENTViBzdHJ1Y3R1cmVcclxuICogUE9TVCAvYXBpL21pZ3JhdGlvbnMvdmFsaWRhdGUtY3N2XHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL3ZhbGlkYXRlLWNzdicsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNzdlBhdGgsIGV4cGVjdGVkQ29sdW1ucyB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgaWYgKCFjc3ZQYXRoKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdDU1YgcGF0aCBpcyByZXF1aXJlZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNzdlByb2Nlc3NvciA9IG5ldyBDU1ZQcm9jZXNzb3IoKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNzdlByb2Nlc3Nvci52YWxpZGF0ZUNTVlN0cnVjdHVyZShjc3ZQYXRoLCBleHBlY3RlZENvbHVtbnMpO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogcmVzdWx0LnZhbGlkLFxyXG4gICAgICAuLi5yZXN1bHQsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFBhdXNlIG1pZ3JhdGlvblxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9wYXVzZVxyXG4gKi9cclxucm91dGVyLnBvc3QoJy9wYXVzZScsIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIW1pZ3JhdGlvbk1hbmFnZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01pZ3JhdGlvbiBtYW5hZ2VyIG5vdCBpbml0aWFsaXplZCcsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IG1pZ3JhdGlvbk1hbmFnZXIucGF1c2VNaWdyYXRpb24oKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIC4uLnJlc3VsdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogUmVzdW1lIG1pZ3JhdGlvblxyXG4gKiBQT1NUIC9hcGkvbWlncmF0aW9ucy9yZXN1bWVcclxuICovXHJcbnJvdXRlci5wb3N0KCcvcmVzdW1lJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghbWlncmF0aW9uTWFuYWdlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnTWlncmF0aW9uIG1hbmFnZXIgbm90IGluaXRpYWxpemVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gbWlncmF0aW9uTWFuYWdlci5yZXN1bWVNaWdyYXRpb24oKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIC4uLnJlc3VsdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vKipcclxuICogU2V0IG1pZ3JhdGlvbiBtYW5hZ2VyIGluc3RhbmNlXHJcbiAqIENhbGxlZCBkdXJpbmcgYXBwIGluaXRpYWxpemF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRNaWdyYXRpb25NYW5hZ2VyKG1hbmFnZXIpIHtcclxuICBtaWdyYXRpb25NYW5hZ2VyID0gbWFuYWdlcjtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XHJcbm1vZHVsZS5leHBvcnRzLnNldE1pZ3JhdGlvbk1hbmFnZXIgPSBzZXRNaWdyYXRpb25NYW5hZ2VyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsZ0JBQWdCLEdBQUdILE9BQU8sQ0FBQyx3Q0FBd0MsQ0FBQztBQUMxRSxNQUFNSSxZQUFZLEdBQUdKLE9BQU8sQ0FBQyxvQ0FBb0MsQ0FBQzs7QUFFbEU7QUFDQSxJQUFJSyxnQkFBZ0IsR0FBRyxJQUFJOztBQUUzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBSixNQUFNLENBQUNLLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDdkMsSUFBSTtJQUNGLE1BQU07TUFBRUMsUUFBUTtNQUFFQztJQUFTLENBQUMsR0FBR0gsR0FBRyxDQUFDSSxJQUFJO0lBRXZDLElBQUksQ0FBQ0YsUUFBUSxJQUFJLENBQUNDLFFBQVEsRUFBRTtNQUMxQixPQUFPRixHQUFHLENBQUNJLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQzFCQyxPQUFPLEVBQUUsS0FBSztRQUNkQyxLQUFLLEVB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