{"version":3,"names":["GPSTrackingService","require","GPSLocation","GPSTrackingController","recordLocation","req","res","driverId","coordinates","speed","heading","altitude","accuracy","satellites","acceleration","seatbeltStatus","engineRunning","body","status","json","success","message","location","error","console","getCurrentLocation","params","lat","lon","timestamp","alerts","getActiveAlerts","getRouteMap","startTime","endTime","query","routeMap","Date","route","getBehaviorReport","now","_dayStart","getFullYear","getMonth","getDate","report","findNearbyDrivers","longitude","latitude","distance","drivers","parseFloat","parseInt","driversCount","length","map","d","driver","getDistanceTo","getFleetStatistics","timeRange","stats","getLocationHistory","limit","locations","getLocationsInTimeRange","lean","locationsCount","loc","acknowledgeAlert","locationId","alertIndex","acknowledgedBy","findById","find","select","sort","activeAlerts","flatMap","alert","toObject","_id","alertsCount","exportTrackingData","format","csvHeader","csvData","join","setHeader","send","module","exports"],"sources":["gpsTracking.controller.js"],"sourcesContent":["/**\r\n * GPS Tracking Controller\r\n * متحكم تتبع GPS المتقدم\r\n */\r\n\r\nconst GPSTrackingService = require('../services/gpsTrackingService');\r\nconst GPSLocation = require('../models/GPSLocation');\r\n\r\nclass GPSTrackingController {\r\n  /**\r\n   * تسجيل موقع جديد (WebSocket/Real-time)\r\n   * POST /api/gps/location\r\n   */\r\n  static async recordLocation(req, res) {\r\n    try {\r\n      const { driverId, coordinates, speed, heading, altitude, accuracy, satellites, acceleration, seatbeltStatus, engineRunning } =\r\n        req.body;\r\n\r\n      // التحقق من المدخلات\r\n      if (!driverId || !coordinates) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف السائق والإحداثيات مطلوبة',\r\n        });\r\n      }\r\n\r\n      // تسجيل الموقع\r\n      const location = await GPSTrackingService.recordLocation(driverId, {\r\n        coordinates,\r\n        speed: speed || 0,\r\n        heading,\r\n        altitude,\r\n        accuracy,\r\n        satellites,\r\n        acceleration,\r\n        seatbeltStatus,\r\n        engineRunning,\r\n      });\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: 'تم تسجيل الموقع بنجاح',\r\n        location,\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في تسجيل الموقع:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على الموقع الحالي\r\n   * GET /api/gps/location/:driverId\r\n   */\r\n  static async getCurrentLocation(req, res) {\r\n    try {\r\n      const { driverId } = req.params;\r\n\r\n      const location = await GPSTrackingService.getCurrentLocation(driverId);\r\n\r\n      if (!location) {\r\n        return res.status(404).json({\r\n          success: false,\r\n          message: 'لا يوجد موقع متاح للسائق',\r\n        });\r\n      }\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        location: {\r\n          lat: location.lat,\r\n          lon: location.lon,\r\n          speed: location.speed,\r\n          heading: location.heading,\r\n          accuracy: location.accuracy,\r\n          timestamp: location.timestamp,\r\n          alerts: location.getActiveAlerts(),\r\n        },\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في جلب الموقع الحالي:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على خريطة المسار\r\n   * GET /api/gps/route/:driverId?startTime=...&endTime=...\r\n   */\r\n  static async getRouteMap(req, res) {\r\n    try {\r\n      const { driverId } = req.params;\r\n      const { startTime, endTime } = req.query;\r\n\r\n      if (!startTime || !endTime) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'startTime و endTime مطلوبة',\r\n        });\r\n      }\r\n\r\n      const routeMap = await GPSTrackingService.getRouteMap(\r\n        driverId,\r\n        new Date(startTime),\r\n        new Date(endTime)\r\n      );\r\n\r\n      if (!routeMap) {\r\n        return res.status(404).json({\r\n          success: false,\r\n          message: 'لا توجد بيانات مسار متاحة',\r\n        });\r\n      }\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        route: routeMap,\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في جلب المسار:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على تقرير السلوك\r\n   * GET /api/gps/behavior/:driverId?startTime=...&endTime=...\r\n   */\r\n  static async getBehaviorReport(req, res) {\r\n    try {\r\n      const { driverId } = req.params;\r\n      const { startTime, endTime } = req.query;\r\n\r\n      if (!startTime || !endTime) {\r\n        // استخدام اليوم الحالي كقيمة افتراضية\r\n        const now = new Date();\r\n        const _dayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());\r\n\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'startTime و endTime مطلوبة',\r\n        });\r\n      }\r\n\r\n      const report = await GPSTrackingService.getBehaviorReport(\r\n        driverId,\r\n        new Date(startTime),\r\n        new Date(endTime)\r\n      );\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        report,\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في جلب تقرير السلوك:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * البحث عن السائقين بالقرب من موقع\r\n   * GET /api/gps/nearby?longitude=...&latitude=...&distance=...\r\n   */\r\n  static async findNearbyDrivers(req, res) {\r\n    try {\r\n      const { longitude, latitude, distance = 1000 } = req.query;\r\n\r\n      if (!longitude || !latitude) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'longitude و latitude مطلوبة',\r\n        });\r\n      }\r\n\r\n      const drivers = await GPSTrackingService.findNearbyDrivers(\r\n        parseFloat(longitude),\r\n        parseFloat(latitude),\r\n        parseInt(distance)\r\n      );\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        driversCount: drivers.length,\r\n        drivers: drivers.map((d) => ({\r\n          driverId: d.driver,\r\n          lat: d.lat,\r\n          lon: d.lon,\r\n          speed: d.speed,\r\n          distance: d.getDistanceTo({ location: { coordinates: [longitude, latitude] } }),\r\n        })),\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في البحث عن السائقين:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على إحصائيات الأسطول\r\n   * GET /api/gps/fleet-stats?timeRange=today\r\n   */\r\n  static async getFleetStatistics(req, res) {\r\n    try {\r\n      const { timeRange = 'today', driverId } = req.query;\r\n\r\n      const stats = await GPSTrackingService.getFleetStatistics(driverId, timeRange);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        stats,\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في جلب إحصائيات الأسطول:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على سجل الموقع الكامل\r\n   * GET /api/gps/history/:driverId?startTime=...&endTime=...&limit=100\r\n   */\r\n  static async getLocationHistory(req, res) {\r\n    try {\r\n      const { driverId } = req.params;\r\n      const { startTime, endTime, limit = 100 } = req.query;\r\n\r\n      if (!startTime || !endTime) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'startTime و endTime مطلوبة',\r\n        });\r\n      }\r\n\r\n      const locations = await GPSLocation.getLocationsInTimeRange(\r\n        driverId,\r\n        new Date(startTime),\r\n        new Date(endTime)\r\n      )\r\n        .limit(parseInt(limit))\r\n        .lean();\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        locationsCount: locations.length,\r\n        locations: locations.map((loc) => ({\r\n          lat: loc.location.coordinates[1],\r\n          lon: loc.location.coordinates[0],\r\n          speed: loc.speed,\r\n          accuracy: loc.accuracy,\r\n          timestamp: loc.timestamp,\r\n        })),\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في جلب السجل:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تأكيد تنبيه\r\n   * POST /api/gps/acknowledge-alert/:locationId/:alertIndex\r\n   */\r\n  static async acknowledgeAlert(req, res) {\r\n    try {\r\n      const { locationId, alertIndex } = req.params;\r\n      const { acknowledgedBy } = req.body;\r\n\r\n      const location = await GPSLocation.findById(locationId);\r\n\r\n      if (!location) {\r\n        return res.status(404).json({\r\n          success: false,\r\n          message: 'الموقع غير موجود',\r\n        });\r\n      }\r\n\r\n      await location.acknowledgeAlert(parseInt(alertIndex), acknowledgedBy);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'تم تأكيد التنبيه',\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في تأكيد التنبيه:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على التنبيهات النشطة\r\n   * GET /api/gps/active-alerts/:driverId\r\n   */\r\n  static async getActiveAlerts(req, res) {\r\n    try {\r\n      const { driverId } = req.params;\r\n      const { limit = 10 } = req.query;\r\n\r\n      const locations = await GPSLocation.find({ driver: driverId, 'alerts.acknowledged': false })\r\n        .select('alerts timestamp')\r\n        .limit(parseInt(limit))\r\n        .sort({ timestamp: -1 });\r\n\r\n      const activeAlerts = locations.flatMap((loc) =>\r\n        loc.getActiveAlerts().map((alert) => ({\r\n          ...alert.toObject(),\r\n          locationId: loc._id,\r\n          timestamp: loc.timestamp,\r\n        }))\r\n      );\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        alertsCount: activeAlerts.length,\r\n        alerts: activeAlerts,\r\n      });\r\n    } catch (error) {\r\n      console.error('خطأ في جلب التنبيهات:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تصدير بيانات تتبع (CSV/PDF)\r\n   * GET /api/gps/export/:driverId?format=csv&startTime=...&endTime=...\r\n   */\r\n  static async exportTrackingData(req, res) {\r\n    try {\r\n      const { driverId } = req.params;\r\n      const { format = 'csv', startTime, endTime } = req.query;\r\n\r\n      if (!startTime || !endTime) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'startTime و endTime مطلوبة',\r\n        });\r\n      }\r\n\r\n      const locations = await GPSLocation.getLocationsInTimeRange(\r\n        driverId,\r\n        new Date(startTime),\r\n        new Date(endTime)\r\n      );\r\n\r\n      if (format === 'csv') {\r\n        // تحويل إلى CSV\r\n        const csvHeader = 'DateTime,Latitude,Longitude,Speed,Heading,Accuracy\\n';\r\n        const csvData = locations\r\n          .map((loc) => `${loc.timestamp},${loc.lat},${loc.lon},${loc.speed},${loc.heading},${loc.accuracy}`)\r\n          .join('\\n');\r\n\r\n        res.setHeader('Content-Type', 'text/csv');\r\n        res.setHeader('Content-Disposition', `attachment; filename=\"tracking_${driverId}.csv\"`);\r\n        res.send(csvHeader + csvData);\r\n      } else {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'الصيغة المطلوبة غير مدعومة',\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('خطأ في تصدير البيانات:', error);\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = GPSTrackingController;\r\n"],"mappings":"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","ignoreList":[]}