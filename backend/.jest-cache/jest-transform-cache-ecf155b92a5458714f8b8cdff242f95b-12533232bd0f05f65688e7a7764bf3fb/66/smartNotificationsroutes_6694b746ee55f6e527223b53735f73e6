83293674af7a52ae895ff0cf62950668
/**
 * مسارات الإشعارات الذكية
 * Smart Notifications Routes
 */

const express = require('express');
const router = express.Router();
const SmartNotificationsController = require('../controllers/smartNotifications.controller');
const {
  protect,
  authorize
} = require('../middleware/auth');

// جميع المسارات تتطلب المصادقة
router.use(protect);

// ========== إدارة الإشعارات ==========

/**
 * @route   POST /api/notifications/smart/create
 * @desc    إنشاء إشعار ذكي
 * @access  Private
 */
router.post('/create', SmartNotificationsController.createNotification);

/**
 * @route   POST /api/notifications/smart/broadcast
 * @desc    إرسال إشعار مجموعي
 * @access  Private (Admin, Manager)
 */
router.post('/broadcast', authorize('admin', 'manager'), SmartNotificationsController.broadcastNotification);

/**
 * @route   GET /api/notifications/smart/list
 * @desc    جلب إشعارات المستخدم
 * @access  Private
 */
router.get('/list', SmartNotificationsController.getNotifications);

/**
 * @route   GET /api/notifications/smart/stats
 * @desc    جلب إحصائيات الإشعارات
 * @access  Private
 */
router.get('/stats', SmartNotificationsController.getStats);

/**
 * @route   GET /api/notifications/smart/performance
 * @desc    جلب تقرير أداء الإشعارات
 * @access  Private
 */
router.get('/performance', SmartNotificationsController.getPerformanceReport);

// ========== تفضيلات الإشعارات ==========

/**
 * @route   PATCH /api/notifications/smart/preferences
 * @desc    تحديث تفضيلات الإشعارات
 * @access  Private
 */
router.patch('/preferences', SmartNotificationsController.updatePreferences);

// ========== التفاعل والحذف ==========

/**
 * @route   POST /api/notifications/smart/:notificationId/interact
 * @desc    تسجيل التفاعل مع الإشعار
 * @access  Private
 */
router.post('/:notificationId/interact', SmartNotificationsController.recordInteraction);

/**
 * @route   DELETE /api/notifications/smart/:notificationId
 * @desc    حذف إشعار محدد
 * @access  Private
 */
router.delete('/:notificationId', SmartNotificationsController.deleteNotification);

/**
 * @route   DELETE /api/notifications/smart/all
 * @desc    حذف جميع إشعارات المستخدم
 * @access  Private
 */
router.delete('/', SmartNotificationsController.clearAllNotifications);

// ========== معالجة الطابور (Admin only) ==========

/**
 * @route   POST /api/notifications/smart/process-queue
 * @desc    معالجة طابور الإشعارات
 * @access  Private (Admin)
 */
router.post('/process-queue', authorize('admin'), SmartNotificationsController.processQueue);
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIlNtYXJ0Tm90aWZpY2F0aW9uc0NvbnRyb2xsZXIiLCJwcm90ZWN0IiwiYXV0aG9yaXplIiwidXNlIiwicG9zdCIsImNyZWF0ZU5vdGlmaWNhdGlvbiIsImJyb2FkY2FzdE5vdGlmaWNhdGlvbiIsImdldCIsImdldE5vdGlmaWNhdGlvbnMiLCJnZXRTdGF0cyIsImdldFBlcmZvcm1hbmNlUmVwb3J0IiwicGF0Y2giLCJ1cGRhdGVQcmVmZXJlbmNlcyIsInJlY29yZEludGVyYWN0aW9uIiwiZGVsZXRlIiwiZGVsZXRlTm90aWZpY2F0aW9uIiwiY2xlYXJBbGxOb3RpZmljYXRpb25zIiwicHJvY2Vzc1F1ZXVlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNtYXJ0Tm90aWZpY2F0aW9ucy5yb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqINmF2LPYp9ix2KfYqiDYp9mE2KXYtNi52KfYsdin2Kog2KfZhNiw2YPZitipXHJcbiAqIFNtYXJ0IE5vdGlmaWNhdGlvbnMgUm91dGVzXHJcbiAqL1xyXG5cclxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgU21hcnROb3RpZmljYXRpb25zQ29udHJvbGxlciA9IHJlcXVpcmUoJy4uL2NvbnRyb2xsZXJzL3NtYXJ0Tm90aWZpY2F0aW9ucy5jb250cm9sbGVyJyk7XHJcbmNvbnN0IHsgcHJvdGVjdCwgYXV0aG9yaXplIH0gPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlL2F1dGgnKTtcclxuXHJcbi8vINis2YXZiti5INin2YTZhdiz2KfYsdin2Kog2KrYqti32YTYqCDYp9mE2YXYtdin2K/ZgtipXHJcbnJvdXRlci51c2UocHJvdGVjdCk7XHJcblxyXG4vLyA9PT09PT09PT09INil2K/Yp9ix2Kkg2KfZhNil2LTYudin2LHYp9iqID09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAcm91dGUgICBQT1NUIC9hcGkvbm90aWZpY2F0aW9ucy9zbWFydC9jcmVhdGVcclxuICogQGRlc2MgICAg2KXZhti02KfYoSDYpdi02LnYp9ixINiw2YPZilxyXG4gKiBAYWNjZXNzICBQcml2YXRlXHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL2NyZWF0ZScsIFNtYXJ0Tm90aWZpY2F0aW9uc0NvbnRyb2xsZXIuY3JlYXRlTm90aWZpY2F0aW9uKTtcclxuXHJcbi8qKlxyXG4gKiBAcm91dGUgICBQT1NUIC9hcGkvbm90aWZpY2F0aW9ucy9zbWFydC9icm9hZGNhc3RcclxuICogQGRlc2MgICAg2KXYsdiz2KfZhCDYpdi02LnYp9ixINmF2KzZhdmI2LnZilxyXG4gKiBAYWNjZXNzICBQcml2YXRlIChBZG1pbiwgTWFuYWdlcilcclxuICovXHJcbnJvdXRlci5wb3N0KFxyXG4gICcvYnJvYWRjYXN0JyxcclxuICBhdXRob3JpemUoJ2FkbWluJywgJ21hbmFnZXInKSxcclxuICBTbWFydE5vdGlmaWNhdGlvbnNDb250cm9sbGVyLmJyb2FkY2FzdE5vdGlmaWNhdGlvblxyXG4pO1xyXG5cclxuLyoqXHJcbiAqIEByb3V0ZSAgIEdFVCAvYXBpL25vdGlmaWNhdGlvbnMvc21hcnQvbGlzdFxyXG4gKiBAZGVzYyAgICDYrNmE2Kgg2KXYtNi52KfYsdin2Kog2KfZhNmF2LPYqtiu2K/ZhVxyXG4gKiBAYWNjZXNzICBQcml2YXRlXHJcbiAqL1xyXG5yb3V0ZXIuZ2V0KCcvbGlzdCcsIFNtYXJ0Tm90aWZpY2F0aW9uc0NvbnRyb2xsZXIuZ2V0Tm90aWZpY2F0aW9ucyk7XHJcblxyXG4vKipcclxuICogQHJvdXRlICAgR0VUIC9hcGkvbm90aWZpY2F0aW9ucy9zbWFydC9zdGF0c1xyXG4gKiBAZGVzYyAgICDYrNmE2Kgg2KXYrdi12KfYptmK2KfYqiDYp9mE2KXYtNi52KfYsdin2KpcclxuICogQGFjY2VzcyAgUHJpdmF0ZVxyXG4gKi9cclxucm91dGVyLmdldCgnL3N0YXRzJywgU21hcnROb3RpZmljYXRpb25zQ29udHJvbGxlci5nZXRTdGF0cyk7XHJcblxyXG4vKipcclxuICogQHJvdXRlICAgR0VUIC9hcGkvbm90aWZpY2F0aW9ucy9zbWFydC9wZXJmb3JtYW5jZVxyXG4gKiBAZGVzYyAgICDYrNmE2Kgg2KrZgtix2YrYsSDYo9iv2KfYoSDYp9mE2KXYtNi52KfYsdin2KpcclxuICogQGFjY2VzcyAgUHJpdmF0ZVxyXG4gKi9cclxucm91dGVyLmdldCgnL3BlcmZvcm1hbmNlJywgU21hcnROb3RpZmljYXRpb25zQ29udHJvbGxlci5nZXRQZXJmb3JtYW5jZVJlcG9ydCk7XHJcblxyXG4vLyA9PT09PT09PT09INiq2YHYttmK2YTYp9iqINin2YTYpdi02LnYp9ix2KfYqiA9PT09PT09PT09XHJcblxyXG4vKipcclxuICogQHJvdXRlICAgUEFUQ0ggL2FwaS9ub3RpZmljYXRpb25zL3NtYXJ0L3ByZWZlcmVuY2VzXHJcbiAqIEBkZXNjICAgINiq2K3Yr9mK2Ksg2KrZgdi22YrZhNin2Kog2KfZhNil2LTYudin2LHYp9iqXHJcbiAqIEBhY2Nlc3MgIFByaXZhdGVcclxuICovXHJcbnJvdXRlci5wYXRjaCgnL3ByZWZlcmVuY2VzJywgU21hcnROb3RpZmljYXRpb25zQ29udHJvbGxlci51cGRhdGVQcmVmZXJlbmNlcyk7XHJcblxyXG4vLyA9PT09PT09PT09INin2YTYqtmB2KfYudmEINmI2KfZhNit2LDZgSA9PT09PT09PT09XHJcblxyXG4vKipcclxuICogQHJvdXRlICAgUE9TVCAvYXBpL25vdGlmaWNhdGlvbnMvc21hcnQvOm5vdGlmaWNhdGlvbklkL2ludGVyYWN0XHJcbiAqIEBkZXNjICAgINiq2LPYrNmK2YQg2KfZhNiq2YHYp9i52YQg2YXYuSDYp9mE2KXYtNi52KfYsVxyXG4gKiBAYWNjZXNzICBQcml2YXRlXHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnLzpub3RpZmljYXRpb25JZC9pbnRlcmFjdCcsIFNtYXJ0Tm90aWZpY2F0aW9uc0NvbnRyb2xsZXIucmVjb3JkSW50ZXJhY3Rpb24pO1xyXG5cclxuLyoqXHJcbiAqIEByb3V0ZSAgIERFTEVURSAvYXBpL25vdGlmaWNhdGlvbnMvc21hcnQvOm5vdGlmaWNhdGlvbklkXHJcbiAqIEBkZXNjICAgINit2LDZgSDYpdi02LnYp9ixINmF2K3Yr9ivXHJcbiAqIEBhY2Nlc3MgIFByaXZhdGVcclxuICovXHJcbnJvdXRlci5kZWxldGUoJy86bm90aWZpY2F0aW9uSWQnLCBTbWFydE5vdGlmaWNhdGlvbnNDb250cm9sbGVyLmRlbGV0ZU5vdGlmaWNhdGlvbik7XHJcblxyXG4vKipcclxuICogQHJvdXRlICAgREVMRVRFIC9hcGkvbm90aWZpY2F0aW9ucy9zbWFydC9hbGxcclxuICogQGRlc2MgICAg2K3YsNmBINis2YXZiti5INil2LTYudin2LHYp9iqINin2YTZhdiz2KrYrtiv2YVcclxuICogQGFjY2VzcyAgUHJpdmF0ZVxyXG4gKi9cclxucm91dGVyLmRlbGV0ZSgnLycsIFNtYXJ0Tm90aWZpY2F0aW9uc0NvbnRyb2xsZXIuY2xlYXJBbGxOb3RpZmljYXRpb25zKTtcclxuXHJcbi8vID09PT09PT09PT0g2YXYudin2YTYrNipINin2YTYt9in2KjZiNixIChBZG1pbiBvbmx5KSA9PT09PT09PT09XHJcblxyXG4vKipcclxuICogQHJvdXRlICAgUE9TVCAvYXBpL25vdGlmaWNhdGlvbnMvc21hcnQvcHJvY2Vzcy1xdWV1ZVxyXG4gKiBAZGVzYyAgICDZhdi52KfZhNis2Kkg2LfYp9io2YjYsSDYp9mE2KXYtNi52KfYsdin2KpcclxuICogQGFjY2VzcyAgUHJpdmF0ZSAoQWRtaW4pXHJcbiAqL1xyXG5yb3V0ZXIucG9zdCgnL3Byb2Nlc3MtcXVldWUnLCBhdXRob3JpemUoJ2FkbWluJyksIFNtYXJ0Tm90aWZpY2F0aW9uc0NvbnRyb2xsZXIucHJvY2Vzc1F1ZXVlKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsNEJBQTRCLEdBQUdILE9BQU8sQ0FBQyw4Q0FBOEMsQ0FBQztBQUM1RixNQUFNO0VBQUVJLE9BQU87RUFBRUM7QUFBVSxDQUFDLEdBQUdMLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQzs7QUFFNUQ7QUFDQUMsTUFBTSxDQUFDSyxHQUFHLENBQUNGLE9BQU8sQ0FBQzs7QUFFbkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBSCxNQUFNLENBQUNNLElBQUksQ0FBQyxTQUFTLEVBQUVKLDRCQUE0QixDQUFDSyxrQkFBa0IsQ0FBQzs7QUFFdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBUCxNQUFNLENBQUNNLElBQUksQ0FDVCxZQUFZLEVBQ1pGLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLEVBQzdCRiw0QkFBNEIsQ0FBQ00scUJBQy9CLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBUixNQUFNLENBQUNTLEdBQUcsQ0FBQyxPQUFPLEVBQUVQLDRCQUE0QixDQUFDUSxnQkFBZ0IsQ0FBQzs7QUFFbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBVixNQUFNLENBQUNTLEdBQUcsQ0FBQyxRQUFRLEVBQUVQLDRCQUE0QixDQUFDUyxRQUFRLENBQUM7O0FBRTNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQVgsTUFBTSxDQUFDUyxHQUFHLENBQUMsY0FBYyxFQUFFUCw0QkFBNEIsQ0FBQ1Usb0JBQW9CLENBQUM7O0FBRTdFOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQVosTUFBTSxDQUFDYSxLQUFLLENBQUMsY0FBYyxFQUFFWCw0QkFBNEIsQ0FBQ1ksaUJBQWlCLENBQUM7O0FBRTVFOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQWQsTUFBTSxDQUFDTSxJQUFJLENBQUMsMkJBQTJCLEVBQUVKLDRCQUE0QixDQUFDYSxpQkFBaUIsQ0FBQzs7QUFFeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBZixNQUFNLENBQUNnQixNQUFNLENBQUMsa0JBQWtCLEVBQUVkLDRCQUE0QixDQUFDZSxrQkFBa0IsQ0FBQzs7QUFFbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBakIsTUFBTSxDQUFDZ0IsTUFBTSxDQUFDLEdBQUcsRUFBRWQsNEJBQTRCLENBQUNnQixxQkFBcUIsQ0FBQzs7QUFFdEU7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBbEIsTUFBTSxDQUFDTSxJQUFJLENBQUMsZ0JBQWdCLEVBQUVGLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRUYsNEJBQTRCLENBQUNpQixZQUFZLENBQUM7QUFFNUZDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHckIsTUFBTSIsImlnbm9yZUxpc3QiOltdfQ==