c105999c04f9ba9f62baf822c5fe1033
// Monitoring Routes
const express = require('express');
const MonitoringService = require('../services/monitoringService');
const {
  ApiResponse,
  ApiError
} = require('../utils/apiResponse');
const router = express.Router();

// Get system health
router.get('/health', (req, res, next) => {
  try {
    const health = MonitoringService.getSystemHealth();
    return res.json(new ApiResponse(200, health, 'System health fetched'));
  } catch (error) {
    return next(new ApiError(500, 'Failed to fetch system health', [error.message]));
  }
});

// Get performance metrics
router.get('/metrics', (req, res, next) => {
  try {
    const metrics = MonitoringService.getPerformanceMetrics();
    return res.json(new ApiResponse(200, metrics, 'Performance metrics fetched'));
  } catch (error) {
    return next(new ApiError(500, 'Failed to fetch performance metrics', [error.message]));
  }
});

// Monitor endpoints
router.get('/endpoints', (req, res, next) => {
  try {
    const endpoints = MonitoringService.monitorEndpoints();
    return res.json(new ApiResponse(200, endpoints, 'Endpoints monitored'));
  } catch (error) {
    return next(new ApiError(500, 'Failed to monitor endpoints', [error.message]));
  }
});

// Get alerts
router.get('/alerts', (req, res, next) => {
  try {
    const alerts = MonitoringService.getAlerts();
    return res.json(new ApiResponse(200, alerts, 'Alerts fetched'));
  } catch (error) {
    return next(new ApiError(500, 'Failed to fetch alerts', [error.message]));
  }
});

// Monitor database
router.get('/database', (req, res, next) => {
  try {
    const dbStatus = MonitoringService.monitorDatabase();
    return res.json(new ApiResponse(200, dbStatus, 'Database status fetched'));
  } catch (error) {
    return next(new ApiError(500, 'Failed to fetch database status', [error.message]));
  }
});

// Get realtime data
router.get('/realtime', (req, res, next) => {
  try {
    const realtime = MonitoringService.getRealtimeData();
    return res.json(new ApiResponse(200, realtime, 'Realtime data fetched'));
  } catch (error) {
    return next(new ApiError(500, 'Failed to fetch realtime data', [error.message]));
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIk1vbml0b3JpbmdTZXJ2aWNlIiwiQXBpUmVzcG9uc2UiLCJBcGlFcnJvciIsInJvdXRlciIsIlJvdXRlciIsImdldCIsInJlcSIsInJlcyIsIm5leHQiLCJoZWFsdGgiLCJnZXRTeXN0ZW1IZWFsdGgiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwibWV0cmljcyIsImdldFBlcmZvcm1hbmNlTWV0cmljcyIsImVuZHBvaW50cyIsIm1vbml0b3JFbmRwb2ludHMiLCJhbGVydHMiLCJnZXRBbGVydHMiLCJkYlN0YXR1cyIsIm1vbml0b3JEYXRhYmFzZSIsInJlYWx0aW1lIiwiZ2V0UmVhbHRpbWVEYXRhIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIm1vbml0b3JpbmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gTW9uaXRvcmluZyBSb3V0ZXNcclxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3QgTW9uaXRvcmluZ1NlcnZpY2UgPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9tb25pdG9yaW5nU2VydmljZScpO1xyXG5jb25zdCB7IEFwaVJlc3BvbnNlLCBBcGlFcnJvciB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvYXBpUmVzcG9uc2UnKTtcclxuXHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcblxyXG4vLyBHZXQgc3lzdGVtIGhlYWx0aFxyXG5yb3V0ZXIuZ2V0KCcvaGVhbHRoJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGhlYWx0aCA9IE1vbml0b3JpbmdTZXJ2aWNlLmdldFN5c3RlbUhlYWx0aCgpO1xyXG4gICAgcmV0dXJuIHJlcy5qc29uKG5ldyBBcGlSZXNwb25zZSgyMDAsIGhlYWx0aCwgJ1N5c3RlbSBoZWFsdGggZmV0Y2hlZCcpKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgJ0ZhaWxlZCB0byBmZXRjaCBzeXN0ZW0gaGVhbHRoJywgW2Vycm9yLm1lc3NhZ2VdKSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEdldCBwZXJmb3JtYW5jZSBtZXRyaWNzXHJcbnJvdXRlci5nZXQoJy9tZXRyaWNzJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IG1ldHJpY3MgPSBNb25pdG9yaW5nU2VydmljZS5nZXRQZXJmb3JtYW5jZU1ldHJpY3MoKTtcclxuICAgIHJldHVybiByZXMuanNvbihuZXcgQXBpUmVzcG9uc2UoMjAwLCBtZXRyaWNzLCAnUGVyZm9ybWFuY2UgbWV0cmljcyBmZXRjaGVkJykpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gbmV4dChuZXcgQXBpRXJyb3IoNTAwLCAnRmFpbGVkIHRvIGZldGNoIHBlcmZvcm1hbmNlIG1ldHJpY3MnLCBbZXJyb3IubWVzc2FnZV0pKTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gTW9uaXRvciBlbmRwb2ludHNcclxucm91dGVyLmdldCgnL2VuZHBvaW50cycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBlbmRwb2ludHMgPSBNb25pdG9yaW5nU2VydmljZS5tb25pdG9yRW5kcG9pbnRzKCk7XHJcbiAgICByZXR1cm4gcmVzLmpzb24obmV3IEFwaVJlc3BvbnNlKDIwMCwgZW5kcG9pbnRzLCAnRW5kcG9pbnRzIG1vbml0b3JlZCcpKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgJ0ZhaWxlZCB0byBtb25pdG9yIGVuZHBvaW50cycsIFtlcnJvci5tZXNzYWdlXSkpO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBHZXQgYWxlcnRzXHJcbnJvdXRlci5nZXQoJy9hbGVydHMnLCAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgYWxlcnRzID0gTW9uaXRvcmluZ1NlcnZpY2UuZ2V0QWxlcnRzKCk7XHJcbiAgICByZXR1cm4gcmVzLmpzb24obmV3IEFwaVJlc3BvbnNlKDIwMCwgYWxlcnRzLCAnQWxlcnRzIGZldGNoZWQnKSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig1MDAsICdGYWlsZWQgdG8gZmV0Y2ggYWxlcnRzJywgW2Vycm9yLm1lc3NhZ2VdKSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIE1vbml0b3IgZGF0YWJhc2Vcclxucm91dGVyLmdldCgnL2RhdGFiYXNlJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRiU3RhdHVzID0gTW9uaXRvcmluZ1NlcnZpY2UubW9uaXRvckRhdGFiYXNlKCk7XHJcbiAgICByZXR1cm4gcmVzLmpzb24obmV3IEFwaVJlc3BvbnNlKDIwMCwgZGJTdGF0dXMsICdEYXRhYmFzZSBzdGF0dXMgZmV0Y2hlZCcpKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgJ0ZhaWxlZCB0byBmZXRjaCBkYXRhYmFzZSBzdGF0dXMnLCBbZXJyb3IubWVzc2FnZV0pKTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gR2V0IHJlYWx0aW1lIGRhdGFcclxucm91dGVyLmdldCgnL3JlYWx0aW1lJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlYWx0aW1lID0gTW9uaXRvcmluZ1NlcnZpY2UuZ2V0UmVhbHRpbWVEYXRhKCk7XHJcbiAgICByZXR1cm4gcmVzLmpzb24obmV3IEFwaVJlc3BvbnNlKDIwMCwgcmVhbHRpbWUsICdSZWFsdGltZSBkYXRhIGZldGNoZWQnKSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig1MDAsICdGYWlsZWQgdG8gZmV0Y2ggcmVhbHRpbWUgZGF0YScsIFtlcnJvci5tZXNzYWdlXSkpO1xyXG4gIH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxpQkFBaUIsR0FBR0QsT0FBTyxDQUFDLCtCQUErQixDQUFDO0FBQ2xFLE1BQU07RUFBRUUsV0FBVztFQUFFQztBQUFTLENBQUMsR0FBR0gsT0FBTyxDQUFDLHNCQUFzQixDQUFDO0FBRWpFLE1BQU1JLE1BQU0sR0FBR0wsT0FBTyxDQUFDTSxNQUFNLENBQUMsQ0FBQzs7QUFFL0I7QUFDQUQsTUFBTSxDQUFDRSxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDeEMsSUFBSTtJQUNGLE1BQU1DLE1BQU0sR0FBR1QsaUJBQWlCLENBQUNVLGVBQWUsQ0FBQyxDQUFDO0lBQ2xELE9BQU9ILEdBQUcsQ0FBQ0ksSUFBSSxDQUFDLElBQUlWLFdBQVcsQ0FBQyxHQUFHLEVBQUVRLE1BQU0sRUFBRSx1QkFBdUIsQ0FBQyxDQUFDO0VBQ3hFLENBQUMsQ0FBQyxPQUFPRyxLQUFLLEVBQUU7SUFDZCxPQUFPSixJQUFJLENBQUMsSUFBSU4sUUFBUSxDQUFDLEdBQUcsRUFBRSwrQkFBK0IsRUFBRSxDQUFDVSxLQUFLLENBQUNDLE9BQU8sQ0FBQyxDQUFDLENBQUM7RUFDbEY7QUFDRixDQUFDLENBQUM7O0FBRUY7QUFDQVYsTUFBTSxDQUFDRSxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDekMsSUFBSTtJQUNGLE1BQU1NLE9BQU8sR0FBR2QsaUJBQWlCLENBQUNlLHFCQUFxQixDQUFDLENBQUM7SUFDekQsT0FBT1IsR0FBRyxDQUFDSSxJQUFJLENBQUMsSUFBSVYsV0FBVyxDQUFDLEdBQUcsRUFBRWEsT0FB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