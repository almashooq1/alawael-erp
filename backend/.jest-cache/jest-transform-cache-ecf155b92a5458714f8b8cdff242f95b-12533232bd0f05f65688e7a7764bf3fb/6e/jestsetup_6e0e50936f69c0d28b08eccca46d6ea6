62402862e1243140849eef04731617a8
const {
  MongoMemoryServer
} = require('mongodb-memory-server');
const mongoose = require('mongoose');
let mongo;
beforeAll(async () => {
  // Ensure test-friendly env
  process.env.NODE_ENV = process.env.NODE_ENV || 'test';
  process.env.JWT_SECRET = process.env.JWT_SECRET || 'test_secret_key';
  // Disable mock DB so Mongoose connects to memory server
  process.env.USE_MOCK_DB = 'false';
  // Keep cache mocked to avoid external dependencies
  process.env.USE_MOCK_CACHE = process.env.USE_MOCK_CACHE || 'true';
  mongo = await MongoMemoryServer.create();
  const uri = mongo.getUri();
  await mongoose.connect(uri, {
    dbName: 'beneficiary_portal_test'
  });
});
afterAll(async () => {
  await mongoose.disconnect();
  if (mongo) await mongo.stop();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNb25nb01lbW9yeVNlcnZlciIsInJlcXVpcmUiLCJtb25nb29zZSIsIm1vbmdvIiwiYmVmb3JlQWxsIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiSldUX1NFQ1JFVCIsIlVTRV9NT0NLX0RCIiwiVVNFX01PQ0tfQ0FDSEUiLCJjcmVhdGUiLCJ1cmkiLCJnZXRVcmkiLCJjb25uZWN0IiwiZGJOYW1lIiwiYWZ0ZXJBbGwiLCJkaXNjb25uZWN0Iiwic3RvcCJdLCJzb3VyY2VzIjpbImplc3Quc2V0dXAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBNb25nb01lbW9yeVNlcnZlciB9ID0gcmVxdWlyZSgnbW9uZ29kYi1tZW1vcnktc2VydmVyJyk7XHJcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuXHJcbmxldCBtb25nbztcclxuXHJcbmJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgLy8gRW5zdXJlIHRlc3QtZnJpZW5kbHkgZW52XHJcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCAndGVzdCc7XHJcbiAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ3Rlc3Rfc2VjcmV0X2tleSc7XHJcbiAgLy8gRGlzYWJsZSBtb2NrIERCIHNvIE1vbmdvb3NlIGNvbm5lY3RzIHRvIG1lbW9yeSBzZXJ2ZXJcclxuICBwcm9jZXNzLmVudi5VU0VfTU9DS19EQiA9ICdmYWxzZSc7XHJcbiAgLy8gS2VlcCBjYWNoZSBtb2NrZWQgdG8gYXZvaWQgZXh0ZXJuYWwgZGVwZW5kZW5jaWVzXHJcbiAgcHJvY2Vzcy5lbnYuVVNFX01PQ0tfQ0FDSEUgPSBwcm9jZXNzLmVudi5VU0VfTU9DS19DQUNIRSB8fCAndHJ1ZSc7XHJcblxyXG4gIG1vbmdvID0gYXdhaXQgTW9uZ29NZW1vcnlTZXJ2ZXIuY3JlYXRlKCk7XHJcbiAgY29uc3QgdXJpID0gbW9uZ28uZ2V0VXJpKCk7XHJcblxyXG4gIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QodXJpLCB7XHJcbiAgICBkYk5hbWU6ICdiZW5lZmljaWFyeV9wb3J0YWxfdGVzdCcsXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xyXG4gIGF3YWl0IG1vbmdvb3NlLmRpc2Nvbm5lY3QoKTtcclxuICBpZiAobW9uZ28pIGF3YWl0IG1vbmdvLnN0b3AoKTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTTtFQUFFQTtBQUFrQixDQUFDLEdBQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQztBQUM5RCxNQUFNQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFcEMsSUFBSUUsS0FBSztBQUVUQyxTQUFTLENBQUMsWUFBWTtFQUNwQjtFQUNBQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsUUFBUSxHQUFHRixPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsUUFBUSxJQUFJLE1BQU07RUFDckRGLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRSxVQUFVLEdBQUdILE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRSxVQUFVLElBQUksaUJBQWlCO0VBQ3BFO0VBQ0FILE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRyxXQUFXLEdBQUcsT0FBTztFQUNqQztFQUNBSixPQUFPLENBQUNDLEdBQUcsQ0FBQ0ksY0FBYyxHQUFHTCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0ksY0FBYyxJQUFJLE1BQU07RUFFakVQLEtBQUssR0FBRyxNQUFNSCxpQkFBaUIsQ0FBQ1csTUFBTSxDQUFDLENBQUM7RUFDeEMsTUFBTUMsR0FBRyxHQUFHVCxLQUFLLENBQUNVLE1BQU0sQ0FBQyxDQUFDO0VBRTFCLE1BQU1YLFFBQVEsQ0FBQ1ksT0FBTyxDQUFDRixHQUFHLEVBQUU7SUFDMUJHLE1BQU0sRUFBRTtFQUNWLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUVGQyxRQUFRLENBQUMsWUFBWTtFQUNuQixNQUFNZCxRQUFRLENBQUNlLFVBQVUsQ0FBQyxDQUFDO0VBQzNCLElBQUlkLEtBQUssRUFBRSxNQUFNQSxLQUFLLENBQUNlLElBQUksQ0FBQyxDQUFDO0FBQy9CLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==