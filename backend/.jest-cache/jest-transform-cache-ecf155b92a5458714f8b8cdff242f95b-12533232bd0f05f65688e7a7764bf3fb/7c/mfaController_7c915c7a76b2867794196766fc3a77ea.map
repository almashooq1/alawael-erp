{"version":3,"names":["crypto","require","mfaService","emailService","smsService","MFASettings","MFASession","OTPLog","MFAAuditLog","TrustedDevice","User","exports","getMFASetupGuide","req","res","guide","status","json","success","data","error","message","initiateTOTPSetup","userId","user","_id","totpData","generateTOTPSecret","email","mfaSettings","findOne","create","action","method","details","reason","ipAddress","ip","userAgent","get","qrCode","manualEntryKey","secret","setupInstructions","step1","step2","step3","step4","verifyAndEnableTOTP","token","body","isValid","verifyTOTP","backupCodes","generateBackupCodes","hashedBackupCodes","map","code","hashBackupCode","used","findOneAndUpdate","$set","totp","enabled","verifiedAt","Date","backupCodesGenerated","primaryMethod","$push","$each","new","upsert","findByIdAndUpdate","twoFactorEnabled","twoFactorSecret","initiateEmailOTP","findById","otpData","generateEmailOTP","otpHash","createHash","update","digest","recipient","expiresAt","sendOTPEmail","name","purpose","expiresIn","substring","verifyAndEnableEmailOTP","otpLog","sort","createdAt","verification","verifyOTP","verificationAttempts","save","emailOTP","initiateSMSOTP","phoneNumber","countryCode","generateSMSOTP","fullPhoneNumber","sendOTP","verifyAndEnableSMSOTP","smsOTP","verifyMFALogin","sessionId","mfaSession","validation","validateMFASession","select","backupCode","find","bc","verifyBackupCode","usedAt","attempts","attemptsRemaining","verified","getMFASettings","secureSettings","toObject","recovery","recoveryKey","disableMFAMethod","includes","enabledMethods","filter","Boolean","length","methodField","updateData","updated","trustDevice","deviceName","deviceFingerprint","deviceToken","generateTrustedDeviceToken","trustedDevice","deviceId","randomBytes","toString","fingerprint","getTrustedDevices","devices","isActive","$gt","revokeTrustedDevice","params","device","revokedAt","revokeReason","module"],"sources":["mfaController.js"],"sourcesContent":["/**\r\n * MFA Controller\r\n * تحكم المصادقة متعددة العوامل\r\n */\r\n\r\nconst crypto = require('crypto');\r\nconst mfaService = require('../services/mfaService');\r\nconst emailService = require('../services/emailService');\r\nconst smsService = require('../services/smsService');\r\nconst {\r\n  MFASettings,\r\n  MFASession,\r\n  OTPLog,\r\n  MFAAuditLog,\r\n  TrustedDevice,\r\n} = require('../models/mfa.models');\r\nconst { User } = require('../models/schemas');\r\n\r\n// ============ SETUP ENDPOINTS ============\r\n\r\n/**\r\n * Get MFA Setup Guide\r\n * الحصول على دليل إعداد MFA\r\n */\r\nexports.getMFASetupGuide = async (req, res) => {\r\n  try {\r\n    const guide = mfaService.getMFASetupGuide();\r\n    res.status(200).json({\r\n      success: true,\r\n      data: guide,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Initialize TOTP Setup\r\n * بدء إعداد TOTP\r\n */\r\nexports.initiateTOTPSetup = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n\r\n    // Generate TOTP secret and QR code\r\n    const totpData = await mfaService.generateTOTPSecret(req.user.email);\r\n\r\n    // Create MFA settings if doesn't exist\r\n    let mfaSettings = await MFASettings.findOne({ userId });\r\n    if (!mfaSettings) {\r\n      mfaSettings = await MFASettings.create({ userId });\r\n    }\r\n\r\n    // Log the setup initiation\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'mfa_setup',\r\n      status: 'success',\r\n      method: 'totp',\r\n      details: {\r\n        reason: 'User initiated TOTP setup',\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'TOTP setup initiated',\r\n      data: {\r\n        qrCode: totpData.qrCode,\r\n        manualEntryKey: totpData.manualEntryKey,\r\n        secret: totpData.secret,\r\n        setupInstructions: {\r\n          step1: 'Download an authenticator app',\r\n          step2: 'Scan the QR code or enter the manual key',\r\n          step3: 'Enter the 6-digit code to verify',\r\n          step4: 'Save your backup codes in a safe place',\r\n        },\r\n      },\r\n    });\r\n  } catch (error) {\r\n    await MFAAuditLog.create({\r\n      userId: req.user._id,\r\n      action: 'mfa_setup',\r\n      status: 'failed',\r\n      method: 'totp',\r\n      error: error.message,\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Verify TOTP and Enable\r\n * التحقق من TOTP وتفعيله\r\n */\r\nexports.verifyAndEnableTOTP = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { token, secret } = req.body;\r\n\r\n    if (!token || !secret) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Token and secret are required',\r\n      });\r\n    }\r\n\r\n    // Verify TOTP token\r\n    const isValid = mfaService.verifyTOTP(token, secret);\r\n    if (!isValid) {\r\n      await MFAAuditLog.create({\r\n        userId,\r\n        action: 'verification_failed',\r\n        status: 'failed',\r\n        method: 'totp',\r\n        error: 'Invalid TOTP token',\r\n        ipAddress: req.ip,\r\n        userAgent: req.get('user-agent'),\r\n      });\r\n\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Invalid TOTP token',\r\n      });\r\n    }\r\n\r\n    // Generate backup codes\r\n    const backupCodes = mfaService.generateBackupCodes();\r\n    const hashedBackupCodes = backupCodes.map((code) => ({\r\n      code: mfaService.hashBackupCode(code),\r\n      used: false,\r\n    }));\r\n\r\n    // Update MFA settings\r\n    await MFASettings.findOneAndUpdate(\r\n      { userId },\r\n      {\r\n        $set: {\r\n          totp: {\r\n            enabled: true,\r\n            secret,\r\n            verifiedAt: new Date(),\r\n            backupCodesGenerated: true,\r\n          },\r\n          primaryMethod: 'totp',\r\n        },\r\n        $push: {\r\n          backupCodes: { $each: hashedBackupCodes },\r\n        },\r\n      },\r\n      { new: true, upsert: true }\r\n    );\r\n\r\n    // Update user\r\n    await User.findByIdAndUpdate(userId, {\r\n      twoFactorEnabled: true,\r\n      twoFactorSecret: secret,\r\n    });\r\n\r\n    // Log success\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'mfa_enable',\r\n      status: 'success',\r\n      method: 'totp',\r\n      details: {\r\n        reason: 'User enabled TOTP authentication',\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'TOTP enabled successfully',\r\n      data: {\r\n        backupCodes,\r\n        message: 'Save these backup codes in a safe place. You can use them to regain access if you lose your authenticator.',\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Start Email OTP Verification\r\n * بدء التحقق من OTP عبر البريد الإلكتروني\r\n */\r\nexports.initiateEmailOTP = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const user = await User.findById(userId);\r\n\r\n    // Generate OTP\r\n    const otpData = mfaService.generateEmailOTP();\r\n\r\n    // Hash OTP for storage\r\n    const otpHash = crypto.createHash('sha256').update(otpData.code).digest('hex');\r\n\r\n    // Create MFA settings if doesn't exist\r\n    let mfaSettings = await MFASettings.findOne({ userId });\r\n    if (!mfaSettings) {\r\n      mfaSettings = await MFASettings.create({ userId });\r\n    }\r\n\r\n    // Log OTP\r\n    await OTPLog.create({\r\n      userId,\r\n      method: 'email',\r\n      recipient: user.email,\r\n      otpHash,\r\n      expiresAt: otpData.expiresAt,\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n      reason: 'mfa_setup',\r\n    });\r\n\r\n    // Send OTP email\r\n    await emailService.sendOTPEmail(user.email, otpData.code, {\r\n      name: user.name,\r\n      purpose: 'Multi-Factor Authentication Setup',\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'OTP sent to your email',\r\n      data: {\r\n        expiresIn: otpData.expiresIn,\r\n        recipient: `${user.email.substring(0, 5)}***`,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Verify Email OTP and Enable\r\n * التحقق من OTP البريدي وتفعيله\r\n */\r\nexports.verifyAndEnableEmailOTP = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { code } = req.body;\r\n\r\n    if (!code) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'OTP code is required',\r\n      });\r\n    }\r\n\r\n    // Find the most recent OTP log\r\n    const otpLog = await OTPLog.findOne({ userId, method: 'email' })\r\n      .sort({ createdAt: -1 });\r\n\r\n    if (!otpLog) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'No OTP request found',\r\n      });\r\n    }\r\n\r\n    // Verify OTP\r\n    const verification = mfaService.verifyOTP(code, otpLog.otpHash, otpLog.expiresAt);\r\n\r\n    if (!verification.isValid) {\r\n      otpLog.verificationAttempts += 1;\r\n      await otpLog.save();\r\n\r\n      await MFAAuditLog.create({\r\n        userId,\r\n        action: 'verification_failed',\r\n        status: 'failed',\r\n        method: 'email',\r\n        error: verification.message,\r\n        ipAddress: req.ip,\r\n        userAgent: req.get('user-agent'),\r\n      });\r\n\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: verification.message,\r\n      });\r\n    }\r\n\r\n    // Update OTP log\r\n    otpLog.status = 'verified';\r\n    otpLog.verifiedAt = new Date();\r\n    await otpLog.save();\r\n\r\n    // Update MFA settings\r\n    let mfaSettings = await MFASettings.findOneAndUpdate(\r\n      { userId },\r\n      {\r\n        $set: {\r\n          emailOTP: {\r\n            enabled: true,\r\n            verifiedAt: new Date(),\r\n          },\r\n          primaryMethod: 'email',\r\n        },\r\n      },\r\n      { new: true, upsert: true }\r\n    );\r\n\r\n    // Log success\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'mfa_enable',\r\n      status: 'success',\r\n      method: 'email',\r\n      details: {\r\n        reason: 'User enabled Email OTP authentication',\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'Email OTP enabled successfully',\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Initiate SMS OTP Verification\r\n * بدء التحقق من OTP عبر الرسائل النصية\r\n */\r\nexports.initiateSMSOTP = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { phoneNumber, countryCode } = req.body;\r\n\r\n    if (!phoneNumber || !countryCode) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Phone number and country code are required',\r\n      });\r\n    }\r\n\r\n    const user = await User.findById(userId);\r\n\r\n    // Generate OTP\r\n    const otpData = mfaService.generateSMSOTP();\r\n    const otpHash = crypto.createHash('sha256').update(otpData.code).digest('hex');\r\n\r\n    // Create MFA settings if doesn't exist\r\n    let mfaSettings = await MFASettings.findOne({ userId });\r\n    if (!mfaSettings) {\r\n      mfaSettings = await MFASettings.create({ userId });\r\n    }\r\n\r\n    // Log OTP\r\n    await OTPLog.create({\r\n      userId,\r\n      method: 'sms',\r\n      recipient: phoneNumber,\r\n      otpHash,\r\n      expiresAt: otpData.expiresAt,\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n      reason: 'mfa_setup',\r\n    });\r\n\r\n    // Send OTP SMS\r\n    const fullPhoneNumber = `${countryCode}${phoneNumber}`;\r\n    await smsService.sendOTP(fullPhoneNumber, otpData.code, {\r\n      name: user.name,\r\n      purpose: 'Multi-Factor Authentication',\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'OTP sent to your phone',\r\n      data: {\r\n        expiresIn: otpData.expiresIn,\r\n        recipient: `${phoneNumber.substring(0, 3)}***`,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Verify SMS OTP and Enable\r\n * التحقق من OTP الرسائل النصية وتفعيله\r\n */\r\nexports.verifyAndEnableSMSOTP = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { code, phoneNumber, countryCode } = req.body;\r\n\r\n    if (!code || !phoneNumber || !countryCode) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Code, phone number, and country code are required',\r\n      });\r\n    }\r\n\r\n    // Find the most recent OTP log\r\n    const otpLog = await OTPLog.findOne({ userId, method: 'sms' })\r\n      .sort({ createdAt: -1 });\r\n\r\n    if (!otpLog) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'No OTP request found',\r\n      });\r\n    }\r\n\r\n    // Verify OTP\r\n    const verification = mfaService.verifyOTP(code, otpLog.otpHash, otpLog.expiresAt);\r\n\r\n    if (!verification.isValid) {\r\n      otpLog.verificationAttempts += 1;\r\n      await otpLog.save();\r\n\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: verification.message,\r\n      });\r\n    }\r\n\r\n    // Update OTP log\r\n    otpLog.status = 'verified';\r\n    otpLog.verifiedAt = new Date();\r\n    await otpLog.save();\r\n\r\n    // Update MFA settings\r\n    const mfaSettings = await MFASettings.findOneAndUpdate(\r\n      { userId },\r\n      {\r\n        $set: {\r\n          smsOTP: {\r\n            enabled: true,\r\n            phoneNumber,\r\n            countryCode,\r\n            verifiedAt: new Date(),\r\n          },\r\n          primaryMethod: 'sms',\r\n        },\r\n      },\r\n      { new: true, upsert: true }\r\n    );\r\n\r\n    // Log success\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'mfa_enable',\r\n      status: 'success',\r\n      method: 'sms',\r\n      details: {\r\n        reason: 'User enabled SMS OTP authentication',\r\n        phoneNumber,\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'SMS OTP enabled successfully',\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n// ============ VERIFICATION ENDPOINTS ============\r\n\r\n/**\r\n * Verify MFA During Login\r\n * التحقق من MFA أثناء تسجيل الدخول\r\n */\r\nexports.verifyMFALogin = async (req, res) => {\r\n  try {\r\n    const { sessionId, token, method } = req.body;\r\n\r\n    if (!sessionId || !token || !method) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Session ID, token, and method are required',\r\n      });\r\n    }\r\n\r\n    // Find MFA session\r\n    const mfaSession = await MFASession.findOne({ sessionId });\r\n    if (!mfaSession) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Invalid MFA session',\r\n      });\r\n    }\r\n\r\n    // Validate session\r\n    const validation = mfaService.validateMFASession(mfaSession);\r\n    if (!validation.isValid) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: validation.message,\r\n      });\r\n    }\r\n\r\n    // Get user and MFA settings\r\n    const user = await User.findById(mfaSession.userId).select('+twoFactorSecret');\r\n    const mfaSettings = await MFASettings.findOne({ userId: mfaSession.userId });\r\n\r\n    let isValid = false;\r\n\r\n    // Verify based on method\r\n    if (method === 'totp') {\r\n      isValid = mfaService.verifyTOTP(token, user.twoFactorSecret);\r\n    } else if (method === 'backup') {\r\n      // Verify backup code\r\n      const backupCode = mfaSettings.backupCodes.find(\r\n        (bc) => !bc.used && mfaService.verifyBackupCode(token, bc.code)\r\n      );\r\n      if (backupCode) {\r\n        backupCode.used = true;\r\n        backupCode.usedAt = new Date();\r\n        await mfaSettings.save();\r\n        isValid = true;\r\n\r\n        // Log backup code usage\r\n        await MFAAuditLog.create({\r\n          userId: mfaSession.userId,\r\n          action: 'backup_code_used',\r\n          status: 'success',\r\n          ipAddress: req.ip,\r\n          userAgent: req.get('user-agent'),\r\n        });\r\n      }\r\n    }\r\n\r\n    if (!isValid) {\r\n      mfaSession.attempts += 1;\r\n      await mfaSession.save();\r\n\r\n      await MFAAuditLog.create({\r\n        userId: mfaSession.userId,\r\n        action: 'verification_failed',\r\n        status: 'failed',\r\n        method,\r\n        error: 'Invalid MFA token',\r\n        ipAddress: req.ip,\r\n        userAgent: req.get('user-agent'),\r\n      });\r\n\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Invalid MFA token',\r\n        attemptsRemaining: validation.attemptsRemaining - 1,\r\n      });\r\n    }\r\n\r\n    // MFA verified\r\n    mfaSession.status = 'verified';\r\n    mfaSession.verifiedAt = new Date();\r\n    await mfaSession.save();\r\n\r\n    // Log success\r\n    await MFAAuditLog.create({\r\n      userId: mfaSession.userId,\r\n      action: 'verification_success',\r\n      status: 'success',\r\n      method,\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'MFA verification successful',\r\n      data: {\r\n        sessionId,\r\n        userId: mfaSession.userId,\r\n        verified: true,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n// ============ SETTINGS ENDPOINTS ============\r\n\r\n/**\r\n * Get MFA Settings\r\n * الحصول على إعدادات MFA\r\n */\r\nexports.getMFASettings = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n\r\n    let mfaSettings = await MFASettings.findOne({ userId });\r\n    if (!mfaSettings) {\r\n      mfaSettings = await MFASettings.create({ userId });\r\n    }\r\n\r\n    // Remove sensitive data\r\n    const secureSettings = mfaSettings.toObject();\r\n    if (secureSettings.totp) delete secureSettings.totp.secret;\r\n    if (secureSettings.recovery) delete secureSettings.recovery.recoveryKey;\r\n    secureSettings.backupCodes = secureSettings.backupCodes.map(({ used, usedAt }) => ({\r\n      used,\r\n      usedAt,\r\n    }));\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      data: secureSettings,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Disable MFA Method\r\n * تعطيل طريقة MFA\r\n */\r\nexports.disableMFAMethod = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { method } = req.body;\r\n\r\n    if (!['totp', 'email', 'sms'].includes(method)) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Invalid MFA method',\r\n      });\r\n    }\r\n\r\n    const mfaSettings = await MFASettings.findOne({ userId });\r\n\r\n    // Cannot disable all methods\r\n    const enabledMethods = [\r\n      mfaSettings?.totp?.enabled,\r\n      mfaSettings?.emailOTP?.enabled,\r\n      mfaSettings?.smsOTP?.enabled,\r\n    ].filter(Boolean);\r\n\r\n    if (enabledMethods.length <= 1) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'At least one MFA method must remain enabled',\r\n      });\r\n    }\r\n\r\n    // Disable method\r\n    const methodField = method === 'totp' ? 'totp' : method === 'email' ? 'emailOTP' : 'smsOTP';\r\n    const updateData = {};\r\n    updateData[`${methodField}.enabled`] = false;\r\n\r\n    const updated = await MFASettings.findOneAndUpdate(\r\n      { userId },\r\n      { $set: updateData },\r\n      { new: true }\r\n    );\r\n\r\n    // Log action\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'mfa_disable',\r\n      status: 'success',\r\n      method,\r\n      details: {\r\n        reason: `User disabled ${method} authentication`,\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: `${method} MFA method disabled successfully`,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n// ============ TRUSTED DEVICE ENDPOINTS ============\r\n\r\n/**\r\n * Trust Current Device\r\n * وضع علامة على الجهاز الحالي كموثوق\r\n */\r\nexports.trustDevice = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { deviceName, deviceFingerprint } = req.body;\r\n\r\n    if (!deviceFingerprint) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Device fingerprint is required',\r\n      });\r\n    }\r\n\r\n    // Generate device token\r\n    const deviceToken = mfaService.generateTrustedDeviceToken(userId, deviceFingerprint);\r\n\r\n    const trustedDevice = await TrustedDevice.create({\r\n      userId,\r\n      deviceId: crypto.randomBytes(12).toString('hex'),\r\n      deviceName: deviceName || 'Unknown Device',\r\n      fingerprint: deviceFingerprint,\r\n      token: deviceToken.token,\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n      expiresAt: deviceToken.expiresAt,\r\n    });\r\n\r\n    // Log action\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'device_trusted',\r\n      status: 'success',\r\n      details: {\r\n        deviceName: deviceName || 'Unknown Device',\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'Device trusted successfully',\r\n      data: {\r\n        deviceToken: deviceToken.token,\r\n        expiresAt: deviceToken.expiresAt,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Get Trusted Devices\r\n * الحصول على قائمة الأجهزة الموثوقة\r\n */\r\nexports.getTrustedDevices = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n\r\n    const devices = await TrustedDevice.find({\r\n      userId,\r\n      isActive: true,\r\n      expiresAt: { $gt: new Date() },\r\n    }).select('-token');\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      data: devices,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Revoke Trusted Device\r\n * إلغاء وضع العلامة على جهاز\r\n */\r\nexports.revokeTrustedDevice = async (req, res) => {\r\n  try {\r\n    const userId = req.user._id;\r\n    const { deviceId } = req.params;\r\n\r\n    const device = await TrustedDevice.findOneAndUpdate(\r\n      { _id: deviceId, userId },\r\n      {\r\n        isActive: false,\r\n        revokedAt: new Date(),\r\n        revokeReason: 'User revoked trust',\r\n      },\r\n      { new: true }\r\n    );\r\n\r\n    if (!device) {\r\n      return res.status(404).json({\r\n        success: false,\r\n        message: 'Device not found',\r\n      });\r\n    }\r\n\r\n    // Log action\r\n    await MFAAuditLog.create({\r\n      userId,\r\n      action: 'device_revoked',\r\n      status: 'success',\r\n      details: {\r\n        deviceName: device.deviceName,\r\n      },\r\n      ipAddress: req.ip,\r\n      userAgent: req.get('user-agent'),\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'Device revoked successfully',\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: error.message,\r\n    });\r\n  }\r\n};\r\n\r\nmodule.exports = exports;\r\n"],"mappings":"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","ignoreList":[]}