6c2443f8f478ade67a3a02dce8cea2df
/**
 * =====================================================
 * ADVANCED VALIDATION MIDDLEWARE - Phase 6
 * =====================================================
 * Comprehensive input validation for all endpoints
 */

const {
  ApiError
} = require('../utils/apiResponse');

// ==================== VALIDATORS ====================

/**
 * Email validation
 */
const isEmail = value => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(value || '');
};

/**
 * Password strength validation
 */
const isStrongPassword = password => {
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
  return passwordRegex.test(password);
};

/**
 * Phone number validation
 */
const isPhoneNumber = phone => {
  const phoneRegex = /^[\d\s\-\+\(\)]+$/;
  return phoneRegex.test(phone) && phone.replace(/\D/g, '').length >= 10;
};

/**
 * URL validation
 */
const isValidUrl = url => {
  try {
    return Boolean(new URL(url));
  } catch (e) {
    return false;
  }
};

/**
 * ID validation (MongoDB ObjectId)
 */
const isValidObjectId = id => {
  return /^[0-9a-f]{24}$/.test(id);
};

// ==================== SANITIZERS ====================

/**
 * Sanitize string input
 */
const sanitizeString = str => {
  if (!str) return '';
  return String(str).trim().replace(/[<>\"'&]/g, char => {
    const escape = {
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '&': '&amp;'
    };
    return escape[char];
  });
};

/**
 * Sanitize email
 */
const sanitizeEmail = email => {
  return String(email || '').toLowerCase().trim();
};

/**
 * Sanitize request body
 */
const sanitizeBody = obj => {
  const sanitized = {};
  for (const [key, value] of Object.entries(obj)) {
    if (typeof value === 'string') {
      sanitized[key] = sanitizeString(value);
    } else if (typeof value === 'object' && value !== null) {
      sanitized[key] = sanitizeBody(value);
    } else {
      sanitized[key] = value;
    }
  }
  return sanitized;
};

// ==================== VALIDATION MIDDLEWARE ====================

/**
 * Registration validation
 */
const validateRegistration = (req, res, next) => {
  try {
    const {
      name,
      email,
      password,
      confirmPassword
    } = req.body || {};

    // Required fields
    if (!name || !email || !password) {
      return res.status(400).json({
        success: false,
        error: 'name, email, and password are required',
        errors: {
          name: !name ? 'Name is required' : undefined,
          email: !email ? 'Email is required' : undefined,
          password: !password ? 'Password is required' : undefined
        }
      });
    }

    // Email validation
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format',
        errors: {
          email: 'Please provide a valid email address'
        }
      });
    }

    // Password length
    if (String(password).length < 8) {
      return res.status(400).json({
        success: false,
        error: 'Password must be at least 8 characters',
        errors: {
          password: 'Password must have at least 8 characters'
        }
      });
    }

    // Confirm password
    if (confirmPassword && password !== confirmPassword) {
      return res.status(400).json({
        success: false,
        error: 'Passwords do not match',
        errors: {
          confirmPassword: 'Passwords must match'
        }
      });
    }

    // Sanitize inputs
    req.body.name = sanitizeString(name);
    req.body.email = sanitizeEmail(email);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Login validation
 */
const validateLogin = (req, res, next) => {
  try {
    const {
      email,
      password
    } = req.body || {};
    if (!email || !password) {
      return res.status(400).json({
        success: false,
        error: 'email and password are required',
        errors: {
          email: !email ? 'Email is required' : undefined,
          password: !password ? 'Password is required' : undefined
        }
      });
    }
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format',
        errors: {
          email: 'Please provide a valid email address'
        }
      });
    }

    // Sanitize
    req.body.email = sanitizeEmail(email);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Create user validation
 */
const validateCreateUser = (req, res, next) => {
  try {
    const {
      name,
      email,
      role,
      department
    } = req.body || {};
    if (!name || !email || !role) {
      return res.status(400).json({
        success: false,
        error: 'name, email, and role are required'
      });
    }
    if (!isEmail(email)) {
      return res.status(400).json({
        success: false,
        error: 'Invalid email format'
      });
    }
    const validRoles = ['admin', 'manager', 'employee', 'viewer'];
    if (!validRoles.includes(role)) {
      return res.status(400).json({
        success: false,
        error: `Invalid role. Must be one of: ${validRoles.join(', ')}`
      });
    }

    // Sanitize
    req.body.name = sanitizeString(name);
    req.body.email = sanitizeEmail(email);
    if (department) req.body.department = sanitizeString(department);
    next();
  } catch (error) {
    res.status(500).json({
      success: false,
      error: 'Validation error',
      message: error.message
    });
  }
};

/**
 * Validate ID parameter
 */
const validateId = (req, res, next) => {
  const {
    id
  } = req.params;
  if (!id) {
    return res.status(400).json({
      success: false,
      error: 'ID parameter is required'
    });
  }
  if (!isValidObjectId(id)) {
    return res.status(400).json({
      success: false,
      error: 'Invalid ID format'
    });
  }
  next();
};

/**
 * Validate pagination
 */
const validatePagination = (req, res, next) => {
  const {
    page = 1,
    limit = 10
  } = req.query;
  const pageNum = parseInt(page);
  const limitNum = parseInt(limit);
  if (isNaN(pageNum) || pageNum < 1) {
    return res.status(400).json({
      success: false,
      error: 'Invalid page number'
    });
  }
  if (isNaN(limitNum) || limitNum < 1 || limitNum > 100) {
    return res.status(400).json({
      success: false,
      error: 'Invalid limit. Must be between 1 and 100'
    });
  }
  req.pagination = {
    page: pageNum,
    limit: limitNum,
    skip: (pageNum - 1) * limitNum
  };
  next();
};
module.exports = {
  // Validators
  isEmail,
  isStrongPassword,
  isPhoneNumber,
  isValidUrl,
  isValidObjectId,
  // Sanitizers
  sanitizeString,
  sanitizeEmail,
  sanitizeBody,
  // Middleware
  validateRegistration,
  validateLogin,
  validateCreateUser,
  validateId,
  validatePagination
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcGlFcnJvciIsInJlcXVpcmUiLCJpc0VtYWlsIiwidmFsdWUiLCJlbWFpbFJlZ2V4IiwidGVzdCIsImlzU3Ryb25nUGFzc3dvcmQiLCJwYXNzd29yZCIsInBhc3N3b3JkUmVnZXgiLCJpc1Bob25lTnVtYmVyIiwicGhvbmUiLCJwaG9uZVJlZ2V4IiwicmVwbGFjZSIsImxlbmd0aCIsImlzVmFsaWRVcmwiLCJ1cmwiLCJCb29sZWFuIiwiVVJMIiwiZSIsImlzVmFsaWRPYmplY3RJZCIsImlkIiwic2FuaXRpemVTdHJpbmciLCJzdHIiLCJTdHJpbmciLCJ0cmltIiwiY2hhciIsImVzY2FwZSIsInNhbml0aXplRW1haWwiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwic2FuaXRpemVCb2R5Iiwib2JqIiwic2FuaXRpemVkIiwia2V5IiwiT2JqZWN0IiwiZW50cmllcyIsInZhbGlkYXRlUmVnaXN0cmF0aW9uIiwicmVxIiwicmVzIiwibmV4dCIsIm5hbWUiLCJjb25maXJtUGFzc3dvcmQiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsImVycm9ycyIsInVuZGVmaW5lZCIsIm1lc3NhZ2UiLCJ2YWxpZGF0ZUxvZ2luIiwidmFsaWRhdGVDcmVhdGVVc2VyIiwicm9sZSIsImRlcGFydG1lbnQiLCJ2YWxpZFJvbGVzIiwiaW5jbHVkZXMiLCJqb2luIiwidmFsaWRhdGVJZCIsInBhcmFtcyIsInZhbGlkYXRlUGFnaW5hdGlvbiIsInBhZ2UiLCJsaW1pdCIsInF1ZXJ5IiwicGFnZU51bSIsInBhcnNlSW50IiwibGltaXROdW0iLCJpc05hTiIsInBhZ2luYXRpb24iLCJza2lwIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInZhbGlkYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqIEFEVkFOQ0VEIFZBTElEQVRJT04gTUlERExFV0FSRSAtIFBoYXNlIDZcclxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogQ29tcHJlaGVuc2l2ZSBpbnB1dCB2YWxpZGF0aW9uIGZvciBhbGwgZW5kcG9pbnRzXHJcbiAqL1xyXG5cclxuY29uc3QgeyBBcGlFcnJvciB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvYXBpUmVzcG9uc2UnKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09IFZBTElEQVRPUlMgPT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBFbWFpbCB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCBpc0VtYWlsID0gKHZhbHVlKSA9PiB7XHJcbiAgY29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xyXG4gIHJldHVybiBlbWFpbFJlZ2V4LnRlc3QodmFsdWUgfHwgJycpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFBhc3N3b3JkIHN0cmVuZ3RoIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IGlzU3Ryb25nUGFzc3dvcmQgPSAocGFzc3dvcmQpID0+IHtcclxuICBjb25zdCBwYXNzd29yZFJlZ2V4ID0gL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcXGQpKD89LipbQCQhJSo/Jl0pW0EtWmEtelxcZEAkISUqPyZdezgsfSQvO1xyXG4gIHJldHVybiBwYXNzd29yZFJlZ2V4LnRlc3QocGFzc3dvcmQpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFBob25lIG51bWJlciB2YWxpZGF0aW9uXHJcbiAqL1xyXG5jb25zdCBpc1Bob25lTnVtYmVyID0gKHBob25lKSA9PiB7XHJcbiAgY29uc3QgcGhvbmVSZWdleCA9IC9eW1xcZFxcc1xcLVxcK1xcKFxcKV0rJC87XHJcbiAgcmV0dXJuIHBob25lUmVnZXgudGVzdChwaG9uZSkgJiYgcGhvbmUucmVwbGFjZSgvXFxEL2csICcnKS5sZW5ndGggPj0gMTA7XHJcbn07XHJcblxyXG4vKipcclxuICogVVJMIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IGlzVmFsaWRVcmwgPSAodXJsKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIHJldHVybiBCb29sZWFuKG5ldyBVUkwodXJsKSk7XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBJRCB2YWxpZGF0aW9uIChNb25nb0RCIE9iamVjdElkKVxyXG4gKi9cclxuY29uc3QgaXNWYWxpZE9iamVjdElkID0gKGlkKSA9PiB7XHJcbiAgcmV0dXJuIC9eWzAtOWEtZl17MjR9JC8udGVzdChpZCk7XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PSBTQU5JVElaRVJTID09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogU2FuaXRpemUgc3RyaW5nIGlucHV0XHJcbiAqL1xyXG5jb25zdCBzYW5pdGl6ZVN0cmluZyA9IChzdHIpID0+IHtcclxuICBpZiAoIXN0cikgcmV0dXJuICcnO1xyXG4gIHJldHVybiBTdHJpbmcoc3RyKS50cmltKCkucmVwbGFjZSgvWzw+XFxcIicmXS9nLCAoY2hhcikgPT4ge1xyXG4gICAgY29uc3QgZXNjYXBlID0geyAnPCc6ICcmbHQ7JywgJz4nOiAnJmd0OycsICdcIic6ICcmcXVvdDsnLCBcIidcIjogJyYjeDI3OycsICcmJzogJyZhbXA7JyB9O1xyXG4gICAgcmV0dXJuIGVzY2FwZVtjaGFyXTtcclxuICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTYW5pdGl6ZSBlbWFpbFxyXG4gKi9cclxuY29uc3Qgc2FuaXRpemVFbWFpbCA9IChlbWFpbCkgPT4ge1xyXG4gIHJldHVybiBTdHJpbmcoZW1haWwgfHwgJycpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNhbml0aXplIHJlcXVlc3QgYm9keVxyXG4gKi9cclxuY29uc3Qgc2FuaXRpemVCb2R5ID0gKG9iaikgPT4ge1xyXG4gIGNvbnN0IHNhbml0aXplZCA9IHt9O1xyXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKG9iaikpIHtcclxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHNhbml0aXplZFtrZXldID0gc2FuaXRpemVTdHJpbmcodmFsdWUpO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgIHNhbml0aXplZFtrZXldID0gc2FuaXRpemVCb2R5KHZhbHVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNhbml0aXplZFtrZXldID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBzYW5pdGl6ZWQ7XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PSBWQUxJREFUSU9OIE1JRERMRVdBUkUgPT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBSZWdpc3RyYXRpb24gdmFsaWRhdGlvblxyXG4gKi9cclxuY29uc3QgdmFsaWRhdGVSZWdpc3RyYXRpb24gPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGNvbmZpcm1QYXNzd29yZCB9ID0gcmVxLmJvZHkgfHwge307XHJcblxyXG4gICAgLy8gUmVxdWlyZWQgZmllbGRzXHJcbiAgICBpZiAoIW5hbWUgfHwgIWVtYWlsIHx8ICFwYXNzd29yZCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnbmFtZSwgZW1haWwsIGFuZCBwYXNzd29yZCBhcmUgcmVxdWlyZWQnLFxyXG4gICAgICAgIGVycm9yczoge1xyXG4gICAgICAgICAgbmFtZTogIW5hbWUgPyAnTmFtZSBpcyByZXF1aXJlZCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBlbWFpbDogIWVtYWlsID8gJ0VtYWlsIGlzIHJlcXVpcmVkJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIHBhc3N3b3JkOiAhcGFzc3dvcmQgPyAnUGFzc3dvcmQgaXMgcmVxdWlyZWQnIDogdW5kZWZpbmVkLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEVtYWlsIHZhbGlkYXRpb25cclxuICAgIGlmICghaXNFbWFpbChlbWFpbCkpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0ludmFsaWQgZW1haWwgZm9ybWF0JyxcclxuICAgICAgICBlcnJvcnM6IHsgZW1haWw6ICdQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3MnIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhc3N3b3JkIGxlbmd0aFxyXG4gICAgaWYgKFN0cmluZyhwYXNzd29yZCkubGVuZ3RoIDwgOCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMnLFxyXG4gICAgICAgIGVycm9yczogeyBwYXNzd29yZDogJ1Bhc3N3b3JkIG11c3QgaGF2ZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMnIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbmZpcm0gcGFzc3dvcmRcclxuICAgIGlmIChjb25maXJtUGFzc3dvcmQgJiYgcGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUGFzc3dvcmRzIGRvIG5vdCBtYXRjaCcsXHJcbiAgICAgICAgZXJyb3JzOiB7IGNvbmZpcm1QYXNzd29yZDogJ1Bhc3N3b3JkcyBtdXN0IG1hdGNoJyB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTYW5pdGl6ZSBpbnB1dHNcclxuICAgIHJlcS5ib2R5Lm5hbWUgPSBzYW5pdGl6ZVN0cmluZyhuYW1lKTtcclxuICAgIHJlcS5ib2R5LmVtYWlsID0gc2FuaXRpemVFbWFpbChlbWFpbCk7XHJcblxyXG4gICAgbmV4dCgpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1ZhbGlkYXRpb24gZXJyb3InLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIExvZ2luIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IHZhbGlkYXRlTG9naW4gPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5IHx8IHt9O1xyXG5cclxuICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdlbWFpbCBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkJyxcclxuICAgICAgICBlcnJvcnM6IHtcclxuICAgICAgICAgIGVtYWlsOiAhZW1haWwgPyAnRW1haWwgaXMgcmVxdWlyZWQnIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgcGFzc3dvcmQ6ICFwYXNzd29yZCA/ICdQYXNzd29yZCBpcyByZXF1aXJlZCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFpc0VtYWlsKGVtYWlsKSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCBlbWFpbCBmb3JtYXQnLFxyXG4gICAgICAgIGVycm9yczogeyBlbWFpbDogJ1BsZWFzZSBwcm92aWRlIGEgdmFsaWQgZW1haWwgYWRkcmVzcycgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2FuaXRpemVcclxuICAgIHJlcS5ib2R5LmVtYWlsID0gc2FuaXRpemVFbWFpbChlbWFpbCk7XHJcblxyXG4gICAgbmV4dCgpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1ZhbGlkYXRpb24gZXJyb3InLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSB1c2VyIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IHZhbGlkYXRlQ3JlYXRlVXNlciA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCByb2xlLCBkZXBhcnRtZW50IH0gPSByZXEuYm9keSB8fCB7fTtcclxuXHJcbiAgICBpZiAoIW5hbWUgfHwgIWVtYWlsIHx8ICFyb2xlKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICduYW1lLCBlbWFpbCwgYW5kIHJvbGUgYXJlIHJlcXVpcmVkJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFpc0VtYWlsKGVtYWlsKSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCBlbWFpbCBmb3JtYXQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB2YWxpZFJvbGVzID0gWydhZG1pbicsICdtYW5hZ2VyJywgJ2VtcGxveWVlJywgJ3ZpZXdlciddO1xyXG4gICAgaWYgKCF2YWxpZFJvbGVzLmluY2x1ZGVzKHJvbGUpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IGBJbnZhbGlkIHJvbGUuIE11c3QgYmUgb25lIG9mOiAke3ZhbGlkUm9sZXMuam9pbignLCAnKX1gLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTYW5pdGl6ZVxyXG4gICAgcmVxLmJvZHkubmFtZSA9IHNhbml0aXplU3RyaW5nKG5hbWUpO1xyXG4gICAgcmVxLmJvZHkuZW1haWwgPSBzYW5pdGl6ZUVtYWlsKGVtYWlsKTtcclxuICAgIGlmIChkZXBhcnRtZW50KSByZXEuYm9keS5kZXBhcnRtZW50ID0gc2FuaXRpemVTdHJpbmcoZGVwYXJ0bWVudCk7XHJcblxyXG4gICAgbmV4dCgpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1ZhbGlkYXRpb24gZXJyb3InLFxyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIElEIHBhcmFtZXRlclxyXG4gKi9cclxuY29uc3QgdmFsaWRhdGVJZCA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgXHJcbiAgaWYgKCFpZCkge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnSUQgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFpc1ZhbGlkT2JqZWN0SWQoaWQpKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdJbnZhbGlkIElEIGZvcm1hdCcsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5leHQoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSBwYWdpbmF0aW9uXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZVBhZ2luYXRpb24gPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICBjb25zdCB7IHBhZ2UgPSAxLCBsaW1pdCA9IDEwIH0gPSByZXEucXVlcnk7XHJcblxyXG4gIGNvbnN0IHBhZ2VOdW0gPSBwYXJzZUludChwYWdlKTtcclxuICBjb25zdCBsaW1pdE51bSA9IHBhcnNlSW50KGxpbWl0KTtcclxuXHJcbiAgaWYgKGlzTmFOKHBhZ2VOdW0pIHx8IHBhZ2VOdW0gPCAxKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdJbnZhbGlkIHBhZ2UgbnVtYmVyJyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaWYgKGlzTmFOKGxpbWl0TnVtKSB8fCBsaW1pdE51bSA8IDEgfHwgbGltaXROdW0gPiAxMDApIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludmFsaWQgbGltaXQuIE11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMDAnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXEucGFnaW5hdGlvbiA9IHtcclxuICAgIHBhZ2U6IHBhZ2VOdW0sXHJcbiAgICBsaW1pdDogbGltaXROdW0sXHJcbiAgICBza2lwOiAocGFnZU51bSAtIDEpICogbGltaXROdW0sXHJcbiAgfTtcclxuXHJcbiAgbmV4dCgpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgLy8gVmFsaWRhdG9yc1xyXG4gIGlzRW1haWwsXHJcbiAgaXNTdHJvbmdQYXNzd29yZCxcclxuICBpc1Bob25lTnVtYmVyLFxyXG4gIGlzVmFsaWRVcmwsXHJcbiAgaXNWYWxpZE9iamVjdElkLFxyXG5cclxuICAvLyBTYW5pdGl6ZXJzXHJcbiAgc2FuaXRpemVTdHJpbmcsXHJcbiAgc2FuaXRpemVFbWFpbCxcclxuICBzYW5pdGl6ZUJvZHksXHJcblxyXG4gIC8vIE1pZGRsZXdhcmVcclxuICB2YWxpZGF0ZVJlZ2lzdHJhdGlvbixcclxuICB2YWxpZGF0ZUxvZ2luLFxyXG4gIHZhbGlkYXRlQ3JlYXRlVXNlcixcclxuICB2YWxpZGF0ZUlkLFxyXG4gIHZhbGlkYXRlUGFnaW5hdGlvbixcclxufTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTTtFQUFFQTtBQUFTLENBQUMsR0FBR0MsT0FBTyxDQUFDLHNCQUFzQixDQUFDOztBQUVwRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNQyxPQUFPLEdBQUlDLEtBQUssSUFBSztFQUN6QixNQUFNQyxVQUFVLEdBQUcsNEJBQTRCO0VBQy9DLE9BQU9BLFVBQVUsQ0FBQ0MsSUFBSSxDQUFDRixLQUFLLElBQUksRUFBRSxDQUFDO0FBQ3JDLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBTUcsZ0JBQWdCLEdBQUlDLFFBQVEsSUFBSztF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