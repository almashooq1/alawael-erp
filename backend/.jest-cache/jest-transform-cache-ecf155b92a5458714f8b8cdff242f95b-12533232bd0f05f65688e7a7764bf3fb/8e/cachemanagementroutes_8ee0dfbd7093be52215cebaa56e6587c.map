{"version":3,"names":["express","require","router","Router","getCacheStats","clearCache","use","req","res","next","console","log","method","path","originalUrl","baseUrl","get","stats","JSON","stringify","json","success","caching","message","error","status","post","body","isHealthy","parseInt","entries","cacheStatus","enabled","size","hitRate","module","exports"],"sources":["cache-management.routes.js"],"sourcesContent":["/**\r\n * Cache Management Routes\r\n * Handles performance optimizer cache statistics and clearing\r\n * \r\n * Endpoints:\r\n * - GET /api/cache-stats - Get cache statistics\r\n * - POST /api/cache/clear - Clear cache\r\n */\r\n\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst { getCacheStats, clearCache } = require('../utils/performance-optimizer');\r\n\r\n// Debug middleware to log all requests to this router\r\nrouter.use((req, res, next) => {\r\n  console.log(`[CACHE-ROUTER] ${req.method} ${req.path} | URL: ${req.originalUrl} | Base URL: ${req.baseUrl}`);\r\n  next();\r\n});\r\n\r\n/**\r\n * @route   GET /cache-stats\r\n * @desc    Get cache statistics from response cache\r\n * @access  Public\r\n */\r\nrouter.get('/cache-stats', (req, res) => {\r\n  try {\r\n    console.log('[CACHE-STATS] Endpoint hit - returning statistics');\r\n    const stats = getCacheStats();\r\n    console.log('[CACHE-STATS] Stats retrieved:', JSON.stringify(stats));\r\n    res.json({\r\n      success: true,\r\n      caching: stats,\r\n      message: 'Cache statistics retrieved successfully'\r\n    });\r\n  } catch (error) {\r\n    console.error('[CACHE-STATS] Error:', error.message);\r\n    res.status(500).json({\r\n      success: false,\r\n      error: error.message,\r\n      message: 'Failed to retrieve cache statistics'\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * @route   POST /cache/clear\r\n * @desc    Clear cache (all or specific path)\r\n * @access  Public\r\n */\r\nrouter.post('/cache/clear', (req, res) => {\r\n  try {\r\n    console.log('[CACHE-CLEAR] Endpoint hit - clearing cache');\r\n    const path = req.body?.path || null;\r\n    clearCache(path);\r\n    \r\n    const stats = getCacheStats();\r\n    console.log('[CACHE-CLEAR] Cache cleared successfully');\r\n    res.json({\r\n      success: true,\r\n      message: path ? `Cache cleared for ${path}` : 'All cache cleared',\r\n      stats: stats\r\n    });\r\n  } catch (error) {\r\n    console.error('[CACHE-CLEAR] Error:', error.message);\r\n    res.status(500).json({\r\n      success: false,\r\n      error: error.message,\r\n      message: 'Failed to clear cache'\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * @route   GET /cache/health\r\n * @desc    Health check for cache system\r\n * @access  Public\r\n */\r\nrouter.get('/cache/health', (req, res) => {\r\n  try {\r\n    const stats = getCacheStats();\r\n    const isHealthy = parseInt(stats.entries) >= 0;\r\n    \r\n    res.json({\r\n      success: true,\r\n      status: isHealthy ? 'healthy' : 'degraded',\r\n      cacheStatus: {\r\n        enabled: true,\r\n        entries: stats.entries,\r\n        size: stats.size,\r\n        hitRate: stats.hitRate\r\n      }\r\n    });\r\n  } catch (error) {\r\n    res.status(503).json({\r\n      success: false,\r\n      status: 'unhealthy',\r\n      error: error.message\r\n    });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}