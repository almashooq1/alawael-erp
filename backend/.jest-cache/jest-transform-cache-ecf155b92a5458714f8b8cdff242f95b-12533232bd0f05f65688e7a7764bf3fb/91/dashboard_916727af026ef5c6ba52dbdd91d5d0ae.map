{"version":3,"names":["express","require","router","Router","systemDashboard","responseFormatter","requireAdmin","optionalAuth","get","_req","res","health","getSystemHealth","json","success","error","status","serverError","summary","getDashboardSummary","list","services","req","name","params","checkServiceStatus","notFound","integrations","analytics","performance","recentAlerts","recentEvents","post","severity","message","details","body","validationError","alert","addAlert","created","metrics","exportMetrics","setHeader","config","getConfig","sanitized","server","features","deployment","version","module","exports"],"sources":["dashboard.js"],"sourcesContent":["/**\n * Dashboard Routes\n * System monitoring, health checks, and metrics\n * Phase 11: System Integration\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst systemDashboard = require('../services/systemDashboard');\nconst responseFormatter = require('../services/responseFormatter');\nconst { requireAdmin, optionalAuth } = require('../middleware/auth');\n\n/**\n * GET /api/dashboard/health\n * System health check\n */\nrouter.get('/health', optionalAuth, (_req, res) => {\n  try {\n    const health = systemDashboard.getSystemHealth();\n    res.json(responseFormatter.success(health, 'System health status'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Health check failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/summary\n * Dashboard summary\n */\nrouter.get('/summary', optionalAuth, (_req, res) => {\n  try {\n    const summary = systemDashboard.getDashboardSummary();\n    res.json(responseFormatter.success(summary, 'Dashboard summary'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Summary retrieval failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/services\n * List all services status\n */\nrouter.get('/services', optionalAuth, (_req, res) => {\n  try {\n    const health = systemDashboard.getSystemHealth();\n    res.json(responseFormatter.list(health.services, 'Services status'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Services retrieval failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/services/:name\n * Get specific service status\n */\nrouter.get('/services/:name', optionalAuth, (req, res) => {\n  try {\n    const { name } = req.params;\n    const status = systemDashboard.checkServiceStatus(name);\n\n    if (status.status === 'unknown') {\n      return res.status(404).json(responseFormatter.notFound(`Service ${name}`));\n    }\n\n    res.json(responseFormatter.success(status, `Service ${name} status`));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Service check failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/integrations\n * List all integrations status\n */\nrouter.get('/integrations', optionalAuth, (req, res) => {\n  try {\n    const health = systemDashboard.getSystemHealth();\n    res.json(responseFormatter.success(health.integrations, 'Integrations status'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Integrations retrieval failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/performance\n * Performance metrics\n */\nrouter.get('/performance', optionalAuth, (req, res) => {\n  try {\n    const health = systemDashboard.getSystemHealth();\n    res.json(responseFormatter.analytics(health.performance, 'current', 'Performance metrics'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Performance metrics failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/alerts\n * System alerts\n */\nrouter.get('/alerts', requireAdmin, (req, res) => {\n  try {\n    const summary = systemDashboard.getDashboardSummary();\n    res.json(responseFormatter.list(summary.recentAlerts, 'Recent alerts'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Alerts retrieval failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/events\n * System events log\n */\nrouter.get('/events', requireAdmin, (req, res) => {\n  try {\n    const summary = systemDashboard.getDashboardSummary();\n    res.json(responseFormatter.list(summary.recentEvents, 'Recent events'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Events retrieval failed', error));\n  }\n});\n\n/**\n * POST /api/dashboard/alert\n * Add custom alert\n */\nrouter.post('/alert', requireAdmin, (req, res) => {\n  try {\n    const { severity, message, details } = req.body;\n\n    if (!severity || !message) {\n      return res\n        .status(400)\n        .json(responseFormatter.validationError(['severity and message are required']));\n    }\n\n    const alert = systemDashboard.addAlert(severity, message, details);\n    res.status(201).json(responseFormatter.created(alert, 'Alert created'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Alert creation failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/export\n * Export all metrics\n */\nrouter.get('/export', requireAdmin, (req, res) => {\n  try {\n    const metrics = systemDashboard.exportMetrics();\n    res.setHeader('Content-Type', 'application/json');\n    res.setHeader('Content-Disposition', 'attachment; filename=metrics.json');\n    res.json(metrics);\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Export failed', error));\n  }\n});\n\n/**\n * GET /api/dashboard/config\n * Get system configuration (admin only)\n */\nrouter.get('/config', requireAdmin, (req, res) => {\n  try {\n    const config = require('../config/production').getConfig();\n    const sanitized = {\n      server: config.server,\n      features: config.features,\n      deployment: config.deployment,\n      version: config.deployment.version,\n    };\n    res.json(responseFormatter.success(sanitized, 'System configuration'));\n  } catch (error) {\n    res.status(500).json(responseFormatter.serverError('Config retrieval failed', error));\n  }\n});\n\nmodule.exports = router;\n"],"mappings":"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","ignoreList":[]}