{"version":3,"names":["logger","require","RealtimeDashboardService","constructor","dataConnections","Map","activeSubscriptions","cachedData","webhooks","streamingConnections","lastUpdateTime","initialize","info","initializeDataSources","setupCaching","enableRealtimeUpdates","error","sources","id","name","endpoints","refreshInterval","forEach","source","set","lastFetch","status","data","cacheStrategy","financialData","ttl","maxSize","hrData","operationsData","customerData","systemMetrics","key","config","Object","entries","timestamp","sourceId","setInterval","fetchSourceData","get","generateMockData","Date","updateCache","notifySubscribers","message","baseData","totalRevenue","totalExpenses","netProfit","cashFlow","budgetUtilization","transactions","amount","type","date","totalEmployees","activeEmployees","attendanceRate","trainingCompleted","performanceRating","departments","engineering","sales","support","admin","hr","management","activeProjects","completedTasks","pendingTasks","operationalEfficiency","projectCompletion","averageTaskDuration","bottlenecks","totalCustomers","activeCustomers","customerSatisfaction","nps","retentionRate","churnRate","averageTicketResolutionTime","openTickets","uptime","averageResponseTime","errorRate","cacheHitRate","databaseHealth","messageQueueDepth","activeConnections","cpuUsage","memoryUsage","cacheKey","cacheEntry","getCachedData","now","getTime","getAggregatedDashboardData","aggregated","summary","healthStatus","dataFreshness","lastUpdate","age","ageMs","isFresh","subscribe","callback","has","push","callbacks","index","indexOf","splice","registerWebhook","url","events","webhook","length","createdAt","active","triggerWebhook","eventType","relevantWebhooks","filter","w","includes","getDataQualityMetrics","metrics","overall","completeness","accuracy","timeliness","consistency","totalCompleteness","totalTimeliness","timelinessScore","Math","max","completenessScore","sourceCount","size","getConnectionStats","totalSources","activeSources","Array","from","values","s","erroredSources","reduce","sum","arr","registeredWebhooks","activeWebhooks","refreshAllData","results","keys","success","getStreamingData","module","exports"],"sources":["realtimeDashboardService.js"],"sourcesContent":["/**\r\n * Real-time Dashboard Integration Service\r\n * Aggregates data from multiple sources and provides real-time updates\r\n * \r\n * Features:\r\n * - Multi-source data aggregation\r\n * - Real-time data streaming\r\n * - Data caching and optimization\r\n * - Webhook integration\r\n * - WebSocket support\r\n * - Data consistency checks\r\n */\r\n\r\nconst logger = require('../utils/logger');\r\n\r\nclass RealtimeDashboardService {\r\n  constructor() {\r\n    this.dataConnections = new Map();\r\n    this.activeSubscriptions = new Map();\r\n    this.cachedData = new Map();\r\n    this.webhooks = [];\r\n    this.streamingConnections = [];\r\n    this.lastUpdateTime = new Map();\r\n  }\r\n\r\n  /**\r\n   * Initialize real-time connections\r\n   */\r\n  async initialize() {\r\n    try {\r\n      logger.info('ðŸš€ Real-time Dashboard Service: Initializing...');\r\n      \r\n      // Initialize data sources\r\n      this.initializeDataSources();\r\n      \r\n      // Setup caching\r\n      this.setupCaching();\r\n      \r\n      // Enable real-time updates\r\n      this.enableRealtimeUpdates();\r\n      \r\n      logger.info('âœ… Real-time Dashboard Service: Initialized');\r\n      return true;\r\n    } catch (error) {\r\n      logger.error('âŒ Real-time Dashboard Service: Initialization failed', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize available data sources\r\n   */\r\n  initializeDataSources() {\r\n    const sources = [\r\n      {\r\n        id: 'financial',\r\n        name: 'Financial Data',\r\n        endpoints: ['/api/finance/transactions', '/api/finance/budgets'],\r\n        refreshInterval: 60000, // 1 minute\r\n      },\r\n      {\r\n        id: 'hr',\r\n        name: 'HR Data',\r\n        endpoints: ['/api/hr/employees', '/api/hr/attendance'],\r\n        refreshInterval: 300000, // 5 minutes\r\n      },\r\n      {\r\n        id: 'operations',\r\n        name: 'Operations Data',\r\n        endpoints: ['/api/operations/tasks', '/api/operations/efficiency'],\r\n        refreshInterval: 120000, // 2 minutes\r\n      },\r\n      {\r\n        id: 'customer',\r\n        name: 'Customer Data',\r\n        endpoints: ['/api/customer/satisfaction', '/api/customer/engagement'],\r\n        refreshInterval: 180000, // 3 minutes\r\n      },\r\n      {\r\n        id: 'system',\r\n        name: 'System Performance',\r\n        endpoints: ['/api/system/health', '/api/system/performance'],\r\n        refreshInterval: 30000, // 30 seconds\r\n      },\r\n    ];\r\n\r\n    sources.forEach(source => {\r\n      this.dataConnections.set(source.id, {\r\n        ...source,\r\n        lastFetch: null,\r\n        status: 'inactive',\r\n        data: null,\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Setup data caching\r\n   */\r\n  setupCaching() {\r\n    const cacheStrategy = {\r\n      financialData: { ttl: 60000, maxSize: 1000 },\r\n      hrData: { ttl: 300000, maxSize: 500 },\r\n      operationsData: { ttl: 120000, maxSize: 500 },\r\n      customerData: { ttl: 180000, maxSize: 500 },\r\n      systemMetrics: { ttl: 30000, maxSize: 2000 },\r\n    };\r\n\r\n    for (const [key, config] of Object.entries(cacheStrategy)) {\r\n      this.cachedData.set(key, {\r\n        data: null,\r\n        timestamp: null,\r\n        ttl: config.ttl,\r\n        maxSize: config.maxSize,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Enable real-time updates\r\n   */\r\n  enableRealtimeUpdates() {\r\n    // Setup periodic update intervals for each data source\r\n    for (const [sourceId, source] of this.dataConnections.entries()) {\r\n      setInterval(() => {\r\n        this.fetchSourceData(sourceId);\r\n      }, source.refreshInterval);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fetch data from a specific source\r\n   */\r\n  async fetchSourceData(sourceId) {\r\n    const source = this.dataConnections.get(sourceId);\r\n    if (!source) return;\r\n\r\n    try {\r\n      // Simulate data fetching\r\n      const data = this.generateMockData(sourceId);\r\n      \r\n      source.data = data;\r\n      source.lastFetch = new Date();\r\n      source.status = 'active';\r\n      \r\n      this.updateCache(sourceId, data);\r\n      this.notifySubscribers(sourceId, data);\r\n      \r\n      return data;\r\n    } catch (error) {\r\n      logger.error(`Error fetching data from ${sourceId}:`, error);\r\n      source.status = 'error';\r\n      source.error = error.message;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate mock data for demonstration\r\n   */\r\n  generateMockData(sourceId) {\r\n    const baseData = {\r\n      timestamp: new Date(),\r\n      sourceId,\r\n    };\r\n\r\n    switch (sourceId) {\r\n      case 'financial':\r\n        return {\r\n          ...baseData,\r\n          totalRevenue: 950000,\r\n          totalExpenses: 620000,\r\n          netProfit: 330000,\r\n          cashFlow: 120000,\r\n          budgetUtilization: 78.5,\r\n          transactions: [\r\n            { id: 1, amount: 50000, type: 'income', date: new Date() },\r\n            { id: 2, amount: 15000, type: 'expense', date: new Date() },\r\n          ],\r\n        };\r\n      \r\n      case 'hr':\r\n        return {\r\n          ...baseData,\r\n          totalEmployees: 250,\r\n          activeEmployees: 245,\r\n          attendanceRate: 96.2,\r\n          trainingCompleted: 178,\r\n          performanceRating: 4.2,\r\n          departments: {\r\n            engineering: 85,\r\n            sales: 45,\r\n            support: 40,\r\n            admin: 35,\r\n            hr: 15,\r\n            management: 15,\r\n          },\r\n        };\r\n      \r\n      case 'operations':\r\n        return {\r\n          ...baseData,\r\n          activeProjects: 12,\r\n          completedTasks: 84,\r\n          pendingTasks: 23,\r\n          operationalEfficiency: 88.5,\r\n          projectCompletion: 91.2,\r\n          averageTaskDuration: 4.5,\r\n          bottlenecks: ['approval_process', 'resource_allocation'],\r\n        };\r\n      \r\n      case 'customer':\r\n        return {\r\n          ...baseData,\r\n          totalCustomers: 1200,\r\n          activeCustomers: 950,\r\n          customerSatisfaction: 92,\r\n          nps: 74,\r\n          retentionRate: 94.2,\r\n          churnRate: 1.2,\r\n          averageTicketResolutionTime: 2.3,\r\n          openTickets: 23,\r\n        };\r\n      \r\n      case 'system':\r\n        return {\r\n          ...baseData,\r\n          uptime: 99.98,\r\n          averageResponseTime: 125,\r\n          errorRate: 0.02,\r\n          cacheHitRate: 94.5,\r\n          databaseHealth: 'healthy',\r\n          messageQueueDepth: 234,\r\n          activeConnections: 2048,\r\n          cpuUsage: 45.2,\r\n          memoryUsage: 62.8,\r\n        };\r\n      \r\n      default:\r\n        return baseData;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update cache with new data\r\n   */\r\n  updateCache(sourceId, data) {\r\n    const cacheKey = `${sourceId}Data`;\r\n    const cacheEntry = this.cachedData.get(cacheKey);\r\n    \r\n    if (cacheEntry) {\r\n      cacheEntry.data = data;\r\n      cacheEntry.timestamp = new Date();\r\n      this.lastUpdateTime.set(sourceId, new Date());\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get cached data\r\n   */\r\n  getCachedData(sourceId) {\r\n    const cacheKey = `${sourceId}Data`;\r\n    const cacheEntry = this.cachedData.get(cacheKey);\r\n    \r\n    if (!cacheEntry) return null;\r\n    \r\n    // Check if cache is still valid\r\n    if (cacheEntry.timestamp && Date.now() - cacheEntry.timestamp.getTime() > cacheEntry.ttl) {\r\n      return null; // Cache expired\r\n    }\r\n    \r\n    return cacheEntry.data;\r\n  }\r\n\r\n  /**\r\n   * Get aggregated dashboard data\r\n   */\r\n  getAggregatedDashboardData() {\r\n    const aggregated = {\r\n      timestamp: new Date(),\r\n      sources: {},\r\n      summary: {\r\n        healthStatus: 'healthy',\r\n        dataFreshness: {},\r\n      },\r\n    };\r\n\r\n    for (const [sourceId, source] of this.dataConnections.entries()) {\r\n      const cachedData = this.getCachedData(sourceId);\r\n      \r\n      aggregated.sources[sourceId] = {\r\n        name: source.name,\r\n        status: source.status,\r\n        lastUpdate: source.lastFetch,\r\n        data: cachedData || source.data,\r\n      };\r\n\r\n      // Calculate data freshness\r\n      if (source.lastFetch) {\r\n        const age = Date.now() - source.lastFetch.getTime();\r\n        aggregated.summary.dataFreshness[sourceId] = {\r\n          ageMs: age,\r\n          isFresh: age < source.refreshInterval * 2,\r\n        };\r\n      }\r\n    }\r\n\r\n    return aggregated;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to real-time updates\r\n   */\r\n  subscribe(sourceId, callback) {\r\n    if (!this.activeSubscriptions.has(sourceId)) {\r\n      this.activeSubscriptions.set(sourceId, []);\r\n    }\r\n\r\n    this.activeSubscriptions.get(sourceId).push(callback);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const callbacks = this.activeSubscriptions.get(sourceId);\r\n      const index = callbacks.indexOf(callback);\r\n      if (index > -1) {\r\n        callbacks.splice(index, 1);\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Notify subscribers of data updates\r\n   */\r\n  notifySubscribers(sourceId, data) {\r\n    const callbacks = this.activeSubscriptions.get(sourceId);\r\n    \r\n    if (callbacks) {\r\n      callbacks.forEach(callback => {\r\n        try {\r\n          callback(data);\r\n        } catch (error) {\r\n          logger.error(`Error in subscriber callback for ${sourceId}:`, error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Register webhook for external notifications\r\n   */\r\n  registerWebhook(sourceId, url, events = []) {\r\n    const webhook = {\r\n      id: `webhook_${Date.now()}`,\r\n      sourceId,\r\n      url,\r\n      events: events.length > 0 ? events : ['update'],\r\n      createdAt: new Date(),\r\n      active: true,\r\n    };\r\n\r\n    this.webhooks.push(webhook);\r\n    return webhook;\r\n  }\r\n\r\n  /**\r\n   * Trigger webhook event\r\n   */\r\n  async triggerWebhook(sourceId, eventType, data) {\r\n    const relevantWebhooks = this.webhooks.filter(\r\n      w => w.sourceId === sourceId && w.events.includes(eventType) && w.active\r\n    );\r\n\r\n    for (const webhook of relevantWebhooks) {\r\n      try {\r\n        // Simulate webhook call\r\n        logger.info(`Triggering webhook: ${webhook.url}`, { eventType, sourceId });\r\n        // In real implementation, would use axios or fetch to call webhook\r\n      } catch (error) {\r\n        logger.error(`Webhook trigger failed: ${webhook.id}`, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get data quality metrics\r\n   */\r\n  getDataQualityMetrics() {\r\n    const metrics = {\r\n      timestamp: new Date(),\r\n      sources: {},\r\n      overall: {\r\n        completeness: 0,\r\n        accuracy: 0,\r\n        timeliness: 0,\r\n        consistency: 0,\r\n      },\r\n    };\r\n\r\n    let totalCompleteness = 0;\r\n    let totalTimeliness = 0;\r\n\r\n    for (const [sourceId, source] of this.dataConnections.entries()) {\r\n      const data = this.getCachedData(sourceId);\r\n      const age = source.lastFetch ? Date.now() - source.lastFetch.getTime() : null;\r\n\r\n      const timelinessScore = age\r\n        ? Math.max(0, 100 - (age / source.refreshInterval) * 100)\r\n        : 0;\r\n\r\n      const completenessScore = data ? 95 : 0;\r\n\r\n      metrics.sources[sourceId] = {\r\n        completeness: completenessScore,\r\n        timeliness: timelinessScore,\r\n        consistency: 98,\r\n        accuracy: 96,\r\n      };\r\n\r\n      totalCompleteness += completenessScore;\r\n      totalTimeliness += timelinessScore;\r\n    }\r\n\r\n    const sourceCount = this.dataConnections.size;\r\n    metrics.overall.completeness = totalCompleteness / sourceCount;\r\n    metrics.overall.timeliness = totalTimeliness / sourceCount;\r\n    metrics.overall.consistency = 97;\r\n    metrics.overall.accuracy = 96;\r\n\r\n    return metrics;\r\n  }\r\n\r\n  /**\r\n   * Get connection statistics\r\n   */\r\n  getConnectionStats() {\r\n    return {\r\n      timestamp: new Date(),\r\n      totalSources: this.dataConnections.size,\r\n      activeSources: Array.from(this.dataConnections.values()).filter(s => s.status === 'active').length,\r\n      erroredSources: Array.from(this.dataConnections.values()).filter(s => s.status === 'error').length,\r\n      activeSubscriptions: Array.from(this.activeSubscriptions.values()).reduce((sum, arr) => sum + arr.length, 0),\r\n      registeredWebhooks: this.webhooks.length,\r\n      activeWebhooks: this.webhooks.filter(w => w.active).length,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Force refresh all data sources\r\n   */\r\n  async refreshAllData() {\r\n    const results = {};\r\n\r\n    for (const sourceId of this.dataConnections.keys()) {\r\n      try {\r\n        const data = await this.fetchSourceData(sourceId);\r\n        results[sourceId] = { success: true, data };\r\n      } catch (error) {\r\n        results[sourceId] = { success: false, error: error.message };\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * Get streaming data for WebSocket\r\n   */\r\n  getStreamingData(sourceId) {\r\n    const source = this.dataConnections.get(sourceId);\r\n    const cachedData = this.getCachedData(sourceId);\r\n\r\n    if (!source) {\r\n      return { error: 'Source not found' };\r\n    }\r\n\r\n    return {\r\n      sourceId,\r\n      timestamp: new Date(),\r\n      data: cachedData || source.data,\r\n      status: source.status,\r\n      lastUpdate: source.lastFetch,\r\n    };\r\n  }\r\n}\r\n\r\nmodule.exports = new RealtimeDashboardService();\r\n"],"mappings":"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","ignoreList":[]}