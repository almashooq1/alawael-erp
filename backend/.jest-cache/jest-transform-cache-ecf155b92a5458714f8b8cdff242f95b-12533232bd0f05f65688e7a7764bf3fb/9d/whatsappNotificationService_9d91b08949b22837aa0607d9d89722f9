3d2cd413e8ccc6614bf2b14d4660a412
/**
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 * üì± WhatsApp Notification Service
 * ÿÆÿØŸÖÿ© ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ŸàÿßŸÑÿ™ŸÜÿ®ŸäŸáÿßÿ™ ÿπÿ®ÿ± ÿßŸÑŸàÿßÿ™ÿ≥ ÿ¢ÿ®
 * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
 * 
 * ŸÖÿ™ŸÇÿØŸÖÿ© Ÿàÿ¥ÿßŸÖŸÑÿ© Ÿàÿ∞ŸÉŸäÿ© ŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ŸàÿßŸÑÿ™ŸÜÿ®ŸäŸáÿßÿ™ ÿπÿ®ÿ± ÿßŸÑŸàÿßÿ™ÿ≥ ÿ¢ÿ®
 * - ÿØÿπŸÖ ÿßŸÑŸÜÿµŸàÿµ ŸàÿßŸÑÿµŸàÿ± ŸàÿßŸÑŸÖŸÑŸÅÿßÿ™
 * - ŸÜÿ∏ÿßŸÖ ŸÇŸàÿßŸÑÿ® ÿ∞ŸÉŸäÿ©
 * - ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ£ÿÆÿ∑ÿßÿ° ŸàÿßŸÑÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©
 * - ÿ™ÿ™ÿ®ÿπ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
 */

const axios = require('axios');
const EventEmitter = require('events');
const logger = require('../utils/logger');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚úÖ WhatsApp Notification Service
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

class WhatsAppNotificationService extends EventEmitter {
  constructor(config = {}) {
    super();

    // ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ° (Whitelist) ŸÖŸÜ ÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑŸáÿßÿ™ŸÅ
    this.whitelist = new Set();

    // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ŸÄ WhatsApp API
    this.apiConfig = {
      baseURL: process.env.WHATSAPP_API_URL || 'https://api.whatsapp.com/send',
      token: process.env.WHATSAPP_API_TOKEN || process.env.WHATSAPP_TOKEN,
      phoneNumberId: process.env.WHATSAPP_PHONE_NUMBER_ID,
      businessAccountId: process.env.WHATSAPP_BUSINESS_ACCOUNT_ID,
      apiVersion: process.env.WHATSAPP_API_VERSION || 'v18.0'
    };

    // ÿÆŸàÿßÿØŸÖ WhatsApp ÿßŸÑŸÖŸàÿ´ŸàŸÇÿ©
    this.whatsappProviders = {
      official: {
        baseURL: 'https://graph.instagram.com',
        version: 'v18.0'
      },
      twilio: {
        baseURL: 'https://api.twilio.com',
        accountSid: process.env.TWILIO_ACCOUNT_SID,
        authToken: process.env.TWILIO_AUTH_TOKEN
      },
      messagebird: {
        baseURL: 'https://messages-sandbox.nexmo.com',
        token: process.env.MESSAGEBIRD_API_KEY
      }
    };

    // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖŸÇÿØŸÖ ÿßŸÑŸÜÿ¥ÿ∑
    this.provider = process.env.WHATSAPP_PROVIDER || 'official';

    // ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÖÿ±ÿ≥ŸÑÿ© (ŸÑŸÑÿ™ÿ™ÿ®ÿπ)
    this.messageHistory = [];
    this.maxHistory = 1000;

    // ŸÖÿπÿØŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿØ (Rate Limiting)
    this.rateLimit = {
      messagesPerMinute: parseInt(process.env.WHATSAPP_RATE_LIMIT || '60'),
      messagesPerHour: parseInt(process.env.WHATSAPP_RATE_LIMIT_HOUR || '1000'),
      messagesSent: []
    };

    // ŸÖÿÆÿ≤ŸÜ ŸÖÿ§ŸÇÿ™ ŸÑÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™
    this.retryQueue = [];
    this.maxRetries = 3;
    this.retryDelay = 5000; // 5 ÿ´ŸàÿßŸÜŸä

    // ŸÇŸàÿßÿ¶ŸÖ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±
    this.messageQueue = [];
    this.isProcessing = false;
    this.initializeProvider();
    this.startQueueProcessor();
  }

  /**
   * ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÖŸÇÿØŸÖ ÿßŸÑŸÖÿÆÿ™ÿßÿ±
   */
  initializeProvider() {
    logger.info(`üîÑ Initializing WhatsApp provider: ${this.provider}`);
    switch (this.provider) {
      case 'twilio':
        this.setupTwilioProvider();
        break;
      case 'messagebird':
        this.setupMessageBirdProvider();
        break;
      default:
        this.setupOfficialProvider();
    }
  }

  /**
   * ÿ•ÿπÿØÿßÿØ ŸÖŸÇÿØŸÖ WhatsApp ÿßŸÑÿ±ÿ≥ŸÖŸä
   */
  setupOfficialProvider() {
    this.client = axios.create({
      baseURL: `${this.whatsappProviders.official.baseURL}/${this.whatsappProviders.official.version}/${this.apiConfig.phoneNumberId}`,
      headers: {
        'Authorization': `Bearer ${this.apiConfig.token}`,
        'Content-Type': 'application/json'
      },
      timeout: 10000
    });
    logger.info('‚úÖ WhatsApp Official Provider initialized');
  }

  /**
   * ÿ•ÿπÿØÿßÿØ ŸÖŸÇÿØŸÖ Twilio
   */
  setupTwilioProvider() {
    try {
      const twilio = require('twilio');
      this.twilioClient = twilio(this.whatsappProviders.twilio.accountSid, this.whatsappProviders.twilio.authToken);
      logger.info('‚úÖ Twilio WhatsApp Provider initialized');
    } catch (error) {
      logger.warn('‚ö†Ô∏è Twilio module not available. Falling back to Official Provider.');
      this.provider = 'official';
      this.setupOfficialProvider();
    }
  }

  /**
   * ÿ•ÿπÿØÿßÿØ ŸÖŸÇÿØŸÖ MessageBird
   */
  setupMessageBirdProvider() {
    this.client = axios.create({
      baseURL: this.whatsappProviders.messagebird.baseURL,
      headers: {
        'Authorization': `Bearer ${this.whatsappProviders.messagebird.token}`,
        'Content-Type': 'application/json'
      },
      timeout: 10000
    });
    logger.info('‚úÖ MessageBird WhatsApp Provider initialized');
  }

  /**
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   * üì® ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   */

  /**
   * ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿµŸäÿ©
   */
  async sendMessage(phoneNumber, message, options = {}) {
    try {
      // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ
      if (!this.isValidPhoneNumber(phoneNumber)) {
        throw new Error(`ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠: ${phoneNumber}`);
      }

      // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÇÿßÿ¶ŸÖÿ© ÿ®Ÿäÿ∂ÿßÿ° (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)
      if (process.env.WHATSAPP_WHITELIST_ONLY === 'true') {
        if (!this.whitelist.has(phoneNumber)) {
          logger.warn(`üì± ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ ÿ∫Ÿäÿ± ŸÖÿØÿ±ÿ¨ ŸÅŸä ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°: ${phoneNumber}`);
          throw new Error(`ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ ÿ∫Ÿäÿ± ŸÖÿµÿ±ÿ≠ ÿ®Ÿá`);
        }
      }

      // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÖÿπÿØŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿØ
      if (!this.checkRateLimit()) {
        logger.warn('‚ö†Ô∏è ÿ™ŸÖ ÿ™ÿ¨ÿßŸàÿ≤ ÿ≠ÿØ ŸÖÿπÿØŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ');
        throw new Error('ÿ™ŸÖ ÿ™ÿ¨ÿßŸàÿ≤ ÿ≠ÿØ ŸÖÿπÿØŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÑÿßÿ≠ŸÇÿßŸã');
      }
      const messageData = {
        phoneNumber: this.normalizePhoneNumber(phoneNumber),
        message: this.sanitizeMessage(message),
        timestamp: new Date(),
        status: 'pending',
        retries: 0,
        ...options
      };

      // ÿ•ÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±
      this.messageQueue.push(messageData);

      // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ≠ÿØÿ´
      this.emit('messageQueued', messageData);
      logger.info(`üìù ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ŸÖÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±: ${phoneNumber}`);
      return messageData;
    } catch (error) {
      logger.error(`‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©: ${error.message}`);
      this.emit('messageSendError', {
        phoneNumber,
        error: error.message
      });
      throw error;
    }
  }

  /**
   * ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ŸÖÿπ ÿµŸàÿ±ÿ©
   */
  async sendImageMessage(phoneNumber, imageUrl, caption = '', options = {}) {
    try {
      if (!this.isValidURL(imageUrl)) {
        throw new Error('ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿµŸàÿ±ÿ© ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠');
      }
      const messageData = {
        type: 'image',
        phoneNumber: this.normalizePhoneNumber(phoneNumber),
        media: imageUrl,
        caption: this.sanitizeMessage(caption),
        timestamp: new Date(),
        status: 'pending',
        retries: 0,
        ...options
      };
      this.messageQueue.push(messageData);
      this.emit('messageQueued', messageData);
      logger.info(`üñºÔ∏è ÿ±ÿ≥ÿßŸÑÿ© ÿµŸàÿ±ÿ© ŸÖÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±: ${phoneNumber}`);
      return messageData;
    } catch (error) {
      logger.error(`‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿµŸàÿ±ÿ©: ${error.message}`);
      throw error;
    }
  }

  /**
   * ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ŸÖÿπ ŸÖŸÑŸÅ
   */
  async sendDocumentMessage(phoneNumber, fileUrl, fileName = '', options = {}) {
    try {
      if (!this.isValidURL(fileUrl)) {
        throw new Error('ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÖŸÑŸÅ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠');
      }
      const messageData = {
        type: 'document',
        phoneNumber: this.normalizePhoneNumber(phoneNumber),
        media: fileUrl,
        fileName: fileName || 'document',
        timestamp: new Date(),
        status: 'pending',
        retries: 0,
        ...options
      };
      this.messageQueue.push(messageData);
      this.emit('messageQueued', messageData);
      logger.info(`üìÑ ÿ±ÿ≥ÿßŸÑÿ© ŸÖŸÑŸÅ ŸÖÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±: ${phoneNumber}`);
      return messageData;
    } catch (error) {
      logger.error(`‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑŸÖŸÑŸÅ: ${error.message}`);
      throw error;
    }
  }

  /**
   * ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿ™ŸÅÿßÿπŸÑŸäÿ© (ÿ£ÿ≤ÿ±ÿßÿ±)
   */
  async sendInteractiveMessage(phoneNumber, message, buttons, options = {}) {
    try {
      if (!Array.isArray(buttons) || buttons.length === 0) {
        throw new Error('Ÿäÿ¨ÿ® ÿ™ŸàŸÅŸäÿ± ÿ≤ÿ± Ÿàÿßÿ≠ÿØ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ');
      }
      if (buttons.length > 3) {
        throw new Error('ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ ŸÑŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸáŸà 3');
      }
      const messageData = {
        type: 'interactive',
        phoneNumber: this.normalizePhoneNumber(phoneNumber),
        message: this.sanitizeMessage(message),
        buttons: buttons.map((btn, idx) => ({
          id: btn.id || `btn_${idx}`,
          title: btn.title,
          description: btn.description || ''
        })),
        timestamp: new Date(),
        status: 'pending',
        retries: 0,
        ...options
      };
      this.messageQueue.push(messageData);
      this.emit('messageQueued', messageData);
      logger.info(`üîò ÿ±ÿ≥ÿßŸÑÿ© ÿ™ŸÅÿßÿπŸÑŸäÿ© ŸÖÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±: ${phoneNumber}`);
      return messageData;
    } catch (error) {
      logger.error(`‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ©: ${error.message}`);
      throw error;
    }
  }

  /**
   * ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿ¨ŸÖÿßÿπŸäÿ©
   */
  async sendBulkMessages(phoneNumbers, message, options = {}) {
    try {
      if (!Array.isArray(phoneNumbers) || phoneNumbers.length === 0) {
        throw new Error('Ÿäÿ¨ÿ® ÿ™ŸàŸÅŸäÿ± ŸÇÿßÿ¶ŸÖÿ© ÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑŸáÿßÿ™ŸÅ');
      }
      const results = [];
      for (const phoneNumber of phoneNumbers) {
        try {
          const result = await this.sendMessage(phoneNumber, message, options);
          results.push({
            phoneNumber,
            status: 'queued',
            id: result.id
          });
        } catch (error) {
          results.push({
            phoneNumber,
            status: 'failed',
            error: error.message
          });
        }
      }
      logger.info(`üì¨ ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ${results.filter(r => r.status === 'queued').length} ÿ±ÿ≥ÿßŸÑÿ© ÿ¨ŸÖÿßÿπŸäÿ© ÿ•ŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±`);
      return results;
    } catch (error) {
      logger.error(`‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ¨ŸÖÿßÿπŸä: ${error.message}`);
      throw error;
    }
  }

  /**
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   * ‚öôÔ∏è ŸÖÿπÿßŸÑÿ¨ÿ© ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   */

  /**
   * ÿ®ÿØÿ° ŸÖÿπÿßŸÑÿ¨ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±
   */
  startQueueProcessor() {
    setInterval(() => {
      if (!this.isProcessing && this.messageQueue.length > 0) {
        this.processQueue();
      }
    }, 1000);
    logger.info('‚ñ∂Ô∏è ŸÖÿπÿßŸÑÿ¨ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ± ŸÜÿ¥ÿ∑');
  }

  /**
   * ŸÖÿπÿßŸÑÿ¨ÿ© ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±
   */
  async processQueue() {
    if (this.isProcessing || this.messageQueue.length === 0) {
      return;
    }
    this.isProcessing = true;
    try {
      while (this.messageQueue.length > 0) {
        const message = this.messageQueue.shift();
        try {
          const result = await this.deliverMessage(message);
          message.status = 'sent';
          message.id = result.id;
          message.sentAt = new Date();
          this.addToHistory(message);
          this.emit('messageSent', message);
          logger.info(`‚úÖ ÿ±ÿ≥ÿßŸÑÿ© ŸÖÿ±ÿ≥ŸÑÿ© ÿ•ŸÑŸâ ${message.phoneNumber}`);

          // ÿ™ÿ£ÿÆŸäÿ± ÿµÿ∫Ÿäÿ± ŸÑÿ™ÿ¨ŸÜÿ® ÿßŸÑÿßÿ≤ÿØÿ≠ÿßŸÖ
          await this.delay(100);
        } catch (error) {
          message.retries = (message.retries || 0) + 1;
          if (message.retries >= this.maxRetries) {
            message.status = 'failed';
            message.error = error.message;
            this.addToHistory(message);
            this.emit('messageFailed', message);
            logger.error(`‚ùå ŸÅÿ¥ŸÑ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿ®ÿπÿØ ${this.maxRetries} ŸÖÿ≠ÿßŸàŸÑÿßÿ™: ${message.phoneNumber}`);
          } else {
            // ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ©
            this.retryQueue.push({
              message,
              retryAt: Date.now() + this.retryDelay * message.retries
            });
            logger.warn(`‚ö†Ô∏è ÿ•ÿπÿßÿØÿ© ŸÖÿ≠ÿßŸàŸÑÿ© ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ (${message.retries}/${this.maxRetries}): ${message.phoneNumber}`);
          }
        }
      }

      // ŸÖÿπÿßŸÑÿ¨ÿ© ŸÇÿßÿ¶ŸÖÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™
      await this.processRetryQueue();
    } finally {
      this.isProcessing = false;
    }
  }

  /**
   * ŸÖÿπÿßŸÑÿ¨ÿ© ŸÇÿßÿ¶ŸÖÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™
   */
  async processRetryQueue() {
    const now = Date.now();
    const readyRetries = this.retryQueue.filter(r => r.retryAt <= now);
    readyRetries.forEach(retry => {
      this.messageQueue.push(retry.message);
      this.retryQueue = this.retryQueue.filter(r => r !== retry);
    });
  }

  /**
   * ÿ™ÿ≥ŸÑŸäŸÖ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑŸÅÿπŸÑŸä
   */
  async deliverMessage(messageData) {
    try {
      switch (this.provider) {
        case 'twilio':
          return await this.sendViatwilio(messageData);
        case 'messagebird':
          return await this.sendViaMessageBird(messageData);
        default:
          return await this.sendViaOfficial(messageData);
      }
    } catch (error) {
      logger.error(`‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ: ${error.message}`);
      throw error;
    }
  }

  /**
   * ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± WhatsApp ÿßŸÑÿ±ÿ≥ŸÖŸä
   */
  async sendViaOfficial(messageData) {
    try {
      let payload;
      switch (messageData.type) {
        case 'image':
          payload = {
            messaging_product: 'whatsapp',
            recipient_type: 'individual',
            to: messageData.phoneNumber,
            type: 'image',
            image: {
              link: messageData.media
            }
          };
          break;
        case 'document':
          payload = {
            messaging_product: 'whatsapp',
            recipient_type: 'individual',
            to: messageData.phoneNumber,
            type: 'document',
            document: {
              link: messageData.media,
              filename: messageData.fileName
            }
          };
          break;
        case 'interactive':
          payload = {
            messaging_product: 'whatsapp',
            recipient_type: 'individual',
            to: messageData.phoneNumber,
            type: 'interactive',
            interactive: {
              type: 'button',
              body: {
                text: messageData.message
              },
              action: {
                buttons: messageData.buttons.map((btn, idx) => ({
                  type: 'reply',
                  reply: {
                    id: btn.id,
                    title: btn.title
                  }
                }))
              }
            }
          };
          break;
        default:
          payload = {
            messaging_product: 'whatsapp',
            recipient_type: 'individual',
            to: messageData.phoneNumber,
            type: 'text',
            text: {
              preview_url: true,
              body: messageData.message
            }
          };
      }
      const response = await this.client.post('/messages', payload);
      return {
        id: response.data.messages[0].id,
        status: 'sent',
        timestamp: new Date()
      };
    } catch (error) {
      throw new Error(`ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± WhatsApp ÿßŸÑÿ±ÿ≥ŸÖŸä: ${error.message}`);
    }
  }

  /**
   * ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± Twilio
   */
  async sendViaTwilio(messageData) {
    try {
      let message;
      switch (messageData.type) {
        case 'image':
          message = await this.twilioClient.messages.create({
            from: 'whatsapp:' + process.env.TWILIO_WHATSAPP_NUMBER,
            mediaUrl: [messageData.media],
            body: messageData.caption || '',
            to: 'whatsapp:' + messageData.phoneNumber
          });
          break;
        default:
          message = await this.twilioClient.messages.create({
            from: 'whatsapp:' + process.env.TWILIO_WHATSAPP_NUMBER,
            body: messageData.message || messageData.caption,
            to: 'whatsapp:' + messageData.phoneNumber
          });
      }
      return {
        id: message.sid,
        status: 'sent',
        timestamp: new Date()
      };
    } catch (error) {
      throw new Error(`ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± Twilio: ${error.message}`);
    }
  }

  /**
   * ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± MessageBird
   */
  async sendViaMessageBird(messageData) {
    try {
      const payload = {
        to: messageData.phoneNumber,
        from: process.env.MESSAGEBIRD_WHATSAPP_CHANNEL_ID,
        type: messageData.type || 'text',
        content: {
          text: messageData.message
        }
      };
      const response = await this.client.post('/send', payload);
      return {
        id: response.data.id,
        status: 'sent',
        timestamp: new Date()
      };
    } catch (error) {
      throw new Error(`ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± MessageBird: ${error.message}`);
    }
  }

  /**
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   * üõ†Ô∏è ÿßŸÑÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   */

  /**
   * ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ
   */
  isValidPhoneNumber(phoneNumber) {
    const cleaned = phoneNumber.replace(/\D/g, '');
    return cleaned.length >= 10 && cleaned.length <= 15;
  }

  /**
   * ÿ™ÿ∑ÿ®Ÿäÿπ ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ
   */
  normalizePhoneNumber(phoneNumber) {
    let cleaned = phoneNumber.replace(/\D/g, '');

    // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ£ÿµŸÅÿßÿ± ÿßŸÑÿ®ÿßÿØÿ¶ÿ©
    if (cleaned.startsWith('00')) {
      cleaned = cleaned.substring(2);
    } else if (cleaned.startsWith('0')) {
      cleaned = cleaned.substring(1);
    }

    // ÿ•ÿ∂ÿßŸÅÿ© ŸÉŸàÿØ ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÖŸàÿ¨ŸàÿØÿßŸã
    if (!cleaned.startsWith('966')) {
      if (cleaned.startsWith('5')) {
        cleaned = '966' + cleaned;
      }
    }
    return cleaned;
  }

  /**
   * ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
   */
  sanitizeMessage(message) {
    return String(message).replace(/[^\w\s\-\u0600-\u06FF.!?ÿåÿõ:()[\]{}]/g, '').trim().substring(0, 4096);
  }

  /**
   * ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑÿ±ÿßÿ®ÿ∑
   */
  isValidURL(url) {
    try {
      new URL(url);
      return true;
    } catch {
      return false;
    }
  }

  /**
   * ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÖÿπÿØŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿØ
   */
  checkRateLimit() {
    const now = Date.now();
    const oneMinuteAgo = now - 60000;
    const oneHourAgo = now - 3600000;

    // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÇÿØŸäŸÖÿ©
    this.rateLimit.messagesSent = this.rateLimit.messagesSent.filter(time => time > oneHourAgo);

    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ≠ÿØ ÿßŸÑÿØŸÇŸäŸÇÿ©
    const lastMinute = this.rateLimit.messagesSent.filter(time => time > oneMinuteAgo).length;
    if (lastMinute >= this.rateLimit.messagesPerMinute) {
      return false;
    }

    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ≠ÿØ ÿßŸÑÿ≥ÿßÿπÿ©
    if (this.rateLimit.messagesSent.length >= this.rateLimit.messagesPerHour) {
      return false;
    }
    this.rateLimit.messagesSent.push(now);
    return true;
  }

  /**
   * ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ© ÿ•ŸÑŸâ ÿßŸÑÿ≥ÿ¨ŸÑ
   */
  addToHistory(message) {
    this.messageHistory.push({
      id: message.id || `msg_${Date.now()}`,
      phoneNumber: message.phoneNumber,
      type: message.type || 'text',
      status: message.status,
      sentAt: message.sentAt || new Date(),
      retries: message.retries || 0
    });

    // ÿßŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ ÿ≠ÿØ ÿ£ŸÇÿµŸâ
    if (this.messageHistory.length > this.maxHistory) {
      this.messageHistory = this.messageHistory.slice(-this.maxHistory);
    }
  }

  /**
   * ÿ™ÿ£ÿÆŸäÿ±
   */
  delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  /**
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   * üìä ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ŸàÿßŸÑŸÖÿ±ÿßŸÇÿ®ÿ©
   * ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   */

  /**
   * ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
   */
  getStatistics() {
    const total = this.messageHistory.length;
    const sent = this.messageHistory.filter(m => m.status === 'sent').length;
    const failed = this.messageHistory.filter(m => m.status === 'failed').length;
    const pending = this.messageQueue.length;
    return {
      total,
      sent,
      failed,
      pending,
      successRate: total > 0 ? (sent / total * 100).toFixed(2) + '%' : '0%',
      queueLength: pending,
      queueProcessing: this.isProcessing
    };
  }

  /**
   * ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ≥ÿ¨ŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
   */
  getHistory(limit = 50) {
    return this.messageHistory.slice(-limit);
  }

  /**
   * ŸÖÿ≥ÿ≠ ÿßŸÑÿ≥ÿ¨ŸÑ
   */
  clearHistory() {
    this.messageHistory = [];
    logger.info('üóëÔ∏è ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿ≥ÿ¨ŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ');
  }

  /**
   * ÿ•ÿ∂ÿßŸÅÿ© ÿ±ŸÇŸÖ ÿ•ŸÑŸâ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°
   */
  addToWhitelist(phoneNumber) {
    const normalized = this.normalizePhoneNumber(phoneNumber);
    this.whitelist.add(normalized);
    logger.info(`‚úÖ ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ${normalized} ÿ•ŸÑŸâ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°`);
  }

  /**
   * ÿ•ÿ≤ÿßŸÑÿ© ÿ±ŸÇŸÖ ŸÖŸÜ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°
   */
  removeFromWhitelist(phoneNumber) {
    const normalized = this.normalizePhoneNumber(phoneNumber);
    this.whitelist.delete(normalized);
    logger.info(`‚ùå ÿ™ŸÖ ÿ•ÿ≤ÿßŸÑÿ© ${normalized} ŸÖŸÜ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°`);
  }

  /**
   * ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°
   */
  getWhitelist() {
    return Array.from(this.whitelist);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üì¶ ÿßŸÑÿ™ÿµÿØŸäÿ±
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

module.exports = new WhatsAppNotificationService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJheGlvcyIsInJlcXVpcmUiLCJFdmVudEVtaXR0ZXIiLCJsb2dnZXIiLCJXaGF0c0FwcE5vdGlmaWNhdGlvblNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsIndoaXRlbGlzdCIsIlNldCIsImFwaUNvbmZpZyIsImJhc2VVUkwiLCJwcm9jZXNzIiwiZW52IiwiV0hBVFNBUFBfQVBJX1VSTCIsInRva2VuIiwiV0hBVFNBUFBfQVBJX1RPS0VOIiwiV0hBVFNBUFBfVE9LRU4iLCJwaG9uZU51bWJlcklkIiwiV0hBVFNBUFBfUEhPTkVfTlVNQkVSX0lEIiwiYnVzaW5lc3NBY2NvdW50SWQiLCJXSEFUU0FQUF9CVVNJTkVTU19BQ0NPVU5UX0lEIiwiYXBpVmVyc2lvbiIsIldIQVRTQVBQX0FQSV9WRVJTSU9OIiwid2hhdHNhcHBQcm92aWRlcnMiLCJvZmZpY2lhbCIsInZlcnNpb24iLCJ0d2lsaW8iLCJhY2NvdW50U2lkIiwiVFdJTElPX0FDQ09VTlRfU0lEIiwiYXV0aFRva2VuIiwiVFdJTElPX0FVVEhfVE9LRU4iLCJtZXNzYWdlYmlyZCIsIk1FU1NBR0VCSVJEX0FQSV9LRVkiLCJwcm92aWRlciIsIldIQVRTQVBQX1BST1ZJREVSIiwibWVzc2FnZUhpc3RvcnkiLCJtYXhIaXN0b3J5IiwicmF0ZUxpbWl0IiwibWVzc2FnZXNQZXJNaW51dGUiLCJwYXJzZUludCIsIldIQVRTQVBQX1JBVEVfTElNSVQiLCJtZXNzYWdlc1BlckhvdXIiLCJXSEFUU0FQUF9SQVRFX0xJTUlUX0hPVVIiLCJtZXNzYWdlc1NlbnQiLCJyZXRyeVF1ZXVlIiwibWF4UmV0cmllcyIsInJldHJ5RGVsYXkiLCJtZXNzYWdlUXVldWUiLCJpc1Byb2Nlc3NpbmciLCJpbml0aWFsaXplUHJvdmlkZXIiLCJzdGFydFF1ZXVlUHJvY2Vzc29yIiwiaW5mbyIsInNldHVwVHdpbGlvUHJvdmlkZXIiLCJzZXR1cE1lc3NhZ2VCaXJkUHJvdmlkZXIiLCJzZXR1cE9mZmljaWFsUHJvdmlkZXIiLCJjbGllbnQiLCJjcmVhdGUiLCJoZWFkZXJzIiwidGltZW91dCIsInR3aWxpb0NsaWVudCIsImVycm9yIiwid2FybiIsInNlbmRNZXNzYWdlIiwicGhvbmVOdW1iZXIiLCJtZXNzYWdlIiwib3B0aW9ucyIsImlzVmFsaWRQaG9uZU51bWJlciIsIkVycm9yIiwiV0hBVFNBUFBfV0hJVEVMSVNUX09OTFkiLCJoYXMiLCJjaGVja1JhdGVMaW1pdCIsIm1lc3NhZ2VEYXRhIiwibm9ybWFsaXplUGhvbmVOdW1iZXIiLCJzYW5pdGl6ZU1lc3NhZ2UiLCJ0aW1lc3RhbXAiLCJEYXRlIiwic3RhdHVzIiwicmV0cmllcyIsInB1c2giLCJlbWl0Iiwic2VuZEltYWdlTWVzc2FnZSIsImltYWdlVXJsIiwiY2FwdGlvbiIsImlzVmFsaWRVUkwiLCJ0eXBlIiwibWVkaWEiLCJzZW5kRG9jdW1lbnRNZXNzYWdlIiwiZmlsZVVybCIsImZpbGVOYW1lIiwic2VuZEludGVyYWN0aXZlTWVzc2FnZSIsImJ1dHRvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJtYXAiLCJidG4iLCJpZHgiLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJzZW5kQnVsa01lc3NhZ2VzIiwicGhvbmVOdW1iZXJzIiwicmVzdWx0cyIsInJlc3VsdCIsImZpbHRlciIsInIiLCJzZXRJbnRlcnZhbCIsInByb2Nlc3NRdWV1ZSIsInNoaWZ0IiwiZGVsaXZlck1lc3NhZ2UiLCJzZW50QXQiLCJhZGRUb0hpc3RvcnkiLCJkZWxheSIsInJldHJ5QXQiLCJub3ciLCJwcm9jZXNzUmV0cnlRdWV1ZSIsInJlYWR5UmV0cmllcyIsImZvckVhY2giLCJyZXRyeSIsInNlbmRWaWF0d2lsaW8iLCJzZW5kVmlhTWVzc2FnZUJpcmQiLCJzZW5kVmlhT2ZmaWNpYWwiLCJwYXlsb2FkIiwibWVzc2FnaW5nX3Byb2R1Y3QiLCJyZWNpcGllbnRfdHlwZSIsInRvIiwiaW1hZ2UiLCJsaW5rIiwiZG9jdW1lbnQiLCJmaWxlbmFtZSIsImludGVyYWN0aXZlIiwiYm9keSIsInRleHQiLCJhY3Rpb24iLCJyZXBseSIsInByZXZpZXdfdXJsIiwicmVzcG9uc2UiLCJwb3N0IiwiZGF0YSIsIm1lc3NhZ2VzIiwic2VuZFZpYVR3aWxpbyIsImZyb20iLCJUV0lMSU9fV0hBVFNBUFBfTlVNQkVSIiwibWVkaWFVcmwiLCJzaWQiLCJNRVNTQUdFQklSRF9XSEFUU0FQUF9DSEFOTkVMX0lEIiwiY29udGVudCIsImNsZWFuZWQiLCJyZXBsYWNlIiwic3RhcnRzV2l0aCIsInN1YnN0cmluZyIsIlN0cmluZyIsInRyaW0iLCJ1cmwiLCJVUkwiLCJvbmVNaW51dGVBZ28iLCJvbmVIb3VyQWdvIiwidGltZSIsImxhc3RNaW51dGUiLCJzbGljZSIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZ2V0U3RhdGlzdGljcyIsInRvdGFsIiwic2VudCIsIm0iLCJmYWlsZWQiLCJwZW5kaW5nIiwic3VjY2Vzc1JhdGUiLCJ0b0ZpeGVkIiwicXVldWVMZW5ndGgiLCJxdWV1ZVByb2Nlc3NpbmciLCJnZXRIaXN0b3J5IiwibGltaXQiLCJjbGVhckhpc3RvcnkiLCJhZGRUb1doaXRlbGlzdCIsIm5vcm1hbGl6ZWQiLCJhZGQiLCJyZW1vdmVGcm9tV2hpdGVsaXN0IiwiZGVsZXRlIiwiZ2V0V2hpdGVsaXN0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIndoYXRzYXBwTm90aWZpY2F0aW9uU2VydmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbiAqIPCfk7EgV2hhdHNBcHAgTm90aWZpY2F0aW9uIFNlcnZpY2VcclxuICog2K7Yr9mF2Kkg2KfZhNil2LTYudin2LHYp9iqINmI2KfZhNiq2YbYqNmK2YfYp9iqINi52KjYsSDYp9mE2YjYp9iq2LMg2KLYqFxyXG4gKiDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcclxuICogXHJcbiAqINmF2KrZgtiv2YXYqSDZiNi02KfZhdmE2Kkg2YjYsNmD2YrYqSDZhNil2LHYs9in2YQg2KfZhNix2LPYp9im2YQg2YjYp9mE2KrZhtio2YrZh9in2Kog2LnYqNixINin2YTZiNin2KrYsyDYotioXHJcbiAqIC0g2K/YudmFINin2YTZhti12YjYtSDZiNin2YTYtdmI2LEg2YjYp9mE2YXZhNmB2KfYqlxyXG4gKiAtINmG2LjYp9mFINmC2YjYp9mE2Kgg2LDZg9mK2KlcclxuICogLSDZhdi52KfZhNis2Kkg2KfZhNij2K7Yt9in2KEg2YjYp9mE2KXYudin2K/YqSDYp9mE2KrZhNmC2KfYptmK2KlcclxuICogLSDYqtiq2KjYuSDYrdin2YTYqSDYp9mE2LHYs9in2KbZhFxyXG4gKi9cclxuXHJcbmNvbnN0IGF4aW9zID0gcmVxdWlyZSgnYXhpb3MnKTtcclxuY29uc3QgRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnZXZlbnRzJyk7XHJcbmNvbnN0IGxvZ2dlciA9IHJlcXVpcmUoJy4uL3V0aWxzL2xvZ2dlcicpO1xyXG5cclxuLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbi8vIOKchSBXaGF0c0FwcCBOb3RpZmljYXRpb24gU2VydmljZVxyXG4vLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcclxuXHJcbmNsYXNzIFdoYXRzQXBwTm90aWZpY2F0aW9uU2VydmljZSBleHRlbmRzIEV2ZW50RW1pdHRlciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnID0ge30pIHtcclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgLy8g2KfZhNmC2KfYptmF2Kkg2KfZhNio2YrYttin2KEgKFdoaXRlbGlzdCkg2YXZhiDYo9ix2YLYp9mFINin2YTZh9in2KrZgVxyXG4gICAgdGhpcy53aGl0ZWxpc3QgPSBuZXcgU2V0KCk7XHJcbiAgICBcclxuICAgIC8vINil2LnYr9in2K/Yp9iqINin2YTYp9iq2LXYp9mEINio2YAgV2hhdHNBcHAgQVBJXHJcbiAgICB0aGlzLmFwaUNvbmZpZyA9IHtcclxuICAgICAgYmFzZVVSTDogcHJvY2Vzcy5lbnYuV0hBVFNBUFBfQVBJX1VSTCB8fCAnaHR0cHM6Ly9hcGkud2hhdHNhcHAuY29tL3NlbmQnLFxyXG4gICAgICB0b2tlbjogcHJvY2Vzcy5lbnYuV0hBVFNBUFBfQVBJX1RPS0VOIHx8IHByb2Nlc3MuZW52LldIQVRTQVBQX1RPS0VOLFxyXG4gICAgICBwaG9uZU51bWJlcklkOiBwcm9jZXNzLmVudi5XSEFUU0FQUF9QSE9ORV9OVU1CRVJfSUQsXHJcbiAgICAgIGJ1c2luZXNzQWNjb3VudElkOiBwcm9jZXNzLmVudi5XSEFUU0FQUF9CVVNJTkVTU19BQ0NPVU5UX0lELFxyXG4gICAgICBhcGlWZXJzaW9uOiBwcm9jZXNzLmVudi5XSEFUU0FQUF9BUElfVkVSU0lPTiB8fCAndjE4LjAnLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyDYrtmI2KfYr9mFIFdoYXRzQXBwINin2YTZhdmI2KvZiNmC2KlcclxuICAgIHRoaXMud2hhdHNhcHBQcm92aWRlcnMgPSB7XHJcbiAgICAgIG9mZmljaWFsOiB7XHJcbiAgICAgICAgYmFzZVVSTDogJ2h0dHBzOi8vZ3JhcGguaW5zdGFncmFtLmNvbScsXHJcbiAgICAgICAgdmVyc2lvbjogJ3YxOC4wJyxcclxuICAgICAgfSxcclxuICAgICAgdHdpbGlvOiB7XHJcbiAgICAgICAgYmFzZVVSTDogJ2h0dHBzOi8vYXBpLnR3aWxpby5jb20nLFxyXG4gICAgICAgIGFjY291bnRTaWQ6IHByb2Nlc3MuZW52LlRXSUxJT19BQ0NPVU5UX1NJRCxcclxuICAgICAgICBhdXRoVG9rZW46IHByb2Nlc3MuZW52LlRXSUxJT19BVVRIX1RPS0VOLFxyXG4gICAgICB9LFxyXG4gICAgICBtZXNzYWdlYmlyZDoge1xyXG4gICAgICAgIGJhc2VVUkw6ICdodHRwczovL21lc3NhZ2VzLXNhbmRib3gubmV4bW8uY29tJyxcclxuICAgICAgICB0b2tlbjogcHJvY2Vzcy5lbnYuTUVTU0FHRUJJUkRfQVBJX0tFWSxcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgLy8g2KXYudiv2KfYr9in2Kog2KfZhNmF2YLYr9mFINin2YTZhti02LdcclxuICAgIHRoaXMucHJvdmlkZXIgPSBwcm9jZXNzLmVudi5XSEFUU0FQUF9QUk9WSURFUiB8fCAnb2ZmaWNpYWwnO1xyXG5cclxuICAgIC8vINmC2KfYptmF2Kkg2KfZhNix2LPYp9im2YQg2KfZhNmF2LHYs9mE2KkgKNmE2YTYqtiq2KjYuSlcclxuICAgIHRoaXMubWVzc2FnZUhpc3RvcnkgPSBbXTtcclxuICAgIHRoaXMubWF4SGlzdG9yeSA9IDEwMDA7XHJcblxyXG4gICAgLy8g2YXYudiv2YQg2KfZhNiq2K3Yr9mK2K8gKFJhdGUgTGltaXRpbmcpXHJcbiAgICB0aGlzLnJhdGVMaW1pdCA9IHtcclxuICAgICAgbWVzc2FnZXNQZXJNaW51dGU6IHBhcnNlSW50KHByb2Nlc3MuZW52LldIQVRTQVBQX1JBVEVfTElNSVQgfHwgJzYwJyksXHJcbiAgICAgIG1lc3NhZ2VzUGVySG91cjogcGFyc2VJbnQocHJvY2Vzcy5lbnYuV0hBVFNBUFBfUkFURV9MSU1JVF9IT1VSIHx8ICcxMDAwJyksXHJcbiAgICAgIG1lc3NhZ2VzU2VudDogW10sXHJcbiAgICB9O1xyXG5cclxuICAgIC8vINmF2K7YstmGINmF2KTZgtiqINmE2KXYudin2K/YqSDYp9mE2YXYrdin2YjZhNin2KpcclxuICAgIHRoaXMucmV0cnlRdWV1ZSA9IFtdO1xyXG4gICAgdGhpcy5tYXhSZXRyaWVzID0gMztcclxuICAgIHRoaXMucmV0cnlEZWxheSA9IDUwMDA7IC8vIDUg2KvZiNin2YbZilxyXG5cclxuICAgIC8vINmC2YjYp9im2YUg2KfZhNin2YbYqti42KfYsVxyXG4gICAgdGhpcy5tZXNzYWdlUXVldWUgPSBbXTtcclxuICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5pbml0aWFsaXplUHJvdmlkZXIoKTtcclxuICAgIHRoaXMuc3RhcnRRdWV1ZVByb2Nlc3NvcigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KrZh9mK2KbYqSDYp9mE2YXZgtiv2YUg2KfZhNmF2K7Yqtin2LFcclxuICAgKi9cclxuICBpbml0aWFsaXplUHJvdmlkZXIoKSB7XHJcbiAgICBsb2dnZXIuaW5mbyhg8J+UhCBJbml0aWFsaXppbmcgV2hhdHNBcHAgcHJvdmlkZXI6ICR7dGhpcy5wcm92aWRlcn1gKTtcclxuXHJcbiAgICBzd2l0Y2ggKHRoaXMucHJvdmlkZXIpIHtcclxuICAgICAgY2FzZSAndHdpbGlvJzpcclxuICAgICAgICB0aGlzLnNldHVwVHdpbGlvUHJvdmlkZXIoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnbWVzc2FnZWJpcmQnOlxyXG4gICAgICAgIHRoaXMuc2V0dXBNZXNzYWdlQmlyZFByb3ZpZGVyKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhpcy5zZXR1cE9mZmljaWFsUHJvdmlkZXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINil2LnYr9in2K8g2YXZgtiv2YUgV2hhdHNBcHAg2KfZhNix2LPZhdmKXHJcbiAgICovXHJcbiAgc2V0dXBPZmZpY2lhbFByb3ZpZGVyKCkge1xyXG4gICAgdGhpcy5jbGllbnQgPSBheGlvcy5jcmVhdGUoe1xyXG4gICAgICBiYXNlVVJMOiBgJHt0aGlzLndoYXRzYXBwUHJvdmlkZXJzLm9mZmljaWFsLmJhc2VVUkx9LyR7dGhpcy53aGF0c2FwcFByb3ZpZGVycy5vZmZpY2lhbC52ZXJzaW9ufS8ke3RoaXMuYXBpQ29uZmlnLnBob25lTnVtYmVySWR9YCxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuYXBpQ29uZmlnLnRva2VufWAsXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgfSxcclxuICAgICAgdGltZW91dDogMTAwMDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICBsb2dnZXIuaW5mbygn4pyFIFdoYXRzQXBwIE9mZmljaWFsIFByb3ZpZGVyIGluaXRpYWxpemVkJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDYpdi52K/Yp9ivINmF2YLYr9mFIFR3aWxpb1xyXG4gICAqL1xyXG4gIHNldHVwVHdpbGlvUHJvdmlkZXIoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0d2lsaW8gPSByZXF1aXJlKCd0d2lsaW8nKTtcclxuICAgICAgdGhpcy50d2lsaW9DbGllbnQgPSB0d2lsaW8oXHJcbiAgICAgICAgdGhpcy53aGF0c2FwcFByb3ZpZGVycy50d2lsaW8uYWNjb3VudFNpZCxcclxuICAgICAgICB0aGlzLndoYXRzYXBwUHJvdmlkZXJzLnR3aWxpby5hdXRoVG9rZW5cclxuICAgICAgKTtcclxuICAgICAgbG9nZ2VyLmluZm8oJ+KchSBUd2lsaW8gV2hhdHNBcHAgUHJvdmlkZXIgaW5pdGlhbGl6ZWQnKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGxvZ2dlci53YXJuKCfimqDvuI8gVHdpbGlvIG1vZHVsZSBub3QgYXZhaWxhYmxlLiBGYWxsaW5nIGJhY2sgdG8gT2ZmaWNpYWwgUHJvdmlkZXIuJyk7XHJcbiAgICAgIHRoaXMucHJvdmlkZXIgPSAnb2ZmaWNpYWwnO1xyXG4gICAgICB0aGlzLnNldHVwT2ZmaWNpYWxQcm92aWRlcigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KXYudiv2KfYryDZhdmC2K/ZhSBNZXNzYWdlQmlyZFxyXG4gICAqL1xyXG4gIHNldHVwTWVzc2FnZUJpcmRQcm92aWRlcigpIHtcclxuICAgIHRoaXMuY2xpZW50ID0gYXhpb3MuY3JlYXRlKHtcclxuICAgICAgYmFzZVVSTDogdGhpcy53aGF0c2FwcFByb3ZpZGVycy5tZXNzYWdlYmlyZC5iYXNlVVJMLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy53aGF0c2FwcFByb3ZpZGVycy5tZXNzYWdlYmlyZC50b2tlbn1gLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICAgIHRpbWVvdXQ6IDEwMDAwLFxyXG4gICAgfSk7XHJcbiAgICBsb2dnZXIuaW5mbygn4pyFIE1lc3NhZ2VCaXJkIFdoYXRzQXBwIFByb3ZpZGVyIGluaXRpYWxpemVkJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcclxuICAgKiDwn5OoINil2LHYs9in2YQg2KfZhNix2LPYp9im2YRcclxuICAgKiDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcclxuICAgKi9cclxuXHJcbiAgLyoqXHJcbiAgICog2KXYsdiz2KfZhCDYsdiz2KfZhNipINmG2LXZitipXHJcbiAgICovXHJcbiAgYXN5bmMgc2VuZE1lc3NhZ2UocGhvbmVOdW1iZXIsIG1lc3NhZ2UsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g2KfZhNiq2K3ZgtmCINmF2YYg2LXYrdipINix2YLZhSDYp9mE2YfYp9iq2YFcclxuICAgICAgaWYgKCF0aGlzLmlzVmFsaWRQaG9uZU51bWJlcihwaG9uZU51bWJlcikpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYNix2YLZhSDYp9mE2YfYp9iq2YEg2LrZitixINi12K3ZititOiAke3Bob25lTnVtYmVyfWApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDYp9mE2KrYrdmC2YIg2YXZhiDZgtin2KbZhdipINio2YrYttin2KEgKNin2K7YqtmK2KfYsdmKKVxyXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuV0hBVFNBUFBfV0hJVEVMSVNUX09OTFkgPT09ICd0cnVlJykge1xyXG4gICAgICAgIGlmICghdGhpcy53aGl0ZWxpc3QuaGFzKHBob25lTnVtYmVyKSkge1xyXG4gICAgICAgICAgbG9nZ2VyLndhcm4oYPCfk7Eg2LHZgtmFINin2YTZh9in2KrZgSDYutmK2LEg2YXYr9ix2Kwg2YHZiiDYp9mE2YLYp9im2YXYqSDYp9mE2KjZiti22KfYoTogJHtwaG9uZU51bWJlcn1gKTtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihg2LHZgtmFINin2YTZh9in2KrZgSDYutmK2LEg2YXYtdix2K0g2KjZh2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g2KfZhNiq2K3ZgtmCINmF2YYg2YXYudiv2YQg2KfZhNiq2K3Yr9mK2K9cclxuICAgICAgaWYgKCF0aGlzLmNoZWNrUmF0ZUxpbWl0KCkpIHtcclxuICAgICAgICBsb2dnZXIud2Fybign4pqg77iPINiq2YUg2KrYrNin2YjYsiDYrdivINmF2LnYr9mEINin2YTYsdiz2KfYptmEJyk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfYqtmFINiq2KzYp9mI2LIg2K3YryDZhdi52K/ZhCDYp9mE2LHYs9in2KbZhC4g2YrYsdis2Ykg2KfZhNmF2K3Yp9mI2YTYqSDZhNin2K3Zgtin2YsnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgbWVzc2FnZURhdGEgPSB7XHJcbiAgICAgICAgcGhvbmVOdW1iZXI6IHRoaXMubm9ybWFsaXplUGhvbmVOdW1iZXIocGhvbmVOdW1iZXIpLFxyXG4gICAgICAgIG1lc3NhZ2U6IHRoaXMuc2FuaXRpemVNZXNzYWdlKG1lc3NhZ2UpLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcclxuICAgICAgICByZXRyaWVzOiAwLFxyXG4gICAgICAgIC4uLm9wdGlvbnMsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyDYpdi22KfZgdipINil2YTZiSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LFcclxuICAgICAgdGhpcy5tZXNzYWdlUXVldWUucHVzaChtZXNzYWdlRGF0YSk7XHJcblxyXG4gICAgICAvLyDYpdix2LPYp9mEINit2K/Yq1xyXG4gICAgICB0aGlzLmVtaXQoJ21lc3NhZ2VRdWV1ZWQnLCBtZXNzYWdlRGF0YSk7XHJcblxyXG4gICAgICBsb2dnZXIuaW5mbyhg8J+TnSDYp9mE2LHYs9in2YTYqSDZhdi22KfZgdipINil2YTZiSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LE6ICR7cGhvbmVOdW1iZXJ9YCk7XHJcblxyXG4gICAgICByZXR1cm4gbWVzc2FnZURhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoYOKdjCDYrti32KMg2YHZiiDYpdix2LPYp9mEINin2YTYsdiz2KfZhNipOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgIHRoaXMuZW1pdCgnbWVzc2FnZVNlbmRFcnJvcicsIHsgcGhvbmVOdW1iZXIsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINil2LHYs9in2YQg2LHYs9in2YTYqSDZhdi5INi12YjYsdipXHJcbiAgICovXHJcbiAgYXN5bmMgc2VuZEltYWdlTWVzc2FnZShwaG9uZU51bWJlciwgaW1hZ2VVcmwsIGNhcHRpb24gPSAnJywgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIXRoaXMuaXNWYWxpZFVSTChpbWFnZVVybCkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ9ix2KfYqNi3INin2YTYtdmI2LHYqSDYutmK2LEg2LXYrdmK2K0nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgbWVzc2FnZURhdGEgPSB7XHJcbiAgICAgICAgdHlwZTogJ2ltYWdlJyxcclxuICAgICAgICBwaG9uZU51bWJlcjogdGhpcy5ub3JtYWxpemVQaG9uZU51bWJlcihwaG9uZU51bWJlciksXHJcbiAgICAgICAgbWVkaWE6IGltYWdlVXJsLFxyXG4gICAgICAgIGNhcHRpb246IHRoaXMuc2FuaXRpemVNZXNzYWdlKGNhcHRpb24pLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcclxuICAgICAgICByZXRyaWVzOiAwLFxyXG4gICAgICAgIC4uLm9wdGlvbnMsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICB0aGlzLm1lc3NhZ2VRdWV1ZS5wdXNoKG1lc3NhZ2VEYXRhKTtcclxuICAgICAgdGhpcy5lbWl0KCdtZXNzYWdlUXVldWVkJywgbWVzc2FnZURhdGEpO1xyXG5cclxuICAgICAgbG9nZ2VyLmluZm8oYPCflrzvuI8g2LHYs9in2YTYqSDYtdmI2LHYqSDZhdi22KfZgdipINil2YTZiSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LE6ICR7cGhvbmVOdW1iZXJ9YCk7XHJcblxyXG4gICAgICByZXR1cm4gbWVzc2FnZURhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoYOKdjCDYrti32KMg2YHZiiDYpdix2LPYp9mEINix2LPYp9mE2Kkg2KfZhNi12YjYsdipOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KXYsdiz2KfZhCDYsdiz2KfZhNipINmF2Lkg2YXZhNmBXHJcbiAgICovXHJcbiAgYXN5bmMgc2VuZERvY3VtZW50TWVzc2FnZShwaG9uZU51bWJlciwgZmlsZVVybCwgZmlsZU5hbWUgPSAnJywgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIXRoaXMuaXNWYWxpZFVSTChmaWxlVXJsKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcign2LHYp9io2Lcg2KfZhNmF2YTZgSDYutmK2LEg2LXYrdmK2K0nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgbWVzc2FnZURhdGEgPSB7XHJcbiAgICAgICAgdHlwZTogJ2RvY3VtZW50JyxcclxuICAgICAgICBwaG9uZU51bWJlcjogdGhpcy5ub3JtYWxpemVQaG9uZU51bWJlcihwaG9uZU51bWJlciksXHJcbiAgICAgICAgbWVkaWE6IGZpbGVVcmwsXHJcbiAgICAgICAgZmlsZU5hbWU6IGZpbGVOYW1lIHx8ICdkb2N1bWVudCcsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxyXG4gICAgICAgIHJldHJpZXM6IDAsXHJcbiAgICAgICAgLi4ub3B0aW9ucyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMubWVzc2FnZVF1ZXVlLnB1c2gobWVzc2FnZURhdGEpO1xyXG4gICAgICB0aGlzLmVtaXQoJ21lc3NhZ2VRdWV1ZWQnLCBtZXNzYWdlRGF0YSk7XHJcblxyXG4gICAgICBsb2dnZXIuaW5mbyhg8J+ThCDYsdiz2KfZhNipINmF2YTZgSDZhdi22KfZgdipINil2YTZiSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LE6ICR7cGhvbmVOdW1iZXJ9YCk7XHJcblxyXG4gICAgICByZXR1cm4gbWVzc2FnZURhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoYOKdjCDYrti32KMg2YHZiiDYpdix2LPYp9mEINix2LPYp9mE2Kkg2KfZhNmF2YTZgTogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINil2LHYs9in2YQg2LHYs9in2YTYqSDYqtmB2KfYudmE2YrYqSAo2KPYstix2KfYsSlcclxuICAgKi9cclxuICBhc3luYyBzZW5kSW50ZXJhY3RpdmVNZXNzYWdlKHBob25lTnVtYmVyLCBtZXNzYWdlLCBidXR0b25zLCBvcHRpb25zID0ge30pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShidXR0b25zKSB8fCBidXR0b25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcign2YrYrNioINiq2YjZgdmK2LEg2LLYsSDZiNin2K3YryDYudmE2Ykg2KfZhNij2YLZhCcpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoYnV0dG9ucy5sZW5ndGggPiAzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfYp9mE2K3YryDYp9mE2KPZgti12Ykg2YTZhNij2LLYsdin2LEg2YfZiCAzJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IG1lc3NhZ2VEYXRhID0ge1xyXG4gICAgICAgIHR5cGU6ICdpbnRlcmFjdGl2ZScsXHJcbiAgICAgICAgcGhvbmVOdW1iZXI6IHRoaXMubm9ybWFsaXplUGhvbmVOdW1iZXIocGhvbmVOdW1iZXIpLFxyXG4gICAgICAgIG1lc3NhZ2U6IHRoaXMuc2FuaXRpemVNZXNzYWdlKG1lc3NhZ2UpLFxyXG4gICAgICAgIGJ1dHRvbnM6IGJ1dHRvbnMubWFwKChidG4sIGlkeCkgPT4gKHtcclxuICAgICAgICAgIGlkOiBidG4uaWQgfHwgYGJ0bl8ke2lkeH1gLFxyXG4gICAgICAgICAgdGl0bGU6IGJ0bi50aXRsZSxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBidG4uZGVzY3JpcHRpb24gfHwgJycsXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcclxuICAgICAgICByZXRyaWVzOiAwLFxyXG4gICAgICAgIC4uLm9wdGlvbnMsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICB0aGlzLm1lc3NhZ2VRdWV1ZS5wdXNoKG1lc3NhZ2VEYXRhKTtcclxuICAgICAgdGhpcy5lbWl0KCdtZXNzYWdlUXVldWVkJywgbWVzc2FnZURhdGEpO1xyXG5cclxuICAgICAgbG9nZ2VyLmluZm8oYPCflJgg2LHYs9in2YTYqSDYqtmB2KfYudmE2YrYqSDZhdi22KfZgdipINil2YTZiSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LE6ICR7cGhvbmVOdW1iZXJ9YCk7XHJcblxyXG4gICAgICByZXR1cm4gbWVzc2FnZURhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoYOKdjCDYrti32KMg2YHZiiDYpdix2LPYp9mEINin2YTYsdiz2KfZhNipINin2YTYqtmB2KfYudmE2YrYqTogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINil2LHYs9in2YQg2LHYs9in2KbZhCDYrNmF2KfYudmK2KlcclxuICAgKi9cclxuICBhc3luYyBzZW5kQnVsa01lc3NhZ2VzKHBob25lTnVtYmVycywgbWVzc2FnZSwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkocGhvbmVOdW1iZXJzKSB8fCBwaG9uZU51bWJlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfZitis2Kgg2KrZiNmB2YrYsSDZgtin2KbZhdipINij2LHZgtin2YUg2KfZhNmH2KfYqtmBJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgcGhvbmVOdW1iZXIgb2YgcGhvbmVOdW1iZXJzKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc2VuZE1lc3NhZ2UocGhvbmVOdW1iZXIsIG1lc3NhZ2UsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgICAgcGhvbmVOdW1iZXIsXHJcbiAgICAgICAgICAgIHN0YXR1czogJ3F1ZXVlZCcsXHJcbiAgICAgICAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgICAgcGhvbmVOdW1iZXIsXHJcbiAgICAgICAgICAgIHN0YXR1czogJ2ZhaWxlZCcsXHJcbiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBsb2dnZXIuaW5mbyhg8J+TrCDYqtmFINil2LbYp9mB2KkgJHtyZXN1bHRzLmZpbHRlcihyID0+IHIuc3RhdHVzID09PSAncXVldWVkJykubGVuZ3RofSDYsdiz2KfZhNipINis2YXYp9i52YrYqSDYpdmE2Ykg2YLYp9im2YXYqSDYp9mE2KfZhtiq2LjYp9ixYCk7XHJcblxyXG4gICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGxvZ2dlci5lcnJvcihg4p2MINiu2LfYoyDZgdmKINin2YTYpdix2LPYp9mEINin2YTYrNmF2KfYudmKOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbiAgICog4pqZ77iPINmF2LnYp9mE2KzYqSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LFcclxuICAgKiDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcclxuICAgKi9cclxuXHJcbiAgLyoqXHJcbiAgICog2KjYr9ihINmF2LnYp9mE2Kwg2YLYp9im2YXYqSDYp9mE2KfZhtiq2LjYp9ixXHJcbiAgICovXHJcbiAgc3RhcnRRdWV1ZVByb2Nlc3NvcigpIHtcclxuICAgIHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmlzUHJvY2Vzc2luZyAmJiB0aGlzLm1lc3NhZ2VRdWV1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzUXVldWUoKTtcclxuICAgICAgfVxyXG4gICAgfSwgMTAwMCk7XHJcblxyXG4gICAgbG9nZ2VyLmluZm8oJ+KWtu+4jyDZhdi52KfZhNisINmC2KfYptmF2Kkg2KfZhNin2YbYqti42KfYsSDZhti02LcnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINmF2LnYp9mE2KzYqSDZgtin2KbZhdipINin2YTYp9mG2KrYuNin2LFcclxuICAgKi9cclxuICBhc3luYyBwcm9jZXNzUXVldWUoKSB7XHJcbiAgICBpZiAodGhpcy5pc1Byb2Nlc3NpbmcgfHwgdGhpcy5tZXNzYWdlUXVldWUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IHRydWU7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgd2hpbGUgKHRoaXMubWVzc2FnZVF1ZXVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCBtZXNzYWdlID0gdGhpcy5tZXNzYWdlUXVldWUuc2hpZnQoKTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVsaXZlck1lc3NhZ2UobWVzc2FnZSk7XHJcbiAgICAgICAgICBtZXNzYWdlLnN0YXR1cyA9ICdzZW50JztcclxuICAgICAgICAgIG1lc3NhZ2UuaWQgPSByZXN1bHQuaWQ7XHJcbiAgICAgICAgICBtZXNzYWdlLnNlbnRBdCA9IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgICAgICAgdGhpcy5hZGRUb0hpc3RvcnkobWVzc2FnZSk7XHJcbiAgICAgICAgICB0aGlzLmVtaXQoJ21lc3NhZ2VTZW50JywgbWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgbG9nZ2VyLmluZm8oYOKchSDYsdiz2KfZhNipINmF2LHYs9mE2Kkg2KXZhNmJICR7bWVzc2FnZS5waG9uZU51bWJlcn1gKTtcclxuXHJcbiAgICAgICAgICAvLyDYqtij2K7ZitixINi12LrZitixINmE2KrYrNmG2Kgg2KfZhNin2LLYr9it2KfZhVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgxMDApO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBtZXNzYWdlLnJldHJpZXMgPSAobWVzc2FnZS5yZXRyaWVzIHx8IDApICsgMTtcclxuXHJcbiAgICAgICAgICBpZiAobWVzc2FnZS5yZXRyaWVzID49IHRoaXMubWF4UmV0cmllcykge1xyXG4gICAgICAgICAgICBtZXNzYWdlLnN0YXR1cyA9ICdmYWlsZWQnO1xyXG4gICAgICAgICAgICBtZXNzYWdlLmVycm9yID0gZXJyb3IubWVzc2FnZTtcclxuICAgICAgICAgICAgdGhpcy5hZGRUb0hpc3RvcnkobWVzc2FnZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnbWVzc2FnZUZhaWxlZCcsIG1lc3NhZ2UpO1xyXG5cclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGDinYwg2YHYtNmEINin2YTYpdix2LPYp9mEINio2LnYryAke3RoaXMubWF4UmV0cmllc30g2YXYrdin2YjZhNin2Ko6ICR7bWVzc2FnZS5waG9uZU51bWJlcn1gKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vINil2LnYp9iv2Kkg2KfZhNmF2K3Yp9mI2YTYqVxyXG4gICAgICAgICAgICB0aGlzLnJldHJ5UXVldWUucHVzaCh7XHJcbiAgICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAgICByZXRyeUF0OiBEYXRlLm5vdygpICsgKHRoaXMucmV0cnlEZWxheSAqIG1lc3NhZ2UucmV0cmllcyksXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oYOKaoO+4jyDYpdi52KfYr9ipINmF2K3Yp9mI2YTYqSDYp9mE2KXYsdiz2KfZhCAoJHttZXNzYWdlLnJldHJpZXN9LyR7dGhpcy5tYXhSZXRyaWVzfSk6ICR7bWVzc2FnZS5waG9uZU51bWJlcn1gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vINmF2LnYp9mE2KzYqSDZgtin2KbZhdipINil2LnYp9iv2Kkg2KfZhNmF2K3Yp9mI2YTYp9iqXHJcbiAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1JldHJ5UXVldWUoKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDZhdi52KfZhNis2Kkg2YLYp9im2YXYqSDYpdi52KfYr9ipINin2YTZhdit2KfZiNmE2KfYqlxyXG4gICAqL1xyXG4gIGFzeW5jIHByb2Nlc3NSZXRyeVF1ZXVlKCkge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IHJlYWR5UmV0cmllcyA9IHRoaXMucmV0cnlRdWV1ZS5maWx0ZXIociA9PiByLnJldHJ5QXQgPD0gbm93KTtcclxuXHJcbiAgICByZWFkeVJldHJpZXMuZm9yRWFjaChyZXRyeSA9PiB7XHJcbiAgICAgIHRoaXMubWVzc2FnZVF1ZXVlLnB1c2gocmV0cnkubWVzc2FnZSk7XHJcbiAgICAgIHRoaXMucmV0cnlRdWV1ZSA9IHRoaXMucmV0cnlRdWV1ZS5maWx0ZXIociA9PiByICE9PSByZXRyeSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINiq2LPZhNmK2YUg2KfZhNix2LPYp9mE2Kkg2KfZhNmB2LnZhNmKXHJcbiAgICovXHJcbiAgYXN5bmMgZGVsaXZlck1lc3NhZ2UobWVzc2FnZURhdGEpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHN3aXRjaCAodGhpcy5wcm92aWRlcikge1xyXG4gICAgICAgIGNhc2UgJ3R3aWxpbyc6XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5zZW5kVmlhdHdpbGlvKG1lc3NhZ2VEYXRhKTtcclxuICAgICAgICBjYXNlICdtZXNzYWdlYmlyZCc6XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5zZW5kVmlhTWVzc2FnZUJpcmQobWVzc2FnZURhdGEpO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5zZW5kVmlhT2ZmaWNpYWwobWVzc2FnZURhdGEpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoYOKdjCDYrti32KMg2YHZiiDYp9mE2KrYs9mE2YrZhTogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINin2YTYpdix2LPYp9mEINi52KjYsSBXaGF0c0FwcCDYp9mE2LHYs9mF2YpcclxuICAgKi9cclxuICBhc3luYyBzZW5kVmlhT2ZmaWNpYWwobWVzc2FnZURhdGEpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxldCBwYXlsb2FkO1xyXG5cclxuICAgICAgc3dpdGNoIChtZXNzYWdlRGF0YS50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnaW1hZ2UnOlxyXG4gICAgICAgICAgcGF5bG9hZCA9IHtcclxuICAgICAgICAgICAgbWVzc2FnaW5nX3Byb2R1Y3Q6ICd3aGF0c2FwcCcsXHJcbiAgICAgICAgICAgIHJlY2lwaWVudF90eXBlOiAnaW5kaXZpZHVhbCcsXHJcbiAgICAgICAgICAgIHRvOiBtZXNzYWdlRGF0YS5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgdHlwZTogJ2ltYWdlJyxcclxuICAgICAgICAgICAgaW1hZ2U6IHtcclxuICAgICAgICAgICAgICBsaW5rOiBtZXNzYWdlRGF0YS5tZWRpYSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxyXG4gICAgICAgICAgcGF5bG9hZCA9IHtcclxuICAgICAgICAgICAgbWVzc2FnaW5nX3Byb2R1Y3Q6ICd3aGF0c2FwcCcsXHJcbiAgICAgICAgICAgIHJlY2lwaWVudF90eXBlOiAnaW5kaXZpZHVhbCcsXHJcbiAgICAgICAgICAgIHRvOiBtZXNzYWdlRGF0YS5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgdHlwZTogJ2RvY3VtZW50JyxcclxuICAgICAgICAgICAgZG9jdW1lbnQ6IHtcclxuICAgICAgICAgICAgICBsaW5rOiBtZXNzYWdlRGF0YS5tZWRpYSxcclxuICAgICAgICAgICAgICBmaWxlbmFtZTogbWVzc2FnZURhdGEuZmlsZU5hbWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ2ludGVyYWN0aXZlJzpcclxuICAgICAgICAgIHBheWxvYWQgPSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2luZ19wcm9kdWN0OiAnd2hhdHNhcHAnLFxyXG4gICAgICAgICAgICByZWNpcGllbnRfdHlwZTogJ2luZGl2aWR1YWwnLFxyXG4gICAgICAgICAgICB0bzogbWVzc2FnZURhdGEucGhvbmVOdW1iZXIsXHJcbiAgICAgICAgICAgIHR5cGU6ICdpbnRlcmFjdGl2ZScsXHJcbiAgICAgICAgICAgIGludGVyYWN0aXZlOiB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXHJcbiAgICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgICAgdGV4dDogbWVzc2FnZURhdGEubWVzc2FnZSxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGFjdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uczogbWVzc2FnZURhdGEuYnV0dG9ucy5tYXAoKGJ0biwgaWR4KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgICB0eXBlOiAncmVwbHknLFxyXG4gICAgICAgICAgICAgICAgICByZXBseToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBidG4uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGJ0bi50aXRsZSxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0pKSxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgcGF5bG9hZCA9IHtcclxuICAgICAgICAgICAgbWVzc2FnaW5nX3Byb2R1Y3Q6ICd3aGF0c2FwcCcsXHJcbiAgICAgICAgICAgIHJlY2lwaWVudF90eXBlOiAnaW5kaXZpZHVhbCcsXHJcbiAgICAgICAgICAgIHRvOiBtZXNzYWdlRGF0YS5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxyXG4gICAgICAgICAgICB0ZXh0OiB7XHJcbiAgICAgICAgICAgICAgcHJldmlld191cmw6IHRydWUsXHJcbiAgICAgICAgICAgICAgYm9keTogbWVzc2FnZURhdGEubWVzc2FnZSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQucG9zdCgnL21lc3NhZ2VzJywgcGF5bG9hZCk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiByZXNwb25zZS5kYXRhLm1lc3NhZ2VzWzBdLmlkLFxyXG4gICAgICAgIHN0YXR1czogJ3NlbnQnLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihg2K7Yt9ijINmB2Yog2KfZhNil2LHYs9in2YQg2LnYqNixIFdoYXRzQXBwINin2YTYsdiz2YXZijogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KfZhNil2LHYs9in2YQg2LnYqNixIFR3aWxpb1xyXG4gICAqL1xyXG4gIGFzeW5jIHNlbmRWaWFUd2lsaW8obWVzc2FnZURhdGEpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxldCBtZXNzYWdlO1xyXG5cclxuICAgICAgc3dpdGNoIChtZXNzYWdlRGF0YS50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnaW1hZ2UnOlxyXG4gICAgICAgICAgbWVzc2FnZSA9IGF3YWl0IHRoaXMudHdpbGlvQ2xpZW50Lm1lc3NhZ2VzLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGZyb206ICd3aGF0c2FwcDonICsgcHJvY2Vzcy5lbnYuVFdJTElPX1dIQVRTQVBQX05VTUJFUixcclxuICAgICAgICAgICAgbWVkaWFVcmw6IFttZXNzYWdlRGF0YS5tZWRpYV0sXHJcbiAgICAgICAgICAgIGJvZHk6IG1lc3NhZ2VEYXRhLmNhcHRpb24gfHwgJycsXHJcbiAgICAgICAgICAgIHRvOiAnd2hhdHNhcHA6JyArIG1lc3NhZ2VEYXRhLnBob25lTnVtYmVyLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIG1lc3NhZ2UgPSBhd2FpdCB0aGlzLnR3aWxpb0NsaWVudC5tZXNzYWdlcy5jcmVhdGUoe1xyXG4gICAgICAgICAgICBmcm9tOiAnd2hhdHNhcHA6JyArIHByb2Nlc3MuZW52LlRXSUxJT19XSEFUU0FQUF9OVU1CRVIsXHJcbiAgICAgICAgICAgIGJvZHk6IG1lc3NhZ2VEYXRhLm1lc3NhZ2UgfHwgbWVzc2FnZURhdGEuY2FwdGlvbixcclxuICAgICAgICAgICAgdG86ICd3aGF0c2FwcDonICsgbWVzc2FnZURhdGEucGhvbmVOdW1iZXIsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogbWVzc2FnZS5zaWQsXHJcbiAgICAgICAgc3RhdHVzOiAnc2VudCcsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGDYrti32KMg2YHZiiDYp9mE2KXYsdiz2KfZhCDYudio2LEgVHdpbGlvOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDYp9mE2KXYsdiz2KfZhCDYudio2LEgTWVzc2FnZUJpcmRcclxuICAgKi9cclxuICBhc3luYyBzZW5kVmlhTWVzc2FnZUJpcmQobWVzc2FnZURhdGEpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHBheWxvYWQgPSB7XHJcbiAgICAgICAgdG86IG1lc3NhZ2VEYXRhLnBob25lTnVtYmVyLFxyXG4gICAgICAgIGZyb206IHByb2Nlc3MuZW52Lk1FU1NBR0VCSVJEX1dIQVRTQVBQX0NIQU5ORUxfSUQsXHJcbiAgICAgICAgdHlwZTogbWVzc2FnZURhdGEudHlwZSB8fCAndGV4dCcsXHJcbiAgICAgICAgY29udGVudDoge1xyXG4gICAgICAgICAgdGV4dDogbWVzc2FnZURhdGEubWVzc2FnZSxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNsaWVudC5wb3N0KCcvc2VuZCcsIHBheWxvYWQpO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5pZCxcclxuICAgICAgICBzdGF0dXM6ICdzZW50JyxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYNiu2LfYoyDZgdmKINin2YTYpdix2LPYp9mEINi52KjYsSBNZXNzYWdlQmlyZDogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbiAgICog8J+boO+4jyDYp9mE2KPYr9mI2KfYqiDYp9mE2YXYs9in2LnYr9ipXHJcbiAgICog4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbiAgICovXHJcblxyXG4gIC8qKlxyXG4gICAqINin2YTYqtit2YLZgiDZhdmGINi12K3YqSDYsdmC2YUg2KfZhNmH2KfYqtmBXHJcbiAgICovXHJcbiAgaXNWYWxpZFBob25lTnVtYmVyKHBob25lTnVtYmVyKSB7XHJcbiAgICBjb25zdCBjbGVhbmVkID0gcGhvbmVOdW1iZXIucmVwbGFjZSgvXFxEL2csICcnKTtcclxuICAgIHJldHVybiBjbGVhbmVkLmxlbmd0aCA+PSAxMCAmJiBjbGVhbmVkLmxlbmd0aCA8PSAxNTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINiq2LfYqNmK2Lkg2LHZgtmFINin2YTZh9in2KrZgVxyXG4gICAqL1xyXG4gIG5vcm1hbGl6ZVBob25lTnVtYmVyKHBob25lTnVtYmVyKSB7XHJcbiAgICBsZXQgY2xlYW5lZCA9IHBob25lTnVtYmVyLnJlcGxhY2UoL1xcRC9nLCAnJyk7XHJcblxyXG4gICAgLy8g2KXYstin2YTYqSDYp9mE2KPYtdmB2KfYsSDYp9mE2KjYp9iv2KbYqVxyXG4gICAgaWYgKGNsZWFuZWQuc3RhcnRzV2l0aCgnMDAnKSkge1xyXG4gICAgICBjbGVhbmVkID0gY2xlYW5lZC5zdWJzdHJpbmcoMik7XHJcbiAgICB9IGVsc2UgaWYgKGNsZWFuZWQuc3RhcnRzV2l0aCgnMCcpKSB7XHJcbiAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnN1YnN0cmluZygxKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDYpdi22KfZgdipINmD2YjYryDYp9mE2YXZhdmE2YPYqSDYp9mE2LPYudmI2K/ZitipINil2LDYpyDZhNmFINmK2YPZhiDZhdmI2KzZiNiv2KfZi1xyXG4gICAgaWYgKCFjbGVhbmVkLnN0YXJ0c1dpdGgoJzk2NicpKSB7XHJcbiAgICAgIGlmIChjbGVhbmVkLnN0YXJ0c1dpdGgoJzUnKSkge1xyXG4gICAgICAgIGNsZWFuZWQgPSAnOTY2JyArIGNsZWFuZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gY2xlYW5lZDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINiq2YbYuNmK2YEg2KfZhNix2LPYp9mE2KlcclxuICAgKi9cclxuICBzYW5pdGl6ZU1lc3NhZ2UobWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIFN0cmluZyhtZXNzYWdlKVxyXG4gICAgICAucmVwbGFjZSgvW15cXHdcXHNcXC1cXHUwNjAwLVxcdTA2RkYuIT/YjNibOigpW1xcXXt9XS9nLCAnJylcclxuICAgICAgLnRyaW0oKVxyXG4gICAgICAuc3Vic3RyaW5nKDAsIDQwOTYpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KfZhNiq2K3ZgtmCINmF2YYg2LXYrdipINin2YTYsdin2KjYt1xyXG4gICAqL1xyXG4gIGlzVmFsaWRVUkwodXJsKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBuZXcgVVJMKHVybCk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINin2YTYqtit2YLZgiDZhdmGINmF2LnYr9mEINin2YTYqtit2K/ZitivXHJcbiAgICovXHJcbiAgY2hlY2tSYXRlTGltaXQoKSB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3Qgb25lTWludXRlQWdvID0gbm93IC0gNjAwMDA7XHJcbiAgICBjb25zdCBvbmVIb3VyQWdvID0gbm93IC0gMzYwMDAwMDtcclxuXHJcbiAgICAvLyDYqtmG2LjZitmBINin2YTYsdiz2KfYptmEINin2YTZgtiv2YrZhdipXHJcbiAgICB0aGlzLnJhdGVMaW1pdC5tZXNzYWdlc1NlbnQgPSB0aGlzLnJhdGVMaW1pdC5tZXNzYWdlc1NlbnQuZmlsdGVyKFxyXG4gICAgICB0aW1lID0+IHRpbWUgPiBvbmVIb3VyQWdvXHJcbiAgICApO1xyXG5cclxuICAgIC8vINin2YTYqtit2YLZgiDZhdmGINit2K8g2KfZhNiv2YLZitmC2KlcclxuICAgIGNvbnN0IGxhc3RNaW51dGUgPSB0aGlzLnJhdGVMaW1pdC5tZXNzYWdlc1NlbnQuZmlsdGVyKFxyXG4gICAgICB0aW1lID0+IHRpbWUgPiBvbmVNaW51dGVBZ29cclxuICAgICkubGVuZ3RoO1xyXG5cclxuICAgIGlmIChsYXN0TWludXRlID49IHRoaXMucmF0ZUxpbWl0Lm1lc3NhZ2VzUGVyTWludXRlKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDYp9mE2KrYrdmC2YIg2YXZhiDYrdivINin2YTYs9in2LnYqVxyXG4gICAgaWYgKHRoaXMucmF0ZUxpbWl0Lm1lc3NhZ2VzU2VudC5sZW5ndGggPj0gdGhpcy5yYXRlTGltaXQubWVzc2FnZXNQZXJIb3VyKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnJhdGVMaW1pdC5tZXNzYWdlc1NlbnQucHVzaChub3cpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDYpdi22KfZgdipINix2LPYp9mE2Kkg2KXZhNmJINin2YTYs9is2YRcclxuICAgKi9cclxuICBhZGRUb0hpc3RvcnkobWVzc2FnZSkge1xyXG4gICAgdGhpcy5tZXNzYWdlSGlzdG9yeS5wdXNoKHtcclxuICAgICAgaWQ6IG1lc3NhZ2UuaWQgfHwgYG1zZ18ke0RhdGUubm93KCl9YCxcclxuICAgICAgcGhvbmVOdW1iZXI6IG1lc3NhZ2UucGhvbmVOdW1iZXIsXHJcbiAgICAgIHR5cGU6IG1lc3NhZ2UudHlwZSB8fCAndGV4dCcsXHJcbiAgICAgIHN0YXR1czogbWVzc2FnZS5zdGF0dXMsXHJcbiAgICAgIHNlbnRBdDogbWVzc2FnZS5zZW50QXQgfHwgbmV3IERhdGUoKSxcclxuICAgICAgcmV0cmllczogbWVzc2FnZS5yZXRyaWVzIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDYp9mE2K3Zgdin2Lgg2LnZhNmJINit2K8g2KPZgti12YlcclxuICAgIGlmICh0aGlzLm1lc3NhZ2VIaXN0b3J5Lmxlbmd0aCA+IHRoaXMubWF4SGlzdG9yeSkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2VIaXN0b3J5ID0gdGhpcy5tZXNzYWdlSGlzdG9yeS5zbGljZSgtdGhpcy5tYXhIaXN0b3J5KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINiq2KPYrtmK2LFcclxuICAgKi9cclxuICBkZWxheShtcykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbiAgICog8J+TiiDYp9mE2KXYrdi12KfYptmK2KfYqiDZiNin2YTZhdix2KfZgtio2KlcclxuICAgKiDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcclxuICAgKi9cclxuXHJcbiAgLyoqXHJcbiAgICog2KfZhNit2LXZiNmEINi52YTZiSDYpdit2LXYp9im2YrYp9iqINin2YTYsdiz2KfYptmEXHJcbiAgICovXHJcbiAgZ2V0U3RhdGlzdGljcygpIHtcclxuICAgIGNvbnN0IHRvdGFsID0gdGhpcy5tZXNzYWdlSGlzdG9yeS5sZW5ndGg7XHJcbiAgICBjb25zdCBzZW50ID0gdGhpcy5tZXNzYWdlSGlzdG9yeS5maWx0ZXIobSA9PiBtLnN0YXR1cyA9PT0gJ3NlbnQnKS5sZW5ndGg7XHJcbiAgICBjb25zdCBmYWlsZWQgPSB0aGlzLm1lc3NhZ2VIaXN0b3J5LmZpbHRlcihtID0+IG0uc3RhdHVzID09PSAnZmFpbGVkJykubGVuZ3RoO1xyXG4gICAgY29uc3QgcGVuZGluZyA9IHRoaXMubWVzc2FnZVF1ZXVlLmxlbmd0aDtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3RhbCxcclxuICAgICAgc2VudCxcclxuICAgICAgZmFpbGVkLFxyXG4gICAgICBwZW5kaW5nLFxyXG4gICAgICBzdWNjZXNzUmF0ZTogdG90YWwgPiAwID8gKChzZW50IC8gdG90YWwpICogMTAwKS50b0ZpeGVkKDIpICsgJyUnIDogJzAlJyxcclxuICAgICAgcXVldWVMZW5ndGg6IHBlbmRpbmcsXHJcbiAgICAgIHF1ZXVlUHJvY2Vzc2luZzogdGhpcy5pc1Byb2Nlc3NpbmcsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KfZhNit2LXZiNmEINi52YTZiSDYs9is2YQg2KfZhNix2LPYp9im2YRcclxuICAgKi9cclxuICBnZXRIaXN0b3J5KGxpbWl0ID0gNTApIHtcclxuICAgIHJldHVybiB0aGlzLm1lc3NhZ2VIaXN0b3J5LnNsaWNlKC1saW1pdCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDZhdiz2K0g2KfZhNiz2KzZhFxyXG4gICAqL1xyXG4gIGNsZWFySGlzdG9yeSgpIHtcclxuICAgIHRoaXMubWVzc2FnZUhpc3RvcnkgPSBbXTtcclxuICAgIGxvZ2dlci5pbmZvKCfwn5eR77iPINiq2YUg2YXYs9itINiz2KzZhCDYp9mE2LHYs9in2KbZhCcpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog2KXYttin2YHYqSDYsdmC2YUg2KXZhNmJINin2YTZgtin2KbZhdipINin2YTYqNmK2LbYp9ihXHJcbiAgICovXHJcbiAgYWRkVG9XaGl0ZWxpc3QocGhvbmVOdW1iZXIpIHtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB0aGlzLm5vcm1hbGl6ZVBob25lTnVtYmVyKHBob25lTnVtYmVyKTtcclxuICAgIHRoaXMud2hpdGVsaXN0LmFkZChub3JtYWxpemVkKTtcclxuICAgIGxvZ2dlci5pbmZvKGDinIUg2KrZhSDYpdi22KfZgdipICR7bm9ybWFsaXplZH0g2KXZhNmJINin2YTZgtin2KbZhdipINin2YTYqNmK2LbYp9ihYCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDYpdiy2KfZhNipINix2YLZhSDZhdmGINin2YTZgtin2KbZhdipINin2YTYqNmK2LbYp9ihXHJcbiAgICovXHJcbiAgcmVtb3ZlRnJvbVdoaXRlbGlzdChwaG9uZU51bWJlcikge1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHRoaXMubm9ybWFsaXplUGhvbmVOdW1iZXIocGhvbmVOdW1iZXIpO1xyXG4gICAgdGhpcy53aGl0ZWxpc3QuZGVsZXRlKG5vcm1hbGl6ZWQpO1xyXG4gICAgbG9nZ2VyLmluZm8oYOKdjCDYqtmFINil2LLYp9mE2KkgJHtub3JtYWxpemVkfSDZhdmGINin2YTZgtin2KbZhdipINin2YTYqNmK2LbYp9ihYCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDYp9mE2K3YtdmI2YQg2LnZhNmJINin2YTZgtin2KbZhdipINin2YTYqNmK2LbYp9ihXHJcbiAgICovXHJcbiAgZ2V0V2hpdGVsaXN0KCkge1xyXG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy53aGl0ZWxpc3QpO1xyXG4gIH1cclxufVxyXG5cclxuLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcbi8vIPCfk6Yg2KfZhNiq2LXYr9mK2LFcclxuLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBXaGF0c0FwcE5vdGlmaWNhdGlvblNlcnZpY2UoKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDO0FBQzlCLE1BQU1DLFlBQVksR0FBR0QsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUN0QyxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7QUFFekM7QUFDQTtBQUNBOztBQUVBLE1BQU1HLDJCQUEyQixTQUFTRixZQUFZLENBQUM7RUFDckRHLFdBQVdBLENBQUNDLE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRTtJQUN2QixLQUFLLENBQUMsQ0FBQzs7SUFFUDtJQUNBLElBQUksQ0FBQ0MsU0FBUyxHQUFHLElBQUlDLEdBQUcsQ0FBQyxDQUFDOztJQUUxQjtJQUNBLElBQUksQ0FBQ0MsU0FBUyxHQUFHO01BQ2ZDLE9BQU8sRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLGdCQUFnQixJQUFJLCtCQUErQjtNQUN4RUMsS0FBSyxFQUFFSCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0csa0JBQWtCLElBQUlKLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSSxjQUFjO01BQ25FQyxhQUFhLEVBQUVOLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTSx3QkFBd0I7TUFDbkRDLGlCQUFpQixFQUFFUixPQUFPLENBQUNDLEdBQUcsQ0FBQ1EsNEJBQTRCO01BQzNEQyxVQUFVLEVBQUVWLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDVSxvQkFBb0IsSUFBSTtJQUNsRCxDQUFDOztJQUVEO0lBQ0EsSUFBSSxDQUFDQyxpQkFBaUIs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