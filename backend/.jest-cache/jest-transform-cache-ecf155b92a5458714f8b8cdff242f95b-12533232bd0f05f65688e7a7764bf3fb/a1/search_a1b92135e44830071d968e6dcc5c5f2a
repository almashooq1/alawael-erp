9775f55602863ea019d4f7ad1d5376dc
/**
 * Search Routes
 * Full-text search, fuzzy search, and advanced search operations
 * Phase 10: Advanced Features
 */

const express = require('express');
const router = express.Router();
const searchEngine = require('../services/searchEngine');
const responseFormatter = require('../services/responseFormatter');
const {
  optionalAuth
} = require('../middleware/auth');

// Sample data for search
const sampleData = [{
  _id: '1',
  name: 'Accounting System',
  description: 'Complete accounting and financial management system with reports',
  category: 'finance',
  rating: 4.5
}, {
  _id: '2',
  name: 'HR Management',
  description: 'Human resources and employee management solution',
  category: 'hr',
  rating: 4.8
}, {
  _id: '3',
  name: 'Inventory Control',
  description: 'Inventory tracking and warehouse management system',
  category: 'supply',
  rating: 4.2
}, {
  _id: '4',
  name: 'Customer Relationship',
  description: 'CRM system for managing customer relationships and sales',
  category: 'sales',
  rating: 4.6
}, {
  _id: '5',
  name: 'Project Management',
  description: 'Project planning and team collaboration platform',
  category: 'operations',
  rating: 4.7
}];

// Initialize search index
let indexInitialized = false;
const initializeIndex = () => {
  if (!indexInitialized) {
    searchEngine.buildIndex('systems', sampleData, ['name', 'description']);
    indexInitialized = true;
  }
};

/**
 * GET /api/search/full-text
 * Full-text search
 */
router.get('/full-text', optionalAuth, (req, res) => {
  try {
    const {
      query,
      collection = 'systems',
      limit = 20
    } = req.query;
    if (!query) {
      return res.status(400).json(responseFormatter.validationError('Query parameter is required'));
    }
    initializeIndex();
    const results = searchEngine.fullTextSearch(query, collection, parseInt(limit));
    res.json(responseFormatter.searchResults(results, query, results.length, 'Full-text search completed'));
  } catch (error) {
    res.status(500).json(responseFormatter.serverError('Search failed', error));
  }
});

/**
 * GET /api/search/fuzzy
 * Fuzzy search with tolerance
 */
router.get('/fuzzy', optionalAuth, (req, res) => {
  try {
    const {
      query,
      collection = 'systems',
      maxDistance = 2
    } = req.query;
    if (!query) {
      return res.status(400).json(responseFormatter.validationError('Query parameter is required'));
    }
    initializeIndex();
    const results = searchEngine.fuzzySearch(query, collection, parseInt(maxDistance));
    res.json(responseFormatter.searchResults(results, query, results.length, 'Fuzzy search completed'));
  } catch (error) {
    res.status(500).json(responseFormatter.serverError('Fuzzy search failed', error));
  }
});

/**
 * POST /api/search/advanced
 * Advanced search with filters
 */
router.post('/advanced', optionalAuth, (req, res) => {
  try {
    const {
      query,
      collection = 'systems',
      filters = {},
      limit = 20,
      offset = 0,
      sortBy = 'relevance',
      sortOrder = 'desc'
    } = req.body;
    if (!query) {
      return res.status(400).json(responseFormatter.validationError('Query is required'));
    }
    initializeIndex();
    const result = searchEngine.advancedSearch(query, collection, filters, {
      limit,
      offset,
      sortBy,
      sortOrder
    });
    res.json(responseFormatter.paginated(result.results, result.total, Math.floor(offset / limit) + 1, limit, 'Advanced search completed'));
  } catch (error) {
    res.status(500).json(responseFormatter.serverError('Advanced search failed', error));
  }
});

/**
 * GET /api/search/suggestions
 * Get search suggestions
 */
router.get('/suggestions', optionalAuth, (req, res) => {
  try {
    const {
      query,
      collection = 'systems',
      limit = 10
    } = req.query;
    if (!query) {
      return res.status(400).json(responseFormatter.validationError('Query parameter is required'));
    }
    initializeIndex();
    const suggestions = searchEngine.getSuggestions(query, collection, parseInt(limit));
    res.json(responseFormatter.success(suggestions, 'Suggestions retrieved'));
  } catch (error) {
    res.status(500).json(responseFormatter.serverError('Suggestions failed', error));
  }
});

/**
 * GET /api/search/stats
 * Get search engine statistics
 */
router.get('/stats', optionalAuth, (req, res) => {
  try {
    initializeIndex();
    const stats = searchEngine.getStats();
    res.json(responseFormatter.analytics(stats, 'current', 'Search engine statistics'));
  } catch (error) {
    res.status(500).json(responseFormatter.serverError('Stats retrieval failed', error));
  }
});

/**
 * POST /api/search/cache/clear
 * Clear search cache
 */
router.post('/cache/clear', optionalAuth, (req, res) => {
  try {
    searchEngine.clearCache();
    res.json(responseFormatter.success(null, 'Search cache cleared'));
  } catch (error) {
    res.status(500).json(responseFormatter.serverError('Cache clear failed', error));
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInNlYXJjaEVuZ2luZSIsInJlc3BvbnNlRm9ybWF0dGVyIiwib3B0aW9uYWxBdXRoIiwic2FtcGxlRGF0YSIsIl9pZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImNhdGVnb3J5IiwicmF0aW5nIiwiaW5kZXhJbml0aWFsaXplZCIsImluaXRpYWxpemVJbmRleCIsImJ1aWxkSW5kZXgiLCJnZXQiLCJyZXEiLCJyZXMiLCJxdWVyeSIsImNvbGxlY3Rpb24iLCJsaW1pdCIsInN0YXR1cyIsImpzb24iLCJ2YWxpZGF0aW9uRXJyb3IiLCJyZXN1bHRzIiwiZnVsbFRleHRTZWFyY2giLCJwYXJzZUludCIsInNlYXJjaFJlc3VsdHMiLCJsZW5ndGgiLCJlcnJvciIsInNlcnZlckVycm9yIiwibWF4RGlzdGFuY2UiLCJmdXp6eVNlYXJjaCIsInBvc3QiLCJmaWx0ZXJzIiwib2Zmc2V0Iiwic29ydEJ5Iiwic29ydE9yZGVyIiwiYm9keSIsInJlc3VsdCIsImFkdmFuY2VkU2VhcmNoIiwicGFnaW5hdGVkIiwidG90YWwiLCJNYXRoIiwiZmxvb3IiLCJzdWdnZXN0aW9ucyIsImdldFN1Z2dlc3Rpb25zIiwic3VjY2VzcyIsInN0YXRzIiwiZ2V0U3RhdHMiLCJhbmFseXRpY3MiLCJjbGVhckNhY2hlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNlYXJjaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNlYXJjaCBSb3V0ZXNcbiAqIEZ1bGwtdGV4dCBzZWFyY2gsIGZ1enp5IHNlYXJjaCwgYW5kIGFkdmFuY2VkIHNlYXJjaCBvcGVyYXRpb25zXG4gKiBQaGFzZSAxMDogQWR2YW5jZWQgRmVhdHVyZXNcbiAqL1xuXG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbmNvbnN0IHNlYXJjaEVuZ2luZSA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL3NlYXJjaEVuZ2luZScpO1xuY29uc3QgcmVzcG9uc2VGb3JtYXR0ZXIgPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9yZXNwb25zZUZvcm1hdHRlcicpO1xuY29uc3QgeyBvcHRpb25hbEF1dGggfSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvYXV0aCcpO1xuXG4vLyBTYW1wbGUgZGF0YSBmb3Igc2VhcmNoXG5jb25zdCBzYW1wbGVEYXRhID0gW1xuICB7XG4gICAgX2lkOiAnMScsXG4gICAgbmFtZTogJ0FjY291bnRpbmcgU3lzdGVtJyxcbiAgICBkZXNjcmlwdGlvbjogJ0NvbXBsZXRlIGFjY291bnRpbmcgYW5kIGZpbmFuY2lhbCBtYW5hZ2VtZW50IHN5c3RlbSB3aXRoIHJlcG9ydHMnLFxuICAgIGNhdGVnb3J5OiAnZmluYW5jZScsXG4gICAgcmF0aW5nOiA0LjUsXG4gIH0sXG4gIHtcbiAgICBfaWQ6ICcyJyxcbiAgICBuYW1lOiAnSFIgTWFuYWdlbWVudCcsXG4gICAgZGVzY3JpcHRpb246ICdIdW1hbiByZXNvdXJjZXMgYW5kIGVtcGxveWVlIG1hbmFnZW1lbnQgc29sdXRpb24nLFxuICAgIGNhdGVnb3J5OiAnaHInLFxuICAgIHJhdGluZzogNC44LFxuICB9LFxuICB7XG4gICAgX2lkOiAnMycsXG4gICAgbmFtZTogJ0ludmVudG9yeSBDb250cm9sJyxcbiAgICBkZXNjcmlwdGlvbjogJ0ludmVudG9yeSB0cmFja2luZyBhbmQgd2FyZWhvdXNlIG1hbmFnZW1lbnQgc3lzdGVtJyxcbiAgICBjYXRlZ29yeTogJ3N1cHBseScsXG4gICAgcmF0aW5nOiA0LjIsXG4gIH0sXG4gIHtcbiAgICBfaWQ6ICc0JyxcbiAgICBuYW1lOiAnQ3VzdG9tZXIgUmVsYXRpb25zaGlwJyxcbiAgICBkZXNjcmlwdGlvbjogJ0NSTSBzeXN0ZW0gZm9yIG1hbmFnaW5nIGN1c3RvbWVyIHJlbGF0aW9uc2hpcHMgYW5kIHNhbGVzJyxcbiAgICBjYXRlZ29yeTogJ3NhbGVzJyxcbiAgICByYXRpbmc6IDQuNixcbiAgfSxcbiAge1xuICAgIF9pZDogJzUnLFxuICAgIG5hbWU6ICdQcm9qZWN0IE1hbmFnZW1lbnQnLFxuICAgIGRlc2NyaXB0aW9uOiAnUHJvamVjdCBwbGFubmluZyBhbmQgdGVhbSBjb2xsYWJvcmF0aW9uIHBsYXRmb3JtJyxcbiAgICBjYXRlZ29yeTogJ29wZXJhdGlvbnMnLFxuICAgIHJhdGluZzogNC43LFxuICB9LFxuXTtcblxuLy8gSW5pdGlhbGl6ZSBzZWFyY2ggaW5kZXhcbmxldCBpbmRleEluaXRpYWxpemVkID0gZmFsc2U7XG5cbmNvbnN0IGluaXRpYWxpemVJbmRleCA9ICgpID0+IHtcbiAgaWYgKCFpbmRleEluaXRpYWxpemVkKSB7XG4gICAgc2VhcmNoRW5naW5lLmJ1aWxkSW5kZXgoJ3N5c3RlbXMnLCBzYW1wbGVEYXRhLCBbJ25hbWUnLCAnZGVzY3JpcHRpb24nXSk7XG4gICAgaW5kZXhJbml0aWFsaXplZCA9IHRydWU7XG4gIH1cbn07XG5cbi8qKlxuICogR0VUIC9hcGkvc2VhcmNoL2Z1bGwtdGV4dFxuICogRnVsbC10ZXh0IHNlYXJjaFxuICovXG5yb3V0ZXIuZ2V0KCcvZnVsbC10ZXh0Jywgb3B0aW9uYWxBdXRoLCAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHF1ZXJ5LCBjb2xsZWN0aW9uID0gJ3N5c3RlbXMnLCBsaW1pdCA9IDIwIH0gPSByZXEucXVlcnk7XG5cbiAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24ocmVzcG9uc2VGb3JtYXR0ZXIudmFsaWRhdGlvbkVycm9yKCdRdWVyeSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnKSk7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUluZGV4KCk7XG5cbiAgICBjb25zdCByZXN1bHRzID0gc2VhcmNoRW5naW5lLmZ1bGxUZXh0U2VhcmNoKHF1ZXJ5LCBjb2xsZWN0aW9uLCBwYXJzZUludChsaW1pdCkpO1xuXG4gICAgcmVzLmpzb24oXG4gICAgICByZXNwb25zZUZvcm1hdHRlci5zZWFyY2hSZXN1bHRzKHJlc3VsdHMsIHF1ZXJ5LCByZXN1bHRzLmxlbmd0aCwgJ0Z1bGwtdGV4dCBzZWFyY2ggY29tcGxldGVkJylcbiAgICApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHJlc3BvbnNlRm9ybWF0dGVyLnNlcnZlckVycm9yKCdTZWFyY2ggZmFpbGVkJywgZXJyb3IpKTtcbiAgfVxufSk7XG5cbi8qKlxuICogR0VUIC9hcGkvc2VhcmNoL2Z1enp5XG4gKiBGdXp6eSBzZWFyY2ggd2l0aCB0b2xlcmFuY2VcbiAqL1xucm91dGVyLmdldCgnL2Z1enp5Jywgb3B0aW9uYWxBdXRoLCAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHF1ZXJ5LCBjb2xsZWN0aW9uID0gJ3N5c3RlbXMnLCBtYXhEaXN0YW5jZSA9IDIgfSA9IHJlcS5xdWVyeTtcblxuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihyZXNwb25zZUZvcm1hdHRlci52YWxpZGF0aW9uRXJyb3IoJ1F1ZXJ5IHBhcmFtZXRlciBpcyByZXF1aXJlZCcpKTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplSW5kZXgoKTtcblxuICAgIGNvbnN0IHJlc3VsdHMgPSBzZWFyY2hFbmdpbmUuZnV6enlTZWFyY2gocXVlcnksIGNvbGxlY3Rpb24sIHBhcnNlSW50KG1heERpc3RhbmNlKSk7XG5cbiAgICByZXMuanNvbihcbiAgICAgIHJlc3BvbnNlRm9ybWF0dGVyLnNlYXJjaFJlc3VsdHMocmVzdWx0cywgcXVlcnksIHJlc3VsdHMubGVuZ3RoLCAnRnV6enkgc2VhcmNoIGNvbXBsZXRlZCcpXG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbihyZXNwb25zZUZvcm1hdHRlci5zZXJ2ZXJFcnJvcignRnV6enkgc2VhcmNoIGZhaWxlZCcsIGVycm9yKSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIFBPU1QgL2FwaS9zZWFyY2gvYWR2YW5jZWRcbiAqIEFkdmFuY2VkIHNlYXJjaCB3aXRoIGZpbHRlcnNcbiAqL1xucm91dGVyLnBvc3QoJy9hZHZhbmNlZCcsIG9wdGlvbmFsQXV0aCwgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qge1xuICAgICAgcXVlcnksXG4gICAgICBjb2xsZWN0aW9uID0gJ3N5c3RlbXMnLFxuICAgICAgZmlsdGVycyA9IHt9LFxuICAgICAgbGltaXQgPSAyMCxcbiAgICAgIG9mZnNldCA9IDAsXG4gICAgICBzb3J0QnkgPSAncmVsZXZhbmNlJyxcbiAgICAgIHNvcnRPcmRlciA9ICdkZXNjJyxcbiAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24ocmVzcG9uc2VGb3JtYXR0ZXIudmFsaWRhdGlvbkVycm9yKCdRdWVyeSBpcyByZXF1aXJlZCcpKTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplSW5kZXgoKTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IHNlYXJjaEVuZ2luZS5hZHZhbmNlZFNlYXJjaChxdWVyeSwgY29sbGVjdGlvbiwgZmlsdGVycywge1xuICAgICAgbGltaXQsXG4gICAgICBvZmZzZXQsXG4gICAgICBzb3J0QnksXG4gICAgICBzb3J0T3JkZXIsXG4gICAgfSk7XG5cbiAgICByZXMuanNvbihcbiAgICAgIHJlc3BvbnNlRm9ybWF0dGVyLnBhZ2luYXRlZChcbiAgICAgICAgcmVzdWx0LnJlc3VsdHMsXG4gICAgICAgIHJlc3VsdC50b3RhbCxcbiAgICAgICAgTWF0aC5mbG9vcihvZmZzZXQgLyBsaW1pdCkgKyAxLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgJ0FkdmFuY2VkIHNlYXJjaCBjb21wbGV0ZWQnXG4gICAgICApXG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbihyZXNwb25zZUZvcm1hdHRlci5zZXJ2ZXJFcnJvcignQWR2YW5jZWQgc2VhcmNoIGZhaWxlZCcsIGVycm9yKSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIEdFVCAvYXBpL3NlYXJjaC9zdWdnZXN0aW9uc1xuICogR2V0IHNlYXJjaCBzdWdnZXN0aW9uc1xuICovXG5yb3V0ZXIuZ2V0KCcvc3VnZ2VzdGlvbnMnLCBvcHRpb25hbEF1dGgsIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcXVlcnksIGNvbGxlY3Rpb24gPSAnc3lzdGVtcycsIGxpbWl0ID0gMTAgfSA9IHJlcS5xdWVyeTtcblxuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihyZXNwb25zZUZvcm1hdHRlci52YWxpZGF0aW9uRXJyb3IoJ1F1ZXJ5IHBhcmFtZXRlciBpcyByZXF1aXJlZCcpKTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplSW5kZXgoKTtcblxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gc2VhcmNoRW5naW5lLmdldFN1Z2dlc3Rpb25zKHF1ZXJ5LCBjb2xsZWN0aW9uLCBwYXJzZUludChsaW1pdCkpO1xuXG4gICAgcmVzLmpzb24ocmVzcG9uc2VGb3JtYXR0ZXIuc3VjY2VzcyhzdWdnZXN0aW9ucywgJ1N1Z2dlc3Rpb25zIHJldHJpZXZlZCcpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbihyZXNwb25zZUZvcm1hdHRlci5zZXJ2ZXJFcnJvcignU3VnZ2VzdGlvbnMgZmFpbGVkJywgZXJyb3IpKTtcbiAgfVxufSk7XG5cbi8qKlxuICogR0VUIC9hcGkvc2VhcmNoL3N0YXRzXG4gKiBHZXQgc2VhcmNoIGVuZ2luZSBzdGF0aXN0aWNzXG4gKi9cbnJvdXRlci5nZXQoJy9zdGF0cycsIG9wdGlvbmFsQXV0aCwgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgaW5pdGlhbGl6ZUluZGV4KCk7XG4gICAgY29uc3Qgc3RhdHMgPSBzZWFyY2hFbmdpbmUuZ2V0U3RhdHMoKTtcblxuICAgIHJlcy5qc29uKHJlc3BvbnNlRm9ybWF0dGVyLmFuYWx5dGljcyhzdGF0cywgJ2N1cnJlbnQnLCAnU2VhcmNoIGVuZ2luZSBzdGF0aXN0aWNzJykpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHJlc3BvbnNlRm9ybWF0dGVyLnNlcnZlckVycm9yKCdTdGF0cyByZXRyaWV2YWwgZmFpbGVkJywgZXJyb3IpKTtcbiAgfVxufSk7XG5cbi8qKlxuICogUE9TVCAvYXBpL3NlYXJjaC9jYWNoZS9jbGVhclxuICogQ2xlYXIgc2VhcmNoIGNhY2hlXG4gKi9cbnJvdXRlci5wb3N0KCcvY2FjaGUvY2xlYXInLCBvcHRpb25hbEF1dGgsIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIHNlYXJjaEVuZ2luZS5jbGVhckNhY2hlKCk7XG5cbiAgICByZXMuanNvbihyZXNwb25zZUZvcm1hdHRlci5zdWNjZXNzKG51bGwsICdTZWFyY2ggY2FjaGUgY2xlYXJlZCcpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbihyZXNwb25zZUZvcm1hdHRlci5zZXJ2ZXJFcnJvcignQ2FjaGUgY2xlYXIgZmFpbGVkJywgZXJyb3IpKTtcbiAgfVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsWUFBWSxHQUFHSCxPQUFPLENBQUMsMEJBQTBCLENBQUM7QUFDeEQsTUFBTUksaUJBQWlCLEdBQUdKLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQztBQUNsRSxNQUFNO0VBQUVLO0FBQWEsQ0FBQyxHQUFHTCxPQUFPLENB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