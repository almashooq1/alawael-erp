{"version":3,"names":["aiController","require","module","exports","express","router","Router","all","req","res","status","json","success","message","get","authenticateToken","post","put"],"sources":["ai.recommendations.routes.js"],"sourcesContent":["/**\r\n * AI Recommendations Routes\r\n * مسارات توصيات الذكاء الاصطناعي\r\n * \r\n * API Routes for AI-powered recommendation system\r\n * مسارات API لنظام الذكاء الاصطناعي\r\n */\r\n\r\nconst aiController = require('../controllers/aiRecommendations.controller');\r\n\r\n// Export the controller routes directly if it's a Router\r\n// Otherwise wrap in error handling\r\nif (aiController && typeof aiController === 'object') {\r\n  module.exports = aiController;\r\n} else {\r\n  // Fallback\r\n  const express = require('express');\r\n  const router = express.Router();\r\n  router.all('*', (req, res) => {\r\n    res.status(501).json({\r\n      success: false,\r\n      message: 'AI Recommendations routes not fully initialized',\r\n      status: 'NOT_IMPLEMENTED'\r\n    });\r\n  });\r\n  module.exports = router;\r\n}\r\n\r\n/**\r\n * GET /api/ai/recommendations/:userId/history\r\n * Get recommendation history for specific user\r\n * \r\n * Query params: limit, startDate, endDate\r\n * Auth: Required\r\n */\r\nrouter.get('/:userId/history', authenticateToken, aiController.get('/:userId/history'));\r\n\r\n// ==================== USER FEEDBACK ====================\r\n\r\n/**\r\n * POST /api/ai/feedback\r\n * Record user feedback on recommendation\r\n * \r\n * Body:\r\n * {\r\n *   \"tenantId\": \"tenant-123\",\r\n *   \"userId\": \"user-456\",\r\n *   \"recommendationId\": \"rec-789\",\r\n *   \"rating\": 5,\r\n *   \"helpful\": true,\r\n *   \"comment\": \"Very useful\",\r\n *   \"action\": \"clicked\"\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.post('/feedback/record', authenticateToken, aiController.post('/feedback/record'));\r\n\r\n/**\r\n * GET /api/ai/feedback/:userId\r\n * Get all feedback given by user\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/feedback/:userId', authenticateToken, aiController.get('/feedback/:userId'));\r\n\r\n// ==================== USER PREFERENCES ====================\r\n\r\n/**\r\n * GET /api/ai/preferences/:userId\r\n * Get user's recommendation preferences\r\n * \r\n * Response includes:\r\n * {\r\n *   \"categories\": [\"rehabilitation\", \"education\"],\r\n *   \"excludeCategories\": [],\r\n *   \"topics\": [],\r\n *   \"maxRecommendations\": 10,\r\n *   \"diversity\": 0.5,\r\n *   \"freshness\": 0.3\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/preferences/:userId', authenticateToken, aiController.get('/preferences/:userId'));\r\n\r\n/**\r\n * PUT /api/ai/preferences/:userId\r\n * Update user's recommendation preferences\r\n * \r\n * Body can include:\r\n * {\r\n *   \"categories\": [\"education\", \"performance\"],\r\n *   \"excludeCategories\": [\"advanced\"],\r\n *   \"topics\": [\"mathematics\", \"science\"],\r\n *   \"maxRecommendations\": 15,\r\n *   \"diversity\": 0.7,\r\n *   \"freshness\": 0.4\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.put('/preferences/:userId', authenticateToken, aiController.put('/preferences/:userId'));\r\n\r\n// ==================== AI MODELS ====================\r\n\r\n/**\r\n * POST /api/ai/models/register\r\n * Register new AI model\r\n * \r\n * Body:\r\n * {\r\n *   \"name\": \"Custom Recommendation Model\",\r\n *   \"type\": \"recommendation|prediction|classification|anomaly_detection\",\r\n *   \"description\": \"Model description\",\r\n *   \"algorithm\": \"collaborative_filtering|random_forest|gradient_boosting\",\r\n *   \"inputs\": [\"user_profile\", \"historical_data\"],\r\n *   \"outputs\": [\"recommendations\"],\r\n *   \"accuracy\": 0.87,\r\n *   \"precision\": 0.85,\r\n *   \"recall\": 0.86,\r\n *   \"trainingDataSize\": 10000\r\n * }\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/models/register', authenticateToken, aiController.post('/models/register'));\r\n\r\n/**\r\n * GET /api/ai/models/all\r\n * Get all registered AI models\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/models/all', authenticateToken, aiController.get('/models/all'));\r\n\r\n/**\r\n * GET /api/ai/models/:modelId\r\n * Get specific model details\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/models/:modelId', authenticateToken, aiController.get('/models/:modelId'));\r\n\r\n/**\r\n * GET /api/ai/models/type/:type\r\n * Get all models of specific type\r\n * \r\n * Types: recommendation, prediction, classification, anomaly_detection\r\n * Auth: Required\r\n */\r\nrouter.get('/models/type/:type', authenticateToken, aiController.get('/models/type/:type'));\r\n\r\n/**\r\n * POST /api/ai/models/:modelId/deploy\r\n * Deploy model to production\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/models/:modelId/deploy', authenticateToken, aiController.post('/models/:modelId/deploy'));\r\n\r\n/**\r\n * POST /api/ai/models/:modelId/undeploy\r\n * Remove model from production\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/models/:modelId/undeploy', authenticateToken, aiController.post('/models/:modelId/undeploy'));\r\n\r\n/**\r\n * GET /api/ai/models/:modelId/metrics\r\n * Get model performance metrics\r\n * \r\n * Returns:\r\n * {\r\n *   \"accuracy\": 0.87,\r\n *   \"precision\": 0.85,\r\n *   \"recall\": 0.86,\r\n *   \"f1Score\": 0.855,\r\n *   \"totalPredictions\": 1000,\r\n *   \"successfulPredictions\": 870\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/models/:modelId/metrics', authenticateToken, aiController.get('/models/:modelId/metrics'));\r\n\r\n/**\r\n * POST /api/ai/models/:modelId/train\r\n * Start training job for model\r\n * \r\n * Body:\r\n * {\r\n *   \"size\": 5000,\r\n *   \"epochs\": 30,\r\n *   \"batchSize\": 32,\r\n *   \"learningRate\": 0.001\r\n * }\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/models/:modelId/train', authenticateToken, aiController.post('/models/:modelId/train'));\r\n\r\n/**\r\n * POST /api/ai/models/:modelId/predict\r\n * Make prediction using model\r\n * \r\n * Body: Input data for model\r\n * {\r\n *   \"user_id\": \"user-123\",\r\n *   \"historical_data\": [...],\r\n *   ... other model inputs\r\n * }\r\n * \r\n * Auth: Optional\r\n */\r\nrouter.post('/models/:modelId/predict', aiController.post('/models/:modelId/predict'));\r\n\r\n/**\r\n * GET /api/ai/models/active/list\r\n * Get all currently active (deployed) models\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/models/active/list', authenticateToken, aiController.get('/models/active/list'));\r\n\r\n// ==================== A/B TESTING ====================\r\n\r\n/**\r\n * POST /api/ai/tests/create\r\n * Create new A/B test for recommendations\r\n * \r\n * Body:\r\n * {\r\n *   \"tenantId\": \"tenant-123\",\r\n *   \"name\": \"Test Name\",\r\n *   \"description\": \"Test description\",\r\n *   \"variants\": [\"control\", \"variant_a\", \"variant_b\"],\r\n *   \"startDate\": \"2026-02-17\",\r\n *   \"endDate\": \"2026-03-17\"\r\n * }\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/tests/create', authenticateToken, aiController.post('/tests/create'));\r\n\r\n/**\r\n * POST /api/ai/tests/:testId/event\r\n * Record event for A/B test\r\n * \r\n * Body:\r\n * {\r\n *   \"variant\": \"control\",\r\n *   \"eventType\": \"impression|click|conversion\"\r\n * }\r\n * \r\n * Auth: Optional\r\n */\r\nrouter.post('/tests/:testId/event', aiController.post('/tests/:testId/event'));\r\n\r\n/**\r\n * GET /api/ai/tests/:testId\r\n * Get A/B test results and statistics\r\n * \r\n * Response includes:\r\n * {\r\n *   \"id\": \"test-123\",\r\n *   \"name\": \"Test Name\",\r\n *   \"status\": \"active|completed\",\r\n *   \"results\": {\r\n *     \"control\": { \"clicks\": 100, \"conversions\": 10 },\r\n *     \"variant_a\": { \"clicks\": 120, \"conversions\": 15 }\r\n *   }\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/tests/:testId', authenticateToken, aiController.get('/tests/:testId'));\r\n\r\n// ==================== STATISTICS ====================\r\n\r\n/**\r\n * GET /api/ai/stats/all\r\n * Get comprehensive AI system statistics\r\n * \r\n * Response includes:\r\n * {\r\n *   \"recommendations\": {\r\n *     \"totalRecommendations\": 1000,\r\n *     \"totalFeedback\": 500,\r\n *     \"positiveRatings\": 400,\r\n *     \"averageRating\": 4.2,\r\n *     \"cacheHitRate\": 75\r\n *   },\r\n *   \"models\": {\r\n *     \"totalModels\": 5,\r\n *     \"activeModels\": 4,\r\n *     \"totalPredictions\": 5000,\r\n *     \"successRate\": 92\r\n *   }\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/stats/all', authenticateToken, aiController.get('/stats/all'));\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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CW,IAAI,CAAC,wBAAwB,EAAED,iBAAiB,EAAEf,YAAY,CAACgB,IAAI,CAAC,wBAAwB,CAAC,CAAC;;AAErG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAX,MAAM,CAACW,IAAI,CAAC,0BAA0B,EAAEhB,YAAY,CAACgB,IAAI,CAAC,0BAA0B,CAAC,CAAC;;AAEtF;AACA;AACA;AACA;AACA;AACA;AACAX,MAAM,CAACS,GAAG,CAAC,qBAAqB,EAAEC,iBAAiB,EAAEf,YAAY,CAACc,GAAG,CAAC,qBAAqB,CAAC,CAAC;;AAE7F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAT,MAAM,CAACW,IAAI,CAAC,eAAe,EAAED,iBAAiB,EAAEf,YAAY,CAACgB,IAAI,CAAC,eAAe,CAAC,CAAC;;AAEnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAX,MAAM,CAACW,IAAI,CAAC,sBAAsB,EAAEhB,YAAY,CAACgB,IAAI,CAAC,sBAAsB,CAAC,CAAC;;AAE9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAX,MAAM,CAACS,GAAG,CAAC,gBAAgB,EAAEC,iBAAiB,EAAEf,YAAY,CAACc,GAAG,CAAC,gBAAgB,CAAC,CAAC;;AAEnF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAT,MAAM,CAACS,GAAG,CAAC,YAAY,EAAEC,iBAAiB,EAAEf,YAAY,CAACc,GAAG,CAAC,YAAY,CAAC,CAAC;AAE3EZ,MAAM,CAACC,OAAO,GAAGE,MAAM","ignoreList":[]}