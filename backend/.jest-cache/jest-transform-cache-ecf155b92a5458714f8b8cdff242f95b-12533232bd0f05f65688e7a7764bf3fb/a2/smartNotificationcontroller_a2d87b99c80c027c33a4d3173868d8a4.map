{"version":3,"names":["NotificationService","require","Notification","SmartNotificationController","sendNotification","req","res","recipientId","title","message","notificationType","priority","channels","body","status","json","success","notification","sendQuickNotification","sms","email","push","inApp","error","sendViolationAlert","driverId","violationType","details","alert","sendPerformanceReport","report","scheduleNotification","scheduledTime","isRecurring","recurrencePattern","result","getUnreadNotifications","userId","user","id","query","limit","parseInt","notifications","count","length","getAllNotifications","skip","recipient","total","Promise","all","find","sort","createdAt","countDocuments","markAsRead","params","deleteNotification","getStats","timeRange","stats","getNotificationStats","previewNotification","preview","sendBulkNotification","filterCriteria","sentCount","getUnreadCount","$ne","unreadCount","module","exports"],"sources":["smartNotification.controller.js"],"sourcesContent":["/**\r\n * Smart Notifications Controller - Phase 31\r\n * متحكم الإشعارات الذكية المتقدمة\r\n */\r\n\r\nconst NotificationService = require('../services/notificationService');\r\nconst Notification = require('../models/Notification');\r\n\r\nclass SmartNotificationController {\r\n  /**\r\n   * إرسال إشعار فوري\r\n   * POST /api/notifications/send\r\n   */\r\n  static async sendNotification(req, res) {\r\n    try {\r\n      const { recipientId, title, message, notificationType, priority, channels } =\r\n        req.body;\r\n\r\n      if (!recipientId || !title || !message) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'البيانات المطلوبة ناقصة',\r\n        });\r\n      }\r\n\r\n      const notification = await NotificationService.sendQuickNotification(\r\n        recipientId,\r\n        {\r\n          title,\r\n          message,\r\n          notificationType: notificationType || 'custom',\r\n          priority: priority || 'normal',\r\n          channels: channels || {\r\n            sms: false,\r\n            email: false,\r\n            push: true,\r\n            inApp: true,\r\n          },\r\n        }\r\n      );\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: 'تم إرسال الإشعار بنجاح',\r\n        notification,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إرسال تنبيه انتهاك\r\n   * POST /api/notifications/violation-alert\r\n   */\r\n  static async sendViolationAlert(req, res) {\r\n    try {\r\n      const { driverId, violationType, details } = req.body;\r\n\r\n      if (!driverId || !violationType) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف السائق ونوع الانتهاك مطلوبان',\r\n        });\r\n      }\r\n\r\n      const alert = await NotificationService.sendViolationAlert(\r\n        driverId,\r\n        violationType,\r\n        details || {}\r\n      );\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: 'تم إرسال التنبيه',\r\n        alert,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إرسال تقرير الأداء\r\n   * POST /api/notifications/performance-report\r\n   */\r\n  static async sendPerformanceReport(req, res) {\r\n    try {\r\n      const { driverId, report } = req.body;\r\n\r\n      if (!driverId || !report) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف السائق والتقرير مطلوبان',\r\n        });\r\n      }\r\n\r\n      const notification = await NotificationService.sendPerformanceReport(\r\n        driverId,\r\n        report\r\n      );\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: 'تم إرسال التقرير',\r\n        notification,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * جدولة إشعار\r\n   * POST /api/notifications/schedule\r\n   */\r\n  static async scheduleNotification(req, res) {\r\n    try {\r\n      const { recipientId, title, message, scheduledTime, isRecurring, recurrencePattern } =\r\n        req.body;\r\n\r\n      if (!recipientId || !title || !scheduledTime) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'البيانات المطلوبة ناقصة',\r\n        });\r\n      }\r\n\r\n      const result = await NotificationService.scheduleNotification(\r\n        recipientId,\r\n        { title, message },\r\n        scheduledTime,\r\n        isRecurring,\r\n        recurrencePattern\r\n      );\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: 'تم جدولة الإشعار',\r\n        result,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على الإشعارات غير المقروءة\r\n   * GET /api/notifications/unread?limit=20\r\n   */\r\n  static async getUnreadNotifications(req, res) {\r\n    try {\r\n      const userId = req.user?.id || req.query.userId;\r\n      const limit = parseInt(req.query.limit) || 20;\r\n\r\n      if (!userId) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف المستخدم مطلوب',\r\n        });\r\n      }\r\n\r\n      const notifications = await NotificationService.getUnreadNotifications(\r\n        userId,\r\n        limit\r\n      );\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        count: notifications.length,\r\n        notifications,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على جميع الإشعارات\r\n   * GET /api/notifications?skip=0&limit=20&status=all\r\n   */\r\n  static async getAllNotifications(req, res) {\r\n    try {\r\n      const userId = req.user?.id || req.query.userId;\r\n      const { skip = 0, limit = 20, status = 'all' } = req.query;\r\n\r\n      if (!userId) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف المستخدم مطلوب',\r\n        });\r\n      }\r\n\r\n      const query = { recipient: userId };\r\n      if (status !== 'all') {\r\n        query.status = status;\r\n      }\r\n\r\n      const [notifications, total] = await Promise.all([\r\n        Notification.find(query)\r\n          .sort({ createdAt: -1 })\r\n          .skip(parseInt(skip))\r\n          .limit(parseInt(limit)),\r\n        Notification.countDocuments(query),\r\n      ]);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        total,\r\n        count: notifications.length,\r\n        notifications,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تحديد الإشعار كمقروء\r\n   * PUT /api/notifications/:id/read\r\n   */\r\n  static async markAsRead(req, res) {\r\n    try {\r\n      const { id } = req.params;\r\n      const userId = req.user?.id || req.body.userId;\r\n\r\n      if (!userId) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف المستخدم مطلوب',\r\n        });\r\n      }\r\n\r\n      const result = await NotificationService.markAsRead(id, userId);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'تم تحديد الإشعار كمقروء',\r\n        notification: result.notification,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * حذف الإشعار\r\n   * DELETE /api/notifications/:id\r\n   */\r\n  static async deleteNotification(req, res) {\r\n    try {\r\n      const { id } = req.params;\r\n      const userId = req.user?.id || req.body.userId;\r\n\r\n      if (!userId) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف المستخدم مطلوب',\r\n        });\r\n      }\r\n\r\n      const result = await NotificationService.deleteNotification(id, userId);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'تم حذف الإشعار',\r\n        result,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إحصائيات الإشعارات\r\n   * GET /api/notifications/stats?timeRange=week\r\n   */\r\n  static async getStats(req, res) {\r\n    try {\r\n      const userId = req.user?.id || req.query.userId;\r\n      const { timeRange = 'week' } = req.query;\r\n\r\n      if (!userId) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف المستخدم مطلوب',\r\n        });\r\n      }\r\n\r\n      const stats = await NotificationService.getNotificationStats(userId, timeRange);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        stats,\r\n        timeRange,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * معاينة الإشعار\r\n   * POST /api/notifications/preview\r\n   */\r\n  static async previewNotification(req, res) {\r\n    try {\r\n      const { title, message, channels } = req.body;\r\n\r\n      if (!title || !message) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'العنوان والرسالة مطلوبان',\r\n        });\r\n      }\r\n\r\n      const preview = await NotificationService.previewNotification({\r\n        title,\r\n        message,\r\n        channels,\r\n      });\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        preview,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إرسال إشعارات جماعية\r\n   * POST /api/notifications/bulk-send\r\n   */\r\n  static async sendBulkNotification(req, res) {\r\n    try {\r\n      const { filterCriteria, title, message, notificationType, priority } = req.body;\r\n\r\n      if (!filterCriteria || !title || !message) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'المعايير والعنوان والرسالة مطلوبة',\r\n        });\r\n      }\r\n\r\n      const result = await NotificationService.sendBulkNotification(\r\n        filterCriteria,\r\n        {\r\n          title,\r\n          message,\r\n          notificationType: notificationType || 'custom',\r\n          priority: priority || 'normal',\r\n        }\r\n      );\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: `تم إرسال ${result.sentCount} إشعار`,\r\n        result,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * عد الإشعارات غير المقروءة\r\n   * GET /api/notifications/unread-count\r\n   */\r\n  static async getUnreadCount(req, res) {\r\n    try {\r\n      const userId = req.user?.id || req.query.userId;\r\n\r\n      if (!userId) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'معرف المستخدم مطلوب',\r\n        });\r\n      }\r\n\r\n      const count = await Notification.countDocuments({\r\n        recipient: userId,\r\n        'channels.inApp.read': false,\r\n        status: { $ne: 'cancelled' },\r\n      });\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        unreadCount: count,\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        message: error.message,\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = SmartNotificationController;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,MAAMA,mBAAmB,GAAGC,OAAO,CAAC,iCAAiC,CAAC;AACtE,MAAMC,YAAY,GAAGD,OAAO,CAAC,wBAAwB,CAAC;AAEtD,MAAME,2BAA2B,CAAC;EAChC;AACF;AACA;AACA;EACE,aAAaC,gBAAgBA,CAACC,GAAG,EAAEC,GAAG,EAAE;IACtC,IAAI;MACF,MAAM;QAAEC,WAAW;QAAEC,KAAK;QAAEC,OAAO;QAAEC,gBAAgB;QAAEC,QAAQ;QAAEC;MAAS,CAAC,GACzEP,GAAG,CAACQ,IAAI;MAEV,IAAI,CAACN,WAAW,IAAI,CAACC,KAAK,IAAI,CAACC,OAAO,EAAE;QACtC,OAAOH,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMQ,YAAY,GAAG,MAAMjB,mBAAmB,CAACkB,qBAAqB,CAClEX,WAAW,EACX;QACEC,KAAK;QACLC,OAAO;QACPC,gBAAgB,EAAEA,gBAAgB,IAAI,QAAQ;QAC9CC,QAAQ,EAAEA,QAAQ,IAAI,QAAQ;QAC9BC,QAAQ,EAAEA,QAAQ,IAAI;UACpBO,GAAG,EAAE,KAAK;UACVC,KAAK,EAAE,KAAK;UACZC,IAAI,EAAE,IAAI;UACVC,KAAK,EAAE;QACT;MACF,CACF,CAAC;MAED,OAAOhB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,wBAAwB;QACjCQ;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOM,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAae,kBAAkBA,CAACnB,GAAG,EAAEC,GAAG,EAAE;IACxC,IAAI;MACF,MAAM;QAAEmB,QAAQ;QAAEC,aAAa;QAAEC;MAAQ,CAAC,GAAGtB,GAAG,CAACQ,IAAI;MAErD,IAAI,CAACY,QAAQ,IAAI,CAACC,aAAa,EAAE;QAC/B,OAAOpB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMmB,KAAK,GAAG,MAAM5B,mBAAmB,CAACwB,kBAAkB,CACxDC,QAAQ,EACRC,aAAa,EACbC,OAAO,IAAI,CAAC,CACd,CAAC;MAED,OAAOrB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,kBAAkB;QAC3BmB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOL,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAaoB,qBAAqBA,CAACxB,GAAG,EAAEC,GAAG,EAAE;IAC3C,IAAI;MACF,MAAM;QAAEmB,QAAQ;QAAEK;MAAO,CAAC,GAAGzB,GAAG,CAACQ,IAAI;MAErC,IAAI,CAACY,QAAQ,IAAI,CAACK,MAAM,EAAE;QACxB,OAAOxB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMQ,YAAY,GAAG,MAAMjB,mBAAmB,CAAC6B,qBAAqB,CAClEJ,QAAQ,EACRK,MACF,CAAC;MAED,OAAOxB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,kBAAkB;QAC3BQ;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOM,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAasB,oBAAoBA,CAAC1B,GAAG,EAAEC,GAAG,EAAE;IAC1C,IAAI;MACF,MAAM;QAAEC,WAAW;QAAEC,KAAK;QAAEC,OAAO;QAAEuB,aAAa;QAAEC,WAAW;QAAEC;MAAkB,CAAC,GAClF7B,GAAG,CAACQ,IAAI;MAEV,IAAI,CAACN,WAAW,IAAI,CAACC,KAAK,IAAI,CAACwB,aAAa,EAAE;QAC5C,OAAO1B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAM0B,MAAM,GAAG,MAAMnC,mBAAmB,CAAC+B,oBAAoB,CAC3DxB,WAAW,EACX;QAAEC,KAAK;QAAEC;MAAQ,CAAC,EAClBuB,aAAa,EACbC,WAAW,EACXC,iBACF,CAAC;MAED,OAAO5B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,kBAAkB;QAC3B0B;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAa2B,sBAAsBA,CAAC/B,GAAG,EAAEC,GAAG,EAAE;IAC5C,IAAI;MACF,MAAM+B,MAAM,GAAGhC,GAAG,CAACiC,IAAI,EAAEC,EAAE,IAAIlC,GAAG,CAACmC,KAAK,CAACH,MAAM;MAC/C,MAAMI,KAAK,GAAGC,QAAQ,CAACrC,GAAG,CAACmC,KAAK,CAACC,KAAK,CAAC,IAAI,EAAE;MAE7C,IAAI,CAACJ,MAAM,EAAE;QACX,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMkC,aAAa,GAAG,MAAM3C,mBAAmB,CAACoC,sBAAsB,CACpEC,MAAM,EACNI,KACF,CAAC;MAED,OAAOnC,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACb4B,KAAK,EAAED,aAAa,CAACE,MAAM;QAC3BF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAaqC,mBAAmBA,CAACzC,GAAG,EAAEC,GAAG,EAAE;IACzC,IAAI;MACF,MAAM+B,MAAM,GAAGhC,GAAG,CAACiC,IAAI,EAAEC,EAAE,IAAIlC,GAAG,CAACmC,KAAK,CAACH,MAAM;MAC/C,MAAM;QAAEU,IAAI,GAAG,CAAC;QAAEN,KAAK,GAAG,EAAE;QAAE3B,MAAM,GAAG;MAAM,CAAC,GAAGT,GAAG,CAACmC,KAAK;MAE1D,IAAI,CAACH,MAAM,EAAE;QACX,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAM+B,KAAK,GAAG;QAAEQ,SAAS,EAAEX;MAAO,CAAC;MACnC,IAAIvB,MAAM,KAAK,KAAK,EAAE;QACpB0B,KAAK,CAAC1B,MAAM,GAAGA,MAAM;MACvB;MAEA,MAAM,CAAC6B,aAAa,EAAEM,KAAK,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CAC/CjD,YAAY,CAACkD,IAAI,CAACZ,KAAK,CAAC,CACrBa,IAAI,CAAC;QAAEC,SAAS,EAAE,CAAC;MAAE,CAAC,CAAC,CACvBP,IAAI,CAACL,QAAQ,CAACK,IAAI,CAAC,CAAC,CACpBN,KAAK,CAACC,QAAQ,CAACD,KAAK,CAAC,CAAC,EACzBvC,YAAY,CAACqD,cAAc,CAACf,KAAK,CAAC,CACnC,CAAC;MAEF,OAAOlC,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbiC,KAAK;QACLL,KAAK,EAAED,aAAa,CAACE,MAAM;QAC3BF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAa+C,UAAUA,CAACnD,GAAG,EAAEC,GAAG,EAAE;IAChC,IAAI;MACF,MAAM;QAAEiC;MAAG,CAAC,GAAGlC,GAAG,CAACoD,MAAM;MACzB,MAAMpB,MAAM,GAAGhC,GAAG,CAACiC,IAAI,EAAEC,EAAE,IAAIlC,GAAG,CAACQ,IAAI,CAACwB,MAAM;MAE9C,IAAI,CAACA,MAAM,EAAE;QACX,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAM0B,MAAM,GAAG,MAAMnC,mBAAmB,CAACwD,UAAU,CAACjB,EAAE,EAAEF,MAAM,CAAC;MAE/D,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,yBAAyB;QAClCQ,YAAY,EAAEkB,MAAM,CAAClB;MACvB,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOM,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAaiD,kBAAkBA,CAACrD,GAAG,EAAEC,GAAG,EAAE;IACxC,IAAI;MACF,MAAM;QAAEiC;MAAG,CAAC,GAAGlC,GAAG,CAACoD,MAAM;MACzB,MAAMpB,MAAM,GAAGhC,GAAG,CAACiC,IAAI,EAAEC,EAAE,IAAIlC,GAAG,CAACQ,IAAI,CAACwB,MAAM;MAE9C,IAAI,CAACA,MAAM,EAAE;QACX,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAM0B,MAAM,GAAG,MAAMnC,mBAAmB,CAAC0D,kBAAkB,CAACnB,EAAE,EAAEF,MAAM,CAAC;MAEvE,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,gBAAgB;QACzB0B;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAakD,QAAQA,CAACtD,GAAG,EAAEC,GAAG,EAAE;IAC9B,IAAI;MACF,MAAM+B,MAAM,GAAGhC,GAAG,CAACiC,IAAI,EAAEC,EAAE,IAAIlC,GAAG,CAACmC,KAAK,CAACH,MAAM;MAC/C,MAAM;QAAEuB,SAAS,GAAG;MAAO,CAAC,GAAGvD,GAAG,CAACmC,KAAK;MAExC,IAAI,CAACH,MAAM,EAAE;QACX,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMoD,KAAK,GAAG,MAAM7D,mBAAmB,CAAC8D,oBAAoB,CAACzB,MAAM,EAAEuB,SAAS,CAAC;MAE/E,OAAOtD,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACb6C,KAAK;QACLD;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOrC,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAasD,mBAAmBA,CAAC1D,GAAG,EAAEC,GAAG,EAAE;IACzC,IAAI;MACF,MAAM;QAAEE,KAAK;QAAEC,OAAO;QAAEG;MAAS,CAAC,GAAGP,GAAG,CAACQ,IAAI;MAE7C,IAAI,CAACL,KAAK,IAAI,CAACC,OAAO,EAAE;QACtB,OAAOH,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMuD,OAAO,GAAG,MAAMhE,mBAAmB,CAAC+D,mBAAmB,CAAC;QAC5DvD,KAAK;QACLC,OAAO;QACPG;MACF,CAAC,CAAC;MAEF,OAAON,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbgD;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOzC,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAawD,oBAAoBA,CAAC5D,GAAG,EAAEC,GAAG,EAAE;IAC1C,IAAI;MACF,MAAM;QAAE4D,cAAc;QAAE1D,KAAK;QAAEC,OAAO;QAAEC,gBAAgB;QAAEC;MAAS,CAAC,GAAGN,GAAG,CAACQ,IAAI;MAE/E,IAAI,CAACqD,cAAc,IAAI,CAAC1D,KAAK,IAAI,CAACC,OAAO,EAAE;QACzC,OAAOH,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAM0B,MAAM,GAAG,MAAMnC,mBAAmB,CAACiE,oBAAoB,CAC3DC,cAAc,EACd;QACE1D,KAAK;QACLC,OAAO;QACPC,gBAAgB,EAAEA,gBAAgB,IAAI,QAAQ;QAC9CC,QAAQ,EAAEA,QAAQ,IAAI;MACxB,CACF,CAAC;MAED,OAAOL,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbP,OAAO,EAAE,YAAY0B,MAAM,CAACgC,SAAS,QAAQ;QAC7ChC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAa2D,cAAcA,CAAC/D,GAAG,EAAEC,GAAG,EAAE;IACpC,IAAI;MACF,MAAM+B,MAAM,GAAGhC,GAAG,CAACiC,IAAI,EAAEC,EAAE,IAAIlC,GAAG,CAACmC,KAAK,CAACH,MAAM;MAE/C,IAAI,CAACA,MAAM,EAAE;QACX,OAAO/B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,KAAK;UACdP,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;MAEA,MAAMmC,KAAK,GAAG,MAAM1C,YAAY,CAACqD,cAAc,CAAC;QAC9CP,SAAS,EAAEX,MAAM;QACjB,qBAAqB,EAAE,KAAK;QAC5BvB,MAAM,EAAE;UAAEuD,GAAG,EAAE;QAAY;MAC7B,CAAC,CAAC;MAEF,OAAO/D,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,IAAI;QACbsD,WAAW,EAAE1B;MACf,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOrB,KAAK,EAAE;MACdjB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,KAAK;QACdP,OAAO,EAAEc,KAAK,CAACd;MACjB,CAAC,CAAC;IACJ;EACF;AACF;AAEA8D,MAAM,CAACC,OAAO,GAAGrE,2BAA2B","ignoreList":[]}