06a1a92f03355f4769ef924c46b7fca8
/**
 * Migration System Tests
 * Comprehensive test suite for migration utilities
 */

const CSVProcessor = require('../services/migration/CSVProcessor');
const DatabaseMigration = require('../services/migration/DatabaseMigration');
const MigrationManager = require('../services/migration/MigrationManager');
const fs = require('fs');

/**
 * Test Suite for CSVProcessor
 */
describe('CSVProcessor', () => {
  let csvProcessor;
  const testCSVPath = './test-data.csv';
  beforeAll(() => {
    csvProcessor = new CSVProcessor({
      delimiter: ',',
      encoding: 'utf-8',
      maxRowsPerChunk: 10
    });

    // Create test CSV
    const testData = 'id,name,email,age\n1,John,john@example.com,30\n2,Jane,jane@example.com,25\n';
    fs.writeFileSync(testCSVPath, testData);
  });
  afterAll(() => {
    if (fs.existsSync(testCSVPath)) {
      fs.unlinkSync(testCSVPath);
    }
  });
  test('should import CSV successfully', async () => {
    const result = await csvProcessor.importCSV(testCSVPath, {
      columns: true
    });
    expect(result.success).toBe(true);
    expect(result.recordCount).toBe(2);
    expect(result.data).toHaveLength(2);
  });
  test('should export CSV successfully', async () => {
    const data = [{
      id: 1,
      name: 'John',
      email: 'john@example.com'
    }, {
      id: 2,
      name: 'Jane',
      email: 'jane@example.com'
    }];
    const exportPath = './test-export.csv';
    const result = await csvProcessor.exportToCSV(data, exportPath);
    expect(result.success).toBe(true);
    expect(result.recordCount).toBe(2);
    expect(fs.existsSync(exportPath)).toBe(true);

    // Cleanup
    fs.unlinkSync(exportPath);
  });
  test('should transform data', () => {
    const data = [{
      email: 'JOHN@EXAMPLE.COM',
      status: '1'
    }, {
      email: 'JANE@EXAMPLE.COM',
      status: '0'
    }];
    const transformRules = {
      email: val => val.toLowerCase(),
      status: {
        mapping: {
          '1': 'active',
          '0': 'inactive'
        }
      }
    };
    const transformed = csvProcessor.transformData(data, transformRules);
    expect(transformed[0].email).toBe('john@example.com');
    expect(transformed[0].status).toBe('active');
  });
  test('should validate CSV structure', async () => {
    const result = await csvProcessor.validateCSVStructure(testCSVPath, ['id', 'name', 'email']);
    expect(result.valid).toBe(true);
    expect(result.columns).toContain('id');
    expect(result.columns).toContain('name');
  });
  test('should sample CSV', async () => {
    const result = await csvProcessor.sampleCSV(testCSVPath, 1);
    expect(result.success).toBe(true);
    expect(result.samples).toHaveLength(1);
  });
  test('should get CSV info', async () => {
    const result = await csvProcessor.getCSVInfo(testCSVPath);
    expect(result.rowCount).toBe(2);
    expect(result.columnCount).toBe(4);
    expect(result.columns).toEqual(['id', 'name', 'email', 'age']);
  });
  test('should filter data', () => {
    const data = [{
      id: 1,
      status: 'active'
    }, {
      id: 2,
      status: 'inactive'
    }, {
      id: 3,
      status: 'active'
    }];
    const filtered = csvProcessor.filterData(data, row => row.status === 'active');
    expect(filtered).toHaveLength(2);
  });
});

/**
 * Test Suite for DatabaseMigration
 */
describe('DatabaseMigration', () => {
  let migration;
  let mockSourceDB;
  let mockTargetDB;
  beforeAll(() => {
    // Mock database connections
    mockSourceDB = {
      query: jest.fn()
    };
    mockTargetDB = {
      query: jest.fn()
    };
    migration = new DatabaseMigration(mockSourceDB, mockTargetDB, console);
  });
  test('should set batch size', () => {
    migration.setBatchSize(5000);
    expect(migration.batchSize).toBe(5000);
  });
  test('should migrate table successfully', async () => {
    mockSourceDB.query.mockResolvedValueOnce([{
      count: 2
    }]) // COUNT query
    .mockResolvedValueOnce([{
      id: 1,
      name: 'John'
    }, {
      id: 2,
      name: 'Jane'
    }]); // SELECT query

    mockTargetDB.query.mockResolvedValue(true); // INSERT query

    const result = await migration.migrateTable('users');
    expect(result.status).toBe('completed');
    expect(result.recordsMigrated).toBe(2);
  });
  test('should verify migration', async () => {
    mockSourceDB.query.mockResolvedValueOnce([{
      count: 100
    }]);
    mockTargetDB.query.mockResolvedValueOnce([{
      count: 100
    }]);
    const result = await migration.verifyMigration('users');
    expect(result.match).toBe(true);
    expect(result.sourceRecords).toBe(100);
    expect(result.targetRecords).toBe(100);
  });
  test('should handle discrepancies in verification', async () => {
    mockSourceDB.query.mockResolvedValueOnce([{
      count: 100
    }]);
    mockTargetDB.query.mockResolvedValueOnce([{
      count: 95
    }]);
    const result = await migration.verifyMigration('users');
    expect(result.match).toBe(false);
    expect(result.discrepancy).toBe(5);
  });
  test('should get migration summary', () => {
    migration.migrationLog = [{
      table: 'users',
      status: 'completed',
      recordsMigrated: 100,
      duration: 1000
    }, {
      table: 'products',
      status: 'completed',
      recordsMigrated: 50,
      duration: 500
    }];
    const summary = migration.getMigrationSummary();
    expect(summary.completedTables).toBe(2);
    expect(summary.totalRecordsMigrated).toBe(150);
    expect(summary.totalDuration).toBe(1500);
  });
});

/**
 * Test Suite for MigrationManager
 */
describe('MigrationManager', () => {
  let manager;
  let mockSourceDB;
  let mockTargetDB;
  beforeAll(() => {
    mockSourceDB = {
      query: jest.fn()
    };
    mockTargetDB = {
      query: jest.fn()
    };
    manager = new MigrationManager({
      sourceDB: mockSourceDB,
      targetDB: mockTargetDB,
      logger: {
        info: jest.fn(),
        error: jest.fn(),
        warn: jest.fn()
      }
    });
  });
  test('should create migration plan', () => {
    const plan = manager.createMigrationPlan(['users', 'products'], {
      preValidation: true,
      postValidation: true
    });
    expect(plan.tables).toEqual(['users', 'products']);
    expect(plan.steps.length).toBeGreaterThan(0);
    expect(plan.steps.some(s => s.type === 'validation')).toBe(true);
  });
  test('should pause migration', () => {
    const result = manager.pauseMigration();
    expect(result.status).toBe('paused');
  });
  test('should resume migration', () => {
    const result = manager.resumeMigration();
    expect(result.status).toBe('resumed');
  });
  test('should clear execution log', () => {
    manager.executionLog = [{
      step: 'test'
    }];
    manager.clearLog();
    expect(manager.executionLog).toHaveLength(0);
  });
  test('should get execution summary', () => {
    manager.executionLog = [{
      step: 'step1',
      status: 'completed',
      duration: 1000
    }, {
      step: 'step2',
      status: 'completed',
      duration: 500
    }];
    const summary = manager.getExecutionSummary();
    expect(summary.summary.completedSteps).toBe(2);
    expect(summary.summary.overallStatus).toBe('success');
  });
  test('should generate migration steps correctly', () => {
    const tables = ['users', 'products'];
    const options = {
      preValidation: true,
      postValidation: true,
      postCleanup: true
    };
    const steps = manager.generateMigrationSteps(tables, options);
    expect(steps[0].type).toBe('validation'); // pre-validation
    expect(steps[1].type).toBe('backup');
    expect(steps.some(s => s.table === 'users')).toBe(true);
    expect(steps[steps.length - 1].type).toBe('cleanup'); // post-cleanup
  });
});

/**
 * Integration Tests
 */
describe('Migration System Integration', () => {
  test('should complete full migration workflow', async () => {
    const mockSourceDB = {
      query: jest.fn().mockResolvedValueOnce([{
        count: 10
      }]) // COUNT
      .mockResolvedValueOnce(Array.from({
        length: 10
      }, (_, i) => ({
        id: i + 1,
        name: `User ${i + 1}`
      }))) // SELECT
    };
    const mockTargetDB = {
      query: jest.fn().mockResolvedValue(true)
    };
    const manager = new MigrationManager({
      sourceDB: mockSourceDB,
      targetDB: mockTargetDB,
      logger: console
    });

    // Create plan
    const plan = manager.createMigrationPlan(['users']);
    expect(plan.tables).toEqual(['users']);

    // Verify steps were created
    expect(plan.steps.length).toBeGreaterThan(0);
  });
  test('should handle CSV import and database migration', async () => {
    const csvProcessor = new CSVProcessor();

    // Simulate CSV import and transformation
    const data = [{
      id: '1',
      email: 'JOHN@EXAMPLE.COM',
      status: '1'
    }, {
      id: '2',
      email: 'JANE@EXAMPLE.COM',
      status: '0'
    }];
    const transformed = csvProcessor.transformData(data, {
      id: {
        type: 'integer'
      },
      email: val => val.toLowerCase(),
      status: {
        mapping: {
          '1': 'active',
          '0': 'inactive'
        }
      }
    });
    expect(transformed[0].email).toBe('john@example.com');
    expect(transformed[0].status).toBe('active');
    expect(typeof transformed[0].id).toBe('number');
  });
});

/**
 * Error Handling Tests
 */
describe('Migration Error Handling', () => {
  test('should handle empty CSV', async () => {
    const csvProcessor = new CSVProcessor();
    const emptyPath = './empty-test.csv';
    fs.writeFileSync(emptyPath, '');
    try {
      const result = await csvProcessor.getCSVInfo(emptyPath);
      expect(result.rowCount).toBe(0);
    } finally {
      fs.unlinkSync(emptyPath);
    }
  });
  test('should handle invalid CSV path', async () => {
    const csvProcessor = new CSVProcessor();
    await expect(csvProcessor.getCSVInfo('./non-existent-file.csv')).rejects.toThrow();
  });
  test('should handle database errors gracefully', async () => {
    const mockSourceDB = {
      query: jest.fn().mockRejectedValue(new Error('Database error'))
    };
    const mockTargetDB = {
      query: jest.fn()
    };
    const migration = new DatabaseMigration(mockSourceDB, mockTargetDB);
    await expect(migration.migrateTable('users')).rejects.toThrow('Database error');
  });
});

/**
 * Performance Tests
 */
describe('Migration Performance', () => {
  test('should handle large batch sizes efficiently', async () => {
    const csvProcessor = new CSVProcessor({
      maxRowsPerChunk: 10000
    });

    // Create large test data
    const largeData = Array.from({
      length: 50000
    }, (_, i) => ({
      id: i + 1,
      name: `User ${i + 1}`,
      email: `user${i + 1}@example.com`
    }));
    const startTime = Date.now();
    // Transform would be applied here
    const transformed = csvProcessor.transformData(largeData, {
      email: val => val.toLowerCase()
    });
    const duration = Date.now() - startTime;
    expect(transformed).toHaveLength(50000);
    expect(duration).toBeLessThan(1000); // Should complete in less than 1 second
  });
  test('should report accurate timing information', () => {
    const manager = new MigrationManager({
      sourceDB: {},
      targetDB: {}
    });
    manager.executionLog = [{
      step: 'migration',
      status: 'completed',
      duration: 5000
    }];
    const summary = manager.getExecutionSummary();
    expect(summary.stats.totalDuration).toBe(5000);
  });
});
module.exports = {
  // Export test utilities if needed
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDU1ZQcm9jZXNzb3IiLCJyZXF1aXJlIiwiRGF0YWJhc2VNaWdyYXRpb24iLCJNaWdyYXRpb25NYW5hZ2VyIiwiZnMiLCJkZXNjcmliZSIsImNzdlByb2Nlc3NvciIsInRlc3RDU1ZQYXRoIiwiYmVmb3JlQWxsIiwiZGVsaW1pdGVyIiwiZW5jb2RpbmciLCJtYXhSb3dzUGVyQ2h1bmsiLCJ0ZXN0RGF0YSIsIndyaXRlRmlsZVN5bmMiLCJhZnRlckFsbCIsImV4aXN0c1N5bmMiLCJ1bmxpbmtTeW5jIiwidGVzdCIsInJlc3VsdCIsImltcG9ydENTViIsImNvbHVtbnMiLCJleHBlY3QiLCJzdWNjZXNzIiwidG9CZSIsInJlY29yZENvdW50IiwiZGF0YSIsInRvSGF2ZUxlbmd0aCIsImlkIiwibmFtZSIsImVtYWlsIiwiZXhwb3J0UGF0aCIsImV4cG9ydFRvQ1NWIiwic3RhdHVzIiwidHJhbnNmb3JtUnVsZXMiLCJ2YWwiLCJ0b0xvd2VyQ2FzZSIsIm1hcHBpbmciLCJ0cmFuc2Zvcm1lZCIsInRyYW5zZm9ybURhdGEiLCJ2YWxpZGF0ZUNTVlN0cnVjdHVyZSIsInZhbGlkIiwidG9Db250YWluIiwic2FtcGxlQ1NWIiwic2FtcGxlcyIsImdldENTVkluZm8iLCJyb3dDb3VudCIsImNvbHVtbkNvdW50IiwidG9FcXVhbCIsImZpbHRlcmVkIiwiZmlsdGVyRGF0YSIsInJvdyIsIm1pZ3JhdGlvbiIsIm1vY2tTb3VyY2VEQiIsIm1vY2tUYXJnZXREQiIsInF1ZXJ5IiwiamVzdCIsImZuIiwiY29uc29sZSIsInNldEJhdGNoU2l6ZSIsImJhdGNoU2l6ZSIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsImNvdW50IiwibW9ja1Jlc29sdmVkVmFsdWUiLCJtaWdyYXRlVGFibGUiLCJyZWNvcmRzTWlncmF0ZWQiLCJ2ZXJpZnlNaWdyYXRpb24iLCJtYXRjaCIsInNvdXJjZVJlY29yZHMiLCJ0YXJnZXRSZWNvcmRzIiwiZGlzY3JlcGFuY3kiLCJtaWdyYXRpb25Mb2ciLCJ0YWJsZSIsImR1cmF0aW9uIiwic3VtbWFyeSIsImdldE1pZ3JhdGlvblN1bW1hcnkiLCJjb21wbGV0ZWRUYWJsZXMiLCJ0b3RhbFJlY29yZHNNaWdyYXRlZCIsInRvdGFsRHVyYXRpb24iLCJtYW5hZ2VyIiwic291cmNlREIiLCJ0YXJnZXREQiIsImxvZ2dlciIsImluZm8iLCJlcnJvciIsIndhcm4iLCJwbGFuIiwiY3JlYXRlTWlncmF0aW9uUGxhbiIsInByZVZhbGlkYXRpb24iLCJwb3N0VmFsaWRhdGlvbiIsInRhYmxlcyIsInN0ZXBzIiwibGVuZ3RoIiwidG9CZUdyZWF0ZXJUaGFuIiwic29tZSIsInMiLCJ0eXBlIiwicGF1c2VNaWdyYXRpb24iLCJyZXN1bWVNaWdyYXRpb24iLCJleGVjdXRpb25Mb2ciLCJzdGVwIiwiY2xlYXJMb2ciLCJnZXRFeGVjdXRpb25TdW1tYXJ5IiwiY29tcGxldGVkU3RlcHMiLCJvdmVyYWxsU3RhdHVzIiwib3B0aW9ucyIsInBvc3RDbGVhbnVwIiwiZ2VuZXJhdGVNaWdyYXRpb25TdGVwcyIsIkFycmF5IiwiZnJvbSIsIl8iLCJpIiwiZW1wdHlQYXRoIiwicmVqZWN0cyIsInRvVGhyb3ciLCJtb2NrUmVqZWN0ZWRWYWx1ZSIsIkVycm9yIiwibGFyZ2VEYXRhIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInRvQmVMZXNzVGhhbiIsInN0YXRzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIm1pZ3JhdGlvbi50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBNaWdyYXRpb24gU3lzdGVtIFRlc3RzXHJcbiAqIENvbXByZWhlbnNpdmUgdGVzdCBzdWl0ZSBmb3IgbWlncmF0aW9uIHV0aWxpdGllc1xyXG4gKi9cclxuXHJcbmNvbnN0IENTVlByb2Nlc3NvciA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL21pZ3JhdGlvbi9DU1ZQcm9jZXNzb3InKTtcclxuY29uc3QgRGF0YWJhc2VNaWdyYXRpb24gPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9taWdyYXRpb24vRGF0YWJhc2VNaWdyYXRpb24nKTtcclxuY29uc3QgTWlncmF0aW9uTWFuYWdlciA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL21pZ3JhdGlvbi9NaWdyYXRpb25NYW5hZ2VyJyk7XHJcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcclxuXHJcbi8qKlxyXG4gKiBUZXN0IFN1aXRlIGZvciBDU1ZQcm9jZXNzb3JcclxuICovXHJcbmRlc2NyaWJlKCdDU1ZQcm9jZXNzb3InLCAoKSA9PiB7XHJcbiAgbGV0IGNzdlByb2Nlc3NvcjtcclxuICBjb25zdCB0ZXN0Q1NWUGF0aCA9ICcuL3Rlc3QtZGF0YS5jc3YnO1xyXG5cclxuICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgY3N2UHJvY2Vzc29yID0gbmV3IENTVlByb2Nlc3Nvcih7XHJcbiAgICAgIGRlbGltaXRlcjogJywnLFxyXG4gICAgICBlbmNvZGluZzogJ3V0Zi04JyxcclxuICAgICAgbWF4Um93c1BlckNodW5rOiAxMCxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0ZXN0IENTVlxyXG4gICAgY29uc3QgdGVzdERhdGEgPSAnaWQsbmFtZSxlbWFpbCxhZ2VcXG4xLEpvaG4sam9obkBleGFtcGxlLmNvbSwzMFxcbjIsSmFuZSxqYW5lQGV4YW1wbGUuY29tLDI1XFxuJztcclxuICAgIGZzLndyaXRlRmlsZVN5bmModGVzdENTVlBhdGgsIHRlc3REYXRhKTtcclxuICB9KTtcclxuXHJcbiAgYWZ0ZXJBbGwoKCkgPT4ge1xyXG4gICAgaWYgKGZzLmV4aXN0c1N5bmModGVzdENTVlBhdGgpKSB7XHJcbiAgICAgIGZzLnVubGlua1N5bmModGVzdENTVlBhdGgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgaW1wb3J0IENTViBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjc3ZQcm9jZXNzb3IuaW1wb3J0Q1NWKHRlc3RDU1ZQYXRoLCB7IGNvbHVtbnM6IHRydWUgfSk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5yZWNvcmRDb3VudCkudG9CZSgyKTtcclxuICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9IYXZlTGVuZ3RoKDIpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgZXhwb3J0IENTViBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBkYXRhID0gW1xyXG4gICAgICB7IGlkOiAxLCBuYW1lOiAnSm9obicsIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScgfSxcclxuICAgICAgeyBpZDogMiwgbmFtZTogJ0phbmUnLCBlbWFpbDogJ2phbmVAZXhhbXBsZS5jb20nIH0sXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGV4cG9ydFBhdGggPSAnLi90ZXN0LWV4cG9ydC5jc3YnO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLmV4cG9ydFRvQ1NWKGRhdGEsIGV4cG9ydFBhdGgpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXN1bHQucmVjb3JkQ291bnQpLnRvQmUoMik7XHJcbiAgICBleHBlY3QoZnMuZXhpc3RzU3luYyhleHBvcnRQYXRoKSkudG9CZSh0cnVlKTtcclxuXHJcbiAgICAvLyBDbGVhbnVwXHJcbiAgICBmcy51bmxpbmtTeW5jKGV4cG9ydFBhdGgpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgdHJhbnNmb3JtIGRhdGEnLCAoKSA9PiB7XHJcbiAgICBjb25zdCBkYXRhID0gW1xyXG4gICAgICB7IGVtYWlsOiAnSk9ITkBFWEFNUExFLkNPTScsIHN0YXR1czogJzEnIH0sXHJcbiAgICAgIHsgZW1haWw6ICdKQU5FQEVYQU1QTEUuQ09NJywgc3RhdHVzOiAnMCcgfSxcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgdHJhbnNmb3JtUnVsZXMgPSB7XHJcbiAgICAgIGVtYWlsOiAodmFsKSA9PiB2YWwudG9Mb3dlckNhc2UoKSxcclxuICAgICAgc3RhdHVzOiB7IG1hcHBpbmc6IHsgJzEnOiAnYWN0aXZlJywgJzAnOiAnaW5hY3RpdmUnIH0gfSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgdHJhbnNmb3JtZWQgPSBjc3ZQcm9jZXNzb3IudHJhbnNmb3JtRGF0YShkYXRhLCB0cmFuc2Zvcm1SdWxlcyk7XHJcblxyXG4gICAgZXhwZWN0KHRyYW5zZm9ybWVkWzBdLmVtYWlsKS50b0JlKCdqb2huQGV4YW1wbGUuY29tJyk7XHJcbiAgICBleHBlY3QodHJhbnNmb3JtZWRbMF0uc3RhdHVzKS50b0JlKCdhY3RpdmUnKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIENTViBzdHJ1Y3R1cmUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjc3ZQcm9jZXNzb3IudmFsaWRhdGVDU1ZTdHJ1Y3R1cmUodGVzdENTVlBhdGgsIFsnaWQnLCAnbmFtZScsICdlbWFpbCddKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0LnZhbGlkKS50b0JlKHRydWUpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5jb2x1bW5zKS50b0NvbnRhaW4oJ2lkJyk7XHJcbiAgICBleHBlY3QocmVzdWx0LmNvbHVtbnMpLnRvQ29udGFpbignbmFtZScpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgc2FtcGxlIENTVicsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNzdlByb2Nlc3Nvci5zYW1wbGVDU1YodGVzdENTVlBhdGgsIDEpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXN1bHQuc2FtcGxlcykudG9IYXZlTGVuZ3RoKDEpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgZ2V0IENTViBpbmZvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLmdldENTVkluZm8odGVzdENTVlBhdGgpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQucm93Q291bnQpLnRvQmUoMik7XHJcbiAgICBleHBlY3QocmVzdWx0LmNvbHVtbkNvdW50KS50b0JlKDQpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5jb2x1bW5zKS50b0VxdWFsKFsnaWQnLCAnbmFtZScsICdlbWFpbCcsICdhZ2UnXSk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBmaWx0ZXIgZGF0YScsICgpID0+IHtcclxuICAgIGNvbnN0IGRhdGEgPSBbXHJcbiAgICAgIHsgaWQ6IDEsIHN0YXR1czogJ2FjdGl2ZScgfSxcclxuICAgICAgeyBpZDogMiwgc3RhdHVzOiAnaW5hY3RpdmUnIH0sXHJcbiAgICAgIHsgaWQ6IDMsIHN0YXR1czogJ2FjdGl2ZScgfSxcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZmlsdGVyZWQgPSBjc3ZQcm9jZXNzb3IuZmlsdGVyRGF0YShkYXRhLCAocm93KSA9PiByb3cuc3RhdHVzID09PSAnYWN0aXZlJyk7XHJcblxyXG4gICAgZXhwZWN0KGZpbHRlcmVkKS50b0hhdmVMZW5ndGgoMik7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFRlc3QgU3VpdGUgZm9yIERhdGFiYXNlTWlncmF0aW9uXHJcbiAqL1xyXG5kZXNjcmliZSgnRGF0YWJhc2VNaWdyYXRpb24nLCAoKSA9PiB7XHJcbiAgbGV0IG1pZ3JhdGlvbjtcclxuICBsZXQgbW9ja1NvdXJjZURCO1xyXG4gIGxldCBtb2NrVGFyZ2V0REI7XHJcblxyXG4gIGJlZm9yZUFsbCgoKSA9PiB7XHJcbiAgICAvLyBNb2NrIGRhdGFiYXNlIGNvbm5lY3Rpb25zXHJcbiAgICBtb2NrU291cmNlREIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCksXHJcbiAgICB9O1xyXG5cclxuICAgIG1vY2tUYXJnZXREQiA9IHtcclxuICAgICAgcXVlcnk6IGplc3QuZm4oKSxcclxuICAgIH07XHJcblxyXG4gICAgbWlncmF0aW9uID0gbmV3IERhdGFiYXNlTWlncmF0aW9uKG1vY2tTb3VyY2VEQiwgbW9ja1RhcmdldERCLCBjb25zb2xlKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIHNldCBiYXRjaCBzaXplJywgKCkgPT4ge1xyXG4gICAgbWlncmF0aW9uLnNldEJhdGNoU2l6ZSg1MDAwKTtcclxuICAgIGV4cGVjdChtaWdyYXRpb24uYmF0Y2hTaXplKS50b0JlKDUwMDApO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgbWlncmF0ZSB0YWJsZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBtb2NrU291cmNlREIucXVlcnlcclxuICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBjb3VudDogMiB9XSkgLy8gQ09VTlQgcXVlcnlcclxuICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbXHJcbiAgICAgICAgeyBpZDogMSwgbmFtZTogJ0pvaG4nIH0sXHJcbiAgICAgICAgeyBpZDogMiwgbmFtZTogJ0phbmUnIH0sXHJcbiAgICAgIF0pOyAvLyBTRUxFQ1QgcXVlcnlcclxuXHJcbiAgICBtb2NrVGFyZ2V0REIucXVlcnkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7IC8vIElOU0VSVCBxdWVyeVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbi5taWdyYXRlVGFibGUoJ3VzZXJzJyk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ2NvbXBsZXRlZCcpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5yZWNvcmRzTWlncmF0ZWQpLnRvQmUoMik7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCB2ZXJpZnkgbWlncmF0aW9uJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgbW9ja1NvdXJjZURCLnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBjb3VudDogMTAwIH1dKTtcclxuICAgIG1vY2tUYXJnZXREQi5xdWVyeS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW3sgY291bnQ6IDEwMCB9XSk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbWlncmF0aW9uLnZlcmlmeU1pZ3JhdGlvbigndXNlcnMnKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0Lm1hdGNoKS50b0JlKHRydWUpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5zb3VyY2VSZWNvcmRzKS50b0JlKDEwMCk7XHJcbiAgICBleHBlY3QocmVzdWx0LnRhcmdldFJlY29yZHMpLnRvQmUoMTAwKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBkaXNjcmVwYW5jaWVzIGluIHZlcmlmaWNhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgIG1vY2tTb3VyY2VEQi5xdWVyeS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW3sgY291bnQ6IDEwMCB9XSk7XHJcbiAgICBtb2NrVGFyZ2V0REIucXVlcnkubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGNvdW50OiA5NSB9XSk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbWlncmF0aW9uLnZlcmlmeU1pZ3JhdGlvbigndXNlcnMnKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0Lm1hdGNoKS50b0JlKGZhbHNlKTtcclxuICAgIGV4cGVjdChyZXN1bHQuZGlzY3JlcGFuY3kpLnRvQmUoNSk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBnZXQgbWlncmF0aW9uIHN1bW1hcnknLCAoKSA9PiB7XHJcbiAgICBtaWdyYXRpb24ubWlncmF0aW9uTG9nID0gW1xyXG4gICAgICB7XHJcbiAgICAgICAgdGFibGU6ICd1c2VycycsXHJcbiAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyxcclxuICAgICAgICByZWNvcmRzTWlncmF0ZWQ6IDEwMCxcclxuICAgICAgICBkdXJhdGlvbjogMTAwMCxcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIHRhYmxlOiAncHJvZHVjdHMnLFxyXG4gICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXHJcbiAgICAgICAgcmVjb3Jkc01pZ3JhdGVkOiA1MCxcclxuICAgICAgICBkdXJhdGlvbjogNTAwLFxyXG4gICAgICB9LFxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gbWlncmF0aW9uLmdldE1pZ3JhdGlvblN1bW1hcnkoKTtcclxuXHJcbiAgICBleHBlY3Qoc3VtbWFyeS5jb21wbGV0ZWRUYWJsZXMpLnRvQmUoMik7XHJcbiAgICBleHBlY3Qoc3VtbWFyeS50b3RhbFJlY29yZHNNaWdyYXRlZCkudG9CZSgxNTApO1xyXG4gICAgZXhwZWN0KHN1bW1hcnkudG90YWxEdXJhdGlvbikudG9CZSgxNTAwKTtcclxuICB9KTtcclxufSk7XHJcblxyXG4vKipcclxuICogVGVzdCBTdWl0ZSBmb3IgTWlncmF0aW9uTWFuYWdlclxyXG4gKi9cclxuZGVzY3JpYmUoJ01pZ3JhdGlvbk1hbmFnZXInLCAoKSA9PiB7XHJcbiAgbGV0IG1hbmFnZXI7XHJcbiAgbGV0IG1vY2tTb3VyY2VEQjtcclxuICBsZXQgbW9ja1RhcmdldERCO1xyXG5cclxuICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgbW9ja1NvdXJjZURCID0ge1xyXG4gICAgICBxdWVyeTogamVzdC5mbigpLFxyXG4gICAgfTtcclxuXHJcbiAgICBtb2NrVGFyZ2V0REIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCksXHJcbiAgICB9O1xyXG5cclxuICAgIG1hbmFnZXIgPSBuZXcgTWlncmF0aW9uTWFuYWdlcih7XHJcbiAgICAgIHNvdXJjZURCOiBtb2NrU291cmNlREIsXHJcbiAgICAgIHRhcmdldERCOiBtb2NrVGFyZ2V0REIsXHJcbiAgICAgIGxvZ2dlcjogeyBpbmZvOiBqZXN0LmZuKCksIGVycm9yOiBqZXN0LmZuKCksIHdhcm46IGplc3QuZm4oKSB9LFxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBjcmVhdGUgbWlncmF0aW9uIHBsYW4nLCAoKSA9PiB7XHJcbiAgICBjb25zdCBwbGFuID0gbWFuYWdlci5jcmVhdGVNaWdyYXRpb25QbGFuKFsndXNlcnMnLCAncHJvZHVjdHMnXSwge1xyXG4gICAgICBwcmVWYWxpZGF0aW9uOiB0cnVlLFxyXG4gICAgICBwb3N0VmFsaWRhdGlvbjogdHJ1ZSxcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdChwbGFuLnRhYmxlcykudG9FcXVhbChbJ3VzZXJzJywgJ3Byb2R1Y3RzJ10pO1xyXG4gICAgZXhwZWN0KHBsYW4uc3RlcHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICBleHBlY3QocGxhbi5zdGVwcy5zb21lKChzKSA9PiBzLnR5cGUgPT09ICd2YWxpZGF0aW9uJykpLnRvQmUodHJ1ZSk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBwYXVzZSBtaWdyYXRpb24nLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBtYW5hZ2VyLnBhdXNlTWlncmF0aW9uKCk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ3BhdXNlZCcpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgcmVzdW1lIG1pZ3JhdGlvbicsICgpID0+IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IG1hbmFnZXIucmVzdW1lTWlncmF0aW9uKCk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ3Jlc3VtZWQnKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGNsZWFyIGV4ZWN1dGlvbiBsb2cnLCAoKSA9PiB7XHJcbiAgICBtYW5hZ2VyLmV4ZWN1dGlvbkxvZyA9IFt7IHN0ZXA6ICd0ZXN0JyB9XTtcclxuICAgIG1hbmFnZXIuY2xlYXJMb2coKTtcclxuXHJcbiAgICBleHBlY3QobWFuYWdlci5leGVjdXRpb25Mb2cpLnRvSGF2ZUxlbmd0aCgwKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGdldCBleGVjdXRpb24gc3VtbWFyeScsICgpID0+IHtcclxuICAgIG1hbmFnZXIuZXhlY3V0aW9uTG9nID0gW1xyXG4gICAgICB7IHN0ZXA6ICdzdGVwMScsIHN0YXR1czogJ2NvbXBsZXRlZCcsIGR1cmF0aW9uOiAxMDAwIH0sXHJcbiAgICAgIHsgc3RlcDogJ3N0ZXAyJywgc3RhdHVzOiAnY29tcGxldGVkJywgZHVyYXRpb246IDUwMCB9LFxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gbWFuYWdlci5nZXRFeGVjdXRpb25TdW1tYXJ5KCk7XHJcblxyXG4gICAgZXhwZWN0KHN1bW1hcnkuc3VtbWFyeS5jb21wbGV0ZWRTdGVwcykudG9CZSgyKTtcclxuICAgIGV4cGVjdChzdW1tYXJ5LnN1bW1hcnkub3ZlcmFsbFN0YXR1cykudG9CZSgnc3VjY2VzcycpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgZ2VuZXJhdGUgbWlncmF0aW9uIHN0ZXBzIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgIGNvbnN0IHRhYmxlcyA9IFsndXNlcnMnLCAncHJvZHVjdHMnXTtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIHByZVZhbGlkYXRpb246IHRydWUsXHJcbiAgICAgIHBvc3RWYWxpZGF0aW9uOiB0cnVlLFxyXG4gICAgICBwb3N0Q2xlYW51cDogdHJ1ZSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3Qgc3RlcHMgPSBtYW5hZ2VyLmdlbmVyYXRlTWlncmF0aW9uU3RlcHModGFibGVzLCBvcHRpb25zKTtcclxuXHJcbiAgICBleHBlY3Qoc3RlcHNbMF0udHlwZSkudG9CZSgndmFsaWRhdGlvbicpOyAvLyBwcmUtdmFsaWRhdGlvblxyXG4gICAgZXhwZWN0KHN0ZXBzWzFdLnR5cGUpLnRvQmUoJ2JhY2t1cCcpO1xyXG4gICAgZXhwZWN0KHN0ZXBzLnNvbWUoKHMpID0+IHMudGFibGUgPT09ICd1c2VycycpKS50b0JlKHRydWUpO1xyXG4gICAgZXhwZWN0KHN0ZXBzW3N0ZXBzLmxlbmd0aCAtIDFdLnR5cGUpLnRvQmUoJ2NsZWFudXAnKTsgLy8gcG9zdC1jbGVhbnVwXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEludGVncmF0aW9uIFRlc3RzXHJcbiAqL1xyXG5kZXNjcmliZSgnTWlncmF0aW9uIFN5c3RlbSBJbnRlZ3JhdGlvbicsICgpID0+IHtcclxuICB0ZXN0KCdzaG91bGQgY29tcGxldGUgZnVsbCBtaWdyYXRpb24gd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBtb2NrU291cmNlREIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKClcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGNvdW50OiAxMCB9XSkgLy8gQ09VTlRcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFxyXG4gICAgICAgICAgQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAgfSwgKF8sIGkpID0+ICh7XHJcbiAgICAgICAgICAgIGlkOiBpICsgMSxcclxuICAgICAgICAgICAgbmFtZTogYFVzZXIgJHtpICsgMX1gLFxyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgKSwgLy8gU0VMRUNUXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1vY2tUYXJnZXREQiA9IHtcclxuICAgICAgcXVlcnk6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbWFuYWdlciA9IG5ldyBNaWdyYXRpb25NYW5hZ2VyKHtcclxuICAgICAgc291cmNlREI6IG1vY2tTb3VyY2VEQixcclxuICAgICAgdGFyZ2V0REI6IG1vY2tUYXJnZXREQixcclxuICAgICAgbG9nZ2VyOiBjb25zb2xlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHBsYW5cclxuICAgIGNvbnN0IHBsYW4gPSBtYW5hZ2VyLmNyZWF0ZU1pZ3JhdGlvblBsYW4oWyd1c2VycyddKTtcclxuICAgIGV4cGVjdChwbGFuLnRhYmxlcykudG9FcXVhbChbJ3VzZXJzJ10pO1xyXG5cclxuICAgIC8vIFZlcmlmeSBzdGVwcyB3ZXJlIGNyZWF0ZWRcclxuICAgIGV4cGVjdChwbGFuLnN0ZXBzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgaGFuZGxlIENTViBpbXBvcnQgYW5kIGRhdGFiYXNlIG1pZ3JhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNzdlByb2Nlc3NvciA9IG5ldyBDU1ZQcm9jZXNzb3IoKTtcclxuXHJcbiAgICAvLyBTaW11bGF0ZSBDU1YgaW1wb3J0IGFuZCB0cmFuc2Zvcm1hdGlvblxyXG4gICAgY29uc3QgZGF0YSA9IFtcclxuICAgICAgeyBpZDogJzEnLCBlbWFpbDogJ0pPSE5ARVhBTVBMRS5DT00nLCBzdGF0dXM6ICcxJyB9LFxyXG4gICAgICB7IGlkOiAnMicsIGVtYWlsOiAnSkFORUBFWEFNUExFLkNPTScsIHN0YXR1czogJzAnIH0sXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gY3N2UHJvY2Vzc29yLnRyYW5zZm9ybURhdGEoZGF0YSwge1xyXG4gICAgICBpZDogeyB0eXBlOiAnaW50ZWdlcicgfSxcclxuICAgICAgZW1haWw6ICh2YWwpID0+IHZhbC50b0xvd2VyQ2FzZSgpLFxyXG4gICAgICBzdGF0dXM6IHsgbWFwcGluZzogeyAnMSc6ICdhY3RpdmUnLCAnMCc6ICdpbmFjdGl2ZScgfSB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgZXhwZWN0KHRyYW5zZm9ybWVkWzBdLmVtYWlsKS50b0JlKCdqb2huQGV4YW1wbGUuY29tJyk7XHJcbiAgICBleHBlY3QodHJhbnNmb3JtZWRbMF0uc3RhdHVzKS50b0JlKCdhY3RpdmUnKTtcclxuICAgIGV4cGVjdCh0eXBlb2YgdHJhbnNmb3JtZWRbMF0uaWQpLnRvQmUoJ251bWJlcicpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBFcnJvciBIYW5kbGluZyBUZXN0c1xyXG4gKi9cclxuZGVzY3JpYmUoJ01pZ3JhdGlvbiBFcnJvciBIYW5kbGluZycsICgpID0+IHtcclxuICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVtcHR5IENTVicsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNzdlByb2Nlc3NvciA9IG5ldyBDU1ZQcm9jZXNzb3IoKTtcclxuICAgIGNvbnN0IGVtcHR5UGF0aCA9ICcuL2VtcHR5LXRlc3QuY3N2JztcclxuICAgIGZzLndyaXRlRmlsZVN5bmMoZW1wdHlQYXRoLCAnJyk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLmdldENTVkluZm8oZW1wdHlQYXRoKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5yb3dDb3VudCkudG9CZSgwKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIGZzLnVubGlua1N5bmMoZW1wdHlQYXRoKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIENTViBwYXRoJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgY3N2UHJvY2Vzc29yID0gbmV3IENTVlByb2Nlc3NvcigpO1xyXG5cclxuICAgIGF3YWl0IGV4cGVjdChjc3ZQcm9jZXNzb3IuZ2V0Q1NWSW5mbygnLi9ub24tZXhpc3RlbnQtZmlsZS5jc3YnKSkucmVqZWN0cy50b1Rocm93KCk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBtb2NrU291cmNlREIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpKSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbW9ja1RhcmdldERCID0ge1xyXG4gICAgICBxdWVyeTogamVzdC5mbigpLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtaWdyYXRpb24gPSBuZXcgRGF0YWJhc2VNaWdyYXRpb24obW9ja1NvdXJjZURCLCBtb2NrVGFyZ2V0REIpO1xyXG5cclxuICAgIGF3YWl0IGV4cGVjdChtaWdyYXRpb24ubWlncmF0ZVRhYmxlKCd1c2VycycpKS5yZWplY3RzLnRvVGhyb3coJ0RhdGFiYXNlIGVycm9yJyk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFBlcmZvcm1hbmNlIFRlc3RzXHJcbiAqL1xyXG5kZXNjcmliZSgnTWlncmF0aW9uIFBlcmZvcm1hbmNlJywgKCkgPT4ge1xyXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbGFyZ2UgYmF0Y2ggc2l6ZXMgZWZmaWNpZW50bHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBjc3ZQcm9jZXNzb3IgPSBuZXcgQ1NWUHJvY2Vzc29yKHtcclxuICAgICAgbWF4Um93c1BlckNodW5rOiAxMDAwMCxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENyZWF0ZSBsYXJnZSB0ZXN0IGRhdGFcclxuICAgIGNvbnN0IGxhcmdlRGF0YSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDUwMDAwIH0sIChfLCBpKSA9PiAoe1xyXG4gICAgICBpZDogaSArIDEsXHJcbiAgICAgIG5hbWU6IGBVc2VyICR7aSArIDF9YCxcclxuICAgICAgZW1haWw6IGB1c2VyJHtpICsgMX1AZXhhbXBsZS5jb21gLFxyXG4gICAgfSkpO1xyXG5cclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAvLyBUcmFuc2Zvcm0gd291bGQgYmUgYXBwbGllZCBoZXJlXHJcbiAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IGNzdlByb2Nlc3Nvci50cmFuc2Zvcm1EYXRhKGxhcmdlRGF0YSwge1xyXG4gICAgICBlbWFpbDogKHZhbCkgPT4gdmFsLnRvTG93ZXJDYXNlKCksXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcclxuXHJcbiAgICBleHBlY3QodHJhbnNmb3JtZWQpLnRvSGF2ZUxlbmd0aCg1MDAwMCk7XHJcbiAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigxMDAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIGluIGxlc3MgdGhhbiAxIHNlY29uZFxyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgcmVwb3J0IGFjY3VyYXRlIHRpbWluZyBpbmZvcm1hdGlvbicsICgpID0+IHtcclxuICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgTWlncmF0aW9uTWFuYWdlcih7XHJcbiAgICAgIHNvdXJjZURCOiB7fSxcclxuICAgICAgdGFyZ2V0REI6IHt9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgbWFuYWdlci5leGVjdXRpb25Mb2cgPSBbXHJcbiAgICAgIHsgc3RlcDogJ21pZ3JhdGlvbicsIHN0YXR1czogJ2NvbXBsZXRlZCcsIGR1cmF0aW9uOiA1MDAwIH0sXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IHN1bW1hcnkgPSBtYW5hZ2VyLmdldEV4ZWN1dGlvblN1bW1hcnkoKTtcclxuICAgIGV4cGVjdChzdW1tYXJ5LnN0YXRzLnRvdGFsRHVyYXRpb24pLnRvQmUoNTAwMCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgLy8gRXhwb3J0IHRlc3QgdXRpbGl0aWVzIGlmIG5lZWRlZFxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLFlBQVksR0FBR0MsT0FBTyxDQUFDLG9DQUFvQyxDQUFDO0FBQ2xFLE1BQU1DLGlCQUFpQixHQUFHRCxPQUFPLENBQUMseUNBQXlDLENBQUM7QUFDNUUsTUFBTUUsZ0JBQWdCLEdBQUdGLE9BQU8sQ0FBQyx3Q0FB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