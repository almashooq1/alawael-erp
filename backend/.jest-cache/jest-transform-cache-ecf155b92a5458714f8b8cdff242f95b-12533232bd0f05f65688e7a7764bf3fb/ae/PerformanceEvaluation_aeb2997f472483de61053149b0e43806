9e542dadb020feae53aa658cfe479051
/**
 * Performance Evaluation Model (HR)
 * Modular, extensible performance evaluation for HR system
 */
const mongoose = require('mongoose');
const IndividualEvaluationSchema = new mongoose.Schema({
  evaluatedBy: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
    required: true
  },
  evaluationType: {
    type: String,
    enum: ['management', 'peer', 'recipient', 'self'],
    required: true
  },
  score: Number,
  scores: [{
    criteriaId: String,
    criteriaName: String,
    score: {
      type: Number,
      min: 1,
      max: 5
    },
    comment: String
  }],
  comments: String,
  strengths: [String],
  areasForImprovement: [String],
  recommendations: String,
  createdAt: {
    type: Date,
    default: Date.now
  },
  updatedAt: {
    type: Date,
    default: Date.now
  }
});
const PerformanceEvaluationSchema = new mongoose.Schema({
  employeeId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Employee',
    required: true
  },
  evaluationPeriod: {
    startDate: {
      type: Date,
      required: true
    },
    endDate: {
      type: Date,
      required: true
    }
  },
  evaluations: {
    managementEvaluation: IndividualEvaluationSchema,
    peerEvaluations: [IndividualEvaluationSchema],
    recipientEvaluations: [IndividualEvaluationSchema],
    selfEvaluation: IndividualEvaluationSchema
  },
  summary: {
    weightedScores: {
      management: Number,
      peers: Number,
      recipients: Number,
      self: Number
    },
    overallScore: Number,
    overallRating: {
      type: String,
      enum: ['ممتاز', 'جيد جداً', 'جيد', 'مقبول', 'ضعيف']
    },
    executiveSummary: String,
    keyAchievements: [String],
    mainChallenges: [String],
    promotionRecommended: Boolean,
    trainingNeeds: [String],
    careerPathRecommendation: String,
    salaryAdjustmentRecommended: Boolean,
    salaryAdjustmentPercentage: Number
  },
  hrNotes: String,
  approvedBy: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User'
  },
  approvalDate: Date,
  status: {
    type: String,
    enum: ['draft', 'in_progress', 'pending_review', 'approved', 'archived'],
    default: 'draft'
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  updatedAt: {
    type: Date,
    default: Date.now
  },
  submittedAt: Date,
  reviewedAt: Date
});
PerformanceEvaluationSchema.index({
  employeeId: 1,
  'evaluationPeriod.startDate': -1
});
PerformanceEvaluationSchema.index({
  status: 1
});
PerformanceEvaluationSchema.index({
  'summary.overallRating': 1
});
module.exports = mongoose.model('PerformanceEvaluation', PerformanceEvaluationSchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJJbmRpdmlkdWFsRXZhbHVhdGlvblNjaGVtYSIsIlNjaGVtYSIsImV2YWx1YXRlZEJ5IiwidHlwZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJyZXF1aXJlZCIsImV2YWx1YXRpb25UeXBlIiwiU3RyaW5nIiwiZW51bSIsInNjb3JlIiwiTnVtYmVyIiwic2NvcmVzIiwiY3JpdGVyaWFJZCIsImNyaXRlcmlhTmFtZSIsIm1pbiIsIm1heCIsImNvbW1lbnQiLCJjb21tZW50cyIsInN0cmVuZ3RocyIsImFyZWFzRm9ySW1wcm92ZW1lbnQiLCJyZWNvbW1lbmRhdGlvbnMiLCJjcmVhdGVkQXQiLCJEYXRlIiwiZGVmYXVsdCIsIm5vdyIsInVwZGF0ZWRBdCIsIlBlcmZvcm1hbmNlRXZhbHVhdGlvblNjaGVtYSIsImVtcGxveWVlSWQiLCJldmFsdWF0aW9uUGVyaW9kIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImV2YWx1YXRpb25zIiwibWFuYWdlbWVudEV2YWx1YXRpb24iLCJwZWVyRXZhbHVhdGlvbnMiLCJyZWNpcGllbnRFdmFsdWF0aW9ucyIsInNlbGZFdmFsdWF0aW9uIiwic3VtbWFyeSIsIndlaWdodGVkU2NvcmVzIiwibWFuYWdlbWVudCIsInBlZXJzIiwicmVjaXBpZW50cyIsInNlbGYiLCJvdmVyYWxsU2NvcmUiLCJvdmVyYWxsUmF0aW5nIiwiZXhlY3V0aXZlU3VtbWFyeSIsImtleUFjaGlldmVtZW50cyIsIm1haW5DaGFsbGVuZ2VzIiwicHJvbW90aW9uUmVjb21tZW5kZWQiLCJCb29sZWFuIiwidHJhaW5pbmdOZWVkcyIsImNhcmVlclBhdGhSZWNvbW1lbmRhdGlvbiIsInNhbGFyeUFkanVzdG1lbnRSZWNvbW1lbmRlZCIsInNhbGFyeUFkanVzdG1lbnRQZXJjZW50YWdlIiwiaHJOb3RlcyIsImFwcHJvdmVkQnkiLCJhcHByb3ZhbERhdGUiLCJzdGF0dXMiLCJzdWJtaXR0ZWRBdCIsInJldmlld2VkQXQiLCJpbmRleCIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VzIjpbIlBlcmZvcm1hbmNlRXZhbHVhdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogUGVyZm9ybWFuY2UgRXZhbHVhdGlvbiBNb2RlbCAoSFIpXHJcbiAqIE1vZHVsYXIsIGV4dGVuc2libGUgcGVyZm9ybWFuY2UgZXZhbHVhdGlvbiBmb3IgSFIgc3lzdGVtXHJcbiAqL1xyXG5jb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcblxyXG5jb25zdCBJbmRpdmlkdWFsRXZhbHVhdGlvblNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xyXG4gIGV2YWx1YXRlZEJ5OiB7IHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwgcmVmOiAnVXNlcicsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgZXZhbHVhdGlvblR5cGU6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIGVudW06IFsnbWFuYWdlbWVudCcsICdwZWVyJywgJ3JlY2lwaWVudCcsICdzZWxmJ10sXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG4gIHNjb3JlOiBOdW1iZXIsXHJcbiAgc2NvcmVzOiBbXHJcbiAgICB7XHJcbiAgICAgIGNyaXRlcmlhSWQ6IFN0cmluZyxcclxuICAgICAgY3JpdGVyaWFOYW1lOiBTdHJpbmcsXHJcbiAgICAgIHNjb3JlOiB7IHR5cGU6IE51bWJlciwgbWluOiAxLCBtYXg6IDUgfSxcclxuICAgICAgY29tbWVudDogU3RyaW5nLFxyXG4gICAgfSxcclxuICBdLFxyXG4gIGNvbW1lbnRzOiBTdHJpbmcsXHJcbiAgc3RyZW5ndGhzOiBbU3RyaW5nXSxcclxuICBhcmVhc0ZvckltcHJvdmVtZW50OiBbU3RyaW5nXSxcclxuICByZWNvbW1lbmRhdGlvbnM6IFN0cmluZyxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxuICB1cGRhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxufSk7XHJcblxyXG5jb25zdCBQZXJmb3JtYW5jZUV2YWx1YXRpb25TY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBlbXBsb3llZUlkOiB7IHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwgcmVmOiAnRW1wbG95ZWUnLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIGV2YWx1YXRpb25QZXJpb2Q6IHtcclxuICAgIHN0YXJ0RGF0ZTogeyB0eXBlOiBEYXRlLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gICAgZW5kRGF0ZTogeyB0eXBlOiBEYXRlLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIH0sXHJcbiAgZXZhbHVhdGlvbnM6IHtcclxuICAgIG1hbmFnZW1lbnRFdmFsdWF0aW9uOiBJbmRpdmlkdWFsRXZhbHVhdGlvblNjaGVtYSxcclxuICAgIHBlZXJFdmFsdWF0aW9uczogW0luZGl2aWR1YWxFdmFsdWF0aW9uU2NoZW1hXSxcclxuICAgIHJlY2lwaWVudEV2YWx1YXRpb25zOiBbSW5kaXZpZHVhbEV2YWx1YXRpb25TY2hlbWFdLFxyXG4gICAgc2VsZkV2YWx1YXRpb246IEluZGl2aWR1YWxFdmFsdWF0aW9uU2NoZW1hLFxyXG4gIH0sXHJcbiAgc3VtbWFyeToge1xyXG4gICAgd2VpZ2h0ZWRTY29yZXM6IHtcclxuICAgICAgbWFuYWdlbWVudDogTnVtYmVyLFxyXG4gICAgICBwZWVyczogTnVtYmVyLFxyXG4gICAgICByZWNpcGllbnRzOiBOdW1iZXIsXHJcbiAgICAgIHNlbGY6IE51bWJlcixcclxuICAgIH0sXHJcbiAgICBvdmVyYWxsU2NvcmU6IE51bWJlcixcclxuICAgIG92ZXJhbGxSYXRpbmc6IHsgdHlwZTogU3RyaW5nLCBlbnVtOiBbJ9mF2YXYqtin2LInLCAn2KzZitivINis2K/Yp9mLJywgJ9is2YrYrycsICfZhdmC2KjZiNmEJywgJ9i22LnZitmBJ10gfSxcclxuICAgIGV4ZWN1dGl2ZVN1bW1hcnk6IFN0cmluZyxcclxuICAgIGtleUFjaGlldmVtZW50czogW1N0cmluZ10sXHJcbiAgICBtYWluQ2hhbGxlbmdlczogW1N0cmluZ10sXHJcbiAgICBwcm9tb3Rpb25SZWNvbW1lbmRlZDogQm9vbGVhbixcclxuICAgIHRyYWluaW5nTmVlZHM6IFtTdHJpbmddLFxyXG4gICAgY2FyZWVyUGF0aFJlY29tbWVuZGF0aW9uOiBTdHJpbmcsXHJcbiAgICBzYWxhcnlBZGp1c3RtZW50UmVjb21tZW5kZWQ6IEJvb2xlYW4sXHJcbiAgICBzYWxhcnlBZGp1c3RtZW50UGVyY2VudGFnZTogTnVtYmVyLFxyXG4gIH0sXHJcbiAgaHJOb3RlczogU3RyaW5nLFxyXG4gIGFwcHJvdmVkQnk6IHsgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCByZWY6ICdVc2VyJyB9LFxyXG4gIGFwcHJvdmFsRGF0ZTogRGF0ZSxcclxuICBzdGF0dXM6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIGVudW06IFsnZHJhZnQnLCAnaW5fcHJvZ3Jlc3MnLCAncGVuZGluZ19yZXZpZXcnLCAnYXBwcm92ZWQnLCAnYXJjaGl2ZWQnXSxcclxuICAgIGRlZmF1bHQ6ICdkcmFmdCcsXHJcbiAgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxuICB1cGRhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxuICBzdWJtaXR0ZWRBdDogRGF0ZSxcclxuICByZXZpZXdlZEF0OiBEYXRlLFxyXG59KTtcclxuXHJcblBlcmZvcm1hbmNlRXZhbHVhdGlvblNjaGVtYS5pbmRleCh7IGVtcGxveWVlSWQ6IDEsICdldmFsdWF0aW9uUGVyaW9kLnN0YXJ0RGF0ZSc6IC0xIH0pO1xyXG5QZXJmb3JtYW5jZUV2YWx1YXRpb25TY2hlbWEuaW5kZXgoeyBzdGF0dXM6IDEgfSk7XHJcblBlcmZvcm1hbmNlRXZhbHVhdGlvblNjaGVtYS5pbmRleCh7ICdzdW1tYXJ5Lm92ZXJhbGxSYXRpbmcnOiAxIH0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbCgnUGVyZm9ybWFuY2VFdmFsdWF0aW9uJywgUGVyZm9ybWFuY2VFdmFsdWF0aW9uU2NoZW1hKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQyxNQUFNQywwQkFBMEIsR0FBRyxJQUFJRixRQUFRLENBQUNHLE1BQU0sQ0FBQztFQUNyREMsV0FBVyxFQUFFO0lBQUVDLElBQUksRUFBRUwsUUFBUSxDQUFDRyxNQUFNLENBQUNHLEtBQUssQ0FBQ0MsUUFBUTtJQUFFQyxHQUFHLEVBQUUsTUFBTTtJQUFFQyxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQ2xGQyxjQUFjLEVBQUU7SUFDZEwsSUFBSSxFQUFFTSxNQUFNO0lBQ1pDLElBQUksRUFBRSxDQUFDLFlBQVksRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQztJQUNqREgsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESSxLQUFLLEVBQUVDLE1BQU07RUFDYkMsTUFBTSxFQUFFLENBQ047SUFDRUMsVUFBVSxFQUFFTCxNQUFNO0lBQ2xCTSxZQUFZLEVBQUVOLE1BQU07SUFDcEJFLEtBQUssRUFBRTtNQUFFUixJQUFJLEVBQUVTLE1BQU07TUFBRUksR0FBRyxFQUFFLENBQUM7TUFBRUMsR0FBRyxFQUFFO0lBQUUsQ0FBQztJQUN2Q0MsT0FBTyxFQUFFVDtFQUNYLENBQUMsQ0FDRjtFQUNEVSxRQUFRLEVBQUVWLE1BQU07RUFDaEJXLFNBQVMsRUFBRSxDQUFDWCxNQUFNLENBQUM7RUFDbkJZLG1CQUFtQixFQUFFLENBQUNaLE1BQU0sQ0FBQztFQUM3QmEsZUFBZSxFQUFFYixNQUFNO0VBQ3ZCYyxTQUFTLEVBQUU7SUFBRXBCLElBQUksRUFBRXFCLElBQUk7SUFBRUMsT0FBTyxFQUFFRCxJQUFJLENB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