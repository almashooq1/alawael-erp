{"version":3,"names":["express","require","router","Router","MOIPassportService","Logger","authenticate","passportService","passportVerificationMiddleware","req","res","next","console","log","path","error","message","status","json","success","use","validateRequest","_body","user","userId","id","_error","get","service","version","timestamp","Date","toISOString","post","passportNumber","body","result","verifyPassport","data","type","nationalId","verifyNationalId","iqamaNumber","verifyIqama","documents","Array","isArray","length","results","errors","doc","value","Error","push","identifier","verified","failed","summary","total","successful","successRate","toFixed","visaType","duration","requestExitReentryVisa","params","getTravelerProfile","cacheMetrics","getMetrics","cache","size","cacheSize","maxSize","maxCacheSize","utilization","cacheUtilization","hits","totalCacheHits","pattern","clearCache","cleared","metrics","requests","totalRequests","successfulRequests","failedRequests","averageResponseTime","logs","errorLogSize","auditLogSize","healthStatus","healthCheck","details","action","limit","startDate","endDate","query","filters","parseInt","getAuditLog","count","statusCode","module","exports"],"sources":["moi-passport.routes.js"],"sourcesContent":["/**\r\n * MOI Passport Integration Routes - مسارات تكامل الجوازات\r\n * Express Routes for Passport Verification & Management\r\n * Version: 3.0.0\r\n */\r\n\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst MOIPassportService = require('../services/moi-passport.service');\r\nconst Logger = require('../utils/logger');\r\nconst { authenticate } = require('../middleware/auth');\r\n\r\n// Initialize service\r\nconst passportService = new MOIPassportService();\r\n\r\n// ============================================================================\r\n// MIDDLEWARE\r\n// ============================================================================\r\n\r\n/**\r\n * Passport verification middleware\r\n */\r\nconst passportVerificationMiddleware = (req, res, next) => {\r\n  try {\r\n    console.log('[MOI-MIDDLEWARE] passportVerificationMiddleware called for:', req.path);\r\n    req.passportService = passportService;\r\n    next();\r\n  } catch (error) {\r\n    console.error('[MOI-MIDDLEWARE] passportVerificationMiddleware error:', error.message);\r\n    res.status(500).json({\r\n      success: false,\r\n      error: 'Service initialization failed',\r\n    });\r\n  }\r\n};\r\n\r\nrouter.use(passportVerificationMiddleware);\r\n\r\n/**\r\n * Request validation middleware\r\n */\r\nconst validateRequest = (req, res, next) => {\r\n  try {\r\n    const { _body, user } = req;\r\n    req.userId = user?.id || 'system';\r\n    next();\r\n  } catch (_error) {\r\n    res.status(400).json({\r\n      success: false,\r\n      error: 'Invalid request',\r\n    });\r\n  }\r\n};\r\n\r\n// ============================================================================\r\n// PUBLIC ENDPOINTS (No Auth Required)\r\n// ============================================================================\r\n\r\n/**\r\n * GET /api/moi/health\r\n * Health check endpoint\r\n */\r\nrouter.get('/health', (req, res) => {\r\n  console.log('[MOI-HEALTH] Health endpoint called');\r\n  res.json({\r\n    success: true,\r\n    status: 'healthy',\r\n    service: 'MOI Passport Integration Service',\r\n    version: '3.0.0',\r\n    timestamp: new Date().toISOString(),\r\n  });\r\n});\r\n\r\n// ============================================================================\r\n// PROTECTED ENDPOINTS (Auth Required)\r\n// ============================================================================\r\n\r\nrouter.use(authenticate, validateRequest);\r\n\r\n// ============================================================================\r\n// VERIFICATION ENDPOINTS\r\n// ============================================================================\r\n\r\n/**\r\n * POST /api/moi/passports/verify\r\n * Verify Passport Number\r\n */\r\nrouter.post('/passports/verify', async (req, res) => {\r\n  try {\r\n    const { passportNumber } = req.body;\r\n\r\n    if (!passportNumber) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'Passport number is required',\r\n      });\r\n    }\r\n\r\n    const result = await passportService.verifyPassport(passportNumber, req.userId);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: result,\r\n      message: 'Passport verification successful',\r\n    });\r\n  } catch (error) {\r\n    Logger.error('Passport verification error:', error);\r\n    res.status(400).json({\r\n      success: false,\r\n      error: error.error || error.message,\r\n      type: error.type || 'VERIFICATION_ERROR',\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * POST /api/moi/national-ids/verify\r\n * Verify National ID\r\n */\r\nrouter.post('/national-ids/verify', async (req, res) => {\r\n  try {\r\n    const { nationalId } = req.body;\r\n\r\n    if (!nationalId) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'National ID is required',\r\n      });\r\n    }\r\n\r\n    const result = await passportService.verifyNationalId(nationalId, req.userId);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: result,\r\n      message: 'National ID verification successful',\r\n    });\r\n  } catch (error) {\r\n    Logger.error('National ID verification error:', error);\r\n    res.status(400).json({\r\n      success: false,\r\n      error: error.error || error.message,\r\n      type: error.type || 'VERIFICATION_ERROR',\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * POST /api/moi/iqamas/verify\r\n * Verify Iqama (Residency)\r\n */\r\nrouter.post('/iqamas/verify', async (req, res) => {\r\n  try {\r\n    const { iqamaNumber } = req.body;\r\n\r\n    if (!iqamaNumber) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'Iqama number is required',\r\n      });\r\n    }\r\n\r\n    const result = await passportService.verifyIqama(iqamaNumber, req.userId);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: result,\r\n      message: 'Iqama verification successful',\r\n    });\r\n  } catch (error) {\r\n    Logger.error('Iqama verification error:', error);\r\n    res.status(400).json({\r\n      success: false,\r\n      error: error.error || error.message,\r\n      type: error.type || 'VERIFICATION_ERROR',\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * POST /api/moi/verify/bulk\r\n * Bulk Verification - Multiple Documents\r\n */\r\nrouter.post('/verify/bulk', async (req, res) => {\r\n  try {\r\n    const { documents } = req.body;\r\n\r\n    if (!Array.isArray(documents) || documents.length === 0) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'Documents array is required and must not be empty',\r\n      });\r\n    }\r\n\r\n    if (documents.length > 100) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'Maximum 100 documents per request',\r\n      });\r\n    }\r\n\r\n    const results = [];\r\n    const errors = [];\r\n\r\n    for (const doc of documents) {\r\n      try {\r\n        let result;\r\n\r\n        if (doc.type === 'passport' && doc.value) {\r\n          result = await passportService.verifyPassport(doc.value, req.userId);\r\n        } else if (doc.type === 'national-id' && doc.value) {\r\n          result = await passportService.verifyNationalId(doc.value, req.userId);\r\n        } else if (doc.type === 'iqama' && doc.value) {\r\n          result = await passportService.verifyIqama(doc.value, req.userId);\r\n        } else {\r\n          throw new Error(`Unknown document type: ${doc.type}`);\r\n        }\r\n\r\n        results.push({\r\n          type: doc.type,\r\n          identifier: doc.value,\r\n          result: result.data,\r\n          status: 'verified',\r\n        });\r\n      } catch (error) {\r\n        errors.push({\r\n          type: doc.type,\r\n          identifier: doc.value,\r\n          error: error.message || error.error,\r\n          status: 'failed',\r\n        });\r\n      }\r\n    }\r\n\r\n    res.json({\r\n      success: errors.length === 0,\r\n      data: {\r\n        verified: results,\r\n        failed: errors,\r\n        summary: {\r\n          total: documents.length,\r\n          successful: results.length,\r\n          failed: errors.length,\r\n          successRate: `${((results.length / documents.length) * 100).toFixed(2)}%`,\r\n        },\r\n      },\r\n    });\r\n  } catch (error) {\r\n    Logger.error('Bulk verification error:', error);\r\n    res.status(400).json({\r\n      success: false,\r\n      error: error.message,\r\n    });\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// VISA & TRAVEL ENDPOINTS\r\n// ============================================================================\r\n\r\n/**\r\n * POST /api/moi/exit-reentry/request\r\n * Request Exit/Re-entry Visa\r\n */\r\nrouter.post('/exit-reentry/request', async (req, res) => {\r\n  try {\r\n    const { iqamaNumber, visaType = 'multiple', duration = 90 } = req.body;\r\n\r\n    if (!iqamaNumber) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'Iqama number is required',\r\n      });\r\n    }\r\n\r\n    const result = await passportService.requestExitReentryVisa(\r\n      iqamaNumber,\r\n      visaType,\r\n      duration,\r\n      req.userId\r\n    );\r\n\r\n    res.json({\r\n      success: true,\r\n      data: result,\r\n      message: 'Exit/Re-entry visa request successful',\r\n    });\r\n  } catch (error) {\r\n    Logger.error('Exit/Re-entry request error:', error);\r\n    res.status(400).json({\r\n      success: false,\r\n      error: error.error || error.message,\r\n      type: error.type || 'VISA_REQUEST_ERROR',\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * GET /api/moi/travelers/:iqamaNumber\r\n * Get Complete Traveler Profile\r\n */\r\nrouter.get('/travelers/:iqamaNumber', async (req, res) => {\r\n  try {\r\n    const { iqamaNumber } = req.params;\r\n\r\n    if (!iqamaNumber) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        error: 'Iqama number is required',\r\n      });\r\n    }\r\n\r\n    const result = await passportService.getTravelerProfile(iqamaNumber, req.userId);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: result,\r\n      message: 'Traveler profile retrieved successfully',\r\n    });\r\n  } catch (error) {\r\n    Logger.error('Traveler profile error:', error);\r\n    res.status(400).json({\r\n      success: false,\r\n      error: error.error || error.message,\r\n    });\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// CACHE MANAGEMENT\r\n// ============================================================================\r\n\r\n/**\r\n * GET /api/moi/cache/stats\r\n * Get Cache Statistics\r\n */\r\nrouter.get('/cache/stats', (req, res) => {\r\n  try {\r\n    const cacheMetrics = passportService.getMetrics();\r\n\r\n    res.json({\r\n      success: true,\r\n      data: {\r\n        cache: {\r\n          size: cacheMetrics.cacheSize,\r\n          maxSize: cacheMetrics.maxCacheSize,\r\n          utilization: cacheMetrics.cacheUtilization,\r\n          hits: cacheMetrics.totalCacheHits,\r\n        },\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      error: error.message,\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * POST /api/moi/cache/clear\r\n * Clear Cache\r\n */\r\nrouter.post('/cache/clear', (req, res) => {\r\n  try {\r\n    const { pattern } = req.body;\r\n    const result = passportService.clearCache(pattern);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: result,\r\n      message: `Cache cleared: ${result.cleared || 'all'} items removed`,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      error: error.message,\r\n    });\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// METRICS & MONITORING\r\n// ============================================================================\r\n\r\n/**\r\n * GET /api/moi/metrics\r\n * Get Service Metrics\r\n */\r\nrouter.get('/metrics', (req, res) => {\r\n  try {\r\n    const metrics = passportService.getMetrics();\r\n\r\n    res.json({\r\n      success: true,\r\n      data: {\r\n        requests: {\r\n          total: metrics.totalRequests,\r\n          successful: metrics.successfulRequests,\r\n          failed: metrics.failedRequests,\r\n          successRate: metrics.successRate,\r\n          averageResponseTime: metrics.averageResponseTime,\r\n        },\r\n        cache: {\r\n          hits: metrics.totalCacheHits,\r\n          size: metrics.cacheSize,\r\n          maxSize: metrics.maxCacheSize,\r\n          utilization: metrics.cacheUtilization,\r\n        },\r\n        logs: {\r\n          errorLogSize: metrics.errorLogSize,\r\n          auditLogSize: metrics.auditLogSize,\r\n        },\r\n      },\r\n      timestamp: new Date(),\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      error: error.message,\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * GET /api/moi/health\r\n * Health Check\r\n */\r\nrouter.get('/health', async (req, res) => {\r\n  try {\r\n    const healthStatus = await passportService.healthCheck();\r\n\r\n    res.json({\r\n      success: healthStatus.status === 'healthy',\r\n      data: healthStatus,\r\n    });\r\n  } catch (error) {\r\n    res.status(503).json({\r\n      success: false,\r\n      error: 'Health check failed',\r\n      details: error.message,\r\n    });\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// AUDIT LOG ENDPOINTS\r\n// ============================================================================\r\n\r\n/**\r\n * GET /api/moi/audit-logs\r\n * Get Audit Logs\r\n */\r\nrouter.get('/audit-logs', (req, res) => {\r\n  try {\r\n    const { action, userId, limit, startDate, endDate } = req.query;\r\n\r\n    const filters = {};\r\n    if (action) filters.action = action;\r\n    if (userId) filters.userId = userId;\r\n    if (limit) filters.limit = parseInt(limit);\r\n    if (startDate && endDate) {\r\n      filters.startDate = new Date(startDate);\r\n      filters.endDate = new Date(endDate);\r\n    }\r\n\r\n    const logs = passportService.getAuditLog(filters);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: {\r\n        logs,\r\n        count: logs.length,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      error: error.message,\r\n    });\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// ERROR HANDLING\r\n// ============================================================================\r\n\r\nrouter.use((error, req, res, next) => {\r\n  Logger.error('Passport route error:', error);\r\n\r\n  res.status(error.statusCode || 500).json({\r\n    success: false,\r\n    error: error.message || 'Internal server error',\r\n    type: error.type || 'INTERNAL_ERROR',\r\n    timestamp: new Date(),\r\n  });\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}