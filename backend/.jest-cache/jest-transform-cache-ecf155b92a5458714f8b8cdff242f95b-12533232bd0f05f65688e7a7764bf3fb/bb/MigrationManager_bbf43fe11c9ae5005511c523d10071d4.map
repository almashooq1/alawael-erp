{"version":3,"names":["CSVProcessor","require","DatabaseMigration","MigrationManager","constructor","config","sourceDB","targetDB","csvProcessor","logger","console","dbMigration","migrationPlan","executionLog","stats","startTime","endTime","duration","totalTables","completedTables","failedTables","totalRecords","createMigrationPlan","tables","options","createdAt","Date","toISOString","steps","generateMigrationSteps","info","length","preValidation","push","id","name","type","timestamp","table","transform","transforms","skipDuplicates","postValidation","postCleanup","executeMigrationPlan","Error","now","results","step","result","executeValidation","executeBackup","executeMigrationStep","executeVerification","executeCleanup","status","continueOnError","error","message","getExecutionSummary","validationResults","verifyMigration","validations","backupFile","migrateTableWithTransform","migrateTable","recordsMigrated","verifications","verifyAllMigrations","allMatch","every","v","match","migrateFromCSV","csvPath","tableName","csvData","importCSV","columns","csvOptions","success","errors","recordCount","data","transformData","insertBatch","csvFile","exportTableToCSV","query","exportToCSV","recordsExported","fileSize","failedSteps","filter","log","warningSteps","totalDuration","reduce","sum","summary","totalSteps","completedSteps","overallStatus","getExecutionLog","clearLog","pauseMigration","resumeMigration","module","exports"],"sources":["MigrationManager.js"],"sourcesContent":["/**\r\n * Migration Manager\r\n * Orchestrates the entire data migration process\r\n */\r\n\r\nconst CSVProcessor = require('./CSVProcessor');\r\nconst DatabaseMigration = require('./DatabaseMigration');\r\n\r\nclass MigrationManager {\r\n  constructor(config = {}) {\r\n    this.config = {\r\n      sourceDB: config.sourceDB,\r\n      targetDB: config.targetDB,\r\n      csvProcessor: config.csvProcessor || new CSVProcessor(),\r\n      logger: config.logger || console,\r\n      ...config,\r\n    };\r\n\r\n    this.csvProcessor = this.config.csvProcessor;\r\n    this.dbMigration = new DatabaseMigration(\r\n      this.config.sourceDB,\r\n      this.config.targetDB,\r\n      this.config.logger,\r\n    );\r\n\r\n    this.migrationPlan = null;\r\n    this.executionLog = [];\r\n    this.stats = {\r\n      startTime: null,\r\n      endTime: null,\r\n      duration: 0,\r\n      totalTables: 0,\r\n      completedTables: 0,\r\n      failedTables: 0,\r\n      totalRecords: 0,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create migration plan\r\n   */\r\n  createMigrationPlan(tables, options = {}) {\r\n    this.migrationPlan = {\r\n      tables,\r\n      options,\r\n      createdAt: new Date().toISOString(),\r\n      steps: this.generateMigrationSteps(tables, options),\r\n    };\r\n\r\n    this.config.logger.info(`Migration plan created with ${tables.length} tables`);\r\n    return this.migrationPlan;\r\n  }\r\n\r\n  /**\r\n   * Generate migration steps\r\n   */\r\n  generateMigrationSteps(tables, options = {}) {\r\n    const steps = [];\r\n\r\n    if (options.preValidation) {\r\n      steps.push({\r\n        id: 'pre_validation',\r\n        name: 'Pre-migration Validation',\r\n        type: 'validation',\r\n        tables,\r\n      });\r\n    }\r\n\r\n    steps.push({\r\n      id: 'backup',\r\n      name: 'Create Database Backup',\r\n      type: 'backup',\r\n      timestamp: true,\r\n    });\r\n\r\n    for (const table of tables) {\r\n      steps.push({\r\n        id: `migrate_${table}`,\r\n        name: `Migrate ${table}`,\r\n        type: 'migration',\r\n        table,\r\n        transform: options.transforms?.[table],\r\n        skipDuplicates: options.skipDuplicates,\r\n      });\r\n    }\r\n\r\n    if (options.postValidation) {\r\n      steps.push({\r\n        id: 'post_validation',\r\n        name: 'Post-migration Verification',\r\n        type: 'verification',\r\n        tables,\r\n      });\r\n    }\r\n\r\n    if (options.postCleanup) {\r\n      steps.push({\r\n        id: 'post_cleanup',\r\n        name: 'Cleanup Source Data',\r\n        type: 'cleanup',\r\n      });\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  /**\r\n   * Execute migration plan\r\n   */\r\n  async executeMigrationPlan(options = {}) {\r\n    if (!this.migrationPlan) {\r\n      throw new Error('No migration plan created. Call createMigrationPlan first.');\r\n    }\r\n\r\n    this.stats.startTime = Date.now();\r\n    const steps = this.migrationPlan.steps;\r\n    const results = [];\r\n\r\n    this.config.logger.info('Starting migration execution');\r\n\r\n    for (const step of steps) {\r\n      try {\r\n        this.config.logger.info(`Executing step: ${step.name}`);\r\n\r\n        let result;\r\n        switch (step.type) {\r\n          case 'validation':\r\n            result = await this.executeValidation(step);\r\n            break;\r\n          case 'backup':\r\n            result = await this.executeBackup(step);\r\n            break;\r\n          case 'migration':\r\n            result = await this.executeMigrationStep(step);\r\n            break;\r\n          case 'verification':\r\n            result = await this.executeVerification(step);\r\n            break;\r\n          case 'cleanup':\r\n            result = await this.executeCleanup(step);\r\n            break;\r\n          default:\r\n            throw new Error(`Unknown step type: ${step.type}`);\r\n        }\r\n\r\n        results.push(result);\r\n        this.executionLog.push(result);\r\n\r\n        // Check if step failed and stop on error\r\n        if (result.status === 'failed' && !options.continueOnError) {\r\n          throw new Error(`Step failed: ${step.name}`);\r\n        }\r\n      } catch (error) {\r\n        this.config.logger.error(`Step execution failed: ${error.message}`);\r\n        results.push({\r\n          step: step.id,\r\n          status: 'failed',\r\n          error: error.message,\r\n        });\r\n\r\n        if (!options.continueOnError) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.stats.endTime = Date.now();\r\n    this.stats.duration = this.stats.endTime - this.stats.startTime;\r\n\r\n    return this.getExecutionSummary();\r\n  }\r\n\r\n  /**\r\n   * Execute validation step\r\n   */\r\n  async executeValidation(step) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      const validationResults = [];\r\n\r\n      for (const table of step.tables) {\r\n        const result = await this.dbMigration.verifyMigration(table);\r\n        validationResults.push(result);\r\n      }\r\n\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'completed',\r\n        duration: Date.now() - startTime,\r\n        validations: validationResults,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'failed',\r\n        duration: Date.now() - startTime,\r\n        error: error.message,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Execute backup step\r\n   */\r\n  async executeBackup(step) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      this.config.logger.info('Creating database backup...');\r\n      // Implement actual backup logic here\r\n      // For now, we'll just log the backup\r\n      const backupFile = `backup_${Date.now()}.sql`;\r\n\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'completed',\r\n        duration: Date.now() - startTime,\r\n        backupFile,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'failed',\r\n        duration: Date.now() - startTime,\r\n        error: error.message,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Execute migration step for a table\r\n   */\r\n  async executeMigrationStep(step) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      let result;\r\n\r\n      if (step.transform) {\r\n        result = await this.dbMigration.migrateTableWithTransform(\r\n          step.table,\r\n          step.transform,\r\n          { skipDuplicates: step.skipDuplicates },\r\n        );\r\n      } else {\r\n        result = await this.dbMigration.migrateTable(step.table, {\r\n          skipDuplicates: step.skipDuplicates,\r\n        });\r\n      }\r\n\r\n      this.stats.completedTables++;\r\n      this.stats.totalRecords += result.recordsMigrated || 0;\r\n\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: result.status,\r\n        duration: Date.now() - startTime,\r\n        recordsMigrated: result.recordsMigrated,\r\n        table: step.table,\r\n      };\r\n    } catch (error) {\r\n      this.stats.failedTables++;\r\n\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'failed',\r\n        duration: Date.now() - startTime,\r\n        error: error.message,\r\n        table: step.table,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Execute verification step\r\n   */\r\n  async executeVerification(step) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      const verifications = await this.dbMigration.verifyAllMigrations(step.tables);\r\n\r\n      const allMatch = verifications.every((v) => v.match === true);\r\n\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: allMatch ? 'completed' : 'warning',\r\n        duration: Date.now() - startTime,\r\n        verifications,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'failed',\r\n        duration: Date.now() - startTime,\r\n        error: error.message,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Execute cleanup step\r\n   */\r\n  async executeCleanup(step) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      this.config.logger.info('Executing post-migration cleanup...');\r\n      // Implement cleanup logic here\r\n\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'completed',\r\n        duration: Date.now() - startTime,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        step: step.id,\r\n        name: step.name,\r\n        status: 'failed',\r\n        duration: Date.now() - startTime,\r\n        error: error.message,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Import CSV and migrate to target\r\n   */\r\n  async migrateFromCSV(csvPath, tableName, options = {}) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      this.config.logger.info(`Starting CSV import from ${csvPath}`);\r\n\r\n      // Import CSV\r\n      const csvData = await this.csvProcessor.importCSV(csvPath, {\r\n        columns: true,\r\n        ...options.csvOptions,\r\n      });\r\n\r\n      if (!csvData.success) {\r\n        throw new Error(`CSV import failed: ${csvData.errors.length} errors`);\r\n      }\r\n\r\n      this.config.logger.info(`Imported ${csvData.recordCount} records from CSV`);\r\n\r\n      // Transform if needed\r\n      let data = csvData.data;\r\n      if (options.transform) {\r\n        data = this.csvProcessor.transformData(data, options.transform);\r\n      }\r\n\r\n      // Insert into target database\r\n      await this.dbMigration.insertBatch(tableName, data, options);\r\n\r\n      return {\r\n        status: 'completed',\r\n        csvFile: csvPath,\r\n        tableName,\r\n        recordsMigrated: data.length,\r\n        duration: Date.now() - startTime,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        status: 'failed',\r\n        csvFile: csvPath,\r\n        tableName,\r\n        error: error.message,\r\n        duration: Date.now() - startTime,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Export table to CSV\r\n   */\r\n  async exportTableToCSV(tableName, csvPath, options = {}) {\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      this.config.logger.info(`Exporting table ${tableName} to CSV`);\r\n\r\n      // Query all data\r\n      const data = await this.config.sourceDB.query(`SELECT * FROM ${tableName}`);\r\n\r\n      // Export to CSV\r\n      const result = await this.csvProcessor.exportToCSV(data, csvPath, options);\r\n\r\n      return {\r\n        status: 'completed',\r\n        table: tableName,\r\n        csvFile: csvPath,\r\n        recordsExported: result.recordCount,\r\n        fileSize: result.fileSize,\r\n        duration: Date.now() - startTime,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        status: 'failed',\r\n        table: tableName,\r\n        csvFile: csvPath,\r\n        error: error.message,\r\n        duration: Date.now() - startTime,\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get execution summary\r\n   */\r\n  getExecutionSummary() {\r\n    const failedSteps = this.executionLog.filter((log) => log.status === 'failed');\r\n    const warningSteps = this.executionLog.filter((log) => log.status === 'warning');\r\n    const totalDuration = this.executionLog.reduce((sum, log) => sum + (log.duration || 0), 0);\r\n\r\n    return {\r\n      stats: { ...this.stats, totalDuration },\r\n      summary: {\r\n        totalSteps: this.executionLog.length,\r\n        completedSteps: this.executionLog.length - failedSteps.length - warningSteps.length,\r\n        failedSteps: failedSteps.length,\r\n        warningSteps: warningSteps.length,\r\n        overallStatus: failedSteps.length > 0 ? 'failed' : 'success',\r\n      },\r\n      executionLog: this.executionLog,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get execution log\r\n   */\r\n  getExecutionLog() {\r\n    return this.executionLog;\r\n  }\r\n\r\n  /**\r\n   * Clear execution log\r\n   */\r\n  clearLog() {\r\n    this.executionLog = [];\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Pause migration\r\n   */\r\n  pauseMigration() {\r\n    this.config.logger.info('Migration paused');\r\n    return {\r\n      status: 'paused',\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Resume migration\r\n   */\r\n  resumeMigration() {\r\n    this.config.logger.info('Migration resumed');\r\n    return {\r\n      status: 'resumed',\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }\r\n}\r\n\r\nmodule.exports = MigrationManager;\r\n"],"mappings":"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","ignoreList":[]}