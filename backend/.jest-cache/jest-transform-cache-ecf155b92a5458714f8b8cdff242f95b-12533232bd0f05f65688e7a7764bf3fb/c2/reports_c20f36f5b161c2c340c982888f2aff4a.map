{"version":3,"names":["express","require","router","Router","ReportService","ApiResponse","ApiError","post","req","res","next","report","generateReport","body","json","err","message","get","limit","query","reports","getAllReports","parseInt","result","exportToCSV","setHeader","mimeType","fileName","send","content","exportToJSON","exportToExcel","delete","deleteReport","params","id","module","exports"],"sources":["reports.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst ReportService = require('../services/reportService');\r\nconst { ApiResponse, ApiError } = require('../utils/apiResponse');\r\n\r\n// Generate Report\r\nrouter.post('/generate', async (req, res, next) => {\r\n  try {\r\n    const report = await ReportService.generateReport(req.body);\r\n    return res.json(new ApiResponse(200, report, 'Report generated'));\r\n  } catch (err) {\r\n    return next(new ApiError(400, 'Failed to generate report', [err.message]));\r\n  }\r\n});\r\n\r\n// Get All Reports\r\nrouter.get('/all', async (req, res, next) => {\r\n  try {\r\n    const limit = req.query.limit || 50;\r\n    const reports = await ReportService.getAllReports(parseInt(limit));\r\n    return res.json(new ApiResponse(200, reports, 'Reports fetched'));\r\n  } catch (err) {\r\n    return next(new ApiError(400, 'Failed to fetch reports', [err.message]));\r\n  }\r\n});\r\n\r\n// Export to CSV\r\nrouter.post('/export/csv', async (req, res, next) => {\r\n  try {\r\n    const result = ReportService.exportToCSV(req.body.report);\r\n    res.setHeader('Content-Type', result.mimeType);\r\n    res.setHeader('Content-Disposition', `attachment; filename=\"${result.fileName}\"`);\r\n    res.send(result.content);\r\n  } catch (err) {\r\n    return next(new ApiError(400, 'Failed to export to CSV', [err.message]));\r\n  }\r\n});\r\n\r\n// Export to JSON\r\nrouter.post('/export/json', async (req, res, next) => {\r\n  try {\r\n    const result = ReportService.exportToJSON(req.body.report);\r\n    return res.json(new ApiResponse(200, result, 'Report exported to JSON'));\r\n  } catch (err) {\r\n    return next(new ApiError(400, 'Failed to export to JSON', [err.message]));\r\n  }\r\n});\r\n\r\n// Export to Excel\r\nrouter.post('/export/excel', async (req, res, next) => {\r\n  try {\r\n    const result = ReportService.exportToExcel(req.body.report);\r\n    return res.json(new ApiResponse(200, result, 'Report exported to Excel'));\r\n  } catch (err) {\r\n    return next(new ApiError(400, 'Failed to export to Excel', [err.message]));\r\n  }\r\n});\r\n\r\n// Delete Report\r\nrouter.delete('/:id', async (req, res, next) => {\r\n  try {\r\n    const result = await ReportService.deleteReport(req.params.id);\r\n    return res.json(new ApiResponse(200, result, 'Report deleted'));\r\n  } catch (err) {\r\n    return next(new ApiError(400, 'Failed to delete report', [err.message]));\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}