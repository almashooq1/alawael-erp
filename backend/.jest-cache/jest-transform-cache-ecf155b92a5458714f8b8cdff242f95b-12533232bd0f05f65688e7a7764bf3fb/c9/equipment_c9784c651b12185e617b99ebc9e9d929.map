{"version":3,"names":["express","require","router","Router","Equipment","MaintenanceSchedule","EquipmentLending","EquipmentFaultLog","EquipmentCalibration","authenticate","authorize","get","req","res","category","status","department","search","query","filter","$or","name","$regex","$options","equipmentId","serialNumber","equipment","find","populate","sort","createdAt","lean","json","success","count","length","data","error","message","findById","params","id","lastMaintenance","findOne","lastLending","borrowDate","post","manufacturer","purchaseDate","purchasePrice","warrantyEndDate","body","existing","warranty","endDate","createdBy","user","_id","save","maintenanceSchedule","scheduleType","preventiveSchedule","frequency","frequencyType","nextScheduledDate","Date","now","put","findByIdAndUpdate","updatedBy","new","runValidators","patch","schedules","overdue","$in","$lt","schedule","findings","recommendations","duration","cost","completion","completedDate","completedBy","signOff","totalCost","nextDate","setDate","getDate","borrower","lending","expectedReturnDate","lendingType","borrowLocation","lendingId","condition","notes","images","actualReturnDate","usageStatus","currentCondition","lastInspectionNotes","returnProcess","photos","inspectionDate","inspectedBy","severity","faults","detectedDate","faultCode","description","symptoms","fault","reportedBy","solutionDescription","actionsTaken","calibrations","calibrationDate","calibrationStandard","results","nextCalibrationDate","calibration","performedBy","totalEquipment","countDocuments","availableEquipment","inUseEquipment","maintenanceEquipment","overdueMaintenances","activeLendings","overdueLendings","openFaults","criticalFaults","total","available","inUse","maintenance","active","open","critical","categories","aggregate","$group","$sum","$cond","$eq","module","exports"],"sources":["equipment.js"],"sourcesContent":["/**\r\n * Equipment Management Routes\r\n * مسارات إدارة المعدات - نظام احترافي متقدم\r\n */\r\n\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst {\r\n  Equipment,\r\n  MaintenanceSchedule,\r\n  EquipmentLending,\r\n  EquipmentFaultLog,\r\n  EquipmentCalibration,\r\n} = require('../models/equipmentManagement');\r\nconst { authenticate, authorize } = require('../middleware/auth');\r\n\r\n// ============ EQUIPMENT ROUTES ============\r\n\r\n/**\r\n * Get all equipment with filters\r\n * GET /api/equipment?category=&status=&department=\r\n */\r\nrouter.get('/', authenticate, async (req, res) => {\r\n  try {\r\n    const { category, status, department, search } = req.query;\r\n    let filter = {};\r\n\r\n    if (category) filter.category = category;\r\n    if (status) filter.status = status;\r\n    if (department) filter['location.department'] = department;\r\n    if (search) {\r\n      filter.$or = [\r\n        { name: { $regex: search, $options: 'i' } },\r\n        { equipmentId: { $regex: search, $options: 'i' } },\r\n        { serialNumber: { $regex: search, $options: 'i' } },\r\n      ];\r\n    }\r\n\r\n    const equipment = await Equipment.find(filter)\r\n      .populate('createdBy', 'name email')\r\n      .sort({ createdAt: -1 })\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: equipment.length,\r\n      data: equipment,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Get equipment by ID with full details\r\n * GET /api/equipment/:id\r\n */\r\nrouter.get('/:id', authenticate, async (req, res) => {\r\n  try {\r\n    const equipment = await Equipment.findById(req.params.id)\r\n      .populate('createdBy', 'name email')\r\n      .populate('updatedBy', 'name email');\r\n\r\n    if (!equipment) {\r\n      return res.status(404).json({ success: false, message: 'المعدة غير موجودة' });\r\n    }\r\n\r\n    // جلب آخر جدولة صيانة\r\n    const lastMaintenance = await MaintenanceSchedule.findOne({\r\n      equipment: req.params.id,\r\n    })\r\n      .sort({ createdAt: -1 })\r\n      .lean();\r\n\r\n    // جلب آخر إعارة\r\n    const lastLending = await EquipmentLending.findOne({\r\n      equipment: req.params.id,\r\n    })\r\n      .sort({ borrowDate: -1 })\r\n      .populate('borrower', 'name email')\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      data: {\r\n        ...equipment,\r\n        lastMaintenance,\r\n        lastLending,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Create new equipment\r\n * POST /api/equipment\r\n */\r\nrouter.post('/', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const {\r\n      equipmentId,\r\n      name,\r\n      category,\r\n      manufacturer,\r\n      purchaseDate,\r\n      purchasePrice,\r\n      warrantyEndDate,\r\n    } = req.body;\r\n\r\n    // التحقق من عدم تكرار رقم المعدة\r\n    const existing = await Equipment.findOne({ equipmentId });\r\n    if (existing) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'رقم المعدة موجود بالفعل',\r\n      });\r\n    }\r\n\r\n    const equipment = new Equipment({\r\n      equipmentId,\r\n      name,\r\n      category,\r\n      manufacturer,\r\n      purchaseDate,\r\n      purchasePrice,\r\n      warranty: {\r\n        endDate: warrantyEndDate,\r\n      },\r\n      createdBy: req.user._id,\r\n    });\r\n\r\n    await equipment.save();\r\n\r\n    // إنشاء جدولة صيانة أولية\r\n    const maintenanceSchedule = new MaintenanceSchedule({\r\n      equipment: equipment._id,\r\n      scheduleType: 'preventive',\r\n      preventiveSchedule: {\r\n        frequency: 30,\r\n        frequencyType: 'monthly',\r\n        nextScheduledDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\r\n      },\r\n    });\r\n\r\n    await maintenanceSchedule.save();\r\n\r\n    res.status(201).json({\r\n      success: true,\r\n      data: equipment,\r\n      message: 'تم إنشاء المعدة بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Update equipment\r\n * PUT /api/equipment/:id\r\n */\r\nrouter.put('/:id', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const equipment = await Equipment.findByIdAndUpdate(\r\n      req.params.id,\r\n      { ...req.body, updatedBy: req.user._id },\r\n      { new: true, runValidators: true }\r\n    );\r\n\r\n    if (!equipment) {\r\n      return res.status(404).json({ success: false, message: 'المعدة غير موجودة' });\r\n    }\r\n\r\n    res.json({ success: true, data: equipment });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Update equipment status\r\n * PATCH /api/equipment/:id/status\r\n */\r\nrouter.patch('/:id/status', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const { status } = req.body;\r\n\r\n    const equipment = await Equipment.findByIdAndUpdate(\r\n      req.params.id,\r\n      { status, updatedBy: req.user._id },\r\n      { new: true }\r\n    );\r\n\r\n    if (!equipment) {\r\n      return res.status(404).json({ success: false, message: 'المعدة غير موجودة' });\r\n    }\r\n\r\n    res.json({\r\n      success: true,\r\n      data: equipment,\r\n      message: `تم تحديث حالة المعدة إلى: ${status}`,\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n// ============ MAINTENANCE SCHEDULE ROUTES ============\r\n\r\n/**\r\n * Get maintenance schedules\r\n * GET /api/maintenance-schedules?status=&equipment=\r\n */\r\nrouter.get('/maintenance/schedules', authenticate, async (req, res) => {\r\n  try {\r\n    const { status, equipment } = req.query;\r\n    let filter = {};\r\n\r\n    if (status) filter.status = status;\r\n    if (equipment) filter.equipment = equipment;\r\n\r\n    const schedules = await MaintenanceSchedule.find(filter)\r\n      .populate('equipment', 'name equipmentId')\r\n      .populate('responsibleTechnician', 'name email')\r\n      .sort({ 'preventiveSchedule.nextScheduledDate': 1 })\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: schedules.length,\r\n      data: schedules,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Get overdue maintenance\r\n * GET /api/maintenance/overdue\r\n */\r\nrouter.get('/maintenance/overdue', authenticate, async (req, res) => {\r\n  try {\r\n    const overdue = await MaintenanceSchedule.find({\r\n      status: { $in: ['scheduled', 'in_progress'] },\r\n      'preventiveSchedule.nextScheduledDate': { $lt: new Date() },\r\n    })\r\n      .populate('equipment', 'name equipmentId')\r\n      .populate('responsibleTechnician', 'name email')\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: overdue.length,\r\n      data: overdue,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Create maintenance schedule\r\n * POST /api/maintenance-schedules\r\n */\r\nrouter.post('/maintenance-schedules', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const { equipmentId, scheduleType, frequency, frequencyType } = req.body;\r\n\r\n    const schedule = new MaintenanceSchedule({\r\n      equipment: equipmentId,\r\n      scheduleType,\r\n      preventiveSchedule: {\r\n        frequency,\r\n        frequencyType,\r\n        nextScheduledDate: new Date(Date.now() + frequency * 24 * 60 * 60 * 1000),\r\n      },\r\n    });\r\n\r\n    await schedule.save();\r\n\r\n    res.status(201).json({\r\n      success: true,\r\n      data: schedule,\r\n      message: 'تم إنشاء جدولة الصيانة بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Complete maintenance\r\n * POST /api/maintenance/:id/complete\r\n */\r\nrouter.post('/maintenance/:id/complete', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const { findings, recommendations, duration, cost } = req.body;\r\n\r\n    const schedule = await MaintenanceSchedule.findByIdAndUpdate(\r\n      req.params.id,\r\n      {\r\n        status: 'completed',\r\n        completion: {\r\n          completedDate: new Date(),\r\n          completedBy: req.user._id,\r\n          findings,\r\n          recommendations,\r\n          duration,\r\n          signOff: true,\r\n        },\r\n        cost: {\r\n          totalCost: cost,\r\n        },\r\n      },\r\n      { new: true }\r\n    );\r\n\r\n    if (!schedule) {\r\n      return res.status(404).json({ success: false, message: 'جدولة الصيانة غير موجودة' });\r\n    }\r\n\r\n    // تحديث تاريخ الصيانة التالية\r\n    const nextDate = new Date();\r\n    nextDate.setDate(\r\n      nextDate.getDate() + schedule.preventiveSchedule.frequency\r\n    );\r\n    schedule.preventiveSchedule.nextScheduledDate = nextDate;\r\n    await schedule.save();\r\n\r\n    res.json({\r\n      success: true,\r\n      data: schedule,\r\n      message: 'تم إكمال جدولة الصيانة بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n// ============ EQUIPMENT LENDING ROUTES ============\r\n\r\n/**\r\n * Get lending records\r\n * GET /api/lending?status=&borrower=\r\n */\r\nrouter.get('/lending', authenticate, async (req, res) => {\r\n  try {\r\n    const { status, borrower } = req.query;\r\n    let filter = {};\r\n\r\n    if (status) filter.status = status;\r\n    if (borrower) filter.borrower = borrower;\r\n\r\n    const lending = await EquipmentLending.find(filter)\r\n      .populate('equipment', 'name equipmentId')\r\n      .populate('borrower', 'name email department')\r\n      .sort({ borrowDate: -1 })\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: lending.length,\r\n      data: lending,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Get overdue lendings\r\n * GET /api/lending/overdue\r\n */\r\nrouter.get('/lending/overdue', authenticate, async (req, res) => {\r\n  try {\r\n    const overdue = await EquipmentLending.find({\r\n      status: 'active',\r\n      expectedReturnDate: { $lt: new Date() },\r\n    })\r\n      .populate('equipment', 'name equipmentId')\r\n      .populate('borrower', 'name email phone')\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: overdue.length,\r\n      data: overdue,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Borrow equipment\r\n * POST /api/lending/borrow\r\n */\r\nrouter.post('/lending/borrow', authenticate, authorize('admin', 'manager', 'user'), async (req, res) => {\r\n  try {\r\n    const {\r\n      equipmentId,\r\n      expectedReturnDate,\r\n      lendingType,\r\n      borrowLocation,\r\n      department,\r\n    } = req.body;\r\n\r\n    // التحقق من توفر المعدة\r\n    const equipment = await Equipment.findById(equipmentId);\r\n    if (!equipment || equipment.status !== 'available') {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'المعدة غير متاحة حالياً',\r\n      });\r\n    }\r\n\r\n    const lendingId = `LEND-${Date.now()}`;\r\n    const lending = new EquipmentLending({\r\n      lendingId,\r\n      equipment: equipmentId,\r\n      borrower: req.user._id,\r\n      expectedReturnDate,\r\n      lendingType,\r\n      borrowLocation,\r\n      department,\r\n    });\r\n\r\n    await lending.save();\r\n\r\n    // تحديث حالة المعدة\r\n    await Equipment.findByIdAndUpdate(equipmentId, { status: 'in_use' });\r\n\r\n    res.status(201).json({\r\n      success: true,\r\n      data: lending,\r\n      message: 'تم إعارة المعدة بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Return equipment\r\n * POST /api/lending/:id/return\r\n */\r\nrouter.post('/lending/:id/return', authenticate, async (req, res) => {\r\n  try {\r\n    const { condition, notes, images } = req.body;\r\n\r\n    const lending = await EquipmentLending.findById(req.params.id);\r\n    if (!lending) {\r\n      return res.status(404).json({ success: false, message: 'الإعارة غير موجودة' });\r\n    }\r\n\r\n    lending.status = 'returned';\r\n    lending.actualReturnDate = new Date();\r\n    lending.usageStatus.currentCondition = condition;\r\n    lending.usageStatus.lastInspectionNotes = notes;\r\n    lending.returnProcess.photos = images || [];\r\n    lending.returnProcess.inspectionDate = new Date();\r\n    lending.returnProcess.inspectedBy = req.user._id;\r\n\r\n    await lending.save();\r\n\r\n    // تحديث حالة المعدة\r\n    await Equipment.findByIdAndUpdate(\r\n      lending.equipment,\r\n      { status: 'available' }\r\n    );\r\n\r\n    res.json({\r\n      success: true,\r\n      data: lending,\r\n      message: 'تم استرجاع المعدة بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n// ============ FAULT LOG ROUTES ============\r\n\r\n/**\r\n * Get fault logs\r\n * GET /api/faults?equipment=&severity=&status=\r\n */\r\nrouter.get('/faults', authenticate, async (req, res) => {\r\n  try {\r\n    const { equipment, severity, status } = req.query;\r\n    let filter = {};\r\n\r\n    if (equipment) filter.equipment = equipment;\r\n    if (severity) filter.severity = severity;\r\n    if (status) filter['resolution.status'] = status;\r\n\r\n    const faults = await EquipmentFaultLog.find(filter)\r\n      .populate('equipment', 'name equipmentId')\r\n      .populate('reportedBy', 'name email')\r\n      .populate('resolution.assignedTo', 'name email')\r\n      .sort({ detectedDate: -1 })\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: faults.length,\r\n      data: faults,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Report a fault\r\n * POST /api/faults\r\n */\r\nrouter.post('/faults', authenticate, async (req, res) => {\r\n  try {\r\n    const {\r\n      equipmentId,\r\n      faultCode,\r\n      description,\r\n      severity,\r\n      category,\r\n      symptoms,\r\n    } = req.body;\r\n\r\n    const fault = new EquipmentFaultLog({\r\n      equipment: equipmentId,\r\n      faultCode,\r\n      description,\r\n      severity,\r\n      category,\r\n      symptoms,\r\n      reportedBy: req.user._id,\r\n    });\r\n\r\n    await fault.save();\r\n\r\n    // تحديث حالة المعدة إلى damaged أو in_maintenance حسب الخطورة\r\n    if (severity === 'critical') {\r\n      await Equipment.findByIdAndUpdate(equipmentId, { status: 'in_maintenance' });\r\n    }\r\n\r\n    res.status(201).json({\r\n      success: true,\r\n      data: fault,\r\n      message: 'تم تسجيل العطل بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Resolve fault\r\n * PATCH /api/faults/:id/resolve\r\n */\r\nrouter.patch('/faults/:id/resolve', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const { solutionDescription, actionsTaken, cost } = req.body;\r\n\r\n    const fault = await EquipmentFaultLog.findByIdAndUpdate(\r\n      req.params.id,\r\n      {\r\n        'resolution.status': 'resolved',\r\n        'resolution.solutionDescription': solutionDescription,\r\n        'resolution.actionsTaken': actionsTaken,\r\n        'resolution.resolvedDate': new Date(),\r\n        'resolution.resolvedBy': req.user._id,\r\n        cost,\r\n      },\r\n      { new: true }\r\n    );\r\n\r\n    if (!fault) {\r\n      return res.status(404).json({ success: false, message: 'العطل غير موجود' });\r\n    }\r\n\r\n    // تحديث حالة المعدة إلى available\r\n    await Equipment.findByIdAndUpdate(fault.equipment, { status: 'available' });\r\n\r\n    res.json({\r\n      success: true,\r\n      data: fault,\r\n      message: 'تم حل العطل بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n// ============ CALIBRATION ROUTES ============\r\n\r\n/**\r\n * Get calibration records\r\n * GET /api/calibrations?equipment=\r\n */\r\nrouter.get('/calibrations', authenticate, async (req, res) => {\r\n  try {\r\n    const { equipment } = req.query;\r\n    let filter = {};\r\n\r\n    if (equipment) filter.equipment = equipment;\r\n\r\n    const calibrations = await EquipmentCalibration.find(filter)\r\n      .populate('equipment', 'name equipmentId')\r\n      .populate('performedBy', 'name email')\r\n      .sort({ calibrationDate: -1 })\r\n      .lean();\r\n\r\n    res.json({\r\n      success: true,\r\n      count: calibrations.length,\r\n      data: calibrations,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Create calibration record\r\n * POST /api/calibrations\r\n */\r\nrouter.post('/calibrations', authenticate, authorize('admin', 'manager'), async (req, res) => {\r\n  try {\r\n    const {\r\n      equipmentId,\r\n      calibrationStandard,\r\n      results,\r\n      cost,\r\n      nextCalibrationDate,\r\n    } = req.body;\r\n\r\n    const calibration = new EquipmentCalibration({\r\n      equipment: equipmentId,\r\n      calibrationDate: new Date(),\r\n      nextCalibrationDate,\r\n      calibrationStandard,\r\n      performedBy: req.user._id,\r\n      results,\r\n      cost,\r\n    });\r\n\r\n    await calibration.save();\r\n\r\n    res.status(201).json({\r\n      success: true,\r\n      data: calibration,\r\n      message: 'تم تسجيل المعايرة بنجاح',\r\n    });\r\n  } catch (error) {\r\n    res.status(400).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n// ============ DASHBOARD & ANALYTICS ROUTES ============\r\n\r\n/**\r\n * Equipment dashboard statistics\r\n * GET /api/equipment/dashboard/stats\r\n */\r\nrouter.get('/dashboard/stats', authenticate, async (req, res) => {\r\n  try {\r\n    const totalEquipment = await Equipment.countDocuments();\r\n    const availableEquipment = await Equipment.countDocuments({ status: 'available' });\r\n    const inUseEquipment = await Equipment.countDocuments({ status: 'in_use' });\r\n    const maintenanceEquipment = await Equipment.countDocuments({ status: 'in_maintenance' });\r\n\r\n    const overdueMaintenances = await MaintenanceSchedule.countDocuments({\r\n      status: { $in: ['scheduled', 'in_progress'] },\r\n      'preventiveSchedule.nextScheduledDate': { $lt: new Date() },\r\n    });\r\n\r\n    const activeLendings = await EquipmentLending.countDocuments({ status: 'active' });\r\n    const overdueLendings = await EquipmentLending.countDocuments({\r\n      status: 'active',\r\n      expectedReturnDate: { $lt: new Date() },\r\n    });\r\n\r\n    const openFaults = await EquipmentFaultLog.countDocuments({\r\n      'resolution.status': 'open',\r\n    });\r\n\r\n    const criticalFaults = await EquipmentFaultLog.countDocuments({\r\n      severity: 'critical',\r\n      'resolution.status': { $in: ['open', 'in_progress'] },\r\n    });\r\n\r\n    res.json({\r\n      success: true,\r\n      data: {\r\n        equipment: {\r\n          total: totalEquipment,\r\n          available: availableEquipment,\r\n          inUse: inUseEquipment,\r\n          maintenance: maintenanceEquipment,\r\n        },\r\n        maintenance: {\r\n          overdue: overdueMaintenances,\r\n        },\r\n        lending: {\r\n          active: activeLendings,\r\n          overdue: overdueLendings,\r\n        },\r\n        faults: {\r\n          open: openFaults,\r\n          critical: criticalFaults,\r\n        },\r\n      },\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\n/**\r\n * Equipment by category statistics\r\n * GET /api/equipment/analytics/by-category\r\n */\r\nrouter.get('/analytics/by-category', authenticate, async (req, res) => {\r\n  try {\r\n    const categories = await Equipment.aggregate([\r\n      {\r\n        $group: {\r\n          _id: '$category',\r\n          total: { $sum: 1 },\r\n          available: {\r\n            $sum: { $cond: [{ $eq: ['$status', 'available'] }, 1, 0] },\r\n          },\r\n          inUse: {\r\n            $sum: { $cond: [{ $eq: ['$status', 'in_use'] }, 1, 0] },\r\n          },\r\n          maintenance: {\r\n            $sum: { $cond: [{ $eq: ['$status', 'in_maintenance'] }, 1, 0] },\r\n          },\r\n        },\r\n      },\r\n    ]);\r\n\r\n    res.json({\r\n      success: true,\r\n      data: categories,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ success: false, message: error.message });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAM;EACJC,SAAS;EACTC,mBAAmB;EACnBC,gBAAgB;EAChBC,iBAAiB;EACjBC;AACF,CAAC,GAAGP,OAAO,CAAC,+BAA+B,CAAC;AAC5C,MAAM;EAAEQ,YAAY;EAAEC;AAAU,CAAC,GAAGT,OAAO,CAAC,oBAAoB,CAAC;;AAEjE;;AAEA;AACA;AACA;AACA;AACAC,MAAM,CAACS,GAAG,CAAC,GAAG,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EAChD,IAAI;IACF,MAAM;MAAEC,QAAQ;MAAEC,MAAM;MAAEC,UAAU;MAAEC;IAAO,CAAC,GAAGL,GAAG,CAACM,KAAK;IAC1D,IAAIC,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIL,QAAQ,EAAEK,MAAM,CAACL,QAAQ,GAAGA,QAAQ;IACxC,IAAIC,MAAM,EAAEI,MAAM,CAACJ,MAAM,GAAGA,MAAM;IAClC,IAAIC,UAAU,EAAEG,MAAM,CAAC,qBAAqB,CAAC,GAAGH,UAAU;IAC1D,IAAIC,MAAM,EAAE;MACVE,MAAM,CAACC,GAAG,GAAG,CACX;QAAEC,IAAI,EAAE;UAAEC,MAAM,EAAEL,MAAM;UAAEM,QAAQ,EAAE;QAAI;MAAE,CAAC,EAC3C;QAAEC,WAAW,EAAE;UAAEF,MAAM,EAAEL,MAAM;UAAEM,QAAQ,EAAE;QAAI;MAAE,CAAC,EAClD;QAAEE,YAAY,EAAE;UAAEH,MAAM,EAAEL,MAAM;UAAEM,QAAQ,EAAE;QAAI;MAAE,CAAC,CACpD;IACH;IAEA,MAAMG,SAAS,GAAG,MAAMtB,SAAS,CAACuB,IAAI,CAACR,MAAM,CAAC,CAC3CS,QAAQ,CAAC,WAAW,EAAE,YAAY,CAAC,CACnCC,IAAI,CAAC;MAAEC,SAAS,EAAE,CAAC;IAAE,CAAC,CAAC,CACvBC,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAER,SAAS,CAACS,MAAM;MACvBC,IAAI,EAAEV;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOW,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,MAAM,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACnD,IAAI;IACF,MAAMa,SAAS,GAAG,MAAMtB,SAAS,CAACmC,QAAQ,CAAC3B,GAAG,CAAC4B,MAAM,CAACC,EAAE,CAAC,CACtDb,QAAQ,CAAC,WAAW,EAAE,YAAY,CAAC,CACnCA,QAAQ,CAAC,WAAW,EAAE,YAAY,CAAC;IAEtC,IAAI,CAACF,SAAS,EAAE;MACd,OAAOb,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAAEC,OAAO,EAAE,KAAK;QAAEK,OAAO,EAAE;MAAoB,CAAC,CAAC;IAC/E;;IAEA;IACA,MAAMI,eAAe,GAAG,MAAMrC,mBAAmB,CAACsC,OAAO,CAAC;MACxDjB,SAAS,EAAEd,GAAG,CAAC4B,MAAM,CAACC;IACxB,CAAC,CAAC,CACCZ,IAAI,CAAC;MAAEC,SAAS,EAAE,CAAC;IAAE,CAAC,CAAC,CACvBC,IAAI,CAAC,CAAC;;IAET;IACA,MAAMa,WAAW,GAAG,MAAMtC,gBAAgB,CAACqC,OAAO,CAAC;MACjDjB,SAAS,EAAEd,GAAG,CAAC4B,MAAM,CAACC;IACxB,CAAC,CAAC,CACCZ,IAAI,CAAC;MAAEgB,UAAU,EAAE,CAAC;IAAE,CAAC,CAAC,CACxBjB,QAAQ,CAAC,UAAU,EAAE,YAAY,CAAC,CAClCG,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAE;QACJ,GAAGV,SAAS;QACZgB,eAAe;QACfE;MACF;IACF,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOP,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,GAAG,EAAErC,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAChF,IAAI;IACF,MAAM;MACJW,WAAW;MACXH,IAAI;MACJP,QAAQ;MACRiC,YAAY;MACZC,YAAY;MACZC,aAAa;MACbC;IACF,CAAC,GAAGtC,GAAG,CAACuC,IAAI;;IAEZ;IACA,MAAMC,QAAQ,GAAG,MAAMhD,SAAS,CAACuC,OAAO,CAAC;MAAEnB;IAAY,CAAC,CAAC;IACzD,IAAI4B,QAAQ,EAAE;MACZ,OAAOvC,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAC1BC,OAAO,EAAE,KAAK;QACdK,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;IAEA,MAAMZ,SAAS,GAAG,IAAItB,SAAS,CAAC;MAC9BoB,WAAW;MACXH,IAAI;MACJP,QAAQ;MACRiC,YAAY;MACZC,YAAY;MACZC,aAAa;MACbI,QAAQ,EAAE;QACRC,OAAO,EAAEJ;MACX,CAAC;MACDK,SAAS,EAAE3C,GAAG,CAAC4C,IAAI,CAACC;IACtB,CAAC,CAAC;IAEF,MAAM/B,SAAS,CAACgC,IAAI,CAAC,CAAC;;IAEtB;IACA,MAAMC,mBAAmB,GAAG,IAAItD,mBAAmB,CAAC;MAClDqB,SAAS,EAAEA,SAAS,CAAC+B,GAAG;MACxBG,YAAY,EAAE,YAAY;MAC1BC,kBAAkB,EAAE;QAClBC,SAAS,EAAE,EAAE;QACbC,aAAa,EAAE,SAAS;QACxBC,iBAAiB,EAAE,IAAIC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;MACnE;IACF,CAAC,CAAC;IAEF,MAAMP,mBAAmB,CAACD,IAAI,CAAC,CAAC;IAEhC7C,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MACnBC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEV,SAAS;MACfY,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACiE,GAAG,CAAC,MAAM,EAAE1D,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAClF,IAAI;IACF,MAAMa,SAAS,GAAG,MAAMtB,SAAS,CAACgE,iBAAiB,CACjDxD,GAAG,CAAC4B,MAAM,CAACC,EAAE,EACb;MAAE,GAAG7B,GAAG,CAACuC,IAAI;MAAEkB,SAAS,EAAEzD,GAAG,CAAC4C,IAAI,CAACC;IAAI,CAAC,EACxC;MAAEa,GAAG,EAAE,IAAI;MAAEC,aAAa,EAAE;IAAK,CACnC,CAAC;IAED,IAAI,CAAC7C,SAAS,EAAE;MACd,OAAOb,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAAEC,OAAO,EAAE,KAAK;QAAEK,OAAO,EAAE;MAAoB,CAAC,CAAC;IAC/E;IAEAzB,GAAG,CAACmB,IAAI,CAAC;MAAEC,OAAO,EAAE,IAAI;MAAEG,IAAI,EAAEV;IAAU,CAAC,CAAC;EAC9C,CAAC,CAAC,OAAOW,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACsE,KAAK,CAAC,aAAa,EAAE/D,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAC3F,IAAI;IACF,MAAM;MAAEE;IAAO,CAAC,GAAGH,GAAG,CAACuC,IAAI;IAE3B,MAAMzB,SAAS,GAAG,MAAMtB,SAAS,CAACgE,iBAAiB,CACjDxD,GAAG,CAAC4B,MAAM,CAACC,EAAE,EACb;MAAE1B,MAAM;MAAEsD,SAAS,EAAEzD,GAAG,CAAC4C,IAAI,CAACC;IAAI,CAAC,EACnC;MAAEa,GAAG,EAAE;IAAK,CACd,CAAC;IAED,IAAI,CAAC5C,SAAS,EAAE;MACd,OAAOb,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAAEC,OAAO,EAAE,KAAK;QAAEK,OAAO,EAAE;MAAoB,CAAC,CAAC;IAC/E;IAEAzB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEV,SAAS;MACfY,OAAO,EAAE,6BAA6BvB,MAAM;IAC9C,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOsB,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;;AAEA;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,wBAAwB,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACrE,IAAI;IACF,MAAM;MAAEE,MAAM;MAAEW;IAAU,CAAC,GAAGd,GAAG,CAACM,KAAK;IACvC,IAAIC,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIJ,MAAM,EAAEI,MAAM,CAACJ,MAAM,GAAGA,MAAM;IAClC,IAAIW,SAAS,EAAEP,MAAM,CAACO,SAAS,GAAGA,SAAS;IAE3C,MAAM+C,SAAS,GAAG,MAAMpE,mBAAmB,CAACsB,IAAI,CAACR,MAAM,CAAC,CACrDS,QAAQ,CAAC,WAAW,EAAE,kBAAkB,CAAC,CACzCA,QAAQ,CAAC,uBAAuB,EAAE,YAAY,CAAC,CAC/CC,IAAI,CAAC;MAAE,sCAAsC,EAAE;IAAE,CAAC,CAAC,CACnDE,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAEuC,SAAS,CAACtC,MAAM;MACvBC,IAAI,EAAEqC;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOpC,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,sBAAsB,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACnE,IAAI;IACF,MAAM6D,OAAO,GAAG,MAAMrE,mBAAmB,CAACsB,IAAI,CAAC;MAC7CZ,MAAM,EAAE;QAAE4D,GAAG,EAAE,CAAC,WAAW,EAAE,aAAa;MAAE,CAAC;MAC7C,sCAAsC,EAAE;QAAEC,GAAG,EAAE,IAAIX,IAAI,CAAC;MAAE;IAC5D,CAAC,CAAC,CACCrC,QAAQ,CAAC,WAAW,EAAE,kBAAkB,CAAC,CACzCA,QAAQ,CAAC,uBAAuB,EAAE,YAAY,CAAC,CAC/CG,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAEwC,OAAO,CAACvC,MAAM;MACrBC,IAAI,EAAEsC;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOrC,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,wBAAwB,EAAErC,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EACrG,IAAI;IACF,MAAM;MAAEW,WAAW;MAAEoC,YAAY;MAAEE,SAAS;MAAEC;IAAc,CAAC,GAAGnD,GAAG,CAACuC,IAAI;IAExE,MAAM0B,QAAQ,GAAG,IAAIxE,mBAAmB,CAAC;MACvCqB,SAAS,EAAEF,WAAW;MACtBoC,YAAY;MACZC,kBAAkB,EAAE;QAClBC,SAAS;QACTC,aAAa;QACbC,iBAAiB,EAAE,IAAIC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGJ,SAAS,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;MAC1E;IACF,CAAC,CAAC;IAEF,MAAMe,QAAQ,CAACnB,IAAI,CAAC,CAAC;IAErB7C,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MACnBC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEyC,QAAQ;MACdvC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,2BAA2B,EAAErC,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EACxG,IAAI;IACF,MAAM;MAAEiE,QAAQ;MAAEC,eAAe;MAAEC,QAAQ;MAAEC;IAAK,CAAC,GAAGrE,GAAG,CAACuC,IAAI;IAE9D,MAAM0B,QAAQ,GAAG,MAAMxE,mBAAmB,CAAC+D,iBAAiB,CAC1DxD,GAAG,CAAC4B,MAAM,CAACC,EAAE,EACb;MACE1B,MAAM,EAAE,WAAW;MACnBmE,UAAU,EAAE;QACVC,aAAa,EAAE,IAAIlB,IAAI,CAAC,CAAC;QACzBmB,WAAW,EAAExE,GAAG,CAAC4C,IAAI,CAACC,GAAG;QACzBqB,QAAQ;QACRC,eAAe;QACfC,QAAQ;QACRK,OAAO,EAAE;MACX,CAAC;MACDJ,IAAI,EAAE;QACJK,SAAS,EAAEL;MACb;IACF,CAAC,EACD;MAAEX,GAAG,EAAE;IAAK,CACd,CAAC;IAED,IAAI,CAACO,QAAQ,EAAE;MACb,OAAOhE,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAAEC,OAAO,EAAE,KAAK;QAAEK,OAAO,EAAE;MAA2B,CAAC,CAAC;IACtF;;IAEA;IACA,MAAMiD,QAAQ,GAAG,IAAItB,IAAI,CAAC,CAAC;IAC3BsB,QAAQ,CAACC,OAAO,CACdD,QAAQ,CAACE,OAAO,CAAC,CAAC,GAAGZ,QAAQ,CAAChB,kBAAkB,CAACC,SACnD,CAAC;IACDe,QAAQ,CAAChB,kBAAkB,CAACG,iBAAiB,GAAGuB,QAAQ;IACxD,MAAMV,QAAQ,CAACnB,IAAI,CAAC,CAAC;IAErB7C,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEyC,QAAQ;MACdvC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;;AAEA;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,UAAU,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACvD,IAAI;IACF,MAAM;MAAEE,MAAM;MAAE2E;IAAS,CAAC,GAAG9E,GAAG,CAACM,KAAK;IACtC,IAAIC,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIJ,MAAM,EAAEI,MAAM,CAACJ,MAAM,GAAGA,MAAM;IAClC,IAAI2E,QAAQ,EAAEvE,MAAM,CAACuE,QAAQ,GAAGA,QAAQ;IAExC,MAAMC,OAAO,GAAG,MAAMrF,gBAAgB,CAACqB,IAAI,CAACR,MAAM,CAAC,CAChDS,QAAQ,CAAC,WAAW,EAAE,kBAAkB,CAAC,CACzCA,QAAQ,CAAC,UAAU,EAAE,uBAAuB,CAAC,CAC7CC,IAAI,CAAC;MAAEgB,UAAU,EAAE,CAAC;IAAE,CAAC,CAAC,CACxBd,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAEyD,OAAO,CAACxD,MAAM;MACrBC,IAAI,EAAEuD;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOtD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,kBAAkB,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EAC/D,IAAI;IACF,MAAM6D,OAAO,GAAG,MAAMpE,gBAAgB,CAACqB,IAAI,CAAC;MAC1CZ,MAAM,EAAE,QAAQ;MAChB6E,kBAAkB,EAAE;QAAEhB,GAAG,EAAE,IAAIX,IAAI,CAAC;MAAE;IACxC,CAAC,CAAC,CACCrC,QAAQ,CAAC,WAAW,EAAE,kBAAkB,CAAC,CACzCA,QAAQ,CAAC,UAAU,EAAE,kBAAkB,CAAC,CACxCG,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAEwC,OAAO,CAACvC,MAAM;MACrBC,IAAI,EAAEsC;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOrC,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,iBAAiB,EAAErC,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EACtG,IAAI;IACF,MAAM;MACJW,WAAW;MACXoE,kBAAkB;MAClBC,WAAW;MACXC,cAAc;MACd9E;IACF,CAAC,GAAGJ,GAAG,CAACuC,IAAI;;IAEZ;IACA,MAAMzB,SAAS,GAAG,MAAMtB,SAAS,CAACmC,QAAQ,CAACf,WAAW,CAAC;IACvD,IAAI,CAACE,SAAS,IAAIA,SAAS,CAACX,MAAM,KAAK,WAAW,EAAE;MAClD,OAAOF,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAC1BC,OAAO,EAAE,KAAK;QACdK,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;IAEA,MAAMyD,SAAS,GAAG,QAAQ9B,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IACtC,MAAMyB,OAAO,GAAG,IAAIrF,gBAAgB,CAAC;MACnCyF,SAAS;MACTrE,SAAS,EAAEF,WAAW;MACtBkE,QAAQ,EAAE9E,GAAG,CAAC4C,IAAI,CAACC,GAAG;MACtBmC,kBAAkB;MAClBC,WAAW;MACXC,cAAc;MACd9E;IACF,CAAC,CAAC;IAEF,MAAM2E,OAAO,CAACjC,IAAI,CAAC,CAAC;;IAEpB;IACA,MAAMtD,SAAS,CAACgE,iBAAiB,CAAC5C,WAAW,EAAE;MAAET,MAAM,EAAE;IAAS,CAAC,CAAC;IAEpEF,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MACnBC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEuD,OAAO;MACbrD,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,qBAAqB,EAAErC,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACnE,IAAI;IACF,MAAM;MAAEmF,SAAS;MAAEC,KAAK;MAAEC;IAAO,CAAC,GAAGtF,GAAG,CAACuC,IAAI;IAE7C,MAAMwC,OAAO,GAAG,MAAMrF,gBAAgB,CAACiC,QAAQ,CAAC3B,GAAG,CAAC4B,MAAM,CAACC,EAAE,CAAC;IAC9D,IAAI,CAACkD,OAAO,EAAE;MACZ,OAAO9E,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAAEC,OAAO,EAAE,KAAK;QAAEK,OAAO,EAAE;MAAqB,CAAC,CAAC;IAChF;IAEAqD,OAAO,CAAC5E,MAAM,GAAG,UAAU;IAC3B4E,OAAO,CAACQ,gBAAgB,GAAG,IAAIlC,IAAI,CAAC,CAAC;IACrC0B,OAAO,CAACS,WAAW,CAACC,gBAAgB,GAAGL,SAAS;IAChDL,OAAO,CAACS,WAAW,CAACE,mBAAmB,GAAGL,KAAK;IAC/CN,OAAO,CAACY,aAAa,CAACC,MAAM,GAAGN,MAAM,IAAI,EAAE;IAC3CP,OAAO,CAACY,aAAa,CAACE,cAAc,GAAG,IAAIxC,IAAI,CAAC,CAAC;IACjD0B,OAAO,CAACY,aAAa,CAACG,WAAW,GAAG9F,GAAG,CAAC4C,IAAI,CAACC,GAAG;IAEhD,MAAMkC,OAAO,CAACjC,IAAI,CAAC,CAAC;;IAEpB;IACA,MAAMtD,SAAS,CAACgE,iBAAiB,CAC/BuB,OAAO,CAACjE,SAAS,EACjB;MAAEX,MAAM,EAAE;IAAY,CACxB,CAAC;IAEDF,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEuD,OAAO;MACbrD,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;;AAEA;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,SAAS,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACtD,IAAI;IACF,MAAM;MAAEa,SAAS;MAAEiF,QAAQ;MAAE5F;IAAO,CAAC,GAAGH,GAAG,CAACM,KAAK;IACjD,IAAIC,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIO,SAAS,EAAEP,MAAM,CAACO,SAAS,GAAGA,SAAS;IAC3C,IAAIiF,QAAQ,EAAExF,MAAM,CAACwF,QAAQ,GAAGA,QAAQ;IACxC,IAAI5F,MAAM,EAAEI,MAAM,CAAC,mBAAmB,CAAC,GAAGJ,MAAM;IAEhD,MAAM6F,MAAM,GAAG,MAAMrG,iBAAiB,CAACoB,IAAI,CAACR,MAAM,CAAC,CAChDS,QAAQ,CAAC,WAAW,EAAE,kBAAkB,CAAC,CACzCA,QAAQ,CAAC,YAAY,EAAE,YAAY,CAAC,CACpCA,QAAQ,CAAC,uBAAuB,EAAE,YAAY,CAAC,CAC/CC,IAAI,CAAC;MAAEgF,YAAY,EAAE,CAAC;IAAE,CAAC,CAAC,CAC1B9E,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAE0E,MAAM,CAACzE,MAAM;MACpBC,IAAI,EAAEwE;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOvE,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,SAAS,EAAErC,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACvD,IAAI;IACF,MAAM;MACJW,WAAW;MACXsF,SAAS;MACTC,WAAW;MACXJ,QAAQ;MACR7F,QAAQ;MACRkG;IACF,CAAC,GAAGpG,GAAG,CAACuC,IAAI;IAEZ,MAAM8D,KAAK,GAAG,IAAI1G,iBAAiB,CAAC;MAClCmB,SAAS,EAAEF,WAAW;MACtBsF,SAAS;MACTC,WAAW;MACXJ,QAAQ;MACR7F,QAAQ;MACRkG,QAAQ;MACRE,UAAU,EAAEtG,GAAG,CAAC4C,IAAI,CAACC;IACvB,CAAC,CAAC;IAEF,MAAMwD,KAAK,CAACvD,IAAI,CAAC,CAAC;;IAElB;IACA,IAAIiD,QAAQ,KAAK,UAAU,EAAE;MAC3B,MAAMvG,SAAS,CAACgE,iBAAiB,CAAC5C,WAAW,EAAE;QAAET,MAAM,EAAE;MAAiB,CAAC,CAAC;IAC9E;IAEAF,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MACnBC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAE6E,KAAK;MACX3E,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACsE,KAAK,CAAC,qBAAqB,EAAE/D,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EACnG,IAAI;IACF,MAAM;MAAEsG,mBAAmB;MAAEC,YAAY;MAAEnC;IAAK,CAAC,GAAGrE,GAAG,CAACuC,IAAI;IAE5D,MAAM8D,KAAK,GAAG,MAAM1G,iBAAiB,CAAC6D,iBAAiB,CACrDxD,GAAG,CAAC4B,MAAM,CAACC,EAAE,EACb;MACE,mBAAmB,EAAE,UAAU;MAC/B,gCAAgC,EAAE0E,mBAAmB;MACrD,yBAAyB,EAAEC,YAAY;MACvC,yBAAyB,EAAE,IAAInD,IAAI,CAAC,CAAC;MACrC,uBAAuB,EAAErD,GAAG,CAAC4C,IAAI,CAACC,GAAG;MACrCwB;IACF,CAAC,EACD;MAAEX,GAAG,EAAE;IAAK,CACd,CAAC;IAED,IAAI,CAAC2C,KAAK,EAAE;MACV,OAAOpG,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;QAAEC,OAAO,EAAE,KAAK;QAAEK,OAAO,EAAE;MAAkB,CAAC,CAAC;IAC7E;;IAEA;IACA,MAAMlC,SAAS,CAACgE,iBAAiB,CAAC6C,KAAK,CAACvF,SAAS,EAAE;MAAEX,MAAM,EAAE;IAAY,CAAC,CAAC;IAE3EF,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAE6E,KAAK;MACX3E,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;;AAEA;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,eAAe,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EAC5D,IAAI;IACF,MAAM;MAAEa;IAAU,CAAC,GAAGd,GAAG,CAACM,KAAK;IAC/B,IAAIC,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIO,SAAS,EAAEP,MAAM,CAACO,SAAS,GAAGA,SAAS;IAE3C,MAAM2F,YAAY,GAAG,MAAM7G,oBAAoB,CAACmB,IAAI,CAACR,MAAM,CAAC,CACzDS,QAAQ,CAAC,WAAW,EAAE,kBAAkB,CAAC,CACzCA,QAAQ,CAAC,aAAa,EAAE,YAAY,CAAC,CACrCC,IAAI,CAAC;MAAEyF,eAAe,EAAE,CAAC;IAAE,CAAC,CAAC,CAC7BvF,IAAI,CAAC,CAAC;IAETlB,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,KAAK,EAAEmF,YAAY,CAAClF,MAAM;MAC1BC,IAAI,EAAEiF;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOhF,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAAC4C,IAAI,CAAC,eAAe,EAAErC,YAAY,EAAEC,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAC5F,IAAI;IACF,MAAM;MACJW,WAAW;MACX+F,mBAAmB;MACnBC,OAAO;MACPvC,IAAI;MACJwC;IACF,CAAC,GAAG7G,GAAG,CAACuC,IAAI;IAEZ,MAAMuE,WAAW,GAAG,IAAIlH,oBAAoB,CAAC;MAC3CkB,SAAS,EAAEF,WAAW;MACtB8F,eAAe,EAAE,IAAIrD,IAAI,CAAC,CAAC;MAC3BwD,mBAAmB;MACnBF,mBAAmB;MACnBI,WAAW,EAAE/G,GAAG,CAAC4C,IAAI,CAACC,GAAG;MACzB+D,OAAO;MACPvC;IACF,CAAC,CAAC;IAEF,MAAMyC,WAAW,CAAChE,IAAI,CAAC,CAAC;IAExB7C,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MACnBC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEsF,WAAW;MACjBpF,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;;AAEA;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,kBAAkB,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EAC/D,IAAI;IACF,MAAM+G,cAAc,GAAG,MAAMxH,SAAS,CAACyH,cAAc,CAAC,CAAC;IACvD,MAAMC,kBAAkB,GAAG,MAAM1H,SAAS,CAACyH,cAAc,CAAC;MAAE9G,MAAM,EAAE;IAAY,CAAC,CAAC;IAClF,MAAMgH,cAAc,GAAG,MAAM3H,SAAS,CAACyH,cAAc,CAAC;MAAE9G,MAAM,EAAE;IAAS,CAAC,CAAC;IAC3E,MAAMiH,oBAAoB,GAAG,MAAM5H,SAAS,CAACyH,cAAc,CAAC;MAAE9G,MAAM,EAAE;IAAiB,CAAC,CAAC;IAEzF,MAAMkH,mBAAmB,GAAG,MAAM5H,mBAAmB,CAACwH,cAAc,CAAC;MACnE9G,MAAM,EAAE;QAAE4D,GAAG,EAAE,CAAC,WAAW,EAAE,aAAa;MAAE,CAAC;MAC7C,sCAAsC,EAAE;QAAEC,GAAG,EAAE,IAAIX,IAAI,CAAC;MAAE;IAC5D,CAAC,CAAC;IAEF,MAAMiE,cAAc,GAAG,MAAM5H,gBAAgB,CAACuH,cAAc,CAAC;MAAE9G,MAAM,EAAE;IAAS,CAAC,CAAC;IAClF,MAAMoH,eAAe,GAAG,MAAM7H,gBAAgB,CAACuH,cAAc,CAAC;MAC5D9G,MAAM,EAAE,QAAQ;MAChB6E,kBAAkB,EAAE;QAAEhB,GAAG,EAAE,IAAIX,IAAI,CAAC;MAAE;IACxC,CAAC,CAAC;IAEF,MAAMmE,UAAU,GAAG,MAAM7H,iBAAiB,CAACsH,cAAc,CAAC;MACxD,mBAAmB,EAAE;IACvB,CAAC,CAAC;IAEF,MAAMQ,cAAc,GAAG,MAAM9H,iBAAiB,CAACsH,cAAc,CAAC;MAC5DlB,QAAQ,EAAE,UAAU;MACpB,mBAAmB,EAAE;QAAEhC,GAAG,EAAE,CAAC,MAAM,EAAE,aAAa;MAAE;IACtD,CAAC,CAAC;IAEF9D,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAE;QACJV,SAAS,EAAE;UACT4G,KAAK,EAAEV,cAAc;UACrBW,SAAS,EAAET,kBAAkB;UAC7BU,KAAK,EAAET,cAAc;UACrBU,WAAW,EAAET;QACf,CAAC;QACDS,WAAW,EAAE;UACX/D,OAAO,EAAEuD;QACX,CAAC;QACDtC,OAAO,EAAE;UACP+C,MAAM,EAAER,cAAc;UACtBxD,OAAO,EAAEyD;QACX,CAAC;QACDvB,MAAM,EAAE;UACN+B,IAAI,EAAEP,UAAU;UAChBQ,QAAQ,EAAEP;QACZ;MACF;IACF,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOhG,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACApC,MAAM,CAACS,GAAG,CAAC,wBAAwB,EAAEF,YAAY,EAAE,OAAOG,GAAG,EAAEC,GAAG,KAAK;EACrE,IAAI;IACF,MAAMgI,UAAU,GAAG,MAAMzI,SAAS,CAAC0I,SAAS,CAAC,CAC3C;MACEC,MAAM,EAAE;QACNtF,GAAG,EAAE,WAAW;QAChB6E,KAAK,EAAE;UAAEU,IAAI,EAAE;QAAE,CAAC;QAClBT,SAAS,EAAE;UACTS,IAAI,EAAE;YAAEC,KAAK,EAAE,CAAC;cAAEC,GAAG,EAAE,CAAC,SAAS,EAAE,WAAW;YAAE,CAAC,EAAE,CAAC,EAAE,CAAC;UAAE;QAC3D,CAAC;QACDV,KAAK,EAAE;UACLQ,IAAI,EAAE;YAAEC,KAAK,EAAE,CAAC;cAAEC,GAAG,EAAE,CAAC,SAAS,EAAE,QAAQ;YAAE,CAAC,EAAE,CAAC,EAAE,CAAC;UAAE;QACxD,CAAC;QACDT,WAAW,EAAE;UACXO,IAAI,EAAE;YAAEC,KAAK,EAAE,CAAC;cAAEC,GAAG,EAAE,CAAC,SAAS,EAAE,gBAAgB;YAAE,CAAC,EAAE,CAAC,EAAE,CAAC;UAAE;QAChE;MACF;IACF,CAAC,CACF,CAAC;IAEFrI,GAAG,CAACmB,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbG,IAAI,EAAEyG;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOxG,KAAK,EAAE;IACdxB,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACiB,IAAI,CAAC;MAAEC,OAAO,EAAE,KAAK;MAAEK,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;AAEF6G,MAAM,CAACC,OAAO,GAAGlJ,MAAM","ignoreList":[]}