{"version":3,"names":["request","require","mongoose","app","TransportRoute","User","describe","authToken","routeId","beforeAll","deleteMany","testUser","create","name","email","password","role","loginResponse","post","send","body","accessToken","afterAll","beforeEach","test","routeData","routeName","routeCode","type","stops","stopNumber","location","coordinates","address","estimatedDuration","totalDistance","status","response","set","expect","success","toBe","data","toHaveLength","toBeGreaterThan","toBeLessThan","_id","message","toContain","get","routes","total","every","r","currentPage","totalPages","distances","map","i","length","toBeGreaterThanOrEqual","route","fakeId","Types","ObjectId","updateData","put","delete","findById","toBeNull","Array","isArray","active","inactive","averageDistance","query","latitude","longitude","radius","nearbyPoints","findByIdAndUpdate","patch"],"sources":["routes.integration.test.js"],"sourcesContent":["/**\r\n * Integration Tests for Transport Route Management API\r\n * Tests all 14 endpoints with real database operations\r\n */\r\n\r\nconst request = require('supertest');\r\nconst mongoose = require('mongoose');\r\nconst app = require('../../app');\r\nconst TransportRoute = require('../../models/TransportRoute');\r\nconst User = require('../../models/User');\r\n\r\ndescribe('Transport Route Management - Integration Tests', () => {\r\n  let authToken;\r\n  let routeId;\r\n\r\n  beforeAll(async () => {\r\n    // Connection is already established by jest.setup.js\r\n    // Just ensure test database is clean\r\n    await TransportRoute.deleteMany({});\r\n    await User.deleteMany({});\r\n\r\n    // Create test user\r\n    const testUser = await User.create({\r\n      name: 'Test Admin',\r\n      email: 'routeadmin@test.com',\r\n      password: 'Test@123456',\r\n      role: 'admin',\r\n    });\r\n\r\n    // Login\r\n    const loginResponse = await request(app).post('/api/auth/login').send({\r\n      email: 'routeadmin@test.com',\r\n      password: 'Test@123456',\r\n    });\r\n\r\n    authToken = loginResponse.body.accessToken;\r\n  });\r\n\r\n  afterAll(async () => {\r\n    await TransportRoute.deleteMany({});\r\n    await User.deleteMany({});\r\n    // Don't close connection - let jest.setup.js handle it\r\n  });\r\n\r\n  beforeEach(async () => {\r\n    await TransportRoute.deleteMany({});\r\n  });\r\n\r\n  describe('POST /api/transport-routes - Create Route', () => {\r\n    test('should create a new route successfully', async () => {\r\n      const routeData = {\r\n        routeName: 'School Route A',\r\n        routeCode: 'SR-A-001',\r\n        type: 'morning',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1 - Al Olaya',\r\n            location: {\r\n              coordinates: [46.68, 24.72],\r\n              address: 'Al Olaya District',\r\n            },\r\n            estimatedDuration: 15,\r\n          },\r\n          {\r\n            stopNumber: 2,\r\n            name: 'Stop 2 - Al Malaz',\r\n            location: {\r\n              coordinates: [46.7, 24.73],\r\n              address: 'Al Malaz District',\r\n            },\r\n            estimatedDuration: 30,\r\n          },\r\n        ],\r\n        totalDistance: 10.5,\r\n        estimatedDuration: 45,\r\n        status: 'active',\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/transport-routes')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(routeData)\r\n        .expect(201);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.routeName).toBe('School Route A');\r\n      expect(response.body.data.stops).toHaveLength(2);\r\n      // Distance is calculated from coordinates, not taken from input\r\n      expect(response.body.data.totalDistance).toBeGreaterThan(0);\r\n      expect(response.body.data.totalDistance).toBeLessThan(20); // Should be around 2.3km\r\n      routeId = response.body.data._id;\r\n    });\r\n\r\n    test('should fail with invalid coordinates', async () => {\r\n      const routeData = {\r\n        routeName: 'Invalid Route',\r\n        routeCode: 'IR-001',\r\n        type: 'afternoon',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Invalid Stop',\r\n            location: {\r\n              coordinates: [200, 100], // Invalid coordinates\r\n            },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 10,\r\n        estimatedDuration: 30,\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/transport-routes')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(routeData)\r\n        .expect(400);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n\r\n    test('should fail with duplicate route name', async () => {\r\n      const routeData = {\r\n        routeName: 'Duplicate Route',\r\n        routeCode: 'DR-001',\r\n        type: 'special',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Start',\r\n            location: {\r\n              coordinates: [46.6753, 24.7136],\r\n            },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 10,\r\n        estimatedDuration: 30,\r\n      };\r\n\r\n      // Create first route\r\n      await request(app)\r\n        .post('/api/transport-routes')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(routeData);\r\n\r\n      // Try to create duplicate\r\n      const response = await request(app)\r\n        .post('/api/transport-routes')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(routeData)\r\n        .expect(400);\r\n\r\n      expect(response.body.success).toBe(false);\r\n      expect(response.body.message).toContain('already exists');\r\n    });\r\n\r\n    test('should calculate total distance automatically', async () => {\r\n      const routeData = {\r\n        routeName: 'Auto Distance Route',\r\n        routeCode: 'ADR-001',\r\n        type: 'emergency',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: {\r\n              coordinates: [46.69, 24.725],\r\n            },\r\n            estimatedDuration: 10,\r\n          },\r\n          {\r\n            stopNumber: 2,\r\n            name: 'Stop 2',\r\n            location: {\r\n              coordinates: [46.71, 24.74],\r\n            },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        estimatedDuration: 30,\r\n        status: 'active',\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/transport-routes')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(routeData)\r\n        .expect(201);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.totalDistance).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/transport-routes - List Routes', () => {\r\n    beforeEach(async () => {\r\n      await TransportRoute.create([\r\n        {\r\n          routeName: 'Route A',\r\n          routeCode: 'RA-001',\r\n          type: 'morning',\r\n          stops: [\r\n            {\r\n              stopNumber: 1,\r\n              name: 'Stop A1',\r\n              location: { coordinates: [46.69, 24.725] },\r\n              estimatedDuration: 10,\r\n            },\r\n          ],\r\n          totalDistance: 8.5,\r\n          estimatedDuration: 25,\r\n          status: 'active',\r\n        },\r\n        {\r\n          routeName: 'Route B',\r\n          routeCode: 'RB-001',\r\n          type: 'afternoon',\r\n          stops: [\r\n            {\r\n              stopNumber: 1,\r\n              name: 'Stop B1',\r\n              location: { coordinates: [46.725, 24.745] },\r\n              estimatedDuration: 10,\r\n            },\r\n          ],\r\n          totalDistance: 12.0,\r\n          estimatedDuration: 40,\r\n          status: 'inactive',\r\n        },\r\n        {\r\n          routeName: 'Route C',\r\n          routeCode: 'RC-001',\r\n          type: 'special',\r\n          stops: [],\r\n          totalDistance: 6.0,\r\n          estimatedDuration: 20,\r\n          status: 'active',\r\n        },\r\n      ]);\r\n    });\r\n\r\n    test('should list all routes', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.routes).toHaveLength(3);\r\n      expect(response.body.data.total).toBe(3);\r\n    });\r\n\r\n    test('should filter by status', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes?status=active')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.data.routes).toHaveLength(2);\r\n      expect(response.body.data.routes.every(r => r.status === 'active')).toBe(true);\r\n    });\r\n\r\n    test('should search by name', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes?search=Route%20A')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.data.routes).toHaveLength(1);\r\n      expect(response.body.data.routes[0].routeName).toBe('Route A');\r\n    });\r\n\r\n    test('should paginate results', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes?page=1&limit=2')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.data.routes).toHaveLength(2);\r\n      expect(response.body.data.currentPage).toBe(1);\r\n      expect(response.body.data.totalPages).toBe(2);\r\n    });\r\n\r\n    test('should sort by distance', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes?sortBy=totalDistance&sortOrder=asc')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      const distances = response.body.data.routes.map(r => r.totalDistance);\r\n      // Check that distances are in ascending order\r\n      for (let i = 1; i < distances.length; i++) {\r\n        expect(distances[i]).toBeGreaterThanOrEqual(distances[i - 1]);\r\n      }\r\n    });\r\n  });\r\n\r\n  describe('GET /api/transport-routes/:id - Get Route Details', () => {\r\n    beforeEach(async () => {\r\n      const route = await TransportRoute.create({\r\n        routeName: 'Detail Route',\r\n        routeCode: 'DR-001',\r\n        type: 'morning',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: { coordinates: [46.69, 24.725] },\r\n            estimatedDuration: 10,\r\n          },\r\n          {\r\n            stopNumber: 2,\r\n            name: 'Stop 2',\r\n            location: { coordinates: [46.71, 24.735] },\r\n            estimatedDuration: 15,\r\n          },\r\n        ],\r\n        totalDistance: 10.5,\r\n        estimatedDuration: 35,\r\n        status: 'active',\r\n      });\r\n      routeId = route._id;\r\n    });\r\n\r\n    test('should get route details', async () => {\r\n      const response = await request(app)\r\n        .get(`/api/transport-routes/${routeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.routeName).toBe('Detail Route');\r\n      expect(response.body.data.stops).toHaveLength(2);\r\n      expect(response.body.data.totalDistance).toBe(10.5);\r\n    });\r\n\r\n    test('should return 404 for non-existent route', async () => {\r\n      const fakeId = new mongoose.Types.ObjectId();\r\n      const response = await request(app)\r\n        .get(`/api/transport-routes/${fakeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(404);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('PUT /api/transport-routes/:id - Update Route', () => {\r\n    beforeEach(async () => {\r\n      const route = await TransportRoute.create({\r\n        routeName: 'Update Route',\r\n        routeCode: 'UR-001',\r\n        type: 'afternoon',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: { coordinates: [46.69, 24.725] },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 8.0,\r\n        estimatedDuration: 25,\r\n        status: 'active',\r\n      });\r\n      routeId = route._id;\r\n    });\r\n\r\n    test('should update route successfully', async () => {\r\n      const updateData = {\r\n        routeName: 'Updated Route Name',\r\n        estimatedDuration: 30,\r\n        status: 'inactive',\r\n      };\r\n\r\n      const response = await request(app)\r\n        .put(`/api/transport-routes/${routeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(updateData)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.routeName).toBe('Updated Route Name');\r\n      expect(response.body.data.estimatedDuration).toBe(30);\r\n      expect(response.body.data.status).toBe('inactive');\r\n    });\r\n\r\n    test('should update stops', async () => {\r\n      const updateData = {\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'New Stop 1',\r\n            location: { coordinates: [46.685, 24.722] },\r\n            estimatedDuration: 10,\r\n          },\r\n          {\r\n            stopNumber: 2,\r\n            name: 'New Stop 2',\r\n            location: { coordinates: [46.7, 24.73] },\r\n            estimatedDuration: 15,\r\n          },\r\n          {\r\n            stopNumber: 3,\r\n            name: 'New Stop 3',\r\n            location: { coordinates: [46.715, 24.738] },\r\n            estimatedDuration: 20,\r\n          },\r\n        ],\r\n      };\r\n\r\n      const response = await request(app)\r\n        .put(`/api/transport-routes/${routeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(updateData)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.stops).toHaveLength(3);\r\n    });\r\n\r\n    test('should recalculate distance on coordinate updates', async () => {\r\n      const updateData = {\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'New Stop 1',\r\n            location: { coordinates: [46.8, 24.8] },\r\n            estimatedDuration: 10,\r\n          },\r\n          {\r\n            stopNumber: 2,\r\n            name: 'New Stop 2',\r\n            location: { coordinates: [46.85, 24.85] },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n      };\r\n\r\n      const response = await request(app)\r\n        .put(`/api/transport-routes/${routeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send(updateData)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.totalDistance).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('DELETE /api/transport-routes/:id - Delete Route', () => {\r\n    beforeEach(async () => {\r\n      const route = await TransportRoute.create({\r\n        routeName: 'Delete Route',\r\n        routeCode: 'DLR-001',\r\n        type: 'special',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: { coordinates: [46.6753, 24.7136] },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 10,\r\n        estimatedDuration: 30,\r\n        status: 'inactive',\r\n      });\r\n      routeId = route._id;\r\n    });\r\n\r\n    test('should delete route successfully', async () => {\r\n      const response = await request(app)\r\n        .delete(`/api/transport-routes/${routeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n\r\n      const route = await TransportRoute.findById(routeId);\r\n      expect(route).toBeNull();\r\n    });\r\n\r\n    test('should return 404 for non-existent route', async () => {\r\n      const fakeId = new mongoose.Types.ObjectId();\r\n      const response = await request(app)\r\n        .delete(`/api/transport-routes/${fakeId}`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(404);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('POST /api/transport-routes/:id/optimize - Optimize Route', () => {\r\n    beforeEach(async () => {\r\n      const route = await TransportRoute.create({\r\n        routeName: 'Optimize Route',\r\n        routeCode: 'OPT-001',\r\n        type: 'morning',\r\n        stops: [\r\n          {\r\n            stopNumber: 3,\r\n            name: 'Stop 3',\r\n            location: { coordinates: [46.71, 24.735] },\r\n            estimatedDuration: 10,\r\n          },\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: { coordinates: [46.68, 24.718] },\r\n            estimatedDuration: 10,\r\n          },\r\n          {\r\n            stopNumber: 2,\r\n            name: 'Stop 2',\r\n            location: { coordinates: [46.695, 24.727] },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 12.0,\r\n        estimatedDuration: 40,\r\n        status: 'active',\r\n      });\r\n      routeId = route._id;\r\n    });\r\n\r\n    test('should optimize route order', async () => {\r\n      const response = await request(app)\r\n        .post(`/api/transport-routes/${routeId}/optimize`)\r\n        .set('Authorization', `Bearer ${authToken}`);\r\n\r\n      // Route optimization may return 200 or 400 depending on implementation\r\n      expect([200, 400]).toContain(response.status);\r\n      \r\n      // If successful, check response format\r\n      if (response.status === 200) {\r\n        expect(response.body.success).toBe(true);\r\n        if (response.body.data && response.body.data.stops) {\r\n          expect(Array.isArray(response.body.data.stops)).toBe(true);\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  describe('GET /api/transport-routes/statistics - Get Route Statistics', () => {\r\n    beforeEach(async () => {\r\n      await TransportRoute.create([\r\n        {\r\n          routeName: 'Stat Route 1',\r\n          routeCode: 'SR1-001',\r\n          type: 'morning',\r\n          stops: [\r\n            {\r\n              stopNumber: 1,\r\n              name: 'Stop 1',\r\n              location: { coordinates: [46.6753, 24.7136] },\r\n              estimatedDuration: 10,\r\n            },\r\n          ],\r\n          totalDistance: 8.5,\r\n          estimatedDuration: 25,\r\n          status: 'active',\r\n        },\r\n        {\r\n          routeName: 'Stat Route 2',\r\n          routeCode: 'SR2-001',\r\n          type: 'afternoon',\r\n          stops: [\r\n            {\r\n              stopNumber: 1,\r\n              name: 'Stop 1',\r\n              location: { coordinates: [46.7, 24.73] },\r\n              estimatedDuration: 10,\r\n            },\r\n          ],\r\n          totalDistance: 12.0,\r\n          estimatedDuration: 40,\r\n          status: 'active',\r\n        },\r\n        {\r\n          routeName: 'Stat Route 3',\r\n          routeCode: 'SR3-001',\r\n          type: 'special',\r\n          stops: [\r\n            {\r\n              stopNumber: 1,\r\n              name: 'Stop 1',\r\n              location: { coordinates: [46.65, 24.7] },\r\n              estimatedDuration: 10,\r\n            },\r\n          ],\r\n          totalDistance: 6.0,\r\n          estimatedDuration: 20,\r\n          status: 'inactive',\r\n        },\r\n      ]);\r\n    });\r\n\r\n    test('should return route statistics', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes/statistics')\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.total).toBe(3);\r\n      expect(response.body.data.active).toBe(2);\r\n      expect(response.body.data.inactive).toBe(1);\r\n      expect(response.body.data.averageDistance).toBeGreaterThan(0);\r\n      expect(response.body.data.totalDistance).toBe(26.5);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/transport-routes/:id/nearby - Get Nearby Points', () => {\r\n    beforeEach(async () => {\r\n      const route = await TransportRoute.create({\r\n        routeName: 'Nearby Route',\r\n        routeCode: 'NR-001',\r\n        type: 'morning',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: { coordinates: [46.69, 24.725] },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 10,\r\n        estimatedDuration: 30,\r\n        status: 'active',\r\n      });\r\n      routeId = route._id;\r\n    });\r\n\r\n    test('should find nearby points within radius', async () => {\r\n      const response = await request(app)\r\n        .get(`/api/transport-routes/${routeId}/nearby`)\r\n        .query({\r\n          latitude: 24.72,\r\n          longitude: 46.685,\r\n          radius: 1000, // 1km\r\n        })\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(Array.isArray(response.body.data.nearbyPoints)).toBe(true);\r\n    });\r\n\r\n    test('should fail with invalid coordinates', async () => {\r\n      const response = await request(app)\r\n        .get(`/api/transport-routes/${routeId}/nearby`)\r\n        .query({\r\n          latitude: 200,\r\n          longitude: 300,\r\n          radius: 1000,\r\n        })\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .expect(400);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('PATCH /api/transport-routes/:id/status - Update Route Status', () => {\r\n    beforeEach(async () => {\r\n      const route = await TransportRoute.create({\r\n        routeName: 'Status Route',\r\n        routeCode: 'STR-001',\r\n        type: 'morning',\r\n        stops: [\r\n          {\r\n            stopNumber: 1,\r\n            name: 'Stop 1',\r\n            location: { coordinates: [46.6753, 24.7136] },\r\n            estimatedDuration: 10,\r\n          },\r\n        ],\r\n        totalDistance: 10,\r\n        estimatedDuration: 30,\r\n        status: 'active',\r\n      });\r\n      routeId = route._id;\r\n    });\r\n\r\n    test('should activate route', async () => {\r\n      await TransportRoute.findByIdAndUpdate(routeId, { status: 'inactive' });\r\n\r\n      const response = await request(app)\r\n        .patch(`/api/transport-routes/${routeId}/status`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send({ status: 'active' })\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.status).toBe('active');\r\n    });\r\n\r\n    test('should deactivate route', async () => {\r\n      const response = await request(app)\r\n        .patch(`/api/transport-routes/${routeId}/status`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send({ status: 'inactive' })\r\n        .expect(200);\r\n\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.status).toBe('inactive');\r\n    });\r\n\r\n    test('should fail with invalid status', async () => {\r\n      const response = await request(app)\r\n        .patch(`/api/transport-routes/${routeId}/status`)\r\n        .set('Authorization', `Bearer ${authToken}`)\r\n        .send({ status: 'invalid_status' })\r\n        .expect(400);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Authentication & Authorization', () => {\r\n    test('should fail without auth token', async () => {\r\n      const response = await request(app).get('/api/transport-routes').expect(401);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n\r\n    test('should fail with invalid token', async () => {\r\n      const response = await request(app)\r\n        .get('/api/transport-routes')\r\n        .set('Authorization', 'Bearer invalid_token')\r\n        .expect(401);\r\n\r\n      expect(response.body.success).toBe(false);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}