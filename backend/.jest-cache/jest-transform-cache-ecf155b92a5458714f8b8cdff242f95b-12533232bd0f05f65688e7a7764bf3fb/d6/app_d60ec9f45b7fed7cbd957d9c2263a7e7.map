{"version":3,"names":["express","require","cors","config","app","console","log","safeRequire","filePath","supplyChainRouter","branchIntegrationRoutes","notificationRoutes","errorHandler","cache","limiters","analytics","systemDashboard","use","json","req","res","next","method","path","get","status","timestamp","Date","toISOString","uptime","process","environment","env","NODE_ENV","port","PORT","mongodb","USE_MOCK_DB","success","Math","floor","services","api","database","USE_MOCK_CACHE","moiHealthHandler","service","version","routeStack","_router","stack","moiRoute","find","r","route","e","message","hrEmployeeRouter","hrAttendanceRouter","hrLeaveRouter","hrPayrollRouter","hrPerformanceEvaluationRouter","docsRouter","predictionsRouter","reportsRouter","notificationsRouter","monitoringRouter","supportRouter","integrationsRouter","performanceRouter","authRouter","usersRouter","rbacRouter","rbacAdvancedRouter","mfaRouter","analyticsRouter","cmsRouter","uploadRouter","exportRouter","searchRouter","validateRouter","dashboardRouter","executiveDashboardRouter","beneficiaryPortalRouter","communityRouter","specializedProgramsRouter","advancedSessionsRouter","smartSchedulerRouter","equipmentRouter","qualityRouter","internalAuditRouter","vehiclesRouter","transportRoutesRouter","tripsRouter","realtimeCollaborationRouter","smartNotificationsRouter","advancedAnalyticsRouter","mobileAppRouter","dashboardWidgetRouter","tenantRouter","aiRecommendationsRouter","integrationHubRouter","qiwaRouter","measurementsRouter","moiPassportRouter","migrationRouter","initialize","then","driversRouter","gpsRouter","trafficAccidentsRouter","trafficAccidentAnalyticsRouter","MigrationService","CSVProcessor","migrationManager","post","sourceDB","targetDB","body","error","csvProcessor","logger","plan","getCurrentPlan","summary","getSummary","clear","stats","getStatus","err","router","module","exports"],"sources":["app.js"],"sourcesContent":["const express = require('express');\r\nconst cors = require('cors');\r\nrequire('dotenv').config();\r\n\r\nconst app = express();\r\n\r\nconsole.log('[APP-INIT] Express app created');\r\n\r\n// Safe require function\r\nconst safeRequire = (filePath) => {\r\n  try {\r\n    return require(filePath);\r\n  } catch {\r\n    console.log(`âš ï¸  Router not found: ${filePath}`);\r\n    return null;\r\n  }\r\n};\r\n\r\n// Load all routers safely\r\n// Note: Following routers are temporarily disabled but kept in code for reference\r\n// Routes: performanceEvaluations, aiNotifications, approvalRequests, montessoriAuth,\r\n// montessori, notificationTemplates, fcm, templates, orgBranding, ai, sso.routes\r\nconst supplyChainRouter = safeRequire('./routes/supplyChain.routes');\r\nconst branchIntegrationRoutes = safeRequire('./routes/branch-integration.routes');\r\nconst notificationRoutes = safeRequire('./routes/notificationRoutes'); // ðŸŽ¯ Advanced Notification System\r\n\r\n// Custom middleware\r\nconst errorHandler = require('./middleware/errorHandler');\r\nconst { cache } = require('./config/redis');\r\nconst { limiters } = require('./middleware/rateLimit');\r\nconst analytics = require('./middleware/analytics');\r\nconst systemDashboard = require('./services/systemDashboard');\r\n\r\n// Middleware\r\napp.use(cors());\r\napp.use(express.json());\r\n\r\n// TEMPORARILY DISABLED - Testing if these cause 404 issue\r\n/*\r\n// Register SSO Routes FIRST (before any logging middleware)\r\nif (ssoRouter) {\r\n  app.use('/api/sso', ssoRouter);\r\n  console.log('âœ… SSO Routes loaded and registered on /api/sso');\r\n} else {\r\n  console.log('âš ï¸  SSO Router not loaded');\r\n  // Fallback SSO status endpoint if router failed\r\n  app.get('/api/sso/status', (req, res) => {\r\n    console.log('[FALLBACK] /api/sso/status called');\r\n    res.json({\r\n      success: true,\r\n      status: 'operational (fallback)',\r\n      message: 'SSO system is operational'\r\n    });\r\n  });\r\n  console.log('âœ… Fallback SSO status endpoint registered');\r\n}\r\n\r\n// Test direct route - should work and prove Express is functioning\r\napp.get('/api/test/sso', (req, res) => {\r\n  console.log('[DIRECT] /api/test/sso endpoint hit');\r\n  res.json({\r\n    test: 'direct endpoint in app.js',\r\n    status: 200\r\n  });\r\n});\r\nconsole.log('âœ… Test endpoint /api/test/sso registered');\r\n\r\n// Debug middleware to see what's happening with requests\r\napp.use((req, res, next) => {\r\n  if (req.path.includes('/sso')) {\r\n    console.log(`[DEBUG] Request to ${req.method} ${req.originalUrl}, path: ${req.path}, baseUrl: ${req.baseUrl}`);\r\n  }\r\n  next();\r\n});\r\n\r\n// Then apply middleware\r\napp.use(requestLogger);\r\napp.use(performanceMonitor.middleware());\r\n\r\n// Rate limiting (Skip for SSO)\r\napp.use('/api/', (req, res, next) => {\r\n  // Bypass rate limiting for SSO and health check routes\r\n  if (req.path.startsWith('/sso') || req.path === '/health' || req.path === '/api/health') {\r\n    return next();\r\n  }\r\n  // Skip rate limiting for now - test if it's the source of 404\r\n  // TODO: Fix async middleware issue\r\n  next();\r\n});\r\napp.use('/api/auth/login', limiters.login.middleware);\r\napp.use('/api/auth/register', limiters.login.middleware);\r\n\r\n// Analytics middleware\r\napp.use((req, res, next) => {\r\n  const startTime = Date.now();\r\n\r\n  res.on('finish', () => {\r\n    const duration = Date.now() - startTime;\r\n    analytics.trackRequest(req, res, duration);\r\n  });\r\n\r\n  next();\r\n});\r\nif (performanceEvaluationsRouter) app.use('/api/performance-evaluations', performanceEvaluationsRouter);\r\nif (aiNotificationsRouter) app.use('/api/ai-notifications', aiNotificationsRouter);\r\nif (approvalRequestsRouter) app.use('/api/approval-requests', approvalRequestsRouter);\r\nif (montessoriAuthRouter) app.use('/api/montessori-auth', montessoriAuthRouter);\r\nif (montessoriRouter) app.use('/api/montessori', montessoriRouter);\r\nif (notificationTemplatesRouter) app.use('/api/notification-templates', notificationTemplatesRouter);\r\nif (fcmRouter) app.use('/api/fcm', fcmRouter);\r\nif (templatesRouter) {\r\n  app.use('/api/templates', templatesRouter);\r\n  app.use('/api/templates/attachments', express.static(path.join(__dirname, 'uploads')));\r\n}\r\nif (orgBrandingRouter) app.use('/api/org-branding', orgBrandingRouter);\r\nif (aiRouter) app.use('/api/ai', aiRouter);\r\n*/\r\n\r\n// Supply chain ONLY - for testing\r\nif (supplyChainRouter) {\r\n  // Debug: Log all supply-chain requests\r\n  app.use('/api/supply-chain', (req, res, next) => {\r\n    console.log(`[SUPPLY-CHAIN] ${req.method} ${req.path} - Routing to handler...`);\r\n    next();\r\n  });\r\n  app.use('/api/supply-chain', supplyChainRouter);\r\n  console.log('âœ… Supply Chain Management Routes loaded');\r\n}\r\n\r\n// Health Check\r\napp.get('/health', (req, res) => {\r\n  res.json({\r\n    status: 'healthy',\r\n    timestamp: new Date().toISOString(),\r\n    uptime: process.uptime(),\r\n    environment: process.env.NODE_ENV,\r\n    port: process.env.PORT,\r\n    mongodb: process.env.USE_MOCK_DB === 'true' ? 'mock' : 'connected',\r\n  });\r\n});\r\n\r\n// Enhanced health check\r\napp.get('/api/health', (req, res) => {\r\n  res.json({\r\n    success: true,\r\n    status: 'healthy',\r\n    timestamp: new Date().toISOString(),\r\n    uptime: Math.floor(process.uptime()),\r\n    environment: process.env.NODE_ENV || 'development',\r\n    services: {\r\n      api: 'operational',\r\n      database: process.env.USE_MOCK_DB === 'true' ? 'mock' : 'checking',\r\n      cache: process.env.USE_MOCK_CACHE === 'true' ? 'mock' : 'configured',\r\n    },\r\n  });\r\n});\r\n\r\n// Log middleware\r\napp.use((req, res, next) => {\r\n  console.log(`${new Date().toISOString()} - ${req.method} ${req.path}`);\r\n  next();\r\n});\r\n\r\n// ðŸ‡¸ðŸ‡¦ Direct MOI Passport Route Registration (Placed Early)\r\nconsole.log('[APP-INIT] === Starting MOI route registration ===');\r\n\r\nconst moiHealthHandler = (req, res) => {\r\n  console.log('[MOI-ENDPOINT] /api/moi/health called');\r\n  res.json({\r\n    success: true,\r\n    status: 'healthy',\r\n    service: 'MOI Passport Integration Service',\r\n    version: '3.0.0',\r\n    timestamp: new Date().toISOString(),\r\n  });\r\n};\r\n\r\napp.get('/api/moi/health', moiHealthHandler);\r\nconsole.log('[APP-INIT] MOI health route registered using app.get()');\r\n\r\n// Verify route was added\r\ntry {\r\n  const routeStack = app._router.stack;\r\n  const moiRoute = routeStack.find(r => r.route && r.route.path === '/api/moi/health');\r\n  console.log('[APP-INIT] MOI route in stack:', moiRoute ? 'YES' : 'NO');\r\n} catch (e) {\r\n  console.log('[APP-INIT] Could not verify route:', e.message);\r\n}\r\n\r\nconsole.log('[APP-INIT] === MOI route registration complete ===');\r\n\r\n// API Routes\r\ntry {\r\n  // HR Routers\r\n  const hrEmployeeRouter = safeRequire('./routes/hr/employee');\r\n  const hrAttendanceRouter = safeRequire('./routes/hr/attendance');\r\n  const hrLeaveRouter = safeRequire('./routes/hr/leave');\r\n  const hrPayrollRouter = safeRequire('./routes/hr/payroll');\r\n  const hrPerformanceEvaluationRouter = safeRequire('./routes/hr/performanceEvaluation');\r\n\r\n  // Documentation\r\n  const docsRouter = safeRequire('./routes/docs');\r\n\r\n  // Original Systems\r\n  const predictionsRouter = safeRequire('./routes/predictions');\r\n  const reportsRouter = safeRequire('./routes/reports');\r\n  const notificationsRouter = safeRequire('./routes/notifications');\r\n\r\n  // Advanced Systems (Phase 3)\r\n  const monitoringRouter = safeRequire('./routes/monitoring');\r\n  const supportRouter = safeRequire('./routes/support');\r\n  const integrationsRouter = safeRequire('./routes/integrations');\r\n  const performanceRouter = safeRequire('./routes/performance');\r\n\r\n  // Authentication & User Management (Phase 4)\r\n  const authRouter = safeRequire('./routes/auth');\r\n  const usersRouter = safeRequire('./routes/users');\r\n  console.log('[DEBUG] usersRouter loaded:', usersRouter ? 'SUCCESS' : 'FAILED');\r\n  const rbacRouter = safeRequire('./routes/rbac');\r\n  const rbacAdvancedRouter = safeRequire('./routes/rbac-advanced.routes');\r\n  const mfaRouter = safeRequire('./routes/mfa');\r\n\r\n  // Analytics & CMS (Phase 4)\r\n  const analyticsRouter = safeRequire('./routes/analytics');\r\n  const cmsRouter = safeRequire('./routes/cms');\r\n\r\n  // Phase 8: Advanced Features\r\n  const uploadRouter = safeRequire('./routes/upload');\r\n  const exportRouter = safeRequire('./routes/export');\r\n\r\n  // Phase 10: Advanced Features (Search, Validation, Response)\r\n  const searchRouter = safeRequire('./routes/search');\r\n  const validateRouter = safeRequire('./routes/validate');\r\n\r\n  // Phase 11: System Integration\r\n  const dashboardRouter = safeRequire('./routes/dashboard');\r\n\r\n  // Executive Intelligence Dashboard\r\n  const executiveDashboardRouter = safeRequire('./routes/executive-dashboard');\r\n\r\n  // Beneficiary Portal (Communication & Awareness)\r\n  const beneficiaryPortalRouter = safeRequire('./routes/beneficiaryPortal');\r\n\r\n  // Community Awareness System\r\n  const communityRouter = safeRequire('./routes/community');\r\n\r\n  // Phase 13: Specialized Programs & Sessions\r\n  const specializedProgramsRouter = safeRequire('./routes/specializedPrograms');\r\n  const advancedSessionsRouter = safeRequire('./routes/advancedSessions');\r\n  const smartSchedulerRouter = safeRequire('./routes/smartScheduler');\r\n\r\n  // Phase 14: Equipment Management System\r\n  const equipmentRouter = safeRequire('./routes/equipment');\r\n\r\n  // Phase 15: Quality Management & Accreditations\r\n  const qualityRouter = safeRequire('./routes/quality');\r\n\r\n  // Phase 16: Internal Audit Management System\r\n  const internalAuditRouter = safeRequire('./routes/internalAudit');\r\n\r\n  // Phase 17: Vehicle & Transport Management System\r\n  const vehiclesRouter = safeRequire('./routes/vehicles');\r\n  const transportRoutesRouter = safeRequire('./routes/transportRoutes');\r\n  const tripsRouter = safeRequire('./routes/trips');\r\n\r\n  // Phase 18: Real-Time Collaboration System\r\n  const realtimeCollaborationRouter = safeRequire('./routes/realtimeCollaboration');\r\n\r\n  // Phase 19: Smart Notifications System\r\n  const smartNotificationsRouter = safeRequire('./routes/smartNotifications');\r\n\r\n  // Phase 20: Advanced Analytics & Reporting\r\n  const advancedAnalyticsRouter = safeRequire('./routes/advancedAnalytics');\r\n\r\n  // Phase 21: Mobile App Backend Support\r\n  const mobileAppRouter = safeRequire('./routes/mobileApp');\r\n\r\n  // Phase 22: Custom Dashboard Widget Builder\r\n  const dashboardWidgetRouter = safeRequire('./routes/dashboardWidget');\r\n\r\n  // Phase 24: Multi-Tenant Support\r\n  const tenantRouter = safeRequire('./routes/tenant.routes');\r\n\r\n  // Phase 25: AI Recommendations Engine\r\n  const aiRecommendationsRouter = safeRequire('./routes/ai.recommendations.routes');\r\n\r\n  // Phase 26: Advanced Integrations Hub\r\n  const integrationHubRouter = safeRequire('./routes/integrationHub.routes');\r\n\r\n  // Phase 27: Qiwa (Ministry of Labor) Integration\r\n  const qiwaRouter = safeRequire('./routes/qiwa.routes');\r\n\r\n  // Phase 28: Measurement & Rehabilitation Program System\r\n  const measurementsRouter = safeRequire('./routes/measurements.routes');\r\n\r\n  // ðŸ‡¸ï¿½ MOI Passport Integration System\r\n  console.log('[MOI-DEBUG] Attempting to load MOI Passport routes...');\r\n  const moiPassportRouter = safeRequire('./routes/moi-passport.routes');\r\n  console.log('[MOI-DEBUG] moiPassportRouter loaded:', typeof moiPassportRouter, moiPassportRouter ? 'SUCCESS' : 'FAILED');\r\n\r\n  // Data Migration System\r\n  const migrationRouter = safeRequire('./routes/migrations');\r\n  systemDashboard.initialize().then(success => {\r\n    if (success) {\r\n      console.log('âœ… System Dashboard Initialized');\r\n    }\r\n  });\r\n\r\n  // Register available routes\r\n  // HR API endpoints\r\n  if (hrEmployeeRouter) app.use('/api/hr/employees', hrEmployeeRouter);\r\n  if (hrAttendanceRouter) app.use('/api/hr/attendance', hrAttendanceRouter);\r\n  if (hrLeaveRouter) app.use('/api/hr/leaves', hrLeaveRouter);\r\n  if (hrPayrollRouter) app.use('/api/hr/payroll', hrPayrollRouter);\r\n  if (hrPerformanceEvaluationRouter)\r\n    app.use('/api/hr/performance-evaluations', hrPerformanceEvaluationRouter);\r\n  if (predictionsRouter) app.use('/api/predictions', predictionsRouter);\r\n  if (reportsRouter) app.use('/api/reports', reportsRouter);\r\n  if (notificationsRouter) app.use('/api/notifications', notificationsRouter);\r\n  // ðŸŽ¯ Advanced Notification System (WhatsApp, Templates, Analytics, Rules)\r\n  if (notificationRoutes) {\r\n    app.use('/api/notifications/advanced', notificationRoutes);\r\n    console.log('âœ… Advanced Notification System Routes loaded on /api/notifications/advanced');\r\n  } else {\r\n    console.log('âš ï¸  Advanced Notification System routes not loaded');\r\n  }\r\n  if (monitoringRouter) app.use('/api/monitoring', monitoringRouter);\r\n  if (supportRouter) app.use('/api/support', supportRouter);\r\n  if (integrationsRouter) app.use('/api/integrations', integrationsRouter);\r\n  if (performanceRouter) app.use('/api/performance', performanceRouter);\r\n  if (authRouter) app.use('/api/auth', authRouter);\r\n  if (usersRouter) {\r\n    app.use('/api/users', usersRouter);\r\n    console.log('âœ… Users Routes loaded on /api/users');\r\n  } else {\r\n    console.log('âš ï¸  Users router failed to load');\r\n  }\r\n  if (rbacRouter) app.use('/api/rbac', rbacRouter);\r\n  if (mfaRouter) {\r\n    app.use('/api/mfa', mfaRouter);\r\n    console.log('âœ… MFA Routes loaded');\r\n  }\r\n  if (rbacAdvancedRouter) {\r\n    app.use('/api/rbac-advanced', rbacAdvancedRouter);\r\n    console.log('âœ… Advanced RBAC Routes loaded');\r\n  }\r\n  if (analyticsRouter) app.use('/api/analytics', analyticsRouter);\r\n  if (cmsRouter) app.use('/api/cms', cmsRouter);\r\n  if (uploadRouter) app.use('/api/upload', uploadRouter);\r\n  if (exportRouter) app.use('/api/export', exportRouter);\r\n  if (searchRouter) app.use('/api/search', searchRouter);\r\n  if (validateRouter) app.use('/api/validate', validateRouter);\r\n  if (dashboardRouter) app.use('/api/dashboard', dashboardRouter);\r\n  if (executiveDashboardRouter) app.use('/api/executive-dashboard', executiveDashboardRouter);\r\n  if (beneficiaryPortalRouter) app.use('/api/beneficiary', beneficiaryPortalRouter);\r\n  if (communityRouter) app.use('/api/community', communityRouter);\r\n  if (specializedProgramsRouter) app.use('/api/programs', specializedProgramsRouter);\r\n  if (advancedSessionsRouter) app.use('/api/sessions', advancedSessionsRouter);\r\n  if (smartSchedulerRouter) app.use('/api/scheduler', smartSchedulerRouter);\r\n\r\n  // Equipment routes - all in one file\r\n  if (equipmentRouter) {\r\n    app.use('/api/equipment', equipmentRouter);\r\n    app.use('/api/maintenance-schedules', equipmentRouter);\r\n    app.use('/api/lending', equipmentRouter);\r\n    app.use('/api/faults', equipmentRouter);\r\n    app.use('/api/calibration', equipmentRouter);\r\n    app.use('/api/alerts', equipmentRouter);\r\n  }\r\n\r\n  // Quality Management routes\r\n  if (qualityRouter) {\r\n    app.use('/api/quality/standards', qualityRouter);\r\n    app.use('/api/quality/accreditations', qualityRouter);\r\n    app.use('/api/quality/audits', qualityRouter);\r\n    app.use('/api/quality/compliance', qualityRouter);\r\n    app.use('/api/quality/indicators', qualityRouter);\r\n    app.use('/api/quality/dashboard', qualityRouter);\r\n    app.use('/api/quality/reports', qualityRouter);\r\n  }\r\n\r\n  // Internal Audit Management routes\r\n  if (internalAuditRouter) {\r\n    app.use('/api/internal-audits', internalAuditRouter);\r\n  }\r\n\r\n  // Vehicle & Transport Management routes (Phase 17)\r\n  if (vehiclesRouter) app.use('/api/vehicles', vehiclesRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/vehicles');\r\n\r\n  if (transportRoutesRouter) app.use('/api/transport-routes', transportRoutesRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/transportRoutes');\r\n\r\n  if (tripsRouter) app.use('/api/trips', tripsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/trips');\r\n\r\n  // Driver Management routes (Phase 29 - AI-Powered Driver Management)\r\n  const driversRouter = safeRequire('./routes/drivers');\r\n  if (driversRouter) app.use('/api/drivers', driversRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/drivers');\r\n\r\n  // GPS Tracking routes (Phase 30 - Real-time Tracking)\r\n  const gpsRouter = safeRequire('./routes/gps');\r\n  if (gpsRouter) app.use('/api/gps', gpsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/gps');\r\n\r\n  // Traffic Accident Reporting System (Phase 31 - Comprehensive Accident Management)\r\n  const trafficAccidentsRouter = safeRequire('./routes/trafficAccidents');\r\n  const trafficAccidentAnalyticsRouter = safeRequire('./routes/trafficAccidentAnalytics');\r\n  if (trafficAccidentsRouter) app.use('/api/traffic-accidents', trafficAccidentsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/trafficAccidents');\r\n  if (trafficAccidentAnalyticsRouter) app.use('/api/traffic-accidents/analytics', trafficAccidentAnalyticsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/trafficAccidentAnalytics');\r\n\r\n  // ðŸ‡¸ï¿½ MOI Passport Integration (Phase: Government Integration)\r\n  console.log(`[APP-ROUTES] MOI router value: ${moiPassportRouter ? 'READY' : 'NULL'}`);\r\n  if (moiPassportRouter) {\r\n    console.log('[APP-ROUTES] Registering MOI routes at /api/moi');\r\n    app.use('/api/moi', moiPassportRouter);\r\n    console.log('âœ… MOI Passport Integration routes loaded on /api/moi');\r\n  } else {\r\n    console.log('âš ï¸  MOI Passport Router not found: ./routes/moi-passport.routes');\r\n  }\r\n\r\n  if (uploadRouter) app.use('/api/upload', uploadRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/upload');\r\n\r\n  if (exportRouter) app.use('/api/export', exportRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/export');\r\n\r\n  if (docsRouter) app.use('/api-docs', docsRouter);\r\n  if (docsRouter) app.use('/docs', docsRouter);\r\n\r\n  // Real-Time Collaboration routes (Phase 18)\r\n  if (realtimeCollaborationRouter) app.use('/api/collaboration', realtimeCollaborationRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/realtimeCollaboration');\r\n\r\n  // Smart Notifications routes (Phase 19)\r\n  if (smartNotificationsRouter) app.use('/api/notifications/smart', smartNotificationsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/smartNotifications');\r\n\r\n  // Advanced Analytics routes (Phase 20)\r\n  if (advancedAnalyticsRouter) app.use('/api/analytics', advancedAnalyticsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/advancedAnalytics');\r\n\r\n  // Mobile App Backend routes (Phase 21)\r\n  if (mobileAppRouter) app.use('/api/mobile', mobileAppRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/mobileApp');\r\n\r\n  // Dashboard Widget Builder routes (Phase 22)\r\n  if (dashboardWidgetRouter) app.use('/api/dashboard', dashboardWidgetRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/dashboardWidget');\r\n\r\n  // Multi-Tenant Support routes (Phase 24)\r\n  if (tenantRouter) app.use('/api/tenants', tenantRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/tenant.routes');\r\n\r\n  // AI Recommendations Engine routes (Phase 25)\r\n  if (aiRecommendationsRouter) app.use('/api/ai', aiRecommendationsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/ai.recommendations.routes');\r\n\r\n  // Advanced Integrations Hub routes (Phase 26)\r\n  if (integrationHubRouter) app.use('/api/integrations-hub', integrationHubRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/integrationHub.routes');\r\n\r\n  // Qiwa (Ministry of Labor) Integration routes (Phase 27)\r\n  if (qiwaRouter) app.use('/api/qiwa', qiwaRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/qiwa.routes');\r\n\r\n  // Measurement & Rehabilitation Program System routes (Phase 28)\r\n  if (measurementsRouter) app.use('/api/measurements', measurementsRouter);\r\n  else console.log('âš ï¸  Router not found: ./routes/measurements.routes');\r\n\r\n  // Data Migration System routes\r\n  console.log('[MIGRATION-DEBUG] About to register migrations router...');\r\n  console.log('[MIGRATION-DEBUG] migrationRouter type:', typeof migrationRouter);\r\n  console.log('[MIGRATION-DEBUG] migrationRouter.stack exists:', migrationRouter && migrationRouter.stack ? 'YES' : 'NO');\r\n  if (migrationRouter) {\r\n    console.log('[MIGRATION-DEBUG] Calling app.use for /api/migrations');\r\n    app.use('/api/migrations', migrationRouter);\r\n    console.log('âœ… Migration Routes loaded successfully on /api/migrations');\r\n    console.log('[MIGRATION-DEBUG] Registered successfully');\r\n  } else {\r\n    console.log('âš ï¸  Router not found: ./routes/migrations');\r\n  }\r\n  console.log('[MIGRATION-DEBUG] Migration router registration complete');\r\n\r\n  console.log('âœ… Routes loaded successfully');\r\n\r\n  // === DIRECT MIGRATION ENDPOINTS (Workaround for Router Issue) ===\r\n  // These are added directly to app as a workaround for router mounting issues\r\n  const MigrationService = require('./services/migration/MigrationManager');\r\n  const CSVProcessor = require('./services/migration/CSVProcessor');\r\n  \r\n  let migrationManager = null;\r\n  \r\n  // Direct endpoint: Initialize\r\n  app.post('/api/migrations/initialize', (req, res) => {\r\n    try {\r\n      const { sourceDB, targetDB } = req.body;\r\n      if (!sourceDB || !targetDB) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          error: 'Source and target databases are required',\r\n        });\r\n      }\r\n      migrationManager = new MigrationService({\r\n        sourceDB,\r\n        targetDB,\r\n        csvProcessor: new CSVProcessor(),\r\n        logger: console,\r\n      });\r\n      console.log('[MIGRATION] Manager initialized');\r\n      res.json({\r\n        success: true,\r\n        message: 'Migration manager initialized',\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        error: error.message,\r\n      });\r\n    }\r\n  });\r\n  \r\n  // Direct endpoint: Get/Create Plan\r\n  app.get('/api/migrations/plan', (req, res) => {\r\n    try {\r\n      if (!migrationManager) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          error: 'No migration plan created'\r\n        });\r\n      }\r\n      res.json({\r\n        success: true,\r\n        plan: migrationManager.getCurrentPlan ? migrationManager.getCurrentPlan() : null\r\n      });\r\n    } catch (error) {\r\n      res.status(500).json({\r\n        success: false,\r\n        error: error.message,\r\n      });\r\n    }\r\n  });\r\n  \r\n  console.log('âœ… Direct Migration Endpoints Registered (Workaround)');\r\n\r\n  // Phase 10: Analytics & Optimization endpoints\r\n  app.get('/api/admin/analytics', (req, res) => {\r\n    try {\r\n      const summary = analytics.getSummary();\r\n      res.json(summary);\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  });\r\n\r\n  // Cache management endpoint\r\n  app.post('/api/admin/cache/clear', async (req, res) => {\r\n    try {\r\n      await cache.clear();\r\n      res.json({ message: 'Cache cleared successfully' });\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  });\r\n\r\n  // Cache status endpoint\r\n  app.get('/api/admin/cache/stats', async (req, res) => {\r\n    try {\r\n      const stats = await cache.stats();\r\n      res.json({ stats });\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  });\r\n\r\n  // Rate limit status endpoint\r\n  app.get('/api/admin/ratelimit/status', async (req, res) => {\r\n    try {\r\n      const status = await limiters.api.getStatus(req);\r\n      res.json(status);\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  });\r\n  console.log('   - Enterprise: auth, users, rbac, analytics, cms');\r\n  console.log('   - Phase 8: upload, export');\r\n  console.log('   - Phase 13: programs, sessions, scheduler');\r\n  console.log('   - Phase 29-31: drivers, gps, traffic-accidents');\r\n} catch (err) {\r\n  console.error('âŒ Error loading routes:', err.message);\r\n}\r\n\r\n// Branch-ERP Integration routes (Advanced Branch Management)\r\n// Registered outside try block to ensure it always loads\r\nconsole.log('[INTEGRATION-DEBUG] Starting integration routes registration...');\r\nconsole.log('[INTEGRATION-DEBUG] branchIntegrationRoutes type:', typeof branchIntegrationRoutes);\r\nif (branchIntegrationRoutes) {\r\n  console.log('[INTEGRATION-DEBUG] branchIntegrationRoutes.router type:', typeof branchIntegrationRoutes.router);\r\n}\r\n\r\nif (branchIntegrationRoutes && branchIntegrationRoutes.router) {\r\n  console.log('[INTEGRATION-DEBUG] Registering integration routes...');\r\n  app.use('/api/integration', branchIntegrationRoutes.router);\r\n  console.log('âœ… Branch-ERP Integration routes loaded on /api/integration');\r\n} else {\r\n  console.log('âš ï¸  Branch-ERP Integration router failed to load');\r\n}\r\n\r\n// Test direct integration route\r\napp.get('/api/integration-test', (req, res) => {\r\n  res.json({ message: 'Direct integration test route works' });\r\n});\r\n\r\n// 404 handler\r\napp.use((req, res) => {\r\n  console.log(`[404-DEBUG] Unmatched route: ${req.method} ${req.path}`);\r\n  res.status(404).json({\r\n    error: 'Not Found',\r\n    path: req.path,\r\n    method: req.method,\r\n  });\r\n});\r\n\r\n// Error Handler\r\napp.use(errorHandler);\r\n\r\n// Start scheduled notifications job\r\ntry {\r\n  require('./services/scheduledNotificationsJob')();\r\n  console.log('Scheduled notifications job started.');\r\n} catch (err) {\r\n  console.error('Failed to start scheduled notifications job:', err);\r\n}\r\n\r\nmodule.exports = app;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5BA,OAAO,CAAC,QAAQ,CAAC,CAACE,MAAM,CAAC,CAAC;AAE1B,MAAMC,GAAG,GAAGJ,OAAO,CAAC,CAAC;AAErBK,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;;AAE7C;AACA,MAAMC,WAAW,GAAIC,QAAQ,IAAK;EAChC,IAAI;IACF,OAAOP,OAAO,CAACO,QAAQ,CAAC;EAC1B,CAAC,CAAC,MAAM;IACNH,OAAO,CAACC,GAAG,CAAC,yBAAyBE,QAAQ,EAAE,CAAC;IAChD,OAAO,IAAI;EACb;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA,MAAMC,iBAAiB,GAAGF,WAAW,CAAC,6BAA6B,CAAC;AACpE,MAAMG,uBAAuB,GAAGH,WAAW,CAAC,oCAAoC,CAAC;AACjF,MAAMI,kBAAkB,GAAGJ,WAAW,CAAC,6BAA6B,CAAC,CAAC,CAAC;;AAEvE;AACA,MAAMK,YAAY,GAAGX,OAAO,CAAC,2BAA2B,CAAC;AACzD,MAAM;EAAEY;AAAM,CAAC,GAAGZ,OAAO,CAAC,gBAAgB,CAAC;AAC3C,MAAM;EAAEa;AAAS,CAAC,GAAGb,OAAO,CAAC,wBAAwB,CAAC;AACtD,MAAMc,SAAS,GAAGd,OAAO,CAAC,wBAAwB,CAAC;AACnD,MAAMe,eAAe,GAAGf,OAAO,CAAC,4BAA4B,CAAC;;AAE7D;AACAG,GAAG,CAACa,GAAG,CAACf,IAAI,CAAC,CAAC,CAAC;AACfE,GAAG,CAACa,GAAG,CAACjB,OAAO,CAACkB,IAAI,CAAC,CAAC,CAAC;;AAEvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAIT,iBAAiB,EAAE;EACrB;EACAL,GAAG,CAACa,GAAG,CAAC,mBAAmB,EAAE,CAACE,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IAC/ChB,OAAO,CAACC,GAAG,CAAC,kBAAkBa,GAAG,CAACG,MAAM,IAAIH,GAAG,CAACI,IAAI,0BAA0B,CAAC;IAC/EF,IAAI,CAAC,CAAC;EACR,CAAC,CAAC;EACFjB,GAAG,CAACa,GAAG,CAAC,mBAAmB,EAAER,iBAAiB,CAAC;EAC/CJ,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAC;AACxD;;AAEA;AACAF,GAAG,CAACoB,GAAG,CAAC,SAAS,EAAE,CAACL,GAAG,EAAEC,GAAG,KAAK;EAC/BA,GAAG,CAACF,IAAI,CAAC;IACPO,MAAM,EAAE,SAAS;IACjBC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;IACnCC,MAAM,EAAEC,OAAO,CAACD,MAAM,CAAC,CAAC;IACxBE,WAAW,EAAED,OAAO,CAACE,GAAG,CAACC,QAAQ;IACjCC,IAAI,EAAEJ,OAAO,CAACE,GAAG,CAACG,IAAI;IACtBC,OAAO,EAAEN,OAAO,CAACE,GAAG,CAACK,WAAW,KAAK,MAAM,GAAG,MAAM,GAAG;EACzD,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF;AACAjC,GAAG,CAACoB,GAAG,CAAC,aAAa,EAAE,CAACL,GAAG,EAAEC,GAAG,KAAK;EACnCA,GAAG,CAACF,IAAI,CAAC;IACPoB,OAAO,EAAE,IAAI;IACbb,MAAM,EAAE,SAAS;IACjBC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;IACnCC,MAAM,EAAEU,IAAI,CAACC,KAAK,CAACV,OAAO,CAACD,MAAM,CAAC,CAAC,CAAC;IACpCE,WAAW,EAAED,OAAO,CAACE,GAAG,CAACC,QAAQ,IAAI,aAAa;IAClDQ,QAAQ,EAAE;MACRC,GAAG,EAAE,aAAa;MAClBC,QAAQ,EAAEb,OAAO,CAACE,GAAG,CAACK,WAAW,KAAK,MAAM,GAAG,MAAM,GAAG,UAAU;MAClExB,KAAK,EAAEiB,OAAO,CAACE,GAAG,CAACY,cAAc,KAAK,MAAM,GAAG,MAAM,GAAG;IAC1D;EACF,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF;AACAxC,GAAG,CAACa,GAAG,CAAC,CAACE,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1BhB,OAAO,CAACC,GAAG,CAAC,GAAG,IAAIqB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,MAAMT,GAAG,CAACG,MAAM,IAAIH,GAAG,CAACI,IAAI,EAAE,CAAC;EACtEF,IAAI,CAAC,CAAC;AACR,CAAC,CAAC;;AAEF;AACAhB,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC;AAEjE,MAAMuC,gBAAgB,GAAGA,CAAC1B,GAAG,EAAEC,GAAG,KAAK;EACrCf,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;EACpDc,GAAG,CAACF,IAAI,CAAC;IACPoB,OAAO,EAAE,IAAI;IACbb,MAAM,EAAE,SAAS;IACjBqB,OAAO,EAAE,kCAAkC;IAC3CC,OAAO,EAAE,OAAO;IAChBrB,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;EACpC,CAAC,CAAC;AACJ,CAAC;AAEDxB,GAAG,CAACoB,GAAG,CAAC,iBAAiB,EAAEqB,gBAAgB,CAAC;AAC5CxC,OAAO,CAACC,GAAG,CAAC,wDAAwD,CAAC;;AAErE;AACA,IAAI;EACF,MAAM0C,UAAU,GAAG5C,GAAG,CAAC6C,OAAO,CAACC,KAAK;EACpC,MAAMC,QAAQ,GAAGH,UAAU,CAACI,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,KAAK,IAAID,CAAC,CAACC,KAAK,CAAC/B,IAAI,KAAK,iBAAiB,CAAC;EACpFlB,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAE6C,QAAQ,GAAG,KAAK,GAAG,IAAI,CAAC;AACxE,CAAC,CAAC,OAAOI,CAAC,EAAE;EACVlD,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEiD,CAAC,CAACC,OAAO,CAAC;AAC9D;AAEAnD,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC;;AAEjE;AACA,IAAI;EACF;EACA,MAAMmD,gBAAgB,GAAGlD,WAAW,CAAC,sBAAsB,CAAC;EAC5D,MAAMmD,kBAAkB,GAAGnD,WAAW,CAAC,wBAAwB,CAAC;EAChE,MAAMoD,aAAa,GAAGpD,WAAW,CAAC,mBAAmB,CAAC;EACtD,MAAMqD,eAAe,GAAGrD,WAAW,CAAC,qBAAqB,CAAC;EAC1D,MAAMsD,6BAA6B,GAAGtD,WAAW,CAAC,mCAAmC,CAAC;;EAEtF;EACA,MAAMuD,UAAU,GAAGvD,WAAW,CAAC,eAAe,CAAC;;EAE/C;EACA,MAAMwD,iBAAiB,GAAGxD,WAAW,CAAC,sBAAsB,CAAC;EAC7D,MAAMyD,aAAa,GAAGzD,WAAW,CAAC,kBAAkB,CAAC;EACrD,MAAM0D,mBAAmB,GAAG1D,WAAW,CAAC,wBAAwB,CAAC;;EAEjE;EACA,MAAM2D,gBAAgB,GAAG3D,WAAW,CAAC,qBAAqB,CAAC;EAC3D,MAAM4D,aAAa,GAAG5D,WAAW,CAAC,kBAAkB,CAAC;EACrD,MAAM6D,kBAAkB,GAAG7D,WAAW,CAAC,uBAAuB,CAAC;EAC/D,MAAM8D,iBAAiB,GAAG9D,WAAW,CAAC,sBAAsB,CAAC;;EAE7D;EACA,MAAM+D,UAAU,GAAG/D,WAAW,CAAC,eAAe,CAAC;EAC/C,MAAMgE,WAAW,GAAGhE,WAAW,CAAC,gBAAgB,CAAC;EACjDF,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEiE,WAAW,GAAG,SAAS,GAAG,QAAQ,CAAC;EAC9E,MAAMC,UAAU,GAAGjE,WAAW,CAAC,eAAe,CAAC;EAC/C,MAAMkE,kBAAkB,GAAGlE,WAAW,CAAC,+BAA+B,CAAC;EACvE,MAAMmE,SAAS,GAAGnE,WAAW,CAAC,cAAc,CAAC;;EAE7C;EACA,MAAMoE,eAAe,GAAGpE,WAAW,CAAC,oBAAoB,CAAC;EACzD,MAAMqE,SAAS,GAAGrE,WAAW,CAAC,cAAc,CAAC;;EAE7C;EACA,MAAMsE,YAAY,GAAGtE,WAAW,CAAC,iBAAiB,CAAC;EACnD,MAAMuE,YAAY,GAAGvE,WAAW,CAAC,iBAAiB,CAAC;;EAEnD;EACA,MAAMwE,YAAY,GAAGxE,WAAW,CAAC,iBAAiB,CAAC;EACnD,MAAMyE,cAAc,GAAGzE,WAAW,CAAC,mBAAmB,CAAC;;EAEvD;EACA,MAAM0E,eAAe,GAAG1E,WAAW,CAAC,oBAAoB,CAAC;;EAEzD;EACA,MAAM2E,wBAAwB,GAAG3E,WAAW,CAAC,8BAA8B,CAAC;;EAE5E;EACA,MAAM4E,uBAAuB,GAAG5E,WAAW,CAAC,4BAA4B,CAAC;;EAEzE;EACA,MAAM6E,eAAe,GAAG7E,WAAW,CAAC,oBAAoB,CAAC;;EAEzD;EACA,MAAM8E,yBAAyB,GAAG9E,WAAW,CAAC,8BAA8B,CAAC;EAC7E,MAAM+E,sBAAsB,GAAG/E,WAAW,CAAC,2BAA2B,CAAC;EACvE,MAAMgF,oBAAoB,GAAGhF,WAAW,CAAC,yBAAyB,CAAC;;EAEnE;EACA,MAAMiF,eAAe,GAAGjF,WAAW,CAAC,oBAAoB,CAAC;;EAEzD;EACA,MAAMkF,aAAa,GAAGlF,WAAW,CAAC,kBAAkB,CAAC;;EAErD;EACA,MAAMmF,mBAAmB,GAAGnF,WAAW,CAAC,wBAAwB,CAAC;;EAEjE;EACA,MAAMoF,cAAc,GAAGpF,WAAW,CAAC,mBAAmB,CAAC;EACvD,MAAMqF,qBAAqB,GAAGrF,WAAW,CAAC,0BAA0B,CAAC;EACrE,MAAMsF,WAAW,GAAGtF,WAAW,CAAC,gBAAgB,CAAC;;EAEjD;EACA,MAAMuF,2BAA2B,GAAGvF,WAAW,CAAC,gCAAgC,CAAC;;EAEjF;EACA,MAAMwF,wBAAwB,GAAGxF,WAAW,CAAC,6BAA6B,CAAC;;EAE3E;EACA,MAAMyF,uBAAuB,GAAGzF,WAAW,CAAC,4BAA4B,CAAC;;EAEzE;EACA,MAAM0F,eAAe,GAAG1F,WAAW,CAAC,oBAAoB,CAAC;;EAEzD;EACA,MAAM2F,qBAAqB,GAAG3F,WAAW,CAAC,0BAA0B,CAAC;;EAErE;EACA,MAAM4F,YAAY,GAAG5F,WAAW,CAAC,wBAAwB,CAAC;;EAE1D;EACA,MAAM6F,uBAAuB,GAAG7F,WAAW,CAAC,oCAAoC,CAAC;;EAEjF;EACA,MAAM8F,oBAAoB,GAAG9F,WAAW,CAAC,gCAAgC,CAAC;;EAE1E;EACA,MAAM+F,UAAU,GAAG/F,WAAW,CAAC,sBAAsB,CAAC;;EAEtD;EACA,MAAMgG,kBAAkB,GAAGhG,WAAW,CAAC,8BAA8B,CAAC;;EAEtE;EACAF,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAC;EACpE,MAAMkG,iBAAiB,GAAGjG,WAAW,CAAC,8BAA8B,CAAC;EACrEF,OAAO,CAACC,GAAG,CAAC,uCAAuC,EAAE,OAAOkG,iBAAiB,EAAEA,iBAAiB,GAAG,SAAS,GAAG,QAAQ,CAAC;;EAExH;EACA,MAAMC,eAAe,GAAGlG,WAAW,CAAC,qBAAqB,CAAC;EAC1DS,eAAe,CAAC0F,UAAU,CAAC,CAAC,CAACC,IAAI,CAACrE,OAAO,IAAI;IAC3C,IAAIA,OAAO,EAAE;MACXjC,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;IAC/C;EACF,CAAC,CAAC;;EAEF;EACA;EACA,IAAImD,gBAAgB,EAAErD,GAAG,CAACa,GAAG,CAAC,mBAAmB,EAAEwC,gBAAgB,CAAC;EACpE,IAAIC,kBAAkB,EAAEtD,GAAG,CAACa,GAAG,CAAC,oBAAoB,EAAEyC,kBAAkB,CAAC;EACzE,IAAIC,aAAa,EAAEvD,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAE0C,aAAa,CAAC;EAC3D,IAAIC,eAAe,EAAExD,GAAG,CAACa,GAAG,CAAC,iBAAiB,EAAE2C,eAAe,CAAC;EAChE,IAAIC,6BAA6B,EAC/BzD,GAAG,CAACa,GAAG,CAAC,iCAAiC,EAAE4C,6BAA6B,CAAC;EAC3E,IAAIE,iBAAiB,EAAE3D,GAAG,CAACa,GAAG,CAAC,kBAAkB,EAAE8C,iBAAiB,CAAC;EACrE,IAAIC,aAAa,EAAE5D,GAAG,CAACa,GAAG,CAAC,cAAc,EAAE+C,aAAa,CAAC;EACzD,IAAIC,mBAAmB,EAAE7D,GAAG,CAACa,GAAG,CAAC,oBAAoB,EAAEgD,mBAAmB,CAAC;EAC3E;EACA,IAAItD,kBAAkB,EAAE;IACtBP,GAAG,CAACa,GAAG,CAAC,6BAA6B,EAAEN,kBAAkB,CAAC;IAC1DN,OAAO,CAACC,GAAG,CAAC,6EAA6E,CAAC;EAC5F,CAAC,MAAM;IACLD,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC;EACnE;EACA,IAAI4D,gBAAgB,EAAE9D,GAAG,CAACa,GAAG,CAAC,iBAAiB,EAAEiD,gBAAgB,CAAC;EAClE,IAAIC,aAAa,EAAE/D,GAAG,CAACa,GAAG,CAAC,cAAc,EAAEkD,aAAa,CAAC;EACzD,IAAIC,kBAAkB,EAAEhE,GAAG,CAACa,GAAG,CAAC,mBAAmB,EAAEmD,kBAAkB,CAAC;EACxE,IAAIC,iBAAiB,EAAEjE,GAAG,CAACa,GAAG,CAAC,kBAAkB,EAAEoD,iBAAiB,CAAC;EACrE,IAAIC,UAAU,EAAElE,GAAG,CAACa,GAAG,CAAC,WAAW,EAAEqD,UAAU,CAAC;EAChD,IAAIC,WAAW,EAAE;IACfnE,GAAG,CAACa,GAAG,CAAC,YAAY,EAAEsD,WAAW,CAAC;IAClClE,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC;EACpD,CAAC,MAAM;IACLD,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;EAChD;EACA,IAAIkE,UAAU,EAAEpE,GAAG,CAACa,GAAG,CAAC,WAAW,EAAEuD,UAAU,CAAC;EAChD,IAAIE,SAAS,EAAE;IACbtE,GAAG,CAACa,GAAG,CAAC,UAAU,EAAEyD,SAAS,CAAC;IAC9BrE,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;EACpC;EACA,IAAImE,kBAAkB,EAAE;IACtBrE,GAAG,CAACa,GAAG,CAAC,oBAAoB,EAAEwD,kBAAkB,CAAC;IACjDpE,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;EAC9C;EACA,IAAIqE,eAAe,EAAEvE,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAE0D,eAAe,CAAC;EAC/D,IAAIC,SAAS,EAAExE,GAAG,CAACa,GAAG,CAAC,UAAU,EAAE2D,SAAS,CAAC;EAC7C,IAAIC,YAAY,EAAEzE,GAAG,CAACa,GAAG,CAAC,aAAa,EAAE4D,YAAY,CAAC;EACtD,IAAIC,YAAY,EAAE1E,GAAG,CAACa,GAAG,CAAC,aAAa,EAAE6D,YAAY,CAAC;EACtD,IAAIC,YAAY,EAAE3E,GAAG,CAACa,GAAG,CAAC,aAAa,EAAE8D,YAAY,CAAC;EACtD,IAAIC,cAAc,EAAE5E,GAAG,CAACa,GAAG,CAAC,eAAe,EAAE+D,cAAc,CAAC;EAC5D,IAAIC,eAAe,EAAE7E,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAEgE,eAAe,CAAC;EAC/D,IAAIC,wBAAwB,EAAE9E,GAAG,CAACa,GAAG,CAAC,0BAA0B,EAAEiE,wBAAwB,CAAC;EAC3F,IAAIC,uBAAuB,EAAE/E,GAAG,CAACa,GAAG,CAAC,kBAAkB,EAAEkE,uBAAuB,CAAC;EACjF,IAAIC,eAAe,EAAEhF,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAEmE,eAAe,CAAC;EAC/D,IAAIC,yBAAyB,EAAEjF,GAAG,CAACa,GAAG,CAAC,eAAe,EAAEoE,yBAAyB,CAAC;EAClF,IAAIC,sBAAsB,EAAElF,GAAG,CAACa,GAAG,CAAC,eAAe,EAAEqE,sBAAsB,CAAC;EAC5E,IAAIC,oBAAoB,EAAEnF,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAEsE,oBAAoB,CAAC;;EAEzE;EACA,IAAIC,eAAe,EAAE;IACnBpF,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAEuE,eAAe,CAAC;IAC1CpF,GAAG,CAACa,GAAG,CAAC,4BAA4B,EAAEuE,eAAe,CAAC;IACtDpF,GAAG,CAACa,GAAG,CAAC,cAAc,EAAEuE,eAAe,CAAC;IACxCpF,GAAG,CAACa,GAAG,CAAC,aAAa,EAAEuE,eAAe,CAAC;IACvCpF,GAAG,CAACa,GAAG,CAAC,kBAAkB,EAAEuE,eAAe,CAAC;IAC5CpF,GAAG,CAACa,GAAG,CAAC,aAAa,EAAEuE,eAAe,CAAC;EACzC;;EAEA;EACA,IAAIC,aAAa,EAAE;IACjBrF,GAAG,CAACa,GAAG,CAAC,wBAAwB,EAAEwE,aAAa,CAAC;IAChDrF,GAAG,CAACa,GAAG,CAAC,6BAA6B,EAAEwE,aAAa,CAAC;IACrDrF,GAAG,CAACa,GAAG,CAAC,qBAAqB,EAAEwE,aAAa,CAAC;IAC7CrF,GAAG,CAACa,GAAG,CAAC,yBAAyB,EAAEwE,aAAa,CAAC;IACjDrF,GAAG,CAACa,GAAG,CAAC,yBAAyB,EAAEwE,aAAa,CAAC;IACjDrF,GAAG,CAACa,GAAG,CAAC,wBAAwB,EAAEwE,aAAa,CAAC;IAChDrF,GAAG,CAACa,GAAG,CAAC,sBAAsB,EAAEwE,aAAa,CAAC;EAChD;;EAEA;EACA,IAAIC,mBAAmB,EAAE;IACvBtF,GAAG,CAACa,GAAG,CAAC,sBAAsB,EAAEyE,mBAAmB,CAAC;EACtD;;EAEA;EACA,IAAIC,cAAc,EAAEvF,GAAG,CAACa,GAAG,CAAC,eAAe,EAAE0E,cAAc,CAAC,CAAC,KACxDtF,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAC;EAE3D,IAAIsF,qBAAqB,EAAExF,GAAG,CAACa,GAAG,CAAC,uBAAuB,EAAE2E,qBAAqB,CAAC,CAAC,KAC9EvF,OAAO,CAACC,GAAG,CAAC,gDAAgD,CAAC;EAElE,IAAIuF,WAAW,EAAEzF,GAAG,CAACa,GAAG,CAAC,YAAY,EAAE4E,WAAW,CAAC,CAAC,KAC/CxF,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC;;EAExD;EACA,MAAMsG,aAAa,GAAGrG,WAAW,CAAC,kBAAkB,CAAC;EACrD,IAAIqG,aAAa,EAAExG,GAAG,CAACa,GAAG,CAAC,cAAc,EAAE2F,aAAa,CAAC,CAAC,KACrDvG,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;;EAE1D;EACA,MAAMuG,SAAS,GAAGtG,WAAW,CAAC,cAAc,CAAC;EAC7C,IAAIsG,SAAS,EAAEzG,GAAG,CAACa,GAAG,CAAC,UAAU,EAAE4F,SAAS,CAAC,CAAC,KACzCxG,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC;;EAEtD;EACA,MAAMwG,sBAAsB,GAAGvG,WAAW,CAAC,2BAA2B,CAAC;EACvE,MAAMwG,8BAA8B,GAAGxG,WAAW,CAAC,mCAAmC,CAAC;EACvF,IAAIuG,sBAAsB,EAAE1G,GAAG,CAACa,GAAG,CAAC,wBAAwB,EAAE6F,sBAAsB,CAAC,CAAC,KACjFzG,OAAO,CAACC,GAAG,CAAC,iDAAiD,CAAC;EACnE,IAAIyG,8BAA8B,EAAE3G,GAAG,CAACa,GAAG,CAAC,kCAAkC,EAAE8F,8BAA8B,CAAC,CAAC,KAC3G1G,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC;;EAE3E;EACAD,OAAO,CAACC,GAAG,CAAC,kCAAkCkG,iBAAiB,GAAG,OAAO,GAAG,MAAM,EAAE,CAAC;EACrF,IAAIA,iBAAiB,EAAE;IACrBnG,OAAO,CAACC,GAAG,CAAC,iDAAiD,CAAC;IAC9DF,GAAG,CAACa,GAAG,CAAC,UAAU,EAAEuF,iBAAiB,CAAC;IACtCnG,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;EACrE,CAAC,MAAM;IACLD,OAAO,CAACC,GAAG,CAAC,iEAAiE,CAAC;EAChF;EAEA,IAAIuE,YAAY,EAAEzE,GAAG,CAACa,GAAG,CAAC,aAAa,EAAE4D,YAAY,CAAC,CAAC,KAClDxE,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;EAEzD,IAAIwE,YAAY,EAAE1E,GAAG,CAACa,GAAG,CAAC,aAAa,EAAE6D,YAAY,CAAC,CAAC,KAClDzE,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;EAEzD,IAAIwD,UAAU,EAAE1D,GAAG,CAACa,GAAG,CAAC,WAAW,EAAE6C,UAAU,CAAC;EAChD,IAAIA,UAAU,EAAE1D,GAAG,CAACa,GAAG,CAAC,OAAO,EAAE6C,UAAU,CAAC;;EAE5C;EACA,IAAIgC,2BAA2B,EAAE1F,GAAG,CAACa,GAAG,CAAC,oBAAoB,EAAE6E,2BAA2B,CAAC,CAAC,KACvFzF,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;;EAExE;EACA,IAAIyF,wBAAwB,EAAE3F,GAAG,CAACa,GAAG,CAAC,0BAA0B,EAAE8E,wBAAwB,CAAC,CAAC,KACvF1F,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAC;;EAErE;EACA,IAAI0F,uBAAuB,EAAE5F,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAE+E,uBAAuB,CAAC,CAAC,KAC3E3F,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC;;EAEpE;EACA,IAAI2F,eAAe,EAAE7F,GAAG,CAACa,GAAG,CAAC,aAAa,EAAEgF,eAAe,CAAC,CAAC,KACxD5F,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAC;;EAE5D;EACA,IAAI4F,qBAAqB,EAAE9F,GAAG,CAACa,GAAG,CAAC,gBAAgB,EAAEiF,qBAAqB,CAAC,CAAC,KACvE7F,OAAO,CAACC,GAAG,CAAC,gDAAgD,CAAC;;EAElE;EACA,IAAI6F,YAAY,EAAE/F,GAAG,CAACa,GAAG,CAAC,cAAc,EAAEkF,YAAY,CAAC,CAAC,KACnD9F,OAAO,CAACC,GAAG,CAAC,8CAA8C,CAAC;;EAEhE;EACA,IAAI8F,uBAAuB,EAAEhG,GAAG,CAACa,GAAG,CAAC,SAAS,EAAEmF,uBAAuB,CAAC,CAAC,KACpE/F,OAAO,CAACC,GAAG,CAAC,0DAA0D,CAAC;;EAE5E;EACA,IAAI+F,oBAAoB,EAAEjG,GAAG,CAACa,GAAG,CAAC,uBAAuB,EAAEoF,oBAAoB,CAAC,CAAC,KAC5EhG,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;;EAExE;EACA,IAAIgG,UAAU,EAAElG,GAAG,CAACa,GAAG,CAAC,WAAW,EAAEqF,UAAU,CAAC,CAAC,KAC5CjG,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;;EAE9D;EACA,IAAIiG,kBAAkB,EAAEnG,GAAG,CAACa,GAAG,CAAC,mBAAmB,EAAEsF,kBAAkB,CAAC,CAAC,KACpElG,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC;;EAEtE;EACAD,OAAO,CAACC,GAAG,CAAC,0DAA0D,CAAC;EACvED,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAE,OAAOmG,eAAe,CAAC;EAC9EpG,OAAO,CAACC,GAAG,CAAC,iDAAiD,EAAEmG,eAAe,IAAIA,eAAe,CAACvD,KAAK,GAAG,KAAK,GAAG,IAAI,CAAC;EACvH,IAAIuD,eAAe,EAAE;IACnBpG,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAC;IACpEF,GAAG,CAACa,GAAG,CAAC,iBAAiB,EAAEwF,eAAe,CAAC;IAC3CpG,OAAO,CAACC,GAAG,CAAC,2DAA2D,CAAC;IACxED,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC;EAC1D,CAAC,MAAM;IACLD,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC;EAC1D;EACAD,OAAO,CAACC,GAAG,CAAC,0DAA0D,CAAC;EAEvED,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;;EAE3C;EACA;EACA,MAAM0G,gBAAgB,GAAG/G,OAAO,CAAC,uCAAuC,CAAC;EACzE,MAAMgH,YAAY,GAAGhH,OAAO,CAAC,mCAAmC,CAAC;EAEjE,IAAIiH,gBAAgB,GAAG,IAAI;;EAE3B;EACA9G,GAAG,CAAC+G,IAAI,CAAC,4BAA4B,EAAE,CAAChG,GAAG,EAAEC,GAAG,KAAK;IACnD,IAAI;MACF,MAAM;QAAEgG,QAAQ;QAAEC;MAAS,CAAC,GAAGlG,GAAG,CAACmG,IAAI;MACvC,IAAI,CAACF,QAAQ,IAAI,CAACC,QAAQ,EAAE;QAC1B,OAAOjG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;UAC1BoB,OAAO,EAAE,KAAK;UACdiF,KAAK,EAAE;QACT,CAAC,CAAC;MACJ;MACAL,gBAAgB,GAAG,IAAIF,gBAAgB,CAAC;QACtCI,QAAQ;QACRC,QAAQ;QACRG,YAAY,EAAE,IAAIP,YAAY,CAAC,CAAC;QAChCQ,MAAM,EAAEpH;MACV,CAAC,CAAC;MACFA,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;MAC9Cc,GAAG,CAACF,IAAI,CAAC;QACPoB,OAAO,EAAE,IAAI;QACbkB,OAAO,EAAE;MACX,CAAC,CAAC;IACJ,CAAC,CAAC,OAAO+D,KAAK,EAAE;MACdnG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QACnBoB,OAAO,EAAE,KAAK;QACdiF,KAAK,EAAEA,KAAK,CAAC/D;MACf,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;;EAEF;EACApD,GAAG,CAACoB,GAAG,CAAC,sBAAsB,EAAE,CAACL,GAAG,EAAEC,GAAG,KAAK;IAC5C,IAAI;MACF,IAAI,CAAC8F,gBAAgB,EAAE;QACrB,OAAO9F,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;UAC1BoB,OAAO,EAAE,KAAK;UACdiF,KAAK,EAAE;QACT,CAAC,CAAC;MACJ;MACAnG,GAAG,CAACF,IAAI,CAAC;QACPoB,OAAO,EAAE,IAAI;QACboF,IAAI,EAAER,gBAAgB,CAACS,cAAc,GAAGT,gBAAgB,CAACS,cAAc,CAAC,CAAC,GAAG;MAC9E,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOJ,KAAK,EAAE;MACdnG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QACnBoB,OAAO,EAAE,KAAK;QACdiF,KAAK,EAAEA,KAAK,CAAC/D;MACf,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;EAEFnD,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;;EAEnE;EACAF,GAAG,CAACoB,GAAG,CAAC,sBAAsB,EAAE,CAACL,GAAG,EAAEC,GAAG,KAAK;IAC5C,IAAI;MACF,MAAMwG,OAAO,GAAG7G,SAAS,CAAC8G,UAAU,CAAC,CAAC;MACtCzG,GAAG,CAACF,IAAI,CAAC0G,OAAO,CAAC;IACnB,CAAC,CAAC,OAAOL,KAAK,EAAE;MACdnG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QAAEqG,KAAK,EAAEA,KAAK,CAAC/D;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC,CAAC;;EAEF;EACApD,GAAG,CAAC+G,IAAI,CAAC,wBAAwB,EAAE,OAAOhG,GAAG,EAAEC,GAAG,KAAK;IACrD,IAAI;MACF,MAAMP,KAAK,CAACiH,KAAK,CAAC,CAAC;MACnB1G,GAAG,CAACF,IAAI,CAAC;QAAEsC,OAAO,EAAE;MAA6B,CAAC,CAAC;IACrD,CAAC,CAAC,OAAO+D,KAAK,EAAE;MACdnG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QAAEqG,KAAK,EAAEA,KAAK,CAAC/D;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC,CAAC;;EAEF;EACApD,GAAG,CAACoB,GAAG,CAAC,wBAAwB,EAAE,OAAOL,GAAG,EAAEC,GAAG,KAAK;IACpD,IAAI;MACF,MAAM2G,KAAK,GAAG,MAAMlH,KAAK,CAACkH,KAAK,CAAC,CAAC;MACjC3G,GAAG,CAACF,IAAI,CAAC;QAAE6G;MAAM,CAAC,CAAC;IACrB,CAAC,CAAC,OAAOR,KAAK,EAAE;MACdnG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QAAEqG,KAAK,EAAEA,KAAK,CAAC/D;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC,CAAC;;EAEF;EACApD,GAAG,CAACoB,GAAG,CAAC,6BAA6B,EAAE,OAAOL,GAAG,EAAEC,GAAG,KAAK;IACzD,IAAI;MACF,MAAMK,MAAM,GAAG,MAAMX,QAAQ,CAAC4B,GAAG,CAACsF,SAAS,CAAC7G,GAAG,CAAC;MAChDC,GAAG,CAACF,IAAI,CAACO,MAAM,CAAC;IAClB,CAAC,CAAC,OAAO8F,KAAK,EAAE;MACdnG,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QAAEqG,KAAK,EAAEA,KAAK,CAAC/D;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC,CAAC;EACFnD,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC;EACjED,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;EAC3CD,OAAO,CAACC,GAAG,CAAC,8CAA8C,CAAC;EAC3DD,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAC;AAClE,CAAC,CAAC,OAAO2H,GAAG,EAAE;EACZ5H,OAAO,CAACkH,KAAK,CAAC,yBAAyB,EAAEU,GAAG,CAACzE,OAAO,CAAC;AACvD;;AAEA;AACA;AACAnD,OAAO,CAACC,GAAG,CAAC,iEAAiE,CAAC;AAC9ED,OAAO,CAACC,GAAG,CAAC,mDAAmD,EAAE,OAAOI,uBAAuB,CAAC;AAChG,IAAIA,uBAAuB,EAAE;EAC3BL,OAAO,CAACC,GAAG,CAAC,0DAA0D,EAAE,OAAOI,uBAAuB,CAACwH,MAAM,CAAC;AAChH;AAEA,IAAIxH,uBAAuB,IAAIA,uBAAuB,CAACwH,MAAM,EAAE;EAC7D7H,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAC;EACpEF,GAAG,CAACa,GAAG,CAAC,kBAAkB,EAAEP,uBAAuB,CAACwH,MAAM,CAAC;EAC3D7H,OAAO,CAACC,GAAG,CAAC,4DAA4D,CAAC;AAC3E,CAAC,MAAM;EACLD,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC;AACjE;;AAEA;AACAF,GAAG,CAACoB,GAAG,CAAC,uBAAuB,EAAE,CAACL,GAAG,EAAEC,GAAG,KAAK;EAC7CA,GAAG,CAACF,IAAI,CAAC;IAAEsC,OAAO,EAAE;EAAsC,CAAC,CAAC;AAC9D,CAAC,CAAC;;AAEF;AACApD,GAAG,CAACa,GAAG,CAAC,CAACE,GAAG,EAAEC,GAAG,KAAK;EACpBf,OAAO,CAACC,GAAG,CAAC,gCAAgCa,GAAG,CAACG,MAAM,IAAIH,GAAG,CAACI,IAAI,EAAE,CAAC;EACrEH,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;IACnBqG,KAAK,EAAE,WAAW;IAClBhG,IAAI,EAAEJ,GAAG,CAACI,IAAI;IACdD,MAAM,EAAEH,GAAG,CAACG;EACd,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF;AACAlB,GAAG,CAACa,GAAG,CAACL,YAAY,CAAC;;AAErB;AACA,IAAI;EACFX,OAAO,CAAC,sCAAsC,CAAC,CAAC,CAAC;EACjDI,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC;AACrD,CAAC,CAAC,OAAO2H,GAAG,EAAE;EACZ5H,OAAO,CAACkH,KAAK,CAAC,8CAA8C,EAAEU,GAAG,CAAC;AACpE;AAEAE,MAAM,CAACC,OAAO,GAAGhI,GAAG","ignoreList":[]}