{"version":3,"names":["mongoose","require","virtualSessionSchema","Schema","title","type","String","required","trim","description","sessionType","enum","default","targetDisabilityCategory","instructor","Types","ObjectId","ref","coInstructors","scheduledDate","Date","duration","Number","maxParticipants","currentParticipants","meetingLink","password","platform","language","accessibilityServices","arabicSignLanguageInterpreter","Boolean","liveSubtitles","arabicSubtitles","englishSubtitles","audioDescription","largeFont","recordingAvailable","agenda","time","topic","materials","name","url","registrations","userId","registrationDate","now","status","speakers","bio","imageUrl","recordingUrl","feedback","rating","min","max","comment","date","statistics","registeredCount","attendedCount","noShowCount","averageRating","timestamps","toJSON","virtuals","toObject","index","createdAt","virtual","get","diff","Math","ceil","statics","getUpcomingSessions","limit","find","$gte","$in","sort","populate","getByCategory","category","module","exports","model"],"sources":["VirtualSession.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst virtualSessionSchema = new mongoose.Schema(\r\n  {\r\n    title: {\r\n      type: String,\r\n      required: [true, 'عنوان الجلسة مطلوب'],\r\n      trim: true,\r\n    },\r\n    description: {\r\n      type: String,\r\n      required: [true, 'وصف الجلسة مطلوب'],\r\n    },\r\n    sessionType: {\r\n      type: String,\r\n      enum: ['workshop', 'webinar', 'training', 'consultation', 'discussion_group'],\r\n      default: 'webinar',\r\n      required: true,\r\n    },\r\n    targetDisabilityCategory: {\r\n      type: String,\r\n      enum: ['visual', 'hearing', 'mobility', 'intellectual', 'psychosocial', 'multiple', 'all'],\r\n      default: 'all',\r\n    },\r\n    instructor: {\r\n      type: mongoose.Schema.Types.ObjectId,\r\n      ref: 'User',\r\n      required: true,\r\n    },\r\n    coInstructors: [\r\n      {\r\n        type: mongoose.Schema.Types.ObjectId,\r\n        ref: 'User',\r\n      },\r\n    ],\r\n    scheduledDate: {\r\n      type: Date,\r\n      required: [true, 'تاريخ الجلسة مطلوب'],\r\n    },\r\n    duration: {\r\n      type: Number,\r\n      required: [true, 'مدة الجلسة مطلوبة'],\r\n      description: 'المدة بالدقائق',\r\n    },\r\n    maxParticipants: {\r\n      type: Number,\r\n      default: 100,\r\n    },\r\n    currentParticipants: {\r\n      type: Number,\r\n      default: 0,\r\n    },\r\n    meetingLink: {\r\n      type: String,\r\n      required: [true, 'رابط الاجتماع مطلوب'],\r\n    },\r\n    password: String,\r\n    platform: {\r\n      type: String,\r\n      enum: ['zoom', 'teams', 'jitsi', 'google_meet', 'youtube_live'],\r\n      default: 'zoom',\r\n    },\r\n    language: {\r\n      type: String,\r\n      default: 'ar',\r\n      enum: ['ar', 'en', 'fr'],\r\n    },\r\n    accessibilityServices: {\r\n      arabicSignLanguageInterpreter: Boolean,\r\n      liveSubtitles: Boolean,\r\n      arabicSubtitles: Boolean,\r\n      englishSubtitles: Boolean,\r\n      audioDescription: Boolean,\r\n      largeFont: Boolean,\r\n      recordingAvailable: {\r\n        type: Boolean,\r\n        default: false,\r\n      },\r\n    },\r\n    agenda: [\r\n      {\r\n        time: String,\r\n        topic: String,\r\n        duration: Number,\r\n      },\r\n    ],\r\n    materials: [\r\n      {\r\n        name: String,\r\n        url: String,\r\n        description: String,\r\n      },\r\n    ],\r\n    registrations: [\r\n      {\r\n        userId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'User',\r\n        },\r\n        registrationDate: {\r\n          type: Date,\r\n          default: Date.now,\r\n        },\r\n        status: {\r\n          type: String,\r\n          enum: ['registered', 'attended', 'no_show', 'cancelled'],\r\n          default: 'registered',\r\n        },\r\n      },\r\n    ],\r\n    speakers: [\r\n      {\r\n        name: String,\r\n        title: String,\r\n        bio: String,\r\n        imageUrl: String,\r\n      },\r\n    ],\r\n    status: {\r\n      type: String,\r\n      enum: ['draft', 'scheduled', 'ongoing', 'completed', 'cancelled'],\r\n      default: 'draft',\r\n    },\r\n    recordingUrl: String,\r\n    feedback: [\r\n      {\r\n        userId: {\r\n          type: mongoose.Schema.Types.ObjectId,\r\n          ref: 'User',\r\n        },\r\n        rating: {\r\n          type: Number,\r\n          min: 1,\r\n          max: 5,\r\n        },\r\n        comment: String,\r\n        date: {\r\n          type: Date,\r\n          default: Date.now,\r\n        },\r\n      },\r\n    ],\r\n    statistics: {\r\n      registeredCount: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      attendedCount: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      noShowCount: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      averageRating: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n    toJSON: { virtuals: true },\r\n    toObject: { virtuals: true },\r\n  }\r\n);\r\n\r\n// Indexes\r\nvirtualSessionSchema.index({ scheduledDate: 1, status: 1 });\r\nvirtualSessionSchema.index({ instructor: 1 });\r\nvirtualSessionSchema.index({ targetDisabilityCategory: 1 });\r\nvirtualSessionSchema.index({ createdAt: -1 });\r\n\r\n// Virtual for is full\r\nvirtualSessionSchema.virtual('isFull').get(function () {\r\n  return this.currentParticipants >= this.maxParticipants;\r\n});\r\n\r\n// Virtual for days until session\r\nvirtualSessionSchema.virtual('daysUntilSession').get(function () {\r\n  const now = new Date();\r\n  const diff = this.scheduledDate - now;\r\n  return Math.ceil(diff / (1000 * 60 * 60 * 24));\r\n});\r\n\r\n// Static method to get upcoming sessions\r\nvirtualSessionSchema.statics.getUpcomingSessions = function (limit = 10) {\r\n  const now = new Date();\r\n  return this.find({\r\n    scheduledDate: { $gte: now },\r\n    status: { $in: ['scheduled', 'draft'] },\r\n  })\r\n    .sort({ scheduledDate: 1 })\r\n    .limit(limit)\r\n    .populate('instructor', 'name email');\r\n};\r\n\r\n// Static method to get sessions by category\r\nvirtualSessionSchema.statics.getByCategory = function (category) {\r\n  return this.find({\r\n    targetDisabilityCategory: { $in: [category, 'all'] },\r\n    status: { $in: ['scheduled', 'completed'] },\r\n  })\r\n    .sort({ scheduledDate: -1 })\r\n    .populate('instructor', 'name email');\r\n};\r\n\r\nmodule.exports = mongoose.model('VirtualSession', virtualSessionSchema);\r\n"],"mappings":"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","ignoreList":[]}