{"version":3,"names":["speakeasy","require","QRCode","crypto","nodemailer","MFAService","constructor","otpExpiration","backupCodesCount","generateTOTPSecret","userEmail","appName","secret","generateSecret","name","issuer","length","qrCode","toDataURL","otpauth_url","base32","manualEntryKey","error","Error","message","verifyTOTP","token","window","isValid","totp","verify","encodingType","generateEmailOTP","otp","randomInt","toString","expiresAt","Date","now","code","expiresIn","generateSMSOTP","verifyOTP","providedCode","storedCode","timingSafeEqual","Buffer","from","_error","generateBackupCodes","count","codes","i","randomBytes","toUpperCase","push","slice","hashBackupCode","createHash","update","digest","verifyBackupCode","hashedCode","hash","generateRecoveryKey","createMFASession","userId","method","metadata","sessionId","attempts","maxAttempts","validateMFASession","session","attemptsRemaining","generateTrustedDeviceToken","deviceFingerprint","createdAt","getMFASetupGuide","description","steps","advantages","email","sms","calculateSecurityScore","mfaMethods","score","maxScore","backupCodes","Math","min","createAuditLog","action","status","timestamp","ipAddress","userAgent","deviceInfo","module","exports"],"sources":["mfaService.js"],"sourcesContent":["/**\r\n * Multi-Factor Authentication Service\r\n * تطوير نظام المصادقة متعددة العوامل\r\n * \r\n * Supports: TOTP (Google Authenticator), Email OTP, SMS OTP, Backup Codes\r\n */\r\n\r\nconst speakeasy = require('speakeasy');\r\nconst QRCode = require('qrcode');\r\nconst crypto = require('crypto');\r\nconst nodemailer = require('nodemailer');\r\n\r\nclass MFAService {\r\n  constructor() {\r\n    this.otpExpiration = 5 * 60 * 1000; // 5 minutes\r\n    this.backupCodesCount = 10;\r\n  }\r\n\r\n  /**\r\n   * Generate TOTP Secret and QR Code\r\n   * إنشاء رمز TOTP وكود QR\r\n   */\r\n  async generateTOTPSecret(userEmail, appName = 'ERP System') {\r\n    try {\r\n      const secret = speakeasy.generateSecret({\r\n        name: `${appName} (${userEmail})`,\r\n        issuer: appName,\r\n        length: 32,\r\n      });\r\n\r\n      // Generate QR Code\r\n      const qrCode = await QRCode.toDataURL(secret.otpauth_url);\r\n\r\n      return {\r\n        secret: secret.base32,\r\n        qrCode,\r\n        otpauth_url: secret.otpauth_url,\r\n        manualEntryKey: secret.base32,\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`Failed to generate TOTP secret: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Verify TOTP Token\r\n   * التحقق من رمز TOTP\r\n   */\r\n  verifyTOTP(token, secret, window = 2) {\r\n    try {\r\n      const isValid = speakeasy.totp.verify({\r\n        secret,\r\n        encodingType: 'base32',\r\n        token,\r\n        window, // Allow 30 seconds before and after\r\n      });\r\n\r\n      return isValid;\r\n    } catch (error) {\r\n      throw new Error(`Failed to verify TOTP token: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate Email OTP\r\n   * توليد رمز OTP عبر البريد الإلكتروني\r\n   */\r\n  generateEmailOTP() {\r\n    const otp = crypto.randomInt(100000, 999999).toString();\r\n    const expiresAt = new Date(Date.now() + this.otpExpiration);\r\n\r\n    return {\r\n      code: otp,\r\n      expiresAt,\r\n      expiresIn: this.otpExpiration / 1000, // seconds\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate SMS OTP\r\n   * توليد رمز OTP عبر الرسائل النصية\r\n   */\r\n  generateSMSOTP() {\r\n    const otp = crypto.randomInt(100000, 999999).toString();\r\n    const expiresAt = new Date(Date.now() + this.otpExpiration);\r\n\r\n    return {\r\n      code: otp,\r\n      expiresAt,\r\n      expiresIn: this.otpExpiration / 1000,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Verify OTP Code\r\n   * التحقق من رمز OTP\r\n   */\r\n  verifyOTP(providedCode, storedCode, expiresAt) {\r\n    try {\r\n      // Check if OTP has expired\r\n      if (new Date() > new Date(expiresAt)) {\r\n        return {\r\n          isValid: false,\r\n          message: 'OTP has expired',\r\n          error: 'EXPIRED',\r\n        };\r\n      }\r\n\r\n      // Check if code matches (constant time comparison)\r\n      const isValid = crypto.timingSafeEqual(\r\n        Buffer.from(providedCode.toString()),\r\n        Buffer.from(storedCode.toString())\r\n      );\r\n\r\n      return {\r\n        isValid,\r\n        message: isValid ? 'OTP verified successfully' : 'Invalid OTP',\r\n        error: isValid ? null : 'INVALID_OTP',\r\n      };\r\n    } catch (_error) {\r\n      return {\r\n        isValid: false,\r\n        message: 'OTP verification failed',\r\n        error: 'VERIFICATION_FAILED',\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate Backup Codes\r\n   * توليد أكواد احتياطية\r\n   */\r\n  generateBackupCodes(count = this.backupCodesCount) {\r\n    const codes = [];\r\n    for (let i = 0; i < count; i++) {\r\n      const code = crypto.randomBytes(4).toString('hex').toUpperCase();\r\n      codes.push(`${code.slice(0, 4)}-${code.slice(4)}`);\r\n    }\r\n    return codes;\r\n  }\r\n\r\n  /**\r\n   * Hash Backup Code (for storage)\r\n   * تشفير رمز احتياطي للتخزين\r\n   */\r\n  hashBackupCode(code) {\r\n    return crypto.createHash('sha256').update(code).digest('hex');\r\n  }\r\n\r\n  /**\r\n   * Verify Backup Code\r\n   * التحقق من الرمز الاحتياطي\r\n   */\r\n  verifyBackupCode(providedCode, hashedCode) {\r\n    const hash = crypto.createHash('sha256').update(providedCode).digest('hex');\r\n    return crypto.timingSafeEqual(\r\n      Buffer.from(hash),\r\n      Buffer.from(hashedCode)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Generate MFA Recovery Key\r\n   * إنشاء مفتاح استرجاع MFA\r\n   */\r\n  generateRecoveryKey() {\r\n    return crypto.randomBytes(16).toString('hex').toUpperCase();\r\n  }\r\n\r\n  /**\r\n   * Create MFA Session\r\n   * إنشاء جلسة MFA\r\n   */\r\n  createMFASession(userId, method = 'totp', metadata = {}) {\r\n    const sessionId = crypto.randomBytes(16).toString('hex');\r\n    const expiresAt = new Date(Date.now() + 15 * 60 * 1000); // 15 minutes\r\n\r\n    return {\r\n      sessionId,\r\n      userId,\r\n      method,\r\n      expiresAt,\r\n      attempts: 0,\r\n      maxAttempts: 5,\r\n      metadata,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Validate MFA Session\r\n   * التحقق من جلسة MFA\r\n   */\r\n  validateMFASession(session) {\r\n    if (!session) {\r\n      return {\r\n        isValid: false,\r\n        message: 'MFA session not found',\r\n      };\r\n    }\r\n\r\n    if (new Date() > new Date(session.expiresAt)) {\r\n      return {\r\n        isValid: false,\r\n        message: 'MFA session has expired',\r\n      };\r\n    }\r\n\r\n    if (session.attempts >= session.maxAttempts) {\r\n      return {\r\n        isValid: false,\r\n        message: 'Maximum verification attempts exceeded',\r\n      };\r\n    }\r\n\r\n    return {\r\n      isValid: true,\r\n      message: 'MFA session is valid',\r\n      attemptsRemaining: session.maxAttempts - session.attempts,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate Trusted Device Token\r\n   * إنشاء رمز جهاز موثوق\r\n   */\r\n  generateTrustedDeviceToken(userId, deviceFingerprint) {\r\n    const token = crypto\r\n      .createHash('sha256')\r\n      .update(`${userId}:${deviceFingerprint}:${Date.now()}`)\r\n      .digest('hex');\r\n\r\n    return {\r\n      token,\r\n      createdAt: new Date(),\r\n      expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get MFA Setup Guide\r\n   * الحصول على دليل إعداد MFA\r\n   */\r\n  getMFASetupGuide() {\r\n    return {\r\n      totp: {\r\n        name: 'Time-based One-Time Password (TOTP)',\r\n        description: 'Use an authenticator app like Google Authenticator or Authy',\r\n        steps: [\r\n          'Download an authenticator app (Google Authenticator, Microsoft Authenticator, or Authy)',\r\n          'Scan the QR code displayed on the setup page',\r\n          'Enter the 6-digit code from your authenticator app',\r\n          'Save your backup codes in a safe place',\r\n        ],\r\n        advantages: [\r\n          'Works offline',\r\n          'No need for SMS or email',\r\n          'Widely supported',\r\n        ],\r\n      },\r\n      email: {\r\n        name: 'Email One-Time Password',\r\n        description: 'Receive a code via email for verification',\r\n        steps: [\r\n          'When logging in, you will receive a 6-digit code via email',\r\n          'Enter the code in the verification prompt',\r\n          'The code expires after 5 minutes',\r\n        ],\r\n        advantages: [\r\n          'No additional app needed',\r\n          'Works on any device',\r\n        ],\r\n      },\r\n      sms: {\r\n        name: 'SMS One-Time Password',\r\n        description: 'Receive a code via text message for verification',\r\n        steps: [\r\n          'When logging in, you will receive a 6-digit code via SMS',\r\n          'Enter the code in the verification prompt',\r\n          'The code expires after 5 minutes',\r\n        ],\r\n        advantages: [\r\n          'Works on any phone',\r\n          'Fast delivery',\r\n        ],\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Calculate Security Score\r\n   * حساب درجة الأمان\r\n   */\r\n  calculateSecurityScore(mfaMethods) {\r\n    let score = 0;\r\n    const maxScore = 100;\r\n\r\n    if (mfaMethods.totp) score += 40;\r\n    if (mfaMethods.email) score += 30;\r\n    if (mfaMethods.sms) score += 20;\r\n    if (mfaMethods.backupCodes && mfaMethods.backupCodes.length > 0) score += 10;\r\n\r\n    return Math.min(score, maxScore);\r\n  }\r\n\r\n  /**\r\n   * Generate MFA Audit Log\r\n   * إنشاء سجل تدقيق MFA\r\n   */\r\n  createAuditLog(userId, action, status, metadata = {}) {\r\n    return {\r\n      userId,\r\n      action,\r\n      status,\r\n      timestamp: new Date(),\r\n      ipAddress: metadata.ipAddress || null,\r\n      userAgent: metadata.userAgent || null,\r\n      deviceInfo: metadata.deviceInfo || null,\r\n    };\r\n  }\r\n}\r\n\r\nmodule.exports = new MFAService();\r\n"],"mappings":"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","ignoreList":[]}