{"version":3,"names":["express","require","router","Router","TripController","protect","authorize","post","createTrip","get","getAllTrips","getActiveTrips","getTodayTrips","listTripStatistics","getTripById","put","updateTrip","delete","deleteTrip","cancelTrip","patch","updatePassengers","startTrip","completeTrip","updateGPS","arriveAtStop","departFromStop","addIncident","calculateDriverScore","analyzeBehavior","addFeedback","getTripStatistics","generateDriverReport","module","exports"],"sources":["trips.js"],"sourcesContent":["/**\r\n * Trip Routes - مسارات API للرحلات\r\n */\r\n\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst TripController = require('../controllers/trip.controller');\r\nconst { protect, authorize } = require('../middleware/auth');\r\n\r\n// ========== مسارات عامة ==========\r\n\r\n/**\r\n * @route   POST /api/trips\r\n * @desc    إنشاء رحلة جديدة\r\n * @access  Private (Admin, Manager, Driver)\r\n */\r\nrouter.post('/', protect, authorize('admin', 'manager', 'driver'), TripController.createTrip);\r\n\r\n/**\r\n * @route   GET /api/trips\r\n * @desc    جلب جميع الرحلات\r\n * @access  Private\r\n */\r\nrouter.get('/', protect, TripController.getAllTrips);\r\n\r\n/**\r\n * @route   GET /api/trips/active\r\n * @desc    جلب الرحلات النشطة\r\n * @access  Private\r\n */\r\nrouter.get('/active', protect, TripController.getActiveTrips);\r\n\r\n/**\r\n * @route   GET /api/trips/today\r\n * @desc    جلب رحلات اليوم\r\n * @access  Private\r\n */\r\nrouter.get('/today', protect, TripController.getTodayTrips);\r\n\r\n/**\r\n * @route   GET /api/trips/statistics\r\n * @desc    جلب إحصائيات الرحلات\r\n * @access  Private\r\n */\r\nrouter.get('/statistics', protect, TripController.listTripStatistics);\r\n\r\n/**\r\n * @route   GET /api/trips/:id\r\n * @desc    جلب رحلة بواسطة ID\r\n * @access  Private\r\n */\r\nrouter.get('/:id', protect, TripController.getTripById);\r\n\r\n/**\r\n * @route   PUT /api/trips/:id\r\n * @desc    تحديث رحلة\r\n * @access  Private (Admin, Manager, Driver)\r\n */\r\nrouter.put('/:id', protect, authorize('admin', 'manager', 'driver'), TripController.updateTrip);\r\n\r\n/**\r\n * @route   DELETE /api/trips/:id\r\n * @desc    حذف رحلة\r\n * @access  Private (Admin, Manager, Driver)\r\n */\r\nrouter.delete('/:id', protect, authorize('admin', 'manager', 'driver'), TripController.deleteTrip);\r\n\r\n/**\r\n * @route   POST /api/trips/:id/cancel\r\n * @desc    إلغاء رحلة\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/:id/cancel',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.cancelTrip\r\n);\r\n\r\n/**\r\n * @route   PATCH /api/trips/:id/passengers\r\n * @desc    تحديث عدد الركاب\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.patch(\r\n  '/:id/passengers',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.updatePassengers\r\n);\r\n\r\n// ========== مسارات التحكم في الرحلة ==========\r\n\r\n/**\r\n * @route   POST /api/trips/:id/start\r\n * @desc    بدء رحلة\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/:id/start',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.startTrip\r\n);\r\n\r\n/**\r\n * @route   POST /api/trips/:id/complete\r\n * @desc    إنهاء رحلة\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/:id/complete',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.completeTrip\r\n);\r\n\r\n// ========== مسارات GPS ==========\r\n\r\n/**\r\n * @route   POST /api/trips/:id/gps\r\n * @desc    تحديث موقع GPS للرحلة\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post('/:id/gps', protect, authorize('driver', 'manager', 'admin'), TripController.updateGPS);\r\n\r\n// ========== مسارات المحطات ==========\r\n\r\n/**\r\n * @route   POST /api/trips/:id/arrive-stop\r\n * @desc    تسجيل الوصول لمحطة\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/:id/arrive-stop',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.arriveAtStop\r\n);\r\n\r\n/**\r\n * @route   POST /api/trips/:id/depart-stop\r\n * @desc    تسجيل المغادرة من محطة\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/:id/depart-stop',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.departFromStop\r\n);\r\n\r\n// ========== مسارات الحوادث ==========\r\n\r\n/**\r\n * @route   POST /api/trips/:id/incident\r\n * @desc    إضافة حادث\r\n * @access  Private (Driver, Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/:id/incident',\r\n  protect,\r\n  authorize('driver', 'manager', 'admin'),\r\n  TripController.addIncident\r\n);\r\n\r\n// ========== مسارات التحليل والتقييم ==========\r\n\r\n/**\r\n * @route   GET /api/trips/:id/driver-score\r\n * @desc    حساب تقييم سلوك السائق\r\n * @access  Private (Manager, Admin)\r\n */\r\nrouter.get(\r\n  '/:id/driver-score',\r\n  protect,\r\n  authorize('manager', 'admin'),\r\n  TripController.calculateDriverScore\r\n);\r\n\r\n/**\r\n * @route   GET /api/trips/:id/behavior-analysis\r\n * @desc    تحليل سلوك السائق\r\n * @access  Private (Manager, Admin)\r\n */\r\nrouter.get(\r\n  '/:id/behavior-analysis',\r\n  protect,\r\n  authorize('manager', 'admin'),\r\n  TripController.analyzeBehavior\r\n);\r\n\r\n/**\r\n * @route   POST /api/trips/:id/feedback\r\n * @desc    إضافة تقييم للرحلة\r\n * @access  Private\r\n */\r\nrouter.post('/:id/feedback', protect, TripController.addFeedback);\r\n\r\n// ========== مسارات الإحصائيات والتقارير ==========\r\n\r\n/**\r\n * @route   GET /api/trips/:id/statistics\r\n * @desc    جلب إحصائيات الرحلة\r\n * @access  Private\r\n */\r\nrouter.get('/:id/statistics', protect, TripController.getTripStatistics);\r\n\r\n/**\r\n * @route   POST /api/trips/driver-report\r\n * @desc    إنشاء تقرير سلوك السائق\r\n * @access  Private (Manager, Admin)\r\n */\r\nrouter.post(\r\n  '/driver-report',\r\n  protect,\r\n  authorize('manager', 'admin'),\r\n  TripController.generateDriverReport\r\n);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}