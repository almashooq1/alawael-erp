{"version":3,"names":["express","require","tenantController","authenticateToken","router","Router","post","get","put","delete","module","exports"],"sources":["tenant.routes.js"],"sourcesContent":["/**\r\n * Tenant Routes\r\n * مسارات الالتزام\r\n * \r\n * API Routes for multi-tenant support\r\n * مسارات API لدعم متعدد الالتزام\r\n */\r\n\r\nconst express = require('express');\r\nconst tenantController = require('../controllers/tenant.controller');\r\nconst { authenticateToken } = require('../middleware/auth');\r\n\r\nconst router = express.Router();\r\n\r\n// ==================== PUBLIC ROUTES ====================\r\n\r\n/**\r\n * POST /api/tenants\r\n * Create new tenant\r\n * \r\n * Required body:\r\n * {\r\n *   \"name\": \"Company Name\",\r\n *   \"email\": \"admin@company.com\",\r\n *   \"planType\": \"starter|professional|enterprise\",\r\n *   \"slug\": \"company-slug\",\r\n *   \"subdomain\": \"company\",\r\n *   \"timezone\": \"UTC\",\r\n *   \"language\": \"ar\"\r\n * }\r\n * \r\n * Response:\r\n * {\r\n *   \"success\": true,\r\n *   \"data\": { tenant object }\r\n * }\r\n */\r\nrouter.post('/', tenantController.post('/'));\r\n\r\n// ==================== PROTECTED ROUTES ====================\r\n\r\n/**\r\n * GET /api/tenants\r\n * Get all tenants\r\n * Query params: status, planType, search, limit, offset\r\n * Auth: Required\r\n */\r\nrouter.get('/', authenticateToken, tenantController.get('/'));\r\n\r\n/**\r\n * GET /api/tenants/:tenantId\r\n * Get single tenant\r\n * Auth: Required\r\n */\r\nrouter.get('/:tenantId', authenticateToken, tenantController.get('/:tenantId'));\r\n\r\n/**\r\n * PUT /api/tenants/:tenantId\r\n * Update tenant\r\n * \r\n * Body:\r\n * {\r\n *   \"name\": \"New Name\",\r\n *   \"email\": \"newemail@company.com\",\r\n *   \"subdomain\": \"new-subdomain\",\r\n *   \"metadata\": { custom properties }\r\n * }\r\n * \r\n * Auth: Required (Owner or Admin)\r\n */\r\nrouter.put('/:tenantId', authenticateToken, tenantController.put('/:tenantId'));\r\n\r\n/**\r\n * DELETE /api/tenants/:tenantId\r\n * Delete tenant (soft delete to archive)\r\n * Auth: Required (Owner or Admin)\r\n */\r\nrouter.delete('/:tenantId', authenticateToken, tenantController.delete('/:tenantId'));\r\n\r\n/**\r\n * POST /api/tenants/:tenantId/suspend\r\n * Suspend tenant\r\n * \r\n * Body:\r\n * {\r\n *   \"reason\": \"Suspension reason\"\r\n * }\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/:tenantId/suspend', authenticateToken, tenantController.post('/:tenantId/suspend'));\r\n\r\n/**\r\n * POST /api/tenants/:tenantId/reactivate\r\n * Reactivate suspended tenant\r\n * Auth: Required (Admin)\r\n */\r\nrouter.post('/:tenantId/reactivate', authenticateToken, tenantController.post('/:tenantId/reactivate'));\r\n\r\n// ==================== USER MANAGEMENT ====================\r\n\r\n/**\r\n * POST /api/tenants/:tenantId/users\r\n * Add user to tenant\r\n * \r\n * Body:\r\n * {\r\n *   \"userId\": \"user-id\",\r\n *   \"role\": \"owner|admin|manager|member|viewer\"\r\n * }\r\n * \r\n * Auth: Required (Manager or Admin)\r\n */\r\nrouter.post('/:tenantId/users', authenticateToken, tenantController.post('/:tenantId/users'));\r\n\r\n/**\r\n * GET /api/tenants/:tenantId/users\r\n * Get all users in tenant\r\n * Auth: Required (Member or higher)\r\n */\r\nrouter.get('/:tenantId/users', authenticateToken, tenantController.get('/:tenantId/users'));\r\n\r\n/**\r\n * DELETE /api/tenants/:tenantId/users/:userId\r\n * Remove user from tenant\r\n * Auth: Required (Manager or Admin)\r\n */\r\nrouter.delete('/:tenantId/users/:userId', authenticateToken, tenantController.delete('/:tenantId/users/:userId'));\r\n\r\n// ==================== SETTINGS ====================\r\n\r\n/**\r\n * GET /api/tenants/:tenantId/settings\r\n * Get tenant settings\r\n * Auth: Required (Owner or Admin)\r\n */\r\nrouter.get('/:tenantId/settings', authenticateToken, tenantController.get('/:tenantId/settings'));\r\n\r\n/**\r\n * PUT /api/tenants/:tenantId/settings\r\n * Update tenant settings\r\n * \r\n * Body can include:\r\n * {\r\n *   \"brandingColor\": \"#FF5733\",\r\n *   \"logo\": \"logo-url\",\r\n *   \"emailFrom\": \"noreply@company.com\",\r\n *   \"twoFactorRequired\": true,\r\n *   \"sessionTimeout\": 3600,\r\n *   \"dataRetention\": 365,\r\n *   ...\r\n * }\r\n * \r\n * Auth: Required (Owner or Admin)\r\n */\r\nrouter.put('/:tenantId/settings', authenticateToken, tenantController.put('/:tenantId/settings'));\r\n\r\n// ==================== QUOTAS & USAGE ====================\r\n\r\n/**\r\n * GET /api/tenants/:tenantId/quota\r\n * Get current quota usage\r\n * \r\n * Response example:\r\n * {\r\n *   \"maxUsers\": 10,\r\n *   \"usedUsers\": 5,\r\n *   \"maxStorage\": 10,\r\n *   \"usedStorage\": 3.5,\r\n *   \"maxApiCalls\": 10000,\r\n *   \"usedApiCalls\": 2345\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.get('/:tenantId/quota', authenticateToken, tenantController.get('/:tenantId/quota'));\r\n\r\n/**\r\n * POST /api/tenants/:tenantId/api-calls\r\n * Record API call for quota tracking\r\n * Auth: Required\r\n */\r\nrouter.post('/:tenantId/api-calls', tenantController.post('/:tenantId/api-calls'));\r\n\r\n/**\r\n * POST /api/tenants/:tenantId/storage\r\n * Record storage usage\r\n * \r\n * Body:\r\n * {\r\n *   \"sizeGB\": 1.5\r\n * }\r\n * \r\n * Auth: Required\r\n */\r\nrouter.post('/:tenantId/storage', authenticateToken, tenantController.post('/:tenantId/storage'));\r\n\r\n// ==================== PLANS ====================\r\n\r\n/**\r\n * POST /api/tenants/:tenantId/upgrade\r\n * Upgrade tenant plan\r\n * \r\n * Body:\r\n * {\r\n *   \"newPlan\": \"professional\" or \"enterprise\"\r\n * }\r\n * \r\n * Auth: Required (Owner or Admin)\r\n */\r\nrouter.post('/:tenantId/upgrade', authenticateToken, tenantController.post('/:tenantId/upgrade'));\r\n\r\n// ==================== DATA ISOLATION ====================\r\n\r\n/**\r\n * GET /api/tenants/:tenantId/isolation\r\n * Get tenant isolation report\r\n * \r\n * Response:\r\n * {\r\n *   \"tenantId\": \"tenant-123\",\r\n *   \"totalItems\": 150,\r\n *   \"breakdown\": {\r\n *     \"users\": 5,\r\n *     \"resources\": 20,\r\n *     \"documents\": 125\r\n *   }\r\n * }\r\n * \r\n * Auth: Required (Admin)\r\n */\r\nrouter.get('/:tenantId/isolation', authenticateToken, tenantController.get('/:tenantId/isolation'));\r\n\r\n// ==================== STATISTICS ====================\r\n\r\n/**\r\n * GET /api/tenants/stats/all\r\n * Get all tenant statistics\r\n * \r\n * Response:\r\n * {\r\n *   \"tenants\": { total, active, suspended, ... },\r\n *   \"isolation\": { violations, unauthorized, ... }\r\n * }\r\n * \r\n * Auth: Required (Super Admin)\r\n */\r\nrouter.get('/stats/all', authenticateToken, tenantController.get('/stats/all'));\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]}