c78d4a33e79d8d062bca3019cd7a24b6
/**
 * Migration Manager
 * Orchestrates the entire data migration process
 */

const CSVProcessor = require('./CSVProcessor');
const DatabaseMigration = require('./DatabaseMigration');
class MigrationManager {
  constructor(config = {}) {
    this.config = {
      sourceDB: config.sourceDB,
      targetDB: config.targetDB,
      csvProcessor: config.csvProcessor || new CSVProcessor(),
      logger: config.logger || console,
      ...config
    };
    this.csvProcessor = this.config.csvProcessor;
    this.dbMigration = new DatabaseMigration(this.config.sourceDB, this.config.targetDB, this.config.logger);
    this.migrationPlan = null;
    this.executionLog = [];
    this.stats = {
      startTime: null,
      endTime: null,
      duration: 0,
      totalTables: 0,
      completedTables: 0,
      failedTables: 0,
      totalRecords: 0
    };
  }

  /**
   * Create migration plan
   */
  createMigrationPlan(tables, options = {}) {
    this.migrationPlan = {
      tables,
      options,
      createdAt: new Date().toISOString(),
      steps: this.generateMigrationSteps(tables, options)
    };
    this.config.logger.info(`Migration plan created with ${tables.length} tables`);
    return this.migrationPlan;
  }

  /**
   * Generate migration steps
   */
  generateMigrationSteps(tables, options = {}) {
    const steps = [];
    if (options.preValidation) {
      steps.push({
        id: 'pre_validation',
        name: 'Pre-migration Validation',
        type: 'validation',
        tables
      });
    }
    steps.push({
      id: 'backup',
      name: 'Create Database Backup',
      type: 'backup',
      timestamp: true
    });
    for (const table of tables) {
      steps.push({
        id: `migrate_${table}`,
        name: `Migrate ${table}`,
        type: 'migration',
        table,
        transform: options.transforms?.[table],
        skipDuplicates: options.skipDuplicates
      });
    }
    if (options.postValidation) {
      steps.push({
        id: 'post_validation',
        name: 'Post-migration Verification',
        type: 'verification',
        tables
      });
    }
    if (options.postCleanup) {
      steps.push({
        id: 'post_cleanup',
        name: 'Cleanup Source Data',
        type: 'cleanup'
      });
    }
    return steps;
  }

  /**
   * Execute migration plan
   */
  async executeMigrationPlan(options = {}) {
    if (!this.migrationPlan) {
      throw new Error('No migration plan created. Call createMigrationPlan first.');
    }
    this.stats.startTime = Date.now();
    const steps = this.migrationPlan.steps;
    const results = [];
    this.config.logger.info('Starting migration execution');
    for (const step of steps) {
      try {
        this.config.logger.info(`Executing step: ${step.name}`);
        let result;
        switch (step.type) {
          case 'validation':
            result = await this.executeValidation(step);
            break;
          case 'backup':
            result = await this.executeBackup(step);
            break;
          case 'migration':
            result = await this.executeMigrationStep(step);
            break;
          case 'verification':
            result = await this.executeVerification(step);
            break;
          case 'cleanup':
            result = await this.executeCleanup(step);
            break;
          default:
            throw new Error(`Unknown step type: ${step.type}`);
        }
        results.push(result);
        this.executionLog.push(result);

        // Check if step failed and stop on error
        if (result.status === 'failed' && !options.continueOnError) {
          throw new Error(`Step failed: ${step.name}`);
        }
      } catch (error) {
        this.config.logger.error(`Step execution failed: ${error.message}`);
        results.push({
          step: step.id,
          status: 'failed',
          error: error.message
        });
        if (!options.continueOnError) {
          break;
        }
      }
    }
    this.stats.endTime = Date.now();
    this.stats.duration = this.stats.endTime - this.stats.startTime;
    return this.getExecutionSummary();
  }

  /**
   * Execute validation step
   */
  async executeValidation(step) {
    const startTime = Date.now();
    try {
      const validationResults = [];
      for (const table of step.tables) {
        const result = await this.dbMigration.verifyMigration(table);
        validationResults.push(result);
      }
      return {
        step: step.id,
        name: step.name,
        status: 'completed',
        duration: Date.now() - startTime,
        validations: validationResults
      };
    } catch (error) {
      return {
        step: step.id,
        name: step.name,
        status: 'failed',
        duration: Date.now() - startTime,
        error: error.message
      };
    }
  }

  /**
   * Execute backup step
   */
  async executeBackup(step) {
    const startTime = Date.now();
    try {
      this.config.logger.info('Creating database backup...');
      // Implement actual backup logic here
      // For now, we'll just log the backup
      const backupFile = `backup_${Date.now()}.sql`;
      return {
        step: step.id,
        name: step.name,
        status: 'completed',
        duration: Date.now() - startTime,
        backupFile
      };
    } catch (error) {
      return {
        step: step.id,
        name: step.name,
        status: 'failed',
        duration: Date.now() - startTime,
        error: error.message
      };
    }
  }

  /**
   * Execute migration step for a table
   */
  async executeMigrationStep(step) {
    const startTime = Date.now();
    try {
      let result;
      if (step.transform) {
        result = await this.dbMigration.migrateTableWithTransform(step.table, step.transform, {
          skipDuplicates: step.skipDuplicates
        });
      } else {
        result = await this.dbMigration.migrateTable(step.table, {
          skipDuplicates: step.skipDuplicates
        });
      }
      this.stats.completedTables++;
      this.stats.totalRecords += result.recordsMigrated || 0;
      return {
        step: step.id,
        name: step.name,
        status: result.status,
        duration: Date.now() - startTime,
        recordsMigrated: result.recordsMigrated,
        table: step.table
      };
    } catch (error) {
      this.stats.failedTables++;
      return {
        step: step.id,
        name: step.name,
        status: 'failed',
        duration: Date.now() - startTime,
        error: error.message,
        table: step.table
      };
    }
  }

  /**
   * Execute verification step
   */
  async executeVerification(step) {
    const startTime = Date.now();
    try {
      const verifications = await this.dbMigration.verifyAllMigrations(step.tables);
      const allMatch = verifications.every(v => v.match === true);
      return {
        step: step.id,
        name: step.name,
        status: allMatch ? 'completed' : 'warning',
        duration: Date.now() - startTime,
        verifications
      };
    } catch (error) {
      return {
        step: step.id,
        name: step.name,
        status: 'failed',
        duration: Date.now() - startTime,
        error: error.message
      };
    }
  }

  /**
   * Execute cleanup step
   */
  async executeCleanup(step) {
    const startTime = Date.now();
    try {
      this.config.logger.info('Executing post-migration cleanup...');
      // Implement cleanup logic here

      return {
        step: step.id,
        name: step.name,
        status: 'completed',
        duration: Date.now() - startTime
      };
    } catch (error) {
      return {
        step: step.id,
        name: step.name,
        status: 'failed',
        duration: Date.now() - startTime,
        error: error.message
      };
    }
  }

  /**
   * Import CSV and migrate to target
   */
  async migrateFromCSV(csvPath, tableName, options = {}) {
    const startTime = Date.now();
    try {
      this.config.logger.info(`Starting CSV import from ${csvPath}`);

      // Import CSV
      const csvData = await this.csvProcessor.importCSV(csvPath, {
        columns: true,
        ...options.csvOptions
      });
      if (!csvData.success) {
        throw new Error(`CSV import failed: ${csvData.errors.length} errors`);
      }
      this.config.logger.info(`Imported ${csvData.recordCount} records from CSV`);

      // Transform if needed
      let data = csvData.data;
      if (options.transform) {
        data = this.csvProcessor.transformData(data, options.transform);
      }

      // Insert into target database
      await this.dbMigration.insertBatch(tableName, data, options);
      return {
        status: 'completed',
        csvFile: csvPath,
        tableName,
        recordsMigrated: data.length,
        duration: Date.now() - startTime
      };
    } catch (error) {
      return {
        status: 'failed',
        csvFile: csvPath,
        tableName,
        error: error.message,
        duration: Date.now() - startTime
      };
    }
  }

  /**
   * Export table to CSV
   */
  async exportTableToCSV(tableName, csvPath, options = {}) {
    const startTime = Date.now();
    try {
      this.config.logger.info(`Exporting table ${tableName} to CSV`);

      // Query all data
      const data = await this.config.sourceDB.query(`SELECT * FROM ${tableName}`);

      // Export to CSV
      const result = await this.csvProcessor.exportToCSV(data, csvPath, options);
      return {
        status: 'completed',
        table: tableName,
        csvFile: csvPath,
        recordsExported: result.recordCount,
        fileSize: result.fileSize,
        duration: Date.now() - startTime
      };
    } catch (error) {
      return {
        status: 'failed',
        table: tableName,
        csvFile: csvPath,
        error: error.message,
        duration: Date.now() - startTime
      };
    }
  }

  /**
   * Get execution summary
   */
  getExecutionSummary() {
    const failedSteps = this.executionLog.filter(log => log.status === 'failed');
    const warningSteps = this.executionLog.filter(log => log.status === 'warning');
    const totalDuration = this.executionLog.reduce((sum, log) => sum + (log.duration || 0), 0);
    return {
      stats: {
        ...this.stats,
        totalDuration
      },
      summary: {
        totalSteps: this.executionLog.length,
        completedSteps: this.executionLog.length - failedSteps.length - warningSteps.length,
        failedSteps: failedSteps.length,
        warningSteps: warningSteps.length,
        overallStatus: failedSteps.length > 0 ? 'failed' : 'success'
      },
      executionLog: this.executionLog
    };
  }

  /**
   * Get execution log
   */
  getExecutionLog() {
    return this.executionLog;
  }

  /**
   * Clear execution log
   */
  clearLog() {
    this.executionLog = [];
    return this;
  }

  /**
   * Pause migration
   */
  pauseMigration() {
    this.config.logger.info('Migration paused');
    return {
      status: 'paused',
      timestamp: new Date().toISOString()
    };
  }

  /**
   * Resume migration
   */
  resumeMigration() {
    this.config.logger.info('Migration resumed');
    return {
      status: 'resumed',
      timestamp: new Date().toISOString()
    };
  }
}
module.exports = MigrationManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDU1ZQcm9jZXNzb3IiLCJyZXF1aXJlIiwiRGF0YWJhc2VNaWdyYXRpb24iLCJNaWdyYXRpb25NYW5hZ2VyIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJzb3VyY2VEQiIsInRhcmdldERCIiwiY3N2UHJvY2Vzc29yIiwibG9nZ2VyIiwiY29uc29sZSIsImRiTWlncmF0aW9uIiwibWlncmF0aW9uUGxhbiIsImV4ZWN1dGlvbkxvZyIsInN0YXRzIiwic3RhcnRUaW1lIiwiZW5kVGltZSIsImR1cmF0aW9uIiwidG90YWxUYWJsZXMiLCJjb21wbGV0ZWRUYWJsZXMiLCJmYWlsZWRUYWJsZXMiLCJ0b3RhbFJlY29yZHMiLCJjcmVhdGVNaWdyYXRpb25QbGFuIiwidGFibGVzIiwib3B0aW9ucyIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInN0ZXBzIiwiZ2VuZXJhdGVNaWdyYXRpb25TdGVwcyIsImluZm8iLCJsZW5ndGgiLCJwcmVWYWxpZGF0aW9uIiwicHVzaCIsImlkIiwibmFtZSIsInR5cGUiLCJ0aW1lc3RhbXAiLCJ0YWJsZSIsInRyYW5zZm9ybSIsInRyYW5zZm9ybXMiLCJza2lwRHVwbGljYXRlcyIsInBvc3RWYWxpZGF0aW9uIiwicG9zdENsZWFudXAiLCJleGVjdXRlTWlncmF0aW9uUGxhbiIsIkVycm9yIiwibm93IiwicmVzdWx0cyIsInN0ZXAiLCJyZXN1bHQiLCJleGVjdXRlVmFsaWRhdGlvbiIsImV4ZWN1dGVCYWNrdXAiLCJleGVjdXRlTWlncmF0aW9uU3RlcCIsImV4ZWN1dGVWZXJpZmljYXRpb24iLCJleGVjdXRlQ2xlYW51cCIsInN0YXR1cyIsImNvbnRpbnVlT25FcnJvciIsImVycm9yIiwibWVzc2FnZSIsImdldEV4ZWN1dGlvblN1bW1hcnkiLCJ2YWxpZGF0aW9uUmVzdWx0cyIsInZlcmlmeU1pZ3JhdGlvbiIsInZhbGlkYXRpb25zIiwiYmFja3VwRmlsZSIsIm1pZ3JhdGVUYWJsZVdpdGhUcmFuc2Zvcm0iLCJtaWdyYXRlVGFibGUiLCJyZWNvcmRzTWlncmF0ZWQiLCJ2ZXJpZmljYXRpb25zIiwidmVyaWZ5QWxsTWlncmF0aW9ucyIsImFsbE1hdGNoIiwiZXZlcnkiLCJ2IiwibWF0Y2giLCJtaWdyYXRlRnJvbUNTViIsImNzdlBhdGgiLCJ0YWJsZU5hbWUiLCJjc3ZEYXRhIiwiaW1wb3J0Q1NWIiwiY29sdW1ucyIsImNzdk9wdGlvbnMiLCJzdWNjZXNzIiwiZXJyb3JzIiwicmVjb3JkQ291bnQiLCJkYXRhIiwidHJhbnNmb3JtRGF0YSIsImluc2VydEJhdGNoIiwiY3N2RmlsZSIsImV4cG9ydFRhYmxlVG9DU1YiLCJxdWVyeSIsImV4cG9ydFRvQ1NWIiwicmVjb3Jkc0V4cG9ydGVkIiwiZmlsZVNpemUiLCJmYWlsZWRTdGVwcyIsImZpbHRlciIsImxvZyIsIndhcm5pbmdTdGVwcyIsInRvdGFsRHVyYXRpb24iLCJyZWR1Y2UiLCJzdW0iLCJzdW1tYXJ5IiwidG90YWxTdGVwcyIsImNvbXBsZXRlZFN0ZXBzIiwib3ZlcmFsbFN0YXR1cyIsImdldEV4ZWN1dGlvbkxvZyIsImNsZWFyTG9nIiwicGF1c2VNaWdyYXRpb24iLCJyZXN1bWVNaWdyYXRpb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiTWlncmF0aW9uTWFuYWdlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTWlncmF0aW9uIE1hbmFnZXJcclxuICogT3JjaGVzdHJhdGVzIHRoZSBlbnRpcmUgZGF0YSBtaWdyYXRpb24gcHJvY2Vzc1xyXG4gKi9cclxuXHJcbmNvbnN0IENTVlByb2Nlc3NvciA9IHJlcXVpcmUoJy4vQ1NWUHJvY2Vzc29yJyk7XHJcbmNvbnN0IERhdGFiYXNlTWlncmF0aW9uID0gcmVxdWlyZSgnLi9EYXRhYmFzZU1pZ3JhdGlvbicpO1xyXG5cclxuY2xhc3MgTWlncmF0aW9uTWFuYWdlciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnID0ge30pIHtcclxuICAgIHRoaXMuY29uZmlnID0ge1xyXG4gICAgICBzb3VyY2VEQjogY29uZmlnLnNvdXJjZURCLFxyXG4gICAgICB0YXJnZXREQjogY29uZmlnLnRhcmdldERCLFxyXG4gICAgICBjc3ZQcm9jZXNzb3I6IGNvbmZpZy5jc3ZQcm9jZXNzb3IgfHwgbmV3IENTVlByb2Nlc3NvcigpLFxyXG4gICAgICBsb2dnZXI6IGNvbmZpZy5sb2dnZXIgfHwgY29uc29sZSxcclxuICAgICAgLi4uY29uZmlnLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmNzdlByb2Nlc3NvciA9IHRoaXMuY29uZmlnLmNzdlByb2Nlc3NvcjtcclxuICAgIHRoaXMuZGJNaWdyYXRpb24gPSBuZXcgRGF0YWJhc2VNaWdyYXRpb24oXHJcbiAgICAgIHRoaXMuY29uZmlnLnNvdXJjZURCLFxyXG4gICAgICB0aGlzLmNvbmZpZy50YXJnZXREQixcclxuICAgICAgdGhpcy5jb25maWcubG9nZ2VyLFxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLm1pZ3JhdGlvblBsYW4gPSBudWxsO1xyXG4gICAgdGhpcy5leGVjdXRpb25Mb2cgPSBbXTtcclxuICAgIHRoaXMuc3RhdHMgPSB7XHJcbiAgICAgIHN0YXJ0VGltZTogbnVsbCxcclxuICAgICAgZW5kVGltZTogbnVsbCxcclxuICAgICAgZHVyYXRpb246IDAsXHJcbiAgICAgIHRvdGFsVGFibGVzOiAwLFxyXG4gICAgICBjb21wbGV0ZWRUYWJsZXM6IDAsXHJcbiAgICAgIGZhaWxlZFRhYmxlczogMCxcclxuICAgICAgdG90YWxSZWNvcmRzOiAwLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBtaWdyYXRpb24gcGxhblxyXG4gICAqL1xyXG4gIGNyZWF0ZU1pZ3JhdGlvblBsYW4odGFibGVzLCBvcHRpb25zID0ge30pIHtcclxuICAgIHRoaXMubWlncmF0aW9uUGxhbiA9IHtcclxuICAgICAgdGFibGVzLFxyXG4gICAgICBvcHRpb25zLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgc3RlcHM6IHRoaXMuZ2VuZXJhdGVNaWdyYXRpb25TdGVwcyh0YWJsZXMsIG9wdGlvbnMpLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmNvbmZpZy5sb2dnZXIuaW5mbyhgTWlncmF0aW9uIHBsYW4gY3JlYXRlZCB3aXRoICR7dGFibGVzLmxlbmd0aH0gdGFibGVzYCk7XHJcbiAgICByZXR1cm4gdGhpcy5taWdyYXRpb25QbGFuO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgbWlncmF0aW9uIHN0ZXBzXHJcbiAgICovXHJcbiAgZ2VuZXJhdGVNaWdyYXRpb25TdGVwcyh0YWJsZXMsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3Qgc3RlcHMgPSBbXTtcclxuXHJcbiAgICBpZiAob3B0aW9ucy5wcmVWYWxpZGF0aW9uKSB7XHJcbiAgICAgIHN0ZXBzLnB1c2goe1xyXG4gICAgICAgIGlkOiAncHJlX3ZhbGlkYXRpb24nLFxyXG4gICAgICAgIG5hbWU6ICdQcmUtbWlncmF0aW9uIFZhbGlkYXRpb24nLFxyXG4gICAgICAgIHR5cGU6ICd2YWxpZGF0aW9uJyxcclxuICAgICAgICB0YWJsZXMsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHN0ZXBzLnB1c2goe1xyXG4gICAgICBpZDogJ2JhY2t1cCcsXHJcbiAgICAgIG5hbWU6ICdDcmVhdGUgRGF0YWJhc2UgQmFja3VwJyxcclxuICAgICAgdHlwZTogJ2JhY2t1cCcsXHJcbiAgICAgIHRpbWVzdGFtcDogdHJ1ZSxcclxuICAgIH0pO1xyXG5cclxuICAgIGZvciAoY29uc3QgdGFibGUgb2YgdGFibGVzKSB7XHJcbiAgICAgIHN0ZXBzLnB1c2goe1xyXG4gICAgICAgIGlkOiBgbWlncmF0ZV8ke3RhYmxlfWAsXHJcbiAgICAgICAgbmFtZTogYE1pZ3JhdGUgJHt0YWJsZX1gLFxyXG4gICAgICAgIHR5cGU6ICdtaWdyYXRpb24nLFxyXG4gICAgICAgIHRhYmxlLFxyXG4gICAgICAgIHRyYW5zZm9ybTogb3B0aW9ucy50cmFuc2Zvcm1zPy5bdGFibGVdLFxyXG4gICAgICAgIHNraXBEdXBsaWNhdGVzOiBvcHRpb25zLnNraXBEdXBsaWNhdGVzLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucy5wb3N0VmFsaWRhdGlvbikge1xyXG4gICAgICBzdGVwcy5wdXNoKHtcclxuICAgICAgICBpZDogJ3Bvc3RfdmFsaWRhdGlvbicsXHJcbiAgICAgICAgbmFtZTogJ1Bvc3QtbWlncmF0aW9uIFZlcmlmaWNhdGlvbicsXHJcbiAgICAgICAgdHlwZTogJ3ZlcmlmaWNhdGlvbicsXHJcbiAgICAgICAgdGFibGVzLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucy5wb3N0Q2xlYW51cCkge1xyXG4gICAgICBzdGVwcy5wdXNoKHtcclxuICAgICAgICBpZDogJ3Bvc3RfY2xlYW51cCcsXHJcbiAgICAgICAgbmFtZTogJ0NsZWFudXAgU291cmNlIERhdGEnLFxyXG4gICAgICAgIHR5cGU6ICdjbGVhbnVwJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHN0ZXBzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXhlY3V0ZSBtaWdyYXRpb24gcGxhblxyXG4gICAqL1xyXG4gIGFzeW5jIGV4ZWN1dGVNaWdyYXRpb25QbGFuKG9wdGlvbnMgPSB7fSkge1xyXG4gICAgaWYgKCF0aGlzLm1pZ3JhdGlvblBsYW4pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBtaWdyYXRpb24gcGxhbiBjcmVhdGVkLiBDYWxsIGNyZWF0ZU1pZ3JhdGlvblBsYW4gZmlyc3QuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zdGF0cy5zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3Qgc3RlcHMgPSB0aGlzLm1pZ3JhdGlvblBsYW4uc3RlcHM7XHJcbiAgICBjb25zdCByZXN1bHRzID0gW107XHJcblxyXG4gICAgdGhpcy5jb25maWcubG9nZ2VyLmluZm8oJ1N0YXJ0aW5nIG1pZ3JhdGlvbiBleGVjdXRpb24nKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHN0ZXAgb2Ygc3RlcHMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0aGlzLmNvbmZpZy5sb2dnZXIuaW5mbyhgRXhlY3V0aW5nIHN0ZXA6ICR7c3RlcC5uYW1lfWApO1xyXG5cclxuICAgICAgICBsZXQgcmVzdWx0O1xyXG4gICAgICAgIHN3aXRjaCAoc3RlcC50eXBlKSB7XHJcbiAgICAgICAgICBjYXNlICd2YWxpZGF0aW9uJzpcclxuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlVmFsaWRhdGlvbihzdGVwKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdiYWNrdXAnOlxyXG4gICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVCYWNrdXAoc3RlcCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAnbWlncmF0aW9uJzpcclxuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlTWlncmF0aW9uU3RlcChzdGVwKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICd2ZXJpZmljYXRpb24nOlxyXG4gICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVWZXJpZmljYXRpb24oc3RlcCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAnY2xlYW51cCc6XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUNsZWFudXAoc3RlcCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHN0ZXAgdHlwZTogJHtzdGVwLnR5cGV9YCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXN1bHRzLnB1c2gocmVzdWx0KTtcclxuICAgICAgICB0aGlzLmV4ZWN1dGlvbkxvZy5wdXNoKHJlc3VsdCk7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHN0ZXAgZmFpbGVkIGFuZCBzdG9wIG9uIGVycm9yXHJcbiAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09ICdmYWlsZWQnICYmICFvcHRpb25zLmNvbnRpbnVlT25FcnJvcikge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTdGVwIGZhaWxlZDogJHtzdGVwLm5hbWV9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRoaXMuY29uZmlnLmxvZ2dlci5lcnJvcihgU3RlcCBleGVjdXRpb24gZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgICAgcmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgIHN0ZXA6IHN0ZXAuaWQsXHJcbiAgICAgICAgICBzdGF0dXM6ICdmYWlsZWQnLFxyXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghb3B0aW9ucy5jb250aW51ZU9uRXJyb3IpIHtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc3RhdHMuZW5kVGltZSA9IERhdGUubm93KCk7XHJcbiAgICB0aGlzLnN0YXRzLmR1cmF0aW9uID0gdGhpcy5zdGF0cy5lbmRUaW1lIC0gdGhpcy5zdGF0cy5zdGFydFRpbWU7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZ2V0RXhlY3V0aW9uU3VtbWFyeSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXhlY3V0ZSB2YWxpZGF0aW9uIHN0ZXBcclxuICAgKi9cclxuICBhc3luYyBleGVjdXRlVmFsaWRhdGlvbihzdGVwKSB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHRzID0gW107XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHRhYmxlIG9mIHN0ZXAudGFibGVzKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kYk1pZ3JhdGlvbi52ZXJpZnlNaWdyYXRpb24odGFibGUpO1xyXG4gICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLnB1c2gocmVzdWx0KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdGVwOiBzdGVwLmlkLFxyXG4gICAgICAgIG5hbWU6IHN0ZXAubmFtZSxcclxuICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxyXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgIHZhbGlkYXRpb25zOiB2YWxpZGF0aW9uUmVzdWx0cyxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RlcDogc3RlcC5pZCxcclxuICAgICAgICBuYW1lOiBzdGVwLm5hbWUsXHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyxcclxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4ZWN1dGUgYmFja3VwIHN0ZXBcclxuICAgKi9cclxuICBhc3luYyBleGVjdXRlQmFja3VwKHN0ZXApIHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5jb25maWcubG9nZ2VyLmluZm8oJ0NyZWF0aW5nIGRhdGFiYXNlIGJhY2t1cC4uLicpO1xyXG4gICAgICAvLyBJbXBsZW1lbnQgYWN0dWFsIGJhY2t1cCBsb2dpYyBoZXJlXHJcbiAgICAgIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgbG9nIHRoZSBiYWNrdXBcclxuICAgICAgY29uc3QgYmFja3VwRmlsZSA9IGBiYWNrdXBfJHtEYXRlLm5vdygpfS5zcWxgO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdGVwOiBzdGVwLmlkLFxyXG4gICAgICAgIG5hbWU6IHN0ZXAubmFtZSxcclxuICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxyXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgIGJhY2t1cEZpbGUsXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0ZXA6IHN0ZXAuaWQsXHJcbiAgICAgICAgbmFtZTogc3RlcC5uYW1lLFxyXG4gICAgICAgIHN0YXR1czogJ2ZhaWxlZCcsXHJcbiAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIG1pZ3JhdGlvbiBzdGVwIGZvciBhIHRhYmxlXHJcbiAgICovXHJcbiAgYXN5bmMgZXhlY3V0ZU1pZ3JhdGlvblN0ZXAoc3RlcCkge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBsZXQgcmVzdWx0O1xyXG5cclxuICAgICAgaWYgKHN0ZXAudHJhbnNmb3JtKSB7XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5kYk1pZ3JhdGlvbi5taWdyYXRlVGFibGVXaXRoVHJhbnNmb3JtKFxyXG4gICAgICAgICAgc3RlcC50YWJsZSxcclxuICAgICAgICAgIHN0ZXAudHJhbnNmb3JtLFxyXG4gICAgICAgICAgeyBza2lwRHVwbGljYXRlczogc3RlcC5za2lwRHVwbGljYXRlcyB9LFxyXG4gICAgICAgICk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5kYk1pZ3JhdGlvbi5taWdyYXRlVGFibGUoc3RlcC50YWJsZSwge1xyXG4gICAgICAgICAgc2tpcER1cGxpY2F0ZXM6IHN0ZXAuc2tpcER1cGxpY2F0ZXMsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuc3RhdHMuY29tcGxldGVkVGFibGVzKys7XHJcbiAgICAgIHRoaXMuc3RhdHMudG90YWxSZWNvcmRzICs9IHJlc3VsdC5yZWNvcmRzTWlncmF0ZWQgfHwgMDtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RlcDogc3RlcC5pZCxcclxuICAgICAgICBuYW1lOiBzdGVwLm5hbWUsXHJcbiAgICAgICAgc3RhdHVzOiByZXN1bHQuc3RhdHVzLFxyXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgIHJlY29yZHNNaWdyYXRlZDogcmVzdWx0LnJlY29yZHNNaWdyYXRlZCxcclxuICAgICAgICB0YWJsZTogc3RlcC50YWJsZSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuc3RhdHMuZmFpbGVkVGFibGVzKys7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0ZXA6IHN0ZXAuaWQsXHJcbiAgICAgICAgbmFtZTogc3RlcC5uYW1lLFxyXG4gICAgICAgIHN0YXR1czogJ2ZhaWxlZCcsXHJcbiAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgdGFibGU6IHN0ZXAudGFibGUsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIHZlcmlmaWNhdGlvbiBzdGVwXHJcbiAgICovXHJcbiAgYXN5bmMgZXhlY3V0ZVZlcmlmaWNhdGlvbihzdGVwKSB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbnMgPSBhd2FpdCB0aGlzLmRiTWlncmF0aW9uLnZlcmlmeUFsbE1pZ3JhdGlvbnMoc3RlcC50YWJsZXMpO1xyXG5cclxuICAgICAgY29uc3QgYWxsTWF0Y2ggPSB2ZXJpZmljYXRpb25zLmV2ZXJ5KCh2KSA9PiB2Lm1hdGNoID09PSB0cnVlKTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RlcDogc3RlcC5pZCxcclxuICAgICAgICBuYW1lOiBzdGVwLm5hbWUsXHJcbiAgICAgICAgc3RhdHVzOiBhbGxNYXRjaCA/ICdjb21wbGV0ZWQnIDogJ3dhcm5pbmcnLFxyXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgIHZlcmlmaWNhdGlvbnMsXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0ZXA6IHN0ZXAuaWQsXHJcbiAgICAgICAgbmFtZTogc3RlcC5uYW1lLFxyXG4gICAgICAgIHN0YXR1czogJ2ZhaWxlZCcsXHJcbiAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIGNsZWFudXAgc3RlcFxyXG4gICAqL1xyXG4gIGFzeW5jIGV4ZWN1dGVDbGVhbnVwKHN0ZXApIHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5jb25maWcubG9nZ2VyLmluZm8oJ0V4ZWN1dGluZyBwb3N0LW1pZ3JhdGlvbiBjbGVhbnVwLi4uJyk7XHJcbiAgICAgIC8vIEltcGxlbWVudCBjbGVhbnVwIGxvZ2ljIGhlcmVcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RlcDogc3RlcC5pZCxcclxuICAgICAgICBuYW1lOiBzdGVwLm5hbWUsXHJcbiAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyxcclxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RlcDogc3RlcC5pZCxcclxuICAgICAgICBuYW1lOiBzdGVwLm5hbWUsXHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyxcclxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEltcG9ydCBDU1YgYW5kIG1pZ3JhdGUgdG8gdGFyZ2V0XHJcbiAgICovXHJcbiAgYXN5bmMgbWlncmF0ZUZyb21DU1YoY3N2UGF0aCwgdGFibGVOYW1lLCBvcHRpb25zID0ge30pIHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5jb25maWcubG9nZ2VyLmluZm8oYFN0YXJ0aW5nIENTViBpbXBvcnQgZnJvbSAke2NzdlBhdGh9YCk7XHJcblxyXG4gICAgICAvLyBJbXBvcnQgQ1NWXHJcbiAgICAgIGNvbnN0IGNzdkRhdGEgPSBhd2FpdCB0aGlzLmNzdlByb2Nlc3Nvci5pbXBvcnRDU1YoY3N2UGF0aCwge1xyXG4gICAgICAgIGNvbHVtbnM6IHRydWUsXHJcbiAgICAgICAgLi4ub3B0aW9ucy5jc3ZPcHRpb25zLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmICghY3N2RGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDU1YgaW1wb3J0IGZhaWxlZDogJHtjc3ZEYXRhLmVycm9ycy5sZW5ndGh9IGVycm9yc2ApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmNvbmZpZy5sb2dnZXIuaW5mbyhgSW1wb3J0ZWQgJHtjc3ZEYXRhLnJlY29yZENvdW50fSByZWNvcmRzIGZyb20gQ1NWYCk7XHJcblxyXG4gICAgICAvLyBUcmFuc2Zvcm0gaWYgbmVlZGVkXHJcbiAgICAgIGxldCBkYXRhID0gY3N2RGF0YS5kYXRhO1xyXG4gICAgICBpZiAob3B0aW9ucy50cmFuc2Zvcm0pIHtcclxuICAgICAgICBkYXRhID0gdGhpcy5jc3ZQcm9jZXNzb3IudHJhbnNmb3JtRGF0YShkYXRhLCBvcHRpb25zLnRyYW5zZm9ybSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEluc2VydCBpbnRvIHRhcmdldCBkYXRhYmFzZVxyXG4gICAgICBhd2FpdCB0aGlzLmRiTWlncmF0aW9uLmluc2VydEJhdGNoKHRhYmxlTmFtZSwgZGF0YSwgb3B0aW9ucyk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXHJcbiAgICAgICAgY3N2RmlsZTogY3N2UGF0aCxcclxuICAgICAgICB0YWJsZU5hbWUsXHJcbiAgICAgICAgcmVjb3Jkc01pZ3JhdGVkOiBkYXRhLmxlbmd0aCxcclxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyxcclxuICAgICAgICBjc3ZGaWxlOiBjc3ZQYXRoLFxyXG4gICAgICAgIHRhYmxlTmFtZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4cG9ydCB0YWJsZSB0byBDU1ZcclxuICAgKi9cclxuICBhc3luYyBleHBvcnRUYWJsZVRvQ1NWKHRhYmxlTmFtZSwgY3N2UGF0aCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuY29uZmlnLmxvZ2dlci5pbmZvKGBFeHBvcnRpbmcgdGFibGUgJHt0YWJsZU5hbWV9IHRvIENTVmApO1xyXG5cclxuICAgICAgLy8gUXVlcnkgYWxsIGRhdGFcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuY29uZmlnLnNvdXJjZURCLnF1ZXJ5KGBTRUxFQ1QgKiBGUk9NICR7dGFibGVOYW1lfWApO1xyXG5cclxuICAgICAgLy8gRXhwb3J0IHRvIENTVlxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNzdlByb2Nlc3Nvci5leHBvcnRUb0NTVihkYXRhLCBjc3ZQYXRoLCBvcHRpb25zKTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyxcclxuICAgICAgICB0YWJsZTogdGFibGVOYW1lLFxyXG4gICAgICAgIGNzdkZpbGU6IGNzdlBhdGgsXHJcbiAgICAgICAgcmVjb3Jkc0V4cG9ydGVkOiByZXN1bHQucmVjb3JkQ291bnQsXHJcbiAgICAgICAgZmlsZVNpemU6IHJlc3VsdC5maWxlU2l6ZSxcclxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyxcclxuICAgICAgICB0YWJsZTogdGFibGVOYW1lLFxyXG4gICAgICAgIGNzdkZpbGU6IGNzdlBhdGgsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZXhlY3V0aW9uIHN1bW1hcnlcclxuICAgKi9cclxuICBnZXRFeGVjdXRpb25TdW1tYXJ5KCkge1xyXG4gICAgY29uc3QgZmFpbGVkU3RlcHMgPSB0aGlzLmV4ZWN1dGlvbkxvZy5maWx0ZXIoKGxvZykgPT4gbG9nLnN0YXR1cyA9PT0gJ2ZhaWxlZCcpO1xyXG4gICAgY29uc3Qgd2FybmluZ1N0ZXBzID0gdGhpcy5leGVjdXRpb25Mb2cuZmlsdGVyKChsb2cpID0+IGxvZy5zdGF0dXMgPT09ICd3YXJuaW5nJyk7XHJcbiAgICBjb25zdCB0b3RhbER1cmF0aW9uID0gdGhpcy5leGVjdXRpb25Mb2cucmVkdWNlKChzdW0sIGxvZykgPT4gc3VtICsgKGxvZy5kdXJhdGlvbiB8fCAwKSwgMCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3RhdHM6IHsgLi4udGhpcy5zdGF0cywgdG90YWxEdXJhdGlvbiB9LFxyXG4gICAgICBzdW1tYXJ5OiB7XHJcbiAgICAgICAgdG90YWxTdGVwczogdGhpcy5leGVjdXRpb25Mb2cubGVuZ3RoLFxyXG4gICAgICAgIGNvbXBsZXRlZFN0ZXBzOiB0aGlzLmV4ZWN1dGlvbkxvZy5sZW5ndGggLSBmYWlsZWRTdGVwcy5sZW5ndGggLSB3YXJuaW5nU3RlcHMubGVuZ3RoLFxyXG4gICAgICAgIGZhaWxlZFN0ZXBzOiBmYWlsZWRTdGVwcy5sZW5ndGgsXHJcbiAgICAgICAgd2FybmluZ1N0ZXBzOiB3YXJuaW5nU3RlcHMubGVuZ3RoLFxyXG4gICAgICAgIG92ZXJhbGxTdGF0dXM6IGZhaWxlZFN0ZXBzLmxlbmd0aCA+IDAgPyAnZmFpbGVkJyA6ICdzdWNjZXNzJyxcclxuICAgICAgfSxcclxuICAgICAgZXhlY3V0aW9uTG9nOiB0aGlzLmV4ZWN1dGlvbkxvZyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZXhlY3V0aW9uIGxvZ1xyXG4gICAqL1xyXG4gIGdldEV4ZWN1dGlvbkxvZygpIHtcclxuICAgIHJldHVybiB0aGlzLmV4ZWN1dGlvbkxvZztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFyIGV4ZWN1dGlvbiBsb2dcclxuICAgKi9cclxuICBjbGVhckxvZygpIHtcclxuICAgIHRoaXMuZXhlY3V0aW9uTG9nID0gW107XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhdXNlIG1pZ3JhdGlvblxyXG4gICAqL1xyXG4gIHBhdXNlTWlncmF0aW9uKCkge1xyXG4gICAgdGhpcy5jb25maWcubG9nZ2VyLmluZm8oJ01pZ3JhdGlvbiBwYXVzZWQnKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN0YXR1czogJ3BhdXNlZCcsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3VtZSBtaWdyYXRpb25cclxuICAgKi9cclxuICByZXN1bWVNaWdyYXRpb24oKSB7XHJcbiAgICB0aGlzLmNvbmZpZy5sb2dnZXIuaW5mbygnTWlncmF0aW9uIHJlc3VtZWQnKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN0YXR1czogJ3Jlc3VtZWQnLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE1pZ3JhdGlvbk1hbmFnZXI7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsWUFBWSxHQUFHQyxPQUFPLENBQUMsZ0JBQWdC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