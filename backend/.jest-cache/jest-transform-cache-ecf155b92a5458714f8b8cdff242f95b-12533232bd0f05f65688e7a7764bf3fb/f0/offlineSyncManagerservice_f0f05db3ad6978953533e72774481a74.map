{"version":3,"names":["EventEmitter","require","uuid","randomUUID","Logger","OfflineSyncManager","constructor","syncQueue","Map","dataCache","conflictLog","syncHistory","pendingOperations","queueOperation","data","operationId","operation","id","userId","deviceId","type","resource","resourceId","payload","timestamp","Date","status","retries","maxRetries","checksum","_generateChecksum","compressed","priority","dependencies","metadata","offlineQueuedAt","attemptedAt","error","set","info","emit","syncOperations","userOperations","Array","from","values","filter","op","sort","a","b","priorityMap","high","normal","low","results","successful","failed","conflicts","totalCount","length","result","_executeOperation","conflict","push","_logConflict","delete","message","_recordSyncHistory","getPendingOperations","map","compressData","JSON","stringify","_removeNullValues","compressionRatio","toFixed","Buffer","toString","ratio","parseFloat","originalSize","compressedSize","decompressData","compressedData","decompressed","parse","resolveConflict","conflictData","localData","remoteData","strategy","resolved","_mergeData","get","resolvedData","getSyncHistory","limit","key","history","slice","reverse","getSyncStatus","pending","syncing","lastSync","queueSize","clearQueue","cleared","operationsCleared","enableAutoSync","intervalSeconds","has","clearInterval","intervalId","setInterval","enabled","interval","startedAt","disableAutoSync","autoSync","Promise","resolve","setTimeout","success","total","crypto","createHash","update","digest","obj","isArray","item","Object","keys","undefined","reduce","local","remote","merged","hasOwnProperty","module","exports"],"sources":["offlineSyncManager.service.js"],"sourcesContent":["/**\r\n * Offline Sync Manager Service\r\n * Ø®Ø¯Ù…Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø¨Ù„Ø§ Ø¥Ù†ØªØ±Ù†Øª\r\n * \r\n * Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:\r\n * - Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„\r\n * - Ø­Ù„ Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©\r\n * - ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\r\n * - Ø¶ØºØ· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù†Ù‚Ù„\r\n * - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©\r\n */\r\n\r\nconst EventEmitter = require('events');\r\nconst uuid = require('crypto').randomUUID;\r\nconst { Logger } = require('../utils/logger');\r\n\r\nclass OfflineSyncManager extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    this.syncQueue = new Map();\r\n    this.dataCache = new Map();\r\n    this.conflictLog = new Map();\r\n    this.syncHistory = new Map();\r\n    this.pendingOperations = new Map();\r\n  }\r\n\r\n  /**\r\n   * Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ© Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„\r\n   * Queue offline operation\r\n   */\r\n  queueOperation(data) {\r\n    try {\r\n      const operationId = uuid();\r\n      const operation = {\r\n        id: operationId,\r\n        userId: data.userId,\r\n        deviceId: data.deviceId,\r\n        type: data.type, // write, update, delete, patch\r\n        resource: data.resource,\r\n        resourceId: data.resourceId,\r\n        payload: data.payload,\r\n        timestamp: new Date(),\r\n        status: 'pending',\r\n        retries: 0,\r\n        maxRetries: 3,\r\n        checksum: this._generateChecksum(data),\r\n        compressed: false,\r\n        priority: data.priority || 'normal',\r\n        dependencies: data.dependencies || [],\r\n        metadata: {\r\n          offlineQueuedAt: new Date(),\r\n          attemptedAt: null,\r\n          error: null,\r\n        },\r\n      };\r\n\r\n      this.syncQueue.set(operationId, operation);\r\n\r\n      Logger.info(`ðŸ“¤ Operation queued: ${operationId} (${data.type})`);\r\n\r\n      this.emit('operation:queued', {\r\n        operationId,\r\n        type: data.type,\r\n        resource: data.resource,\r\n      });\r\n\r\n      return operation;\r\n    } catch (error) {\r\n      Logger.error('Queue operation error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©\r\n   * Sync pending operations\r\n   */\r\n  async syncOperations(userId, deviceId) {\r\n    try {\r\n      const userOperations = Array.from(this.syncQueue.values())\r\n        .filter(op => op.userId === userId && op.deviceId === deviceId)\r\n        .sort((a, b) => {\r\n          // Process by priority and timestamp\r\n          const priorityMap = { high: 0, normal: 1, low: 2 };\r\n          return priorityMap[a.priority] - priorityMap[b.priority] ||\r\n                 a.timestamp - b.timestamp;\r\n        });\r\n\r\n      const results = {\r\n        successful: [],\r\n        failed: [],\r\n        conflicts: [],\r\n        totalCount: userOperations.length,\r\n      };\r\n\r\n      for (const operation of userOperations) {\r\n        try {\r\n          operation.status = 'syncing';\r\n          operation.metadata.attemptedAt = new Date();\r\n\r\n          const result = await this._executeOperation(operation);\r\n\r\n          if (result.conflict) {\r\n            operation.status = 'conflict';\r\n            results.conflicts.push({\r\n              operationId: operation.id,\r\n              conflict: result.conflict,\r\n            });\r\n\r\n            this._logConflict(userId, operation, result.conflict);\r\n          } else {\r\n            operation.status = 'synced';\r\n            this.syncQueue.delete(operation.id);\r\n            results.successful.push(operation.id);\r\n          }\r\n        } catch (error) {\r\n          operation.retries++;\r\n          operation.metadata.error = error.message;\r\n\r\n          if (operation.retries >= operation.maxRetries) {\r\n            operation.status = 'failed';\r\n            results.failed.push({\r\n              operationId: operation.id,\r\n              error: error.message,\r\n            });\r\n          } else {\r\n            operation.status = 'pending';\r\n          }\r\n        }\r\n      }\r\n\r\n      this._recordSyncHistory(userId, deviceId, results);\r\n\r\n      Logger.info(\r\n        `ðŸ”„ Sync completed: ${results.successful.length} synced, ${results.failed.length} failed`\r\n      );\r\n\r\n      this.emit('sync:completed', {\r\n        userId,\r\n        deviceId,\r\n        results,\r\n      });\r\n\r\n      return results;\r\n    } catch (error) {\r\n      Logger.error('Sync operations error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©\r\n   * Get pending operations\r\n   */\r\n  getPendingOperations(userId, deviceId) {\r\n    return Array.from(this.syncQueue.values())\r\n      .filter(op => op.userId === userId && op.deviceId === deviceId && op.status === 'pending')\r\n      .map(op => ({\r\n        id: op.id,\r\n        type: op.type,\r\n        resource: op.resource,\r\n        timestamp: op.timestamp,\r\n        priority: op.priority,\r\n      }));\r\n  }\r\n\r\n  /**\r\n   * Ø¶ØºØ· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©\r\n   * Compress data for sync\r\n   */\r\n  compressData(data) {\r\n    try {\r\n      // Simple compression: remove null/undefined values\r\n      const compressed = JSON.stringify(this._removeNullValues(data));\r\n\r\n      const compressionRatio = ((1 - compressed.length / JSON.stringify(data).length) * 100).toFixed(2);\r\n\r\n      Logger.info(`ðŸ“¦ Data compressed: ${compressionRatio}% reduction`);\r\n\r\n      return {\r\n        compressed: Buffer.from(compressed).toString('base64'),\r\n        ratio: parseFloat(compressionRatio),\r\n        originalSize: JSON.stringify(data).length,\r\n        compressedSize: compressed.length,\r\n      };\r\n    } catch (error) {\r\n      Logger.error('Data compression error:', error);\r\n      return { compressed: data, ratio: 0 };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ÙÙƒ Ø¶ØºØ· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\r\n   * Decompress data\r\n   */\r\n  decompressData(compressedData) {\r\n    try {\r\n      const decompressed = JSON.parse(\r\n        Buffer.from(compressedData, 'base64').toString('utf8')\r\n      );\r\n      return decompressed;\r\n    } catch (error) {\r\n      Logger.error('Data decompression error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ø­Ù„ Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\r\n   * Resolve conflicts\r\n   */\r\n  resolveConflict(conflictData) {\r\n    try {\r\n      const {\r\n        operationId,\r\n        localData,\r\n        remoteData,\r\n        strategy = 'remote', // remote, local, merge\r\n      } = conflictData;\r\n\r\n      let resolved;\r\n\r\n      switch (strategy) {\r\n        case 'remote':\r\n          resolved = remoteData;\r\n          break;\r\n        case 'local':\r\n          resolved = localData;\r\n          break;\r\n        case 'merge':\r\n          resolved = this._mergeData(localData, remoteData);\r\n          break;\r\n        default:\r\n          resolved = remoteData;\r\n      }\r\n\r\n      const operation = this.syncQueue.get(operationId);\r\n      if (operation) {\r\n        operation.status = 'resolved';\r\n        operation.resolvedData = resolved;\r\n      }\r\n\r\n      this.emit('conflict:resolved', {\r\n        operationId,\r\n        strategy,\r\n        timestamp: new Date(),\r\n      });\r\n\r\n      return resolved;\r\n    } catch (error) {\r\n      Logger.error('Conflict resolution error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©\r\n   * Get sync history\r\n   */\r\n  getSyncHistory(userId, deviceId, limit = 50) {\r\n    const key = `${userId}:${deviceId}`;\r\n    const history = this.syncHistory.get(key) || [];\r\n\r\n    return history.slice(-limit).reverse();\r\n  }\r\n\r\n  /**\r\n   * Ø­ÙˆÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©\r\n   * Get sync status\r\n   */\r\n  getSyncStatus(userId, deviceId) {\r\n    const pending = Array.from(this.syncQueue.values())\r\n      .filter(op => op.userId === userId && op.deviceId === deviceId && op.status === 'pending')\r\n      .length;\r\n\r\n    const conflicts = Array.from(this.syncQueue.values())\r\n      .filter(op => op.userId === userId && op.deviceId === deviceId && op.status === 'conflict')\r\n      .length;\r\n\r\n    const syncing = Array.from(this.syncQueue.values())\r\n      .filter(op => op.userId === userId && op.deviceId === deviceId && op.status === 'syncing')\r\n      .length;\r\n\r\n    const history = this.getSyncHistory(userId, deviceId, 1);\r\n    const lastSync = history.length > 0 ? history[0].timestamp : null;\r\n\r\n    return {\r\n      pending,\r\n      conflicts,\r\n      syncing,\r\n      lastSync,\r\n      queueSize: pending + syncing + conflicts,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Ù…Ø³Ø­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±\r\n   * Clear sync queue\r\n   */\r\n  clearQueue(userId, deviceId) {\r\n    let cleared = 0;\r\n\r\n    for (const [operationId, operation] of this.syncQueue) {\r\n      if (operation.userId === userId && operation.deviceId === deviceId) {\r\n        this.syncQueue.delete(operationId);\r\n        cleared++;\r\n      }\r\n    }\r\n\r\n    Logger.info(`ðŸ—‘ï¸  Cleared ${cleared} operations from sync queue`);\r\n\r\n    this.emit('queue:cleared', {\r\n      userId,\r\n      deviceId,\r\n      operationsCleared: cleared,\r\n    });\r\n\r\n    return cleared;\r\n  }\r\n\r\n  /**\r\n   * ÙØ¹Ù‘Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©\r\n   * Enable auto sync\r\n   */\r\n  enableAutoSync(userId, deviceId, intervalSeconds = 300) {\r\n    const key = `${userId}:${deviceId}`;\r\n\r\n    if (this.pendingOperations.has(key)) {\r\n      clearInterval(this.pendingOperations.get(key).intervalId);\r\n    }\r\n\r\n    const intervalId = setInterval(async () => {\r\n      await this.syncOperations(userId, deviceId);\r\n    }, intervalSeconds * 1000);\r\n\r\n    this.pendingOperations.set(key, {\r\n      intervalId,\r\n      enabled: true,\r\n      interval: intervalSeconds,\r\n      startedAt: new Date(),\r\n    });\r\n\r\n    Logger.info(`âš™ï¸  Auto sync enabled for ${userId}/${deviceId} (${intervalSeconds}s)`);\r\n\r\n    return { intervalId, enabled: true };\r\n  }\r\n\r\n  /**\r\n   * Ø¹Ø·Ù‘Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©\r\n   * Disable auto sync\r\n   */\r\n  disableAutoSync(userId, deviceId) {\r\n    const key = `${userId}:${deviceId}`;\r\n    const autoSync = this.pendingOperations.get(key);\r\n\r\n    if (autoSync) {\r\n      clearInterval(autoSync.intervalId);\r\n      this.pendingOperations.delete(key);\r\n    }\r\n\r\n    Logger.info(`â¸ï¸  Auto sync disabled for ${userId}/${deviceId}`);\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * ===== Private Methods =====\r\n   */\r\n\r\n  /**\r\n   * Execute operation\r\n   */\r\n  async _executeOperation(operation) {\r\n    // Simulate API call\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        resolve({\r\n          success: true,\r\n          conflict: null,\r\n        });\r\n      }, 100);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Log conflict\r\n   */\r\n  _logConflict(userId, operation, conflict) {\r\n    const key = `${userId}:${operation.deviceId}`;\r\n\r\n    if (!this.conflictLog.has(key)) {\r\n      this.conflictLog.set(key, []);\r\n    }\r\n\r\n    this.conflictLog.get(key).push({\r\n      operationId: operation.id,\r\n      type: operation.type,\r\n      resource: operation.resource,\r\n      conflict,\r\n      timestamp: new Date(),\r\n      resolved: false,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Record sync history\r\n   */\r\n  _recordSyncHistory(userId, deviceId, results) {\r\n    const key = `${userId}:${deviceId}`;\r\n\r\n    if (!this.syncHistory.has(key)) {\r\n      this.syncHistory.set(key, []);\r\n    }\r\n\r\n    this.syncHistory.get(key).push({\r\n      timestamp: new Date(),\r\n      successful: results.successful.length,\r\n      failed: results.failed.length,\r\n      conflicts: results.conflicts.length,\r\n      total: results.totalCount,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Generate checksum\r\n   */\r\n  _generateChecksum(data) {\r\n    const crypto = require('crypto');\r\n    return crypto.createHash('md5').update(JSON.stringify(data)).digest('hex');\r\n  }\r\n\r\n  /**\r\n   * Remove null values for compression\r\n   */\r\n  _removeNullValues(obj) {\r\n    if (Array.isArray(obj)) {\r\n      return obj.map(item => this._removeNullValues(item));\r\n    }\r\n\r\n    if (obj !== null && typeof obj === 'object') {\r\n      return Object.keys(obj)\r\n        .filter(key => obj[key] !== null && obj[key] !== undefined)\r\n        .reduce((result, key) => {\r\n          result[key] = this._removeNullValues(obj[key]);\r\n          return result;\r\n        }, {});\r\n    }\r\n\r\n    return obj;\r\n  }\r\n\r\n  /**\r\n   * Merge data\r\n   */\r\n  _mergeData(local, remote) {\r\n    const merged = { ...remote };\r\n\r\n    for (const key in local) {\r\n      if (local.hasOwnProperty(key) && typeof local[key] === 'object') {\r\n        merged[key] = this._mergeData(local[key], remote[key] || {});\r\n      }\r\n    }\r\n\r\n    return merged;\r\n  }\r\n}\r\n\r\nmodule.exports = new OfflineSyncManager();\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMA,YAAY,GAAGC,OAAO,CAAC,QAAQ,CAAC;AACtC,MAAMC,IAAI,GAAGD,OAAO,CAAC,QAAQ,CAAC,CAACE,UAAU;AACzC,MAAM;EAAEC;AAAO,CAAC,GAAGH,OAAO,CAAC,iBAAiB,CAAC;AAE7C,MAAMI,kBAAkB,SAASL,YAAY,CAAC;EAC5CM,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IACP,IAAI,CAACC,SAAS,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC1B,IAAI,CAACC,SAAS,GAAG,IAAID,GAAG,CAAC,CAAC;IAC1B,IAAI,CAACE,WAAW,GAAG,IAAIF,GAAG,CAAC,CAAC;IAC5B,IAAI,CAACG,WAAW,GAAG,IAAIH,GAAG,CAAC,CAAC;IAC5B,IAAI,CAACI,iBAAiB,GAAG,IAAIJ,GAAG,CAAC,CAAC;EACpC;;EAEA;AACF;AACA;AACA;EACEK,cAAcA,CAACC,IAAI,EAAE;IACnB,IAAI;MACF,MAAMC,WAAW,GAAGb,IAAI,CAAC,CAAC;MAC1B,MAAMc,SAAS,GAAG;QAChBC,EAAE,EAAEF,WAAW;QACfG,MAAM,EAAEJ,IAAI,CAACI,MAAM;QACnBC,QAAQ,EAAEL,IAAI,CAACK,QAAQ;QACvBC,IAAI,EAAEN,IAAI,CAACM,IAAI;QAAE;QACjBC,QAAQ,EAAEP,IAAI,CAACO,QAAQ;QACvBC,UAAU,EAAER,IAAI,CAACQ,UAAU;QAC3BC,OAAO,EAAET,IAAI,CAACS,OAAO;QACrBC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;QACrBC,MAAM,EAAE,SAAS;QACjBC,OAAO,EAAE,CAAC;QACVC,UAAU,EAAE,CAAC;QACbC,QAAQ,EAAE,IAAI,CAACC,iBAAiB,CAAChB,IAAI,CAAC;QACtCiB,UAAU,EAAE,KAAK;QACjBC,QAAQ,EAAElB,IAAI,CAACkB,QAAQ,IAAI,QAAQ;QACnCC,YAAY,EAAEnB,IAAI,CAACmB,YAAY,IAAI,EAAE;QACrCC,QAAQ,EAAE;UACRC,eAAe,EAAE,IAAIV,IAAI,CAAC,CAAC;UAC3BW,WAAW,EAAE,IAAI;UACjBC,KAAK,EAAE;QACT;MACF,CAAC;MAED,IAAI,CAAC9B,SAAS,CAAC+B,GAAG,CAACvB,WAAW,EAAEC,SAAS,CAAC;MAE1CZ,MAAM,CAACmC,IAAI,CAAC,wBAAwBxB,WAAW,KAAKD,IAAI,CAACM,IAAI,GAAG,CAAC;MAEjE,IAAI,CAACoB,IAAI,CAAC,kBAAkB,EAAE;QAC5BzB,WAAW;QACXK,IAAI,EAAEN,IAAI,CAACM,IAAI;QACfC,QAAQ,EAAEP,IAAI,CAACO;MACjB,CAAC,CAAC;MAEF,OAAOL,SAAS;IAClB,CAAC,CAAC,OAAOqB,KAAK,EAAE;MACdjC,MAAM,CAACiC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC7C,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACE,MAAMI,cAAcA,CAACvB,MAAM,EAAEC,QAAQ,EAAE;IACrC,IAAI;MACF,MAAMuB,cAAc,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAI,CAACrC,SAAS,CAACsC,MAAM,CAAC,CAAC,CAAC,CACvDC,MAAM,CAACC,EAAE,IAAIA,EAAE,CAAC7B,MAAM,KAAKA,MAAM,IAAI6B,EAAE,CAAC5B,QAAQ,KAAKA,QAAQ,CAAC,CAC9D6B,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;QACd;QACA,MAAMC,WAAW,GAAG;UAAEC,IAAI,EAAE,CAAC;UAAEC,MAAM,EAAE,CAAC;UAAEC,GAAG,EAAE;QAAE,CAAC;QAClD,OAAOH,WAAW,CAACF,CAAC,CAACjB,QAAQ,CAAC,GAAGmB,WAAW,CAACD,CAAC,CAAClB,QAAQ,CAAC,IACjDiB,CAAC,CAACzB,SAAS,GAAG0B,CAAC,CAAC1B,SAAS;MAClC,CAAC,CAAC;MAEJ,MAAM+B,OAAO,GAAG;QACdC,UAAU,EAAE,EAAE;QACdC,MAAM,EAAE,EAAE;QACVC,SAAS,EAAE,EAAE;QACbC,UAAU,EAAEjB,cAAc,CAACkB;MAC7B,CAAC;MAED,KAAK,MAAM5C,SAAS,IAAI0B,cAAc,EAAE;QACtC,IAAI;UACF1B,SAAS,CAACU,MAAM,GAAG,SAAS;UAC5BV,SAAS,CAACkB,QAAQ,CAACE,WAAW,GAAG,IAAIX,IAAI,CAAC,CAAC;UAE3C,MAAMoC,MAAM,GAAG,MAAM,IAAI,CAACC,iBAAiB,CAAC9C,SAAS,CAAC;UAEtD,IAAI6C,MAAM,CAACE,QAAQ,EAAE;YACnB/C,SAAS,CAACU,MAAM,GAAG,UAAU;YAC7B6B,OAAO,CAACG,SAAS,CAACM,IAAI,CAAC;cACrBjD,WAAW,EAAEC,SAAS,CAACC,EAAE;cACzB8C,QAAQ,EAAEF,MAAM,CAACE;YACnB,CAAC,CAAC;YAEF,IAAI,CAACE,YAAY,CAAC/C,MAAM,EAAEF,SAAS,EAAE6C,MAAM,CAACE,QAAQ,CAAC;UACvD,CAAC,MAAM;YACL/C,SAAS,CAACU,MAAM,GAAG,QAAQ;YAC3B,IAAI,CAACnB,SAAS,CAAC2D,MAAM,CAAClD,SAAS,CAACC,EAAE,CAAC;YACnCsC,OAAO,CAACC,UAAU,CAACQ,IAAI,CAAChD,SAAS,CAACC,EAAE,CAAC;UACvC;QACF,CAAC,CAAC,OAAOoB,KAAK,EAAE;UACdrB,SAAS,CAACW,OAAO,EAAE;UACnBX,SAAS,CAACkB,QAAQ,CAACG,KAAK,GAAGA,KAAK,CAAC8B,OAAO;UAExC,IAAInD,SAAS,CAACW,OAAO,IAAIX,SAAS,CAACY,UAAU,EAAE;YAC7CZ,SAAS,CAACU,MAAM,GAAG,QAAQ;YAC3B6B,OAAO,CAACE,MAAM,CAACO,IAAI,CAAC;cAClBjD,WAAW,EAAEC,SAAS,CAACC,EAAE;cACzBoB,KAAK,EAAEA,KAAK,CAAC8B;YACf,CAAC,CAAC;UACJ,CAAC,MAAM;YACLnD,SAAS,CAACU,MAAM,GAAG,SAAS;UAC9B;QACF;MACF;MAEA,IAAI,CAAC0C,kBAAkB,CAAClD,MAAM,EAAEC,QAAQ,EAAEoC,OAAO,CAAC;MAElDnD,MAAM,CAACmC,IAAI,CACT,sBAAsBgB,OAAO,CAACC,UAAU,CAACI,MAAM,YAAYL,OAAO,CAACE,MAAM,CAACG,MAAM,SAClF,CAAC;MAED,IAAI,CAACpB,IAAI,CAAC,gBAAgB,EAAE;QAC1BtB,MAAM;QACNC,QAAQ;QACRoC;MACF,CAAC,CAAC;MAEF,OAAOA,OAAO;IAChB,CAAC,CAAC,OAAOlB,KAAK,EAAE;MACdjC,MAAM,CAACiC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC7C,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACEgC,oBAAoBA,CAACnD,MAAM,EAAEC,QAAQ,EAAE;IACrC,OAAOwB,KAAK,CAACC,IAAI,CAAC,IAAI,CAACrC,SAAS,CAACsC,MAAM,CAAC,CAAC,CAAC,CACvCC,MAAM,CAACC,EAAE,IAAIA,EAAE,CAAC7B,MAAM,KAAKA,MAAM,IAAI6B,EAAE,CAAC5B,QAAQ,KAAKA,QAAQ,IAAI4B,EAAE,CAACrB,MAAM,KAAK,SAAS,CAAC,CACzF4C,GAAG,CAACvB,EAAE,KAAK;MACV9B,EAAE,EAAE8B,EAAE,CAAC9B,EAAE;MACTG,IAAI,EAAE2B,EAAE,CAAC3B,IAAI;MACbC,QAAQ,EAAE0B,EAAE,CAAC1B,QAAQ;MACrBG,SAAS,EAAEuB,EAAE,CAACvB,SAAS;MACvBQ,QAAQ,EAAEe,EAAE,CAACf;IACf,CAAC,CAAC,CAAC;EACP;;EAEA;AACF;AACA;AACA;EACEuC,YAAYA,CAACzD,IAAI,EAAE;IACjB,IAAI;MACF;MACA,MAAMiB,UAAU,GAAGyC,IAAI,CAACC,SAAS,CAAC,IAAI,CAACC,iBAAiB,CAAC5D,IAAI,CAAC,CAAC;MAE/D,MAAM6D,gBAAgB,GAAG,CAAC,CAAC,CAAC,GAAG5C,UAAU,CAAC6B,MAAM,GAAGY,IAAI,CAACC,SAAS,CAAC3D,IAAI,CAAC,CAAC8C,MAAM,IAAI,GAAG,EAAEgB,OAAO,CAAC,CAAC,CAAC;MAEjGxE,MAAM,CAACmC,IAAI,CAAC,uBAAuBoC,gBAAgB,aAAa,CAAC;MAEjE,OAAO;QACL5C,UAAU,EAAE8C,MAAM,CAACjC,IAAI,CAACb,UAAU,CAAC,CAAC+C,QAAQ,CAAC,QAAQ,CAAC;QACtDC,KAAK,EAAEC,UAAU,CAACL,gBAAgB,CAAC;QACnCM,YAAY,EAAET,IAAI,CAACC,SAAS,CAAC3D,IAAI,CAAC,CAAC8C,MAAM;QACzCsB,cAAc,EAAEnD,UAAU,CAAC6B;MAC7B,CAAC;IACH,CAAC,CAAC,OAAOvB,KAAK,EAAE;MACdjC,MAAM,CAACiC,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC9C,OAAO;QAAEN,UAAU,EAAEjB,IAAI;QAAEiE,KAAK,EAAE;MAAE,CAAC;IACvC;EACF;;EAEA;AACF;AACA;AACA;EACEI,cAAcA,CAACC,cAAc,EAAE;IAC7B,IAAI;MACF,MAAMC,YAAY,GAAGb,IAAI,CAACc,KAAK,CAC7BT,MAAM,CAACjC,IAAI,CAACwC,cAAc,EAAE,QAAQ,CAAC,CAACN,QAAQ,CAAC,MAAM,CACvD,CAAC;MACD,OAAOO,YAAY;IACrB,CAAC,CAAC,OAAOhD,KAAK,EAAE;MACdjC,MAAM,CAACiC,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MAChD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACEkD,eAAeA,CAACC,YAAY,EAAE;IAC5B,IAAI;MACF,MAAM;QACJzE,WAAW;QACX0E,SAAS;QACTC,UAAU;QACVC,QAAQ,GAAG,QAAQ,CAAE;MACvB,CAAC,GAAGH,YAAY;MAEhB,IAAII,QAAQ;MAEZ,QAAQD,QAAQ;QACd,KAAK,QAAQ;UACXC,QAAQ,GAAGF,UAAU;UACrB;QACF,KAAK,OAAO;UACVE,QAAQ,GAAGH,SAAS;UACpB;QACF,KAAK,OAAO;UACVG,QAAQ,GAAG,IAAI,CAACC,UAAU,CAACJ,SAAS,EAAEC,UAAU,CAAC;UACjD;QACF;UACEE,QAAQ,GAAGF,UAAU;MACzB;MAEA,MAAM1E,SAAS,GAAG,IAAI,CAACT,SAAS,CAACuF,GAAG,CAAC/E,WAAW,CAAC;MACjD,IAAIC,SAAS,EAAE;QACbA,SAAS,CAACU,MAAM,GAAG,UAAU;QAC7BV,SAAS,CAAC+E,YAAY,GAAGH,QAAQ;MACnC;MAEA,IAAI,CAACpD,IAAI,CAAC,mBAAmB,EAAE;QAC7BzB,WAAW;QACX4E,QAAQ;QACRnE,SAAS,EAAE,IAAIC,IAAI,CAAC;MACtB,CAAC,CAAC;MAEF,OAAOmE,QAAQ;IACjB,CAAC,CAAC,OAAOvD,KAAK,EAAE;MACdjC,MAAM,CAACiC,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACjD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACE2D,cAAcA,CAAC9E,MAAM,EAAEC,QAAQ,EAAE8E,KAAK,GAAG,EAAE,EAAE;IAC3C,MAAMC,GAAG,GAAG,GAAGhF,MAAM,IAAIC,QAAQ,EAAE;IACnC,MAAMgF,OAAO,GAAG,IAAI,CAACxF,WAAW,CAACmF,GAAG,CAACI,GAAG,CAAC,IAAI,EAAE;IAE/C,OAAOC,OAAO,CAACC,KAAK,CAAC,CAACH,KAAK,CAAC,CAACI,OAAO,CAAC,CAAC;EACxC;;EAEA;AACF;AACA;AACA;EACEC,aAAaA,CAACpF,MAAM,EAAEC,QAAQ,EAAE;IAC9B,MAAMoF,OAAO,GAAG5D,KAAK,CAACC,IAAI,CAAC,IAAI,CAACrC,SAAS,CAACsC,MAAM,CAAC,CAAC,CAAC,CAChDC,MAAM,CAACC,EAAE,IAAIA,EAAE,CAAC7B,MAAM,KAAKA,MAAM,IAAI6B,EAAE,CAAC5B,QAAQ,KAAKA,QAAQ,IAAI4B,EAAE,CAACrB,MAAM,KAAK,SAAS,CAAC,CACzFkC,MAAM;IAET,MAAMF,SAAS,GAAGf,KAAK,CAACC,IAAI,CAAC,IAAI,CAACrC,SAAS,CAACsC,MAAM,CAAC,CAAC,CAAC,CAClDC,MAAM,CAACC,EAAE,IAAIA,EAAE,CAAC7B,MAAM,KAAKA,MAAM,IAAI6B,EAAE,CAAC5B,QAAQ,KAAKA,QAAQ,IAAI4B,EAAE,CAACrB,MAAM,KAAK,UAAU,CAAC,CAC1FkC,MAAM;IAET,MAAM4C,OAAO,GAAG7D,KAAK,CAACC,IAAI,CAAC,IAAI,CAACrC,SAAS,CAACsC,MAAM,CAAC,CAAC,CAAC,CAChDC,MAAM,CAACC,EAAE,IAAIA,EAAE,CAAC7B,MAAM,KAAKA,MAAM,IAAI6B,EAAE,CAAC5B,QAAQ,KAAKA,QAAQ,IAAI4B,EAAE,CAACrB,MAAM,KAAK,SAAS,CAAC,CACzFkC,MAAM;IAET,MAAMuC,OAAO,GAAG,IAAI,CAACH,cAAc,CAAC9E,MAAM,EAAEC,QAAQ,EAAE,CAAC,CAAC;IACxD,MAAMsF,QAAQ,GAAGN,OAAO,CAACvC,MAAM,GAAG,CAAC,GAAGuC,OAAO,CAAC,CAAC,CAAC,CAAC3E,SAAS,GAAG,IAAI;IAEjE,OAAO;MACL+E,OAAO;MACP7C,SAAS;MACT8C,OAAO;MACPC,QAAQ;MACRC,SAAS,EAAEH,OAAO,GAAGC,OAAO,GAAG9C;IACjC,CAAC;EACH;;EAEA;AACF;AACA;AACA;EACEiD,UAAUA,CAACzF,MAAM,EAAEC,QAAQ,EAAE;IAC3B,IAAIyF,OAAO,GAAG,CAAC;IAEf,KAAK,MAAM,CAAC7F,WAAW,EAAEC,SAAS,CAAC,IAAI,IAAI,CAACT,SAAS,EAAE;MACrD,IAAIS,SAAS,CAACE,MAAM,KAAKA,MAAM,IAAIF,SAAS,CAACG,QAAQ,KAAKA,QAAQ,EAAE;QAClE,IAAI,CAACZ,SAAS,CAAC2D,MAAM,CAACnD,WAAW,CAAC;QAClC6F,OAAO,EAAE;MACX;IACF;IAEAxG,MAAM,CAACmC,IAAI,CAAC,gBAAgBqE,OAAO,6BAA6B,CAAC;IAEjE,IAAI,CAACpE,IAAI,CAAC,eAAe,EAAE;MACzBtB,MAAM;MACNC,QAAQ;MACR0F,iBAAiB,EAAED;IACrB,CAAC,CAAC;IAEF,OAAOA,OAAO;EAChB;;EAEA;AACF;AACA;AACA;EACEE,cAAcA,CAAC5F,MAAM,EAAEC,QAAQ,EAAE4F,eAAe,GAAG,GAAG,EAAE;IACtD,MAAMb,GAAG,GAAG,GAAGhF,MAAM,IAAIC,QAAQ,EAAE;IAEnC,IAAI,IAAI,CAACP,iBAAiB,CAACoG,GAAG,CAACd,GAAG,CAAC,EAAE;MACnCe,aAAa,CAAC,IAAI,CAACrG,iBAAiB,CAACkF,GAAG,CAACI,GAAG,CAAC,CAACgB,UAAU,CAAC;IAC3D;IAEA,MAAMA,UAAU,GAAGC,WAAW,CAAC,YAAY;MACzC,MAAM,IAAI,CAAC1E,cAAc,CAACvB,MAAM,EAAEC,QAAQ,CAAC;IAC7C,CAAC,EAAE4F,eAAe,GAAG,IAAI,CAAC;IAE1B,IAAI,CAACnG,iBAAiB,CAAC0B,GAAG,CAAC4D,GAAG,EAAE;MAC9BgB,UAAU;MACVE,OAAO,EAAE,IAAI;MACbC,QAAQ,EAAEN,eAAe;MACzBO,SAAS,EAAE,IAAI7F,IAAI,CAAC;IACtB,CAAC,CAAC;IAEFrB,MAAM,CAACmC,IAAI,CAAC,6BAA6BrB,MAAM,IAAIC,QAAQ,KAAK4F,eAAe,IAAI,CAAC;IAEpF,OAAO;MAAEG,UAAU;MAAEE,OAAO,EAAE;IAAK,CAAC;EACtC;;EAEA;AACF;AACA;AACA;EACEG,eAAeA,CAACrG,MAAM,EAAEC,QAAQ,EAAE;IAChC,MAAM+E,GAAG,GAAG,GAAGhF,MAAM,IAAIC,QAAQ,EAAE;IACnC,MAAMqG,QAAQ,GAAG,IAAI,CAAC5G,iBAAiB,CAACkF,GAAG,CAACI,GAAG,CAAC;IAEhD,IAAIsB,QAAQ,EAAE;MACZP,aAAa,CAACO,QAAQ,CAACN,UAAU,CAAC;MAClC,IAAI,CAACtG,iBAAiB,CAACsD,MAAM,CAACgC,GAAG,CAAC;IACpC;IAEA9F,MAAM,CAACmC,IAAI,CAAC,8BAA8BrB,MAAM,IAAIC,QAAQ,EAAE,CAAC;IAE/D,OAAO,IAAI;EACb;;EAEA;AACF;AACA;;EAEE;AACF;AACA;EACE,MAAM2C,iBAAiBA,CAAC9C,SAAS,EAAE;IACjC;IACA,OAAO,IAAIyG,OAAO,CAAEC,OAAO,IAAK;MAC9BC,UAAU,CAAC,MAAM;QACfD,OAAO,CAAC;UACNE,OAAO,EAAE,IAAI;UACb7D,QAAQ,EAAE;QACZ,CAAC,CAAC;MACJ,CAAC,EAAE,GAAG,CAAC;IACT,CAAC,CAAC;EACJ;;EAEA;AACF;AACA;EACEE,YAAYA,CAAC/C,MAAM,EAAEF,SAAS,EAAE+C,QAAQ,EAAE;IACxC,MAAMmC,GAAG,GAAG,GAAGhF,MAAM,IAAIF,SAAS,CAACG,QAAQ,EAAE;IAE7C,IAAI,CAAC,IAAI,CAACT,WAAW,CAACsG,GAAG,CAACd,GAAG,CAAC,EAAE;MAC9B,IAAI,CAACxF,WAAW,CAAC4B,GAAG,CAAC4D,GAAG,EAAE,EAAE,CAAC;IAC/B;IAEA,IAAI,CAACxF,WAAW,CAACoF,GAAG,CAACI,GAAG,CAAC,CAAClC,IAAI,CAAC;MAC7BjD,WAAW,EAAEC,SAAS,CAACC,EAAE;MACzBG,IAAI,EAAEJ,SAAS,CAACI,IAAI;MACpBC,QAAQ,EAAEL,SAAS,CAACK,QAAQ;MAC5B0C,QAAQ;MACRvC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;MACrBmE,QAAQ,EAAE;IACZ,CAAC,CAAC;EACJ;;EAEA;AACF;AACA;EACExB,kBAAkBA,CAAClD,MAAM,EAAEC,QAAQ,EAAEoC,OAAO,EAAE;IAC5C,MAAM2C,GAAG,GAAG,GAAGhF,MAAM,IAAIC,QAAQ,EAAE;IAEnC,IAAI,CAAC,IAAI,CAACR,WAAW,CAACqG,GAAG,CAACd,GAAG,CAAC,EAAE;MAC9B,IAAI,CAACvF,WAAW,CAAC2B,GAAG,CAAC4D,GAAG,EAAE,EAAE,CAAC;IAC/B;IAEA,IAAI,CAACvF,WAAW,CAACmF,GAAG,CAACI,GAAG,CAAC,CAAClC,IAAI,CAAC;MAC7BxC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;MACrB+B,UAAU,EAAED,OAAO,CAACC,UAAU,CAACI,MAAM;MACrCH,MAAM,EAAEF,OAAO,CAACE,MAAM,CAACG,MAAM;MAC7BF,SAAS,EAAEH,OAAO,CAACG,SAAS,CAACE,MAAM;MACnCiE,KAAK,EAAEtE,OAAO,CAACI;IACjB,CAAC,CAAC;EACJ;;EAEA;AACF;AACA;EACE7B,iBAAiBA,CAAChB,IAAI,EAAE;IACtB,MAAMgH,MAAM,GAAG7H,OAAO,CAAC,QAAQ,CAAC;IAChC,OAAO6H,MAAM,CAACC,UAAU,CAAC,KAAK,CAAC,CAACC,MAAM,CAACxD,IAAI,CAACC,SAAS,CAAC3D,IAAI,CAAC,CAAC,CAACmH,MAAM,CAAC,KAAK,CAAC;EAC5E;;EAEA;AACF;AACA;EACEvD,iBAAiBA,CAACwD,GAAG,EAAE;IACrB,IAAIvF,KAAK,CAACwF,OAAO,CAACD,GAAG,CAAC,EAAE;MACtB,OAAOA,GAAG,CAAC5D,GAAG,CAAC8D,IAAI,IAAI,IAAI,CAAC1D,iBAAiB,CAAC0D,IAAI,CAAC,CAAC;IACtD;IAEA,IAAIF,GAAG,KAAK,IAAI,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;MAC3C,OAAOG,MAAM,CAACC,IAAI,CAACJ,GAAG,CAAC,CACpBpF,MAAM,CAACoD,GAAG,IAAIgC,GAAG,CAAChC,GAAG,CAAC,KAAK,IAAI,IAAIgC,GAAG,CAAChC,GAAG,CAAC,KAAKqC,SAAS,CAAC,CAC1DC,MAAM,CAAC,CAAC3E,MAAM,EAAEqC,GAAG,KAAK;QACvBrC,MAAM,CAACqC,GAAG,CAAC,GAAG,IAAI,CAACxB,iBAAiB,CAACwD,GAAG,CAAChC,GAAG,CAAC,CAAC;QAC9C,OAAOrC,MAAM;MACf,CAAC,EAAE,CAAC,CAAC,CAAC;IACV;IAEA,OAAOqE,GAAG;EACZ;;EAEA;AACF;AACA;EACErC,UAAUA,CAAC4C,KAAK,EAAEC,MAAM,EAAE;IACxB,MAAMC,MAAM,GAAG;MAAE,GAAGD;IAAO,CAAC;IAE5B,KAAK,MAAMxC,GAAG,IAAIuC,KAAK,EAAE;MACvB,IAAIA,KAAK,CAACG,cAAc,CAAC1C,GAAG,CAAC,IAAI,OAAOuC,KAAK,CAACvC,GAAG,CAAC,KAAK,QAAQ,EAAE;QAC/DyC,MAAM,CAACzC,GAAG,CAAC,GAAG,IAAI,CAACL,UAAU,CAAC4C,KAAK,CAACvC,GAAG,CAAC,EAAEwC,MAAM,CAACxC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;MAC9D;IACF;IAEA,OAAOyC,MAAM;EACf;AACF;AAEAE,MAAM,CAACC,OAAO,GAAG,IAAIzI,kBAAkB,CAAC,CAAC","ignoreList":[]}