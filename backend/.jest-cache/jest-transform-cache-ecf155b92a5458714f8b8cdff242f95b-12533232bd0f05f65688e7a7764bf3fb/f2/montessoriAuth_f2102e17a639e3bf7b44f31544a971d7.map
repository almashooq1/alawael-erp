{"version":3,"names":["express","require","jwt","User","router","Router","post","req","res","username","password","body","user","findOne","status","json","message","valid","comparePassword","token","sign","id","_id","role","name","process","env","JWT_SECRET","expiresIn","module","exports"],"sources":["montessoriAuth.js"],"sourcesContent":["const express = require('express');\r\nconst jwt = require('jsonwebtoken');\r\nconst User = require('../models/User');\r\nconst router = express.Router();\r\n\r\n// تسجيل الدخول (إرجاع JWT)\r\nrouter.post('/login', async (req, res) => {\r\n  const { username, password } = req.body;\r\n  const user = await User.findOne({ username });\r\n  if (!user) return res.status(401).json({ message: 'اسم المستخدم أو كلمة المرور غير صحيحة' });\r\n  const valid = await user.comparePassword(password);\r\n  if (!valid) return res.status(401).json({ message: 'اسم المستخدم أو كلمة المرور غير صحيحة' });\r\n  const token = jwt.sign(\r\n    { id: user._id, role: user.role, name: user.name },\r\n    process.env.JWT_SECRET,\r\n    { expiresIn: '12h' }\r\n  );\r\n  res.json({ token, user: { id: user._id, name: user.name, role: user.role } });\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAc,CAAC;AACnC,MAAME,IAAI,GAAGF,OAAO,CAAC,gBAAgB,CAAC;AACtC,MAAMG,MAAM,GAAGJ,OAAO,CAACK,MAAM,CAAC,CAAC;;AAE/B;AACAD,MAAM,CAACE,IAAI,CAAC,QAAQ,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACxC,MAAM;IAAEC,QAAQ;IAAEC;EAAS,CAAC,GAAGH,GAAG,CAACI,IAAI;EACvC,MAAMC,IAAI,GAAG,MAAMT,IAAI,CAACU,OAAO,CAAC;IAAEJ;EAAS,CAAC,CAAC;EAC7C,IAAI,CAACG,IAAI,EAAE,OAAOJ,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAAEC,OAAO,EAAE;EAAwC,CAAC,CAAC;EAC5F,MAAMC,KAAK,GAAG,MAAML,IAAI,CAACM,eAAe,CAACR,QAAQ,CAAC;EAClD,IAAI,CAACO,KAAK,EAAE,OAAOT,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAAEC,OAAO,EAAE;EAAwC,CAAC,CAAC;EAC7F,MAAMG,KAAK,GAAGjB,GAAG,CAACkB,IAAI,CACpB;IAAEC,EAAE,EAAET,IAAI,CAACU,GAAG;IAAEC,IAAI,EAAEX,IAAI,CAACW,IAAI;IAAEC,IAAI,EAAEZ,IAAI,CAACY;EAAK,CAAC,EAClDC,OAAO,CAACC,GAAG,CAACC,UAAU,EACtB;IAAEC,SAAS,EAAE;EAAM,CACrB,CAAC;EACDpB,GAAG,CAACO,IAAI,CAAC;IAAEI,KAAK;IAAEP,IAAI,EAAE;MAAES,EAAE,EAAET,IAAI,CAACU,GAAG;MAAEE,IAAI,EAAEZ,IAAI,CAACY,IAAI;MAAED,IAAI,EAAEX,IAAI,CAACW;IAAK;EAAE,CAAC,CAAC;AAC/E,CAAC,CAAC;AAEFM,MAAM,CAACC,OAAO,GAAG1B,MAAM","ignoreList":[]}