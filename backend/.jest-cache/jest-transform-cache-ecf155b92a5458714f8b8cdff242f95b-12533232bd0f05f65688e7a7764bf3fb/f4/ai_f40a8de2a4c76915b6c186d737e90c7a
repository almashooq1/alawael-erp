ef91f68dc1a2a8e6ae31cc590e02c502
// AI Attendance Prediction Route
const express = require('express');
const router = express.Router();

// AIService: منطق التوقع الحقيقي
const AIService = require('../services/aiService');

// POST /api/ai/predict-absence
router.post('/predict-absence', async (req, res) => {
  try {
    const {
      studentId,
      absencesLast30Days,
      attendanceRate,
      behaviorScore,
      performanceScore
    } = req.body;
    if (!studentId) return res.status(400).json({
      error: 'studentId required'
    });

    // بناء بيانات اليوم (يمكن تطويرها لاحقاً)
    const dayData = {
      dayOfWeek: new Date().toLocaleString('en-US', {
        weekday: 'long'
      }),
      absencesLast30Days,
      attendanceRate,
      behaviorScore,
      performanceScore
      // يمكن إضافة المزيد من الخصائص لاحقاً
    };

    // استدعاء منطق الذكاء الاصطناعي
    const aiResult = await AIService.predictAttendance(dayData);
    res.json({
      studentId,
      ...aiResult
    });
  } catch (err) {
    res.status(500).json({
      error: err.message
    });
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIkFJU2VydmljZSIsInBvc3QiLCJyZXEiLCJyZXMiLCJzdHVkZW50SWQiLCJhYnNlbmNlc0xhc3QzMERheXMiLCJhdHRlbmRhbmNlUmF0ZSIsImJlaGF2aW9yU2NvcmUiLCJwZXJmb3JtYW5jZVNjb3JlIiwiYm9keSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImRheURhdGEiLCJkYXlPZldlZWsiLCJEYXRlIiwidG9Mb2NhbGVTdHJpbmciLCJ3ZWVrZGF5IiwiYWlSZXN1bHQiLCJwcmVkaWN0QXR0ZW5kYW5jZSIsImVyciIsIm1lc3NhZ2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiYWkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQUkgQXR0ZW5kYW5jZSBQcmVkaWN0aW9uIFJvdXRlXHJcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcblxyXG4vLyBBSVNlcnZpY2U6INmF2YbYt9mCINin2YTYqtmI2YLYuSDYp9mE2K3ZgtmK2YLZilxyXG5jb25zdCBBSVNlcnZpY2UgPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9haVNlcnZpY2UnKTtcclxuXHJcbi8vIFBPU1QgL2FwaS9haS9wcmVkaWN0LWFic2VuY2Vcclxucm91dGVyLnBvc3QoJy9wcmVkaWN0LWFic2VuY2UnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBzdHVkZW50SWQsIGFic2VuY2VzTGFzdDMwRGF5cywgYXR0ZW5kYW5jZVJhdGUsIGJlaGF2aW9yU2NvcmUsIHBlcmZvcm1hbmNlU2NvcmUgfSA9XHJcbiAgICAgIHJlcS5ib2R5O1xyXG4gICAgaWYgKCFzdHVkZW50SWQpIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnc3R1ZGVudElkIHJlcXVpcmVkJyB9KTtcclxuXHJcbiAgICAvLyDYqNmG2KfYoSDYqNmK2KfZhtin2Kog2KfZhNmK2YjZhSAo2YrZhdmD2YYg2KrYt9mI2YrYsdmH2Kcg2YTYp9it2YLYp9mLKVxyXG4gICAgY29uc3QgZGF5RGF0YSA9IHtcclxuICAgICAgZGF5T2ZXZWVrOiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdlbi1VUycsIHsgd2Vla2RheTogJ2xvbmcnIH0pLFxyXG4gICAgICBhYnNlbmNlc0xhc3QzMERheXMsXHJcbiAgICAgIGF0dGVuZGFuY2VSYXRlLFxyXG4gICAgICBiZWhhdmlvclNjb3JlLFxyXG4gICAgICBwZXJmb3JtYW5jZVNjb3JlLFxyXG4gICAgICAvLyDZitmF2YPZhiDYpdi22KfZgdipINin2YTZhdiy2YrYryDZhdmGINin2YTYrti12KfYpti1INmE2KfYrdmC2KfZi1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyDYp9iz2KrYr9i52KfYoSDZhdmG2LfZgiDYp9mE2LDZg9in2KEg2KfZhNin2LXYt9mG2KfYudmKXHJcbiAgICBjb25zdCBhaVJlc3VsdCA9IGF3YWl0IEFJU2VydmljZS5wcmVkaWN0QXR0ZW5kYW5jZShkYXlEYXRhKTtcclxuICAgIHJlcy5qc29uKHsgc3R1ZGVudElkLCAuLi5haVJlc3VsdCB9KTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVyci5tZXNzYWdlIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7O0FBRS9CO0FBQ0EsTUFBTUMsU0FBUyxHQUFHSCxPQUFPLENBQUMsdUJBQXVCLENBQUM7O0FBRWxEO0FBQ0FDLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLGtCQUFrQixFQUFFLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ2xELElBQUk7SUFDRixNQUFNO01BQUVDLFNBQVM7TUFBRUMsa0JBQWtCO01BQUVDLGNBQWM7TUFBRUMsYUFBYTtNQUFFQztJQUFpQixDQUFDLEdBQ3RGTixHQUFHLENBQUNPLElBQUk7SUFDVixJQUFJLENBQUNMLFNBQVMsRUFBRSxPQUFPRCxHQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQUVDLEtBQUssRUFBRTtJQUFxQixDQUFDLENBQUM7O0lBRTVFO0lBQ0EsTUFBTUMsT0FBTyxHQUFHO01BQ2RDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxjQUFjLENBQUMsT0FBTyxFQUFFO1FBQUVDLE9BQU8sRUFBRTtNQUFPLENBQUMsQ0FBQztNQUNsRVosa0JBQWtCO01BQ2xCQyxjQUFjO01BQ2RDLGFBQWE7TUFDYkM7TUFDQTtJQUNGLENBQUM7O0lBRUQ7SUFDQSxNQUFNVSxRQUFRLEdBQUcsTUFBTWxCLFNBQVMsQ0FBQ21CLGlCQUFpQixDQUFDTixPQUFPLENBQUM7SUFDM0RWLEdBQUcsQ0FBQ1EsSUFBSSxDQUFDO01BQUVQLFNBQVM7TUFBRSxHQUFHYztJQUFTLENBQUMsQ0FBQztFQUN0QyxDQUFDLENBQUMsT0FBT0UsR0FBRyxFQUFFO0lBQ1pqQixHQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQUVDLEtBQUssRUFBRVEsR0FBRyxDQUFDQztJQUFRLENBQUMsQ0FBQztFQUM5QztBQUNGLENBQUMsQ0FBQztBQUVGQyxNQUFNLENBQUNDLE9BQU8sR0FBR3pCLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=