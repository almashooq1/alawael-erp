{"version":3,"names":["MeasurementType","MeasurementMaster","MeasurementResult","IndividualRehabPlan","QuickAssessment","require","RehabilitationProgram","ProgramProgress","ProgramSession","SmartEngine","MeasurementService","createMeasurementType","data","measurementType","code","nameAr","nameEn","category","description","targetDisabilities","ageRange","estimatedTime","isStandardized","normSource","scoringMethod","scoreRange","interpretationLevels","domains","administratedBy","save","error","Error","message","createMeasurementMaster","measurementMaster","typeId","version","administrationGuide","items","totalItems","estimatedDuration","scoringGuide","normTables","reliabilityCoefficients","validityInfo","interpretationGuide","requiredCertifications","culturalAdaptations","recordMeasurementResult","beneficiaryId","measurementResult","measurementId","dateAdministrated","rawScore","standardScore","percentileRank","ageEquivalent","gradeEquivalent","domainScores","overallLevel","interpretation","behavioralObservations","testingLimitations","recommendedFollowUp","status","saved","smartEngine","automatedPrograms","analyzeMeasurementAndActivatePrograms","_id","getBeneficiaryLatestResults","results","find","sort","populate","limit","compareMeasurementResults","measurementTypeId","length","trend","map","r","date","score","level","progress","d","domain","domainName","improvement","improvementPercentage","totalMeasurements","totalImprovement","toFixed","direction","createIndividualRehabPlan","planCode","generatePlanCode","irp","beneficiaryInfo","planningTeam","baseMeasurements","vision","mission","rehabilitationAreas","activePrograms","milestones","recommendations","familyInvolvement","externalCoordination","planPeriod","updateIndividualRehabPlan","planId","updateData","updated","findByIdAndUpdate","updatedAt","Date","new","getIndividualRehabPlan","plan","findOne","$in","generateComprehensiveReport","measurements","programs","overallStatus","report","generationDate","total","latest","history","active","filter","p","completed","individualPlan","summary","calculateOverallStatus","strengths","identifyStrengths","areasForImprovement","identifyAreasForImprovement","generateFinalRecommendations","recordProgramSession","programId","session","sessionNumber","scheduledDate","actualDate","sessionDuration","sessionType","facilitators","participants","content","performance","education","nextSteps","sessionOutcome","updateProgramProgress","sessionData","completedSessions","taskCompletion","i","objectiveProgress","totalPlannedSessions","count","countDocuments","year","getFullYear","String","padStart","weaknesses","push","module","exports"],"sources":["MeasurementService.js"],"sourcesContent":["/**\r\n * خدمات المقاييس والتقييمات الشاملة\r\n * Comprehensive Measurement Services\r\n * ==================================\r\n */\r\n\r\nconst {\r\n  MeasurementType,\r\n  MeasurementMaster,\r\n  MeasurementResult,\r\n  IndividualRehabPlan,\r\n  QuickAssessment\r\n} = require('../models/MeasurementModels');\r\n\r\nconst {\r\n  RehabilitationProgram,\r\n  ProgramProgress,\r\n  ProgramSession\r\n} = require('../models/RehabilitationProgramModels');\r\n\r\nconst SmartEngine = require('./SmartMeasurementProgramEngine');\r\n\r\nclass MeasurementService {\r\n  /**\r\n   * إنشاء نوع مقياس جديد\r\n   */\r\n  async createMeasurementType(data) {\r\n    try {\r\n      const measurementType = new MeasurementType({\r\n        code: data.code,\r\n        nameAr: data.nameAr,\r\n        nameEn: data.nameEn,\r\n        category: data.category,\r\n        description: data.description,\r\n        targetDisabilities: data.targetDisabilities,\r\n        ageRange: data.ageRange,\r\n        estimatedTime: data.estimatedTime,\r\n        isStandardized: data.isStandardized,\r\n        normSource: data.normSource,\r\n        scoringMethod: data.scoringMethod,\r\n        scoreRange: data.scoreRange,\r\n        interpretationLevels: data.interpretationLevels,\r\n        domains: data.domains,\r\n        administratedBy: data.administratedBy\r\n      });\r\n\r\n      return await measurementType.save();\r\n    } catch (error) {\r\n      throw new Error(`خطأ في إنشاء نوع المقياس: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إنشاء مقياس رئيسي\r\n   */\r\n  async createMeasurementMaster(data) {\r\n    try {\r\n      const measurementMaster = new MeasurementMaster({\r\n        code: data.code,\r\n        typeId: data.typeId,\r\n        nameAr: data.nameAr,\r\n        nameEn: data.nameEn,\r\n        description: data.description,\r\n        version: data.version,\r\n        targetDisabilities: data.targetDisabilities,\r\n        ageRange: data.ageRange,\r\n        administrationGuide: data.administrationGuide,\r\n        items: data.items,\r\n        totalItems: data.totalItems,\r\n        estimatedDuration: data.estimatedDuration,\r\n        scoringMethod: data.scoringMethod,\r\n        scoringGuide: data.scoringGuide,\r\n        normTables: data.normTables,\r\n        reliabilityCoefficients: data.reliabilityCoefficients,\r\n        validityInfo: data.validityInfo,\r\n        interpretationGuide: data.interpretationGuide,\r\n        requiredCertifications: data.requiredCertifications,\r\n        culturalAdaptations: data.culturalAdaptations\r\n      });\r\n\r\n      return await measurementMaster.save();\r\n    } catch (error) {\r\n      throw new Error(`خطأ في إنشاء المقياس الرئيسي: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تسجيل نتيجة قياس جديدة\r\n   */\r\n  async recordMeasurementResult(beneficiaryId, data) {\r\n    try {\r\n      const measurementResult = new MeasurementResult({\r\n        beneficiaryId,\r\n        measurementId: data.measurementId,\r\n        typeId: data.typeId,\r\n        administratedBy: data.administratedBy,\r\n        dateAdministrated: data.dateAdministrated,\r\n        rawScore: data.rawScore,\r\n        standardScore: data.standardScore,\r\n        percentileRank: data.percentileRank,\r\n        ageEquivalent: data.ageEquivalent,\r\n        gradeEquivalent: data.gradeEquivalent,\r\n        domainScores: data.domainScores,\r\n        overallLevel: data.overallLevel,\r\n        interpretation: data.interpretation,\r\n        behavioralObservations: data.behavioralObservations,\r\n        testingLimitations: data.testingLimitations,\r\n        recommendedFollowUp: data.recommendedFollowUp,\r\n        status: 'PENDING_REVIEW'\r\n      });\r\n\r\n      const saved = await measurementResult.save();\r\n\r\n      // تفعيل محرك الربط الذكي\r\n      const smartEngine = new SmartEngine();\r\n      const automatedPrograms = await smartEngine.analyzeMeasurementAndActivatePrograms(\r\n        saved._id\r\n      );\r\n\r\n      return {\r\n        measurementResult: saved,\r\n        automatedPrograms\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`خطأ في تسجيل نتيجة القياس: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على آخر نتائج المستفيد\r\n   */\r\n  async getBeneficiaryLatestResults(beneficiaryId) {\r\n    try {\r\n      const results = await MeasurementResult.find({\r\n        beneficiaryId,\r\n        status: 'APPROVED'\r\n      })\r\n        .sort({ dateAdministrated: -1 })\r\n        .populate('measurementId')\r\n        .populate('typeId')\r\n        .limit(10);\r\n\r\n      return results;\r\n    } catch (error) {\r\n      throw new Error(`خطأ في جلب النتائج: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * مقارنة نتائج القياس عبر الزمن\r\n   */\r\n  async compareMeasurementResults(beneficiaryId, measurementTypeId) {\r\n    try {\r\n      const results = await MeasurementResult.find({\r\n        beneficiaryId,\r\n        typeId: measurementTypeId,\r\n        status: 'APPROVED'\r\n      })\r\n        .sort({ dateAdministrated: 1 })\r\n        .populate('typeId');\r\n\r\n      if (results.length < 2) {\r\n        return {\r\n          message: 'لا توجد نتائج كافية للمقارنة',\r\n          results\r\n        };\r\n      }\r\n\r\n      // حساب الفرق\r\n      const trend = results.map(r => ({\r\n        date: r.dateAdministrated,\r\n        score: r.rawScore,\r\n        level: r.overallLevel,\r\n        progress: r.domainScores?.map(d => ({\r\n          domain: d.domainName,\r\n          score: d.standardScore\r\n        }))\r\n      }));\r\n\r\n      const improvement = results[results.length - 1].rawScore - results[0].rawScore;\r\n      const improvementPercentage = (improvement / results[0].rawScore) * 100;\r\n\r\n      return {\r\n        totalMeasurements: results.length,\r\n        trend,\r\n        totalImprovement: improvement,\r\n        improvementPercentage: improvementPercentage.toFixed(2),\r\n        direction: improvement > 0 ? 'تحسن' : improvement < 0 ? 'انخفاض' : 'مستقر'\r\n      };\r\n    } catch (error) {\r\n      throw new Error(`خطأ في مقارنة النتائج: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إنشاء خطة تأهيلية فردية\r\n   */\r\n  async createIndividualRehabPlan(beneficiaryId, data) {\r\n    try {\r\n      const planCode = await this.generatePlanCode();\r\n\r\n      const irp = new IndividualRehabPlan({\r\n        beneficiaryId,\r\n        planCode,\r\n        beneficiaryInfo: data.beneficiaryInfo,\r\n        planningTeam: data.planningTeam,\r\n        baseMeasurements: data.baseMeasurements,\r\n        vision: data.vision,\r\n        mission: data.mission,\r\n        rehabilitationAreas: data.rehabilitationAreas,\r\n        activePrograms: data.activePrograms,\r\n        milestones: data.milestones,\r\n        recommendations: data.recommendations,\r\n        familyInvolvement: data.familyInvolvement,\r\n        externalCoordination: data.externalCoordination,\r\n        planPeriod: data.planPeriod,\r\n        status: 'DRAFT'\r\n      });\r\n\r\n      return await irp.save();\r\n    } catch (error) {\r\n      throw new Error(`خطأ في إنشاء خطة التأهيل: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تحديث خطة تأهيلية فردية\r\n   */\r\n  async updateIndividualRehabPlan(planId, updateData) {\r\n    try {\r\n      const updated = await IndividualRehabPlan.findByIdAndUpdate(\r\n        planId,\r\n        {\r\n          ...updateData,\r\n          updatedAt: new Date()\r\n        },\r\n        { new: true }\r\n      );\r\n\r\n      return updated;\r\n    } catch (error) {\r\n      throw new Error(`خطأ في تحديث خطة التأهيل: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * الحصول على خطة التأهيل الفردية\r\n   */\r\n  async getIndividualRehabPlan(beneficiaryId) {\r\n    try {\r\n      const plan = await IndividualRehabPlan.findOne({\r\n        beneficiaryId,\r\n        status: { $in: ['DRAFT', 'ACTIVE', 'UNDER_REVIEW'] }\r\n      })\r\n        .populate('planningTeam.userId')\r\n        .populate('baseMeasurements.resultId')\r\n        .populate('activePrograms.programId');\r\n\r\n      return plan;\r\n    } catch (error) {\r\n      throw new Error(`خطأ في جلب خطة التأهيل: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * إنشاء تقرير شامل للمستفيد\r\n   */\r\n  async generateComprehensiveReport(beneficiaryId) {\r\n    try {\r\n      const smartEngine = new SmartEngine();\r\n      \r\n      // جلب البيانات الشاملة\r\n      const measurements = await MeasurementResult.find({\r\n        beneficiaryId,\r\n        status: 'APPROVED'\r\n      })\r\n        .sort({ dateAdministrated: -1 })\r\n        .populate('typeId')\r\n        .populate('measurementId')\r\n        .limit(15);\r\n\r\n      const programs = await ProgramProgress.find({\r\n        beneficiaryId,\r\n        overallStatus: { $in: ['ACTIVE', 'COMPLETED'] }\r\n      })\r\n        .populate('programId');\r\n\r\n      const irp = await IndividualRehabPlan.findOne({\r\n        beneficiaryId,\r\n        status: { $in: ['ACTIVE'] }\r\n      });\r\n\r\n      // توليد التقرير\r\n      const report = {\r\n        beneficiaryId,\r\n        generationDate: new Date(),\r\n        measurements: {\r\n          total: measurements.length,\r\n          latest: measurements[0],\r\n          history: measurements\r\n        },\r\n        programs: {\r\n          active: programs.filter(p => p.overallStatus === 'ACTIVE'),\r\n          completed: programs.filter(p => p.overallStatus === 'COMPLETED')\r\n        },\r\n        individualPlan: irp,\r\n        summary: {\r\n          overallStatus: this.calculateOverallStatus(measurements, programs),\r\n          strengths: this.identifyStrengths(measurements),\r\n          areasForImprovement: this.identifyAreasForImprovement(measurements),\r\n          recommendations: this.generateFinalRecommendations(measurements, programs)\r\n        }\r\n      };\r\n\r\n      return report;\r\n    } catch (error) {\r\n      throw new Error(`خطأ في إنشاء التقرير الشامل: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تسجيل جلسة برنامج\r\n   */\r\n  async recordProgramSession(beneficiaryId, programId, data) {\r\n    try {\r\n      const session = new ProgramSession({\r\n        beneficiaryId,\r\n        programId,\r\n        sessionNumber: data.sessionNumber,\r\n        scheduledDate: data.scheduledDate,\r\n        actualDate: data.actualDate || new Date(),\r\n        sessionDuration: data.sessionDuration,\r\n        sessionType: data.sessionType,\r\n        facilitators: data.facilitators,\r\n        participants: data.participants,\r\n        content: data.content,\r\n        performance: data.performance,\r\n        education: data.education,\r\n        nextSteps: data.nextSteps,\r\n        sessionOutcome: data.sessionOutcome,\r\n        status: 'COMPLETED'\r\n      });\r\n\r\n      const saved = await session.save();\r\n\r\n      // تحديث تقدم البرنامج\r\n      await this.updateProgramProgress(beneficiaryId, programId, data);\r\n\r\n      return saved;\r\n    } catch (error) {\r\n      throw new Error(`خطأ في تسجيل جلسة البرنامج: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * تحديث تقدم البرنامج\r\n   */\r\n  async updateProgramProgress(beneficiaryId, programId, sessionData) {\r\n    try {\r\n      const progress = await ProgramProgress.findOne({\r\n        beneficiaryId,\r\n        programId\r\n      });\r\n\r\n      if (!progress) return;\r\n\r\n      progress.completedSessions = (progress.completedSessions || 0) + 1;\r\n\r\n      // تحديث تقدم الأهداف\r\n      if (sessionData.performance?.taskCompletion) {\r\n        for (let i = 0; i < progress.objectiveProgress.length; i++) {\r\n          progress.objectiveProgress[i].progress += \r\n            (sessionData.performance.taskCompletion / progress.totalPlannedSessions);\r\n        }\r\n      }\r\n\r\n      return await progress.save();\r\n    } catch (error) {\r\n      throw new Error(`خطأ في تحديث تقدم البرنامج: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * دوال مساعدة\r\n   */\r\n  async generatePlanCode() {\r\n    const count = await IndividualRehabPlan.countDocuments();\r\n    const year = new Date().getFullYear();\r\n    return `IRP-${year}-${String(count + 1).padStart(5, '0')}`;\r\n  }\r\n\r\n  calculateOverallStatus(measurements, programs) {\r\n    if (!measurements.length) return 'جديد';\r\n    return measurements[0].overallLevel;\r\n  }\r\n\r\n  identifyStrengths(measurements) {\r\n    if (!measurements.length) return [];\r\n    \r\n    const latest = measurements[0];\r\n    return latest.interpretation?.strengths || [];\r\n  }\r\n\r\n  identifyAreasForImprovement(measurements) {\r\n    if (!measurements.length) return [];\r\n    \r\n    const latest = measurements[0];\r\n    return latest.interpretation?.weaknesses || [];\r\n  }\r\n\r\n  generateFinalRecommendations(measurements, programs) {\r\n    const recommendations = [];\r\n\r\n    if (measurements.length === 0) {\r\n      recommendations.push('تقييم شامل مطلوب');\r\n      return recommendations;\r\n    }\r\n\r\n    const latest = measurements[0];\r\n    recommendations.push(...(latest.interpretation?.recommendations || []));\r\n\r\n    if (programs.filter(p => p.overallStatus === 'ACTIVE').length === 0) {\r\n      recommendations.push('تفعيل برامج تدخلية');\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n}\r\n\r\nmodule.exports = MeasurementService;\r\n"],"mappings":"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","ignoreList":[]}