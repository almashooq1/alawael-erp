{"version":3,"names":["express","require","router","Router","mfaController","protect","get","getMFASetupGuide","post","verifyMFALogin","initiateTOTPSetup","verifyAndEnableTOTP","initiateEmailOTP","verifyAndEnableEmailOTP","initiateSMSOTP","verifyAndEnableSMSOTP","getMFASettings","disableMFAMethod","trustDevice","getTrustedDevices","delete","revokeTrustedDevice","module","exports"],"sources":["mfa.js"],"sourcesContent":["/**\r\n * MFA Routes\r\n * مسارات المصادقة متعددة العوامل\r\n */\r\n\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst mfaController = require('../controllers/mfaController');\r\nconst { protect } = require('../middleware/auth');\r\n\r\n// ============ PUBLIC ROUTES ============\r\n\r\n/**\r\n * GET /api/mfa/setup-guide\r\n * Get MFA setup guide and information\r\n */\r\nrouter.get('/setup-guide', mfaController.getMFASetupGuide);\r\n\r\n/**\r\n * POST /api/mfa/login/verify\r\n * Verify MFA during login (requires MFA session)\r\n */\r\nrouter.post('/login/verify', mfaController.verifyMFALogin);\r\n\r\n// ============ PROTECTED ROUTES (requires authentication) ============\r\n\r\n/**\r\n * TOTP Setup Routes\r\n */\r\n\r\n/**\r\n * POST /api/mfa/totp/initiate\r\n * Initiate TOTP setup - returns QR code\r\n */\r\nrouter.post('/totp/initiate', protect, mfaController.initiateTOTPSetup);\r\n\r\n/**\r\n * POST /api/mfa/totp/verify\r\n * Verify TOTP token and enable TOTP\r\n */\r\nrouter.post('/totp/verify', protect, mfaController.verifyAndEnableTOTP);\r\n\r\n/**\r\n * Email OTP Routes\r\n */\r\n\r\n/**\r\n * POST /api/mfa/email/initiate\r\n * Send OTP via email\r\n */\r\nrouter.post('/email/initiate', protect, mfaController.initiateEmailOTP);\r\n\r\n/**\r\n * POST /api/mfa/email/verify\r\n * Verify email OTP and enable\r\n */\r\nrouter.post('/email/verify', protect, mfaController.verifyAndEnableEmailOTP);\r\n\r\n/**\r\n * SMS OTP Routes\r\n */\r\n\r\n/**\r\n * POST /api/mfa/sms/initiate\r\n * Send OTP via SMS\r\n */\r\nrouter.post('/sms/initiate', protect, mfaController.initiateSMSOTP);\r\n\r\n/**\r\n * POST /api/mfa/sms/verify\r\n * Verify SMS OTP and enable\r\n */\r\nrouter.post('/sms/verify', protect, mfaController.verifyAndEnableSMSOTP);\r\n\r\n/**\r\n * Settings Routes\r\n */\r\n\r\n/**\r\n * GET /api/mfa/settings\r\n * Get user's MFA settings\r\n */\r\nrouter.get('/settings', protect, mfaController.getMFASettings);\r\n\r\n/**\r\n * POST /api/mfa/settings/disable-method\r\n * Disable a specific MFA method\r\n */\r\nrouter.post('/settings/disable-method', protect, mfaController.disableMFAMethod);\r\n\r\n/**\r\n * Trusted Device Routes\r\n */\r\n\r\n/**\r\n * POST /api/mfa/device/trust\r\n * Mark current device as trusted\r\n */\r\nrouter.post('/device/trust', protect, mfaController.trustDevice);\r\n\r\n/**\r\n * GET /api/mfa/device/list\r\n * Get list of trusted devices\r\n */\r\nrouter.get('/device/list', protect, mfaController.getTrustedDevices);\r\n\r\n/**\r\n * DELETE /api/mfa/device/:deviceId\r\n * Revoke trust for a device\r\n */\r\nrouter.delete('/device/:deviceId', protect, mfaController.revokeTrustedDevice);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,aAAa,GAAGH,OAAO,CAAC,8BAA8B,CAAC;AAC7D,MAAM;EAAEI;AAAQ,CAAC,GAAGJ,OAAO,CAAC,oBAAoB,CAAC;;AAEjD;;AAEA;AACA;AACA;AACA;AACAC,MAAM,CAACI,GAAG,CAAC,cAAc,EAAEF,aAAa,CAACG,gBAAgB,CAAC;;AAE1D;AACA;AACA;AACA;AACAL,MAAM,CAACM,IAAI,CAAC,eAAe,EAAEJ,aAAa,CAACK,cAAc,CAAC;;AAE1D;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACAP,MAAM,CAACM,IAAI,CAAC,gBAAgB,EAAEH,OAAO,EAAED,aAAa,CAACM,iBAAiB,CAAC;;AAEvE;AACA;AACA;AACA;AACAR,MAAM,CAACM,IAAI,CAAC,cAAc,EAAEH,OAAO,EAAED,aAAa,CAACO,mBAAmB,CAAC;;AAEvE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACAT,MAAM,CAACM,IAAI,CAAC,iBAAiB,EAAEH,OAAO,EAAED,aAAa,CAACQ,gBAAgB,CAAC;;AAEvE;AACA;AACA;AACA;AACAV,MAAM,CAACM,IAAI,CAAC,eAAe,EAAEH,OAAO,EAAED,aAAa,CAACS,uBAAuB,CAAC;;AAE5E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACAX,MAAM,CAACM,IAAI,CAAC,eAAe,EAAEH,OAAO,EAAED,aAAa,CAACU,cAAc,CAAC;;AAEnE;AACA;AACA;AACA;AACAZ,MAAM,CAACM,IAAI,CAAC,aAAa,EAAEH,OAAO,EAAED,aAAa,CAACW,qBAAqB,CAAC;;AAExE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACAb,MAAM,CAACI,GAAG,CAAC,WAAW,EAAED,OAAO,EAAED,aAAa,CAACY,cAAc,CAAC;;AAE9D;AACA;AACA;AACA;AACAd,MAAM,CAACM,IAAI,CAAC,0BAA0B,EAAEH,OAAO,EAAED,aAAa,CAACa,gBAAgB,CAAC;;AAEhF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACAf,MAAM,CAACM,IAAI,CAAC,eAAe,EAAEH,OAAO,EAAED,aAAa,CAACc,WAAW,CAAC;;AAEhE;AACA;AACA;AACA;AACAhB,MAAM,CAACI,GAAG,CAAC,cAAc,EAAED,OAAO,EAAED,aAAa,CAACe,iBAAiB,CAAC;;AAEpE;AACA;AACA;AACA;AACAjB,MAAM,CAACkB,MAAM,CAAC,mBAAmB,EAAEf,OAAO,EAAED,aAAa,CAACiB,mBAAmB,CAAC;AAE9EC,MAAM,CAACC,OAAO,GAAGrB,MAAM","ignoreList":[]}