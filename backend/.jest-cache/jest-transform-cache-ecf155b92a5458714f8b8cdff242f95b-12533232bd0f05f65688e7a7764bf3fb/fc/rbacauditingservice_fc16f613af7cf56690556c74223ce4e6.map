{"version":3,"names":["RBACAuditingService","constructor","config","auditLog","securityIncidents","complianceReports","accessPatterns","Map","maxLogSize","retentionDays","encryptLogs","alertingEnabled","startCleanupTimer","logAuditEvent","eventData","auditEntry","id","_generateId","timestamp","Date","eventType","userId","actor","action","resource","resourceId","status","statusCode","before","after","changes","ipAddress","userAgent","sessionId","correlationId","metadata","severity","_calculateSeverity","tags","push","length","slice","_analyzeForIncidents","queryAuditLog","query","results","filters","filter","e","Array","isArray","includes","startDate","endDate","search","searchLower","toLowerCase","sort","a","b","sortBy","sortOrder","limit","offset","total","returned","incidents","failedAttempts","now","type","attemptCount","_isNormalAccessPattern","details","time","incident","reportSecurityIncident","report","reportedAt","notes","_triggerAlert","getSecurityIncidents","i","generateAuditReport","reportConfig","relevantLogs","generatedAt","period","summary","totalEvents","successfulActions","failedActions","uniqueUsers","Set","map","size","avgEventsPerDay","Math","round","eventDistribution","_calculateEventDistribution","userActivity","_calculateUserActivity","resourceActivity","_calculateResourceActivity","changesSummary","rolesCreated","rolesModified","rolesDeleted","permissionsChanged","securitySummary","totalIncidents","highSeverityIncidents","recommendations","_generateRecommendations","generateComplianceReport","checks","auditLoggingEnabled","accessControlImplemented","roleHierarchyDefined","permissionAssignmentDocumented","incidentResponseProcedureInPlace","riskAssessment","overallRisk","highRiskAreas","certifications","SOC2","HIPAA","GDPR","recordNormalPattern","context","key","has","set","occurrences","times","locations","devices","pattern","get","getHours","location","device","shift","currentHour","avgHour","reduce","abs","logs","distribution","forEach","log","activity","totalActions","actions","accesses","modifications","deletions","users","add","Object","keys","from","failureRate","priority","title","description","toFixed","rolesCount","flatMap","roles","severityMap","console","warn","random","toString","substr","setInterval","cutoffDate","originalLength","oldIncidentsLength","exportAuditLogs","format","_exportAsCSV","exportDate","totalRecords","data","headers","rows","toISOString","csv","join","row","cell","getSecuritySummary","last7Days","last30Days","failures","criticalEvents","activeIncidents","highRiskIncidents","getUserAccessHistory","userLogs","module","exports"],"sources":["rbac-auditing.service.js"],"sourcesContent":["/**\r\n * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n * ðŸ“‹ RBAC Auditing Service - Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©\r\n * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n * \r\n * ÙŠÙˆÙØ± Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ù…Ø¹:\r\n * âœ… ØªØªØ¨Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª\r\n * âœ… ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø©\r\n * âœ… ÙƒØ´Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©\r\n * âœ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ØªÙˆØ§ÙÙ‚ÙŠØ§Øª\r\n */\r\n\r\nclass RBACAuditingService {\r\n  constructor(config = {}) {\r\n    this.auditLog = [];\r\n    this.securityIncidents = [];\r\n    this.complianceReports = [];\r\n    this.accessPatterns = new Map();\r\n    this.config = {\r\n      maxLogSize: config.maxLogSize || 100000,\r\n      retentionDays: config.retentionDays || 90,\r\n      encryptLogs: config.encryptLogs || false,\r\n      alertingEnabled: config.alertingEnabled || true,\r\n      ...config\r\n    };\r\n    \r\n    this.startCleanupTimer();\r\n  }\r\n\r\n  /**\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   * 1ï¸âƒ£ AUDIT LOG MANAGEMENT - Ø¥Ø¯Ø§Ø±Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   */\r\n\r\n  /**\r\n   * Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« ØªØ¯Ù‚ÙŠÙ‚\r\n   */\r\n  logAuditEvent(eventData) {\r\n    const auditEntry = {\r\n      id: this._generateId(),\r\n      timestamp: new Date(),\r\n      eventType: eventData.eventType,\r\n      userId: eventData.userId,\r\n      actor: eventData.actor || 'system',\r\n      \r\n      // Action Details\r\n      action: eventData.action,\r\n      resource: eventData.resource,\r\n      resourceId: eventData.resourceId,\r\n      \r\n      // Status\r\n      status: eventData.status || 'success', // success, failure, partial\r\n      statusCode: eventData.statusCode || 200,\r\n      \r\n      // Change Details\r\n      before: eventData.before || {},\r\n      after: eventData.after || {},\r\n      changes: eventData.changes || [],\r\n      \r\n      // Context\r\n      ipAddress: eventData.ipAddress,\r\n      userAgent: eventData.userAgent,\r\n      sessionId: eventData.sessionId,\r\n      correlationId: eventData.correlationId,\r\n      \r\n      // Metadata\r\n      metadata: eventData.metadata || {},\r\n      severity: eventData.severity || this._calculateSeverity(eventData.eventType),\r\n      tags: eventData.tags || []\r\n    };\r\n\r\n    this.auditLog.push(auditEntry);\r\n\r\n    // Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø­Ø¯ Ø£Ù‚ØµÙ‰\r\n    if (this.auditLog.length > this.config.maxLogSize) {\r\n      this.auditLog = this.auditLog.slice(-this.config.maxLogSize);\r\n    }\r\n\r\n    // ÙØ­Øµ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©\r\n    this._analyzeForIncidents(auditEntry);\r\n\r\n    return auditEntry;\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ù…Ø¹ Ø§Ù„ØªØµÙÙŠØ© ÙˆØ§Ù„Ø¨Ø­Ø«\r\n   */\r\n  queryAuditLog(query = {}) {\r\n    let results = this.auditLog;\r\n\r\n    // Handle filters object if provided\r\n    const filters = query.filters || query;\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹\r\n    if (filters.eventType) {\r\n      results = results.filter(e =>\r\n        Array.isArray(filters.eventType)\r\n          ? filters.eventType.includes(e.eventType)\r\n          : e.eventType === filters.eventType\r\n      );\r\n    }\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…\r\n    if (filters.userId) {\r\n      results = results.filter(e => e.userId === filters.userId);\r\n    }\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡\r\n    if (filters.action) {\r\n      results = results.filter(e => e.action === filters.action);\r\n    }\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ±Ø¯\r\n    if (filters.resource) {\r\n      results = results.filter(e => e.resource === filters.resource);\r\n    }\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©\r\n    if (filters.status) {\r\n      results = results.filter(e => e.status === filters.status);\r\n    }\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø´Ø¯Ø© Ø§Ù„Ø­Ø¯Ø«\r\n    if (filters.severity) {\r\n      results = results.filter(e => e.severity === filters.severity);\r\n    }\r\n\r\n    // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø²Ù…Ù†ÙŠ\r\n    if (filters.startDate) {\r\n      results = results.filter(e => e.timestamp >= filters.startDate);\r\n    }\r\n\r\n    if (filters.endDate) {\r\n      results = results.filter(e => e.timestamp <= filters.endDate);\r\n    }\r\n\r\n    // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ\r\n    if (filters.search) {\r\n      const searchLower = filters.search.toLowerCase();\r\n      results = results.filter(e =>\r\n        e.action?.toLowerCase().includes(searchLower) ||\r\n        e.resource?.toLowerCase().includes(searchLower) ||\r\n        e.userId?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    // Ø§Ù„ØªØ±ØªÙŠØ¨\r\n    const sort = (a, b) => {\r\n      if (filters.sortBy === 'timestamp') {\r\n        return filters.sortOrder === 'asc'\r\n          ? a.timestamp - b.timestamp\r\n          : b.timestamp - a.timestamp;\r\n      }\r\n      return 0;\r\n    };\r\n\r\n    results = results.sort(sort);\r\n\r\n    // Ø§Ù„Ø­Ø¯ Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬\r\n    if (filters.limit || query.limit) {\r\n      results = results.slice(0, filters.limit || query.limit);\r\n    }\r\n\r\n    if (filters.offset || query.offset) {\r\n      results = results.slice(filters.offset || query.offset);\r\n    }\r\n\r\n    return {\r\n      total: this.auditLog.length,\r\n      returned: results.length,\r\n      results\r\n    };\r\n  }\r\n\r\n  /**\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   * 2ï¸âƒ£ INCIDENT DETECTION - ÙƒØ´Ù Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   */\r\n\r\n  /**\r\n   * ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„ÙƒØ´Ù Ø§Ù„Ø­ÙˆØ§Ø¯Ø«\r\n   */\r\n  _analyzeForIncidents(auditEntry) {\r\n    const incidents = [];\r\n\r\n    // ÙƒØ´Ù Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…ØªÙƒØ±Ø±Ø© Ø§Ù„ÙØ§Ø´Ù„Ø©\r\n    if (auditEntry.status === 'failure') {\r\n      const failedAttempts = this.auditLog\r\n        .filter(e =>\r\n          e.userId === auditEntry.userId &&\r\n          e.action === auditEntry.action &&\r\n          e.status === 'failure' &&\r\n          e.timestamp > new Date(Date.now() - 3600000) // Ø¢Ø®Ø± Ø³Ø§Ø¹Ø©\r\n        );\r\n\r\n      if (failedAttempts.length >= 5) {\r\n        incidents.push({\r\n          type: 'BRUTE_FORCE_ATTEMPT',\r\n          severity: 'high',\r\n          userId: auditEntry.userId,\r\n          action: auditEntry.action,\r\n          attemptCount: failedAttempts.length,\r\n          timestamp: new Date()\r\n        });\r\n      }\r\n    }\r\n\r\n    // ÙƒØ´Ù Ø§Ù„ÙˆØµÙˆÙ„ ØºÙŠØ± Ø§Ù„Ù…Ø¹ØªØ§Ø¯\r\n    if (!this._isNormalAccessPattern(auditEntry)) {\r\n      incidents.push({\r\n        type: 'ABNORMAL_ACCESS_PATTERN',\r\n        severity: 'medium',\r\n        userId: auditEntry.userId,\r\n        timestamp: new Date(),\r\n        details: {\r\n          action: auditEntry.action,\r\n          resource: auditEntry.resource,\r\n          time: auditEntry.timestamp\r\n        }\r\n      });\r\n    }\r\n\r\n    // ÙƒØ´Ù Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ…\r\n    if (auditEntry.eventType === 'ROLE_DELETED' || \r\n        auditEntry.eventType === 'PERMISSION_REVOKED') {\r\n      incidents.push({\r\n        type: 'SENSITIVE_OPERATION',\r\n        severity: 'high',\r\n        userId: auditEntry.userId,\r\n        actor: auditEntry.actor,\r\n        action: auditEntry.action,\r\n        timestamp: new Date()\r\n      });\r\n    }\r\n\r\n    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ù…ÙƒØªØ´ÙØ©\r\n    for (const incident of incidents) {\r\n      this.reportSecurityIncident(incident);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ØªÙ‚Ø±ÙŠØ± Ø­Ø§Ø¯Ø«Ø© Ø£Ù…Ù†ÙŠØ©\r\n   */\r\n  reportSecurityIncident(incident) {\r\n    const report = {\r\n      id: this._generateId(),\r\n      ...incident,\r\n      reportedAt: new Date(),\r\n      status: 'open', // open, investigating, resolved, closed\r\n      notes: []\r\n    };\r\n\r\n    this.securityIncidents.push(report);\r\n\r\n    // ØªÙ†Ø¨ÙŠÙ‡Ø§Øª\r\n    if (this.config.alertingEnabled) {\r\n      this._triggerAlert(report);\r\n    }\r\n\r\n    return report;\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©\r\n   */\r\n  getSecurityIncidents(filters = {}) {\r\n    let incidents = this.securityIncidents;\r\n\r\n    if (filters.status) {\r\n      incidents = incidents.filter(i => i.status === filters.status);\r\n    }\r\n\r\n    if (filters.severity) {\r\n      incidents = incidents.filter(i => i.severity === filters.severity);\r\n    }\r\n\r\n    if (filters.type) {\r\n      incidents = incidents.filter(i => i.type === filters.type);\r\n    }\r\n\r\n    return incidents.sort((a, b) => b.reportedAt - a.reportedAt);\r\n  }\r\n\r\n  /**\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   * 3ï¸âƒ£ REPORTING - Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   */\r\n\r\n  /**\r\n   * ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚\r\n   */\r\n  generateAuditReport(reportConfig = {}) {\r\n    const startDate = reportConfig.startDate || new Date(Date.now() - 2592000000); // 30 days\r\n    const endDate = reportConfig.endDate || new Date();\r\n\r\n    const relevantLogs = this.auditLog.filter(e =>\r\n      e.timestamp >= startDate && e.timestamp <= endDate\r\n    );\r\n\r\n    const report = {\r\n      id: this._generateId(),\r\n      generatedAt: new Date(),\r\n      period: { startDate, endDate },\r\n      \r\n      // Summary Statistics\r\n      summary: {\r\n        totalEvents: relevantLogs.length,\r\n        successfulActions: relevantLogs.filter(e => e.status === 'success').length,\r\n        failedActions: relevantLogs.filter(e => e.status === 'failure').length,\r\n        uniqueUsers: new Set(relevantLogs.map(e => e.userId)).size,\r\n        avgEventsPerDay: Math.round(relevantLogs.length / 30)\r\n      },\r\n\r\n      // Event Distribution\r\n      eventDistribution: this._calculateEventDistribution(relevantLogs),\r\n      userActivity: this._calculateUserActivity(relevantLogs),\r\n      resourceActivity: this._calculateResourceActivity(relevantLogs),\r\n      \r\n      // Changes Summary\r\n      changesSummary: {\r\n        rolesCreated: relevantLogs.filter(e => e.eventType === 'ROLE_CREATED').length,\r\n        rolesModified: relevantLogs.filter(e => e.eventType === 'ROLE_UPDATED').length,\r\n        rolesDeleted: relevantLogs.filter(e => e.eventType === 'ROLE_DELETED').length,\r\n        permissionsChanged: relevantLogs.filter(e => e.eventType === 'PERMISSION_CHANGED').length\r\n      },\r\n\r\n      // Security Summary\r\n      securitySummary: {\r\n        totalIncidents: this.securityIncidents.filter(i =>\r\n          i.reportedAt >= startDate && i.reportedAt <= endDate\r\n        ).length,\r\n        highSeverityIncidents: this.securityIncidents.filter(i =>\r\n          i.severity === 'high' && i.reportedAt >= startDate && i.reportedAt <= endDate\r\n        ).length\r\n      },\r\n\r\n      // Recommendations\r\n      recommendations: this._generateRecommendations(relevantLogs)\r\n    };\r\n\r\n    this.complianceReports.push(report);\r\n    return report;\r\n  }\r\n\r\n  /**\r\n   * ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„\r\n   */\r\n  generateComplianceReport() {\r\n    const report = {\r\n      id: this._generateId(),\r\n      generatedAt: new Date(),\r\n      timestamp: new Date(),\r\n      \r\n      // Compliance Checks\r\n      checks: {\r\n        auditLoggingEnabled: true,\r\n        accessControlImplemented: true,\r\n        roleHierarchyDefined: true,\r\n        permissionAssignmentDocumented: true,\r\n        incidentResponseProcedureInPlace: true\r\n      },\r\n\r\n      // Risk Assessment\r\n      riskAssessment: {\r\n        overallRisk: 'medium',\r\n        highRiskAreas: [],\r\n        recommendations: []\r\n      },\r\n\r\n      // Certifications\r\n      certifications: {\r\n        SOC2: 'compliant',\r\n        HIPAA: 'partial',\r\n        GDPR: 'compliant'\r\n      }\r\n    };\r\n\r\n    return report;\r\n  }\r\n\r\n  /**\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   * 4ï¸âƒ£ PATTERN ANALYSIS - ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø·\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   */\r\n\r\n  /**\r\n   * ØªØ³Ø¬ÙŠÙ„ Ù†Ù…Ø· Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ\r\n   */\r\n  recordNormalPattern(userId, action, context = {}) {\r\n    const key = `${userId}:${action}`;\r\n\r\n    if (!this.accessPatterns.has(key)) {\r\n      this.accessPatterns.set(key, {\r\n        occurrences: 0,\r\n        times: [],\r\n        locations: [],\r\n        devices: []\r\n      });\r\n    }\r\n\r\n    const pattern = this.accessPatterns.get(key);\r\n    pattern.occurrences++;\r\n    pattern.times.push(new Date().getHours());\r\n    if (context.location) pattern.locations.push(context.location);\r\n    if (context.device) pattern.devices.push(context.device);\r\n\r\n    // Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ 100 Ø­Ø¯Ø« ÙÙ‚Ø·\r\n    if (pattern.times.length > 100) {\r\n      pattern.times.shift();\r\n      pattern.locations.shift();\r\n      pattern.devices.shift();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†Ù…Ø· Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ\r\n   */\r\n  _isNormalAccessPattern(auditEntry) {\r\n    const key = `${auditEntry.userId}:${auditEntry.action}`;\r\n    const pattern = this.accessPatterns.get(key);\r\n\r\n    if (!pattern || pattern.occurrences < 5) {\r\n      return true; // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ\r\n    }\r\n\r\n    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø©\r\n    const currentHour = new Date().getHours();\r\n    const avgHour = Math.round(\r\n      pattern.times.reduce((a, b) => a + b, 0) / pattern.times.length\r\n    );\r\n\r\n    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆØµÙˆÙ„ ÙÙŠ Ø£ÙˆÙ‚Ø§Øª Ù…Ø®ØªÙ„ÙØ© Ø¬Ø¯Ø§Ù‹ØŒ Ù‚Ø¯ ÙŠÙƒÙˆÙ† ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ\r\n    if (Math.abs(currentHour - avgHour) > 6) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   * PRIVATE METHODS - Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ø®Ø§ØµØ©\r\n   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n   */\r\n\r\n  /**\r\n   * Ø­Ø³Ø§Ø¨ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«\r\n   */\r\n  _calculateEventDistribution(logs) {\r\n    const distribution = {};\r\n\r\n    logs.forEach(log => {\r\n      distribution[log.eventType] = (distribution[log.eventType] || 0) + 1;\r\n    });\r\n\r\n    return distribution;\r\n  }\r\n\r\n  /**\r\n   * Ø­Ø³Ø§Ø¨ Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…\r\n   */\r\n  _calculateUserActivity(logs) {\r\n    const activity = {};\r\n\r\n    logs.forEach(log => {\r\n      if (!activity[log.userId]) {\r\n        activity[log.userId] = {\r\n          totalActions: 0,\r\n          successfulActions: 0,\r\n          failedActions: 0,\r\n          actions: []\r\n        };\r\n      }\r\n\r\n      activity[log.userId].totalActions++;\r\n      if (log.status === 'success') activity[log.userId].successfulActions++;\r\n      if (log.status === 'failure') activity[log.userId].failedActions++;\r\n\r\n      if (!activity[log.userId].actions.includes(log.action)) {\r\n        activity[log.userId].actions.push(log.action);\r\n      }\r\n    });\r\n\r\n    return activity;\r\n  }\r\n\r\n  /**\r\n   * Ø­Ø³Ø§Ø¨ Ù†Ø´Ø§Ø· Ø§Ù„Ù…ÙˆØ±Ø¯\r\n   */\r\n  _calculateResourceActivity(logs) {\r\n    const activity = {};\r\n\r\n    logs.forEach(log => {\r\n      if (!activity[log.resource]) {\r\n        activity[log.resource] = {\r\n          accesses: 0,\r\n          modifications: 0,\r\n          deletions: 0,\r\n          users: new Set()\r\n        };\r\n      }\r\n\r\n      activity[log.resource].accesses++;\r\n      if (log.action === 'DELETE') activity[log.resource].deletions++;\r\n      if (log.action === 'UPDATE') activity[log.resource].modifications++;\r\n      activity[log.resource].users.add(log.userId);\r\n    });\r\n\r\n    // ØªØ­ÙˆÙŠÙ„ Sets Ø¥Ù„Ù‰ Arrays\r\n    Object.keys(activity).forEach(resource => {\r\n      activity[resource].users = Array.from(activity[resource].users);\r\n    });\r\n\r\n    return activity;\r\n  }\r\n\r\n  /**\r\n   * ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª\r\n   */\r\n  _generateRecommendations(logs) {\r\n    const recommendations = [];\r\n\r\n    // ÙØ­Øµ Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„ÙØ´Ù„ Ø§Ù„Ù…Ø±ØªÙØ¹Ø©\r\n    const failureRate = logs.filter(e => e.status === 'failure').length / logs.length;\r\n    if (failureRate > 0.1) {\r\n      recommendations.push({\r\n        priority: 'high',\r\n        title: 'Ù…Ø¹Ø¯Ù„ ÙØ´Ù„ Ù…Ø±ØªÙØ¹ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„',\r\n        description: `Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙØ´Ù„ ${(failureRate * 100).toFixed(2)}% Ù‚Ø¯ ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„ØªÙƒÙˆÙŠÙ†`,\r\n        action: 'ÙØ­Øµ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ø£Ø°ÙˆÙ†Ø§Øª'\r\n      });\r\n    }\r\n\r\n    // ÙØ­Øµ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ØºÙŠØ± Ø§Ù„ÙƒØ§ÙÙŠØ©\r\n    const rolesCount = new Set(logs.flatMap(e => e.metadata.roles || [])).size;\r\n    if (rolesCount < 5) {\r\n      recommendations.push({\r\n        priority: 'medium',\r\n        title: 'Ø¹Ø¯Ø¯ Ù…Ø­Ø¯ÙˆØ¯ Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Ø±',\r\n        description: 'Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…ØªØ®ØµØµØ©',\r\n        action: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„Ø£Ø°ÙˆÙ†Ø§Øª'\r\n      });\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  /**\r\n   * Ø­Ø³Ø§Ø¨ Ø´Ø¯Ø© Ø§Ù„Ø­Ø¯Ø«\r\n   */\r\n  _calculateSeverity(eventType) {\r\n    const severityMap = {\r\n      'ROLE_DELETED': 'critical',\r\n      'PERMISSION_REVOKED': 'high',\r\n      'UNAUTHORIZED_ACCESS': 'high',\r\n      'ROLE_CREATED': 'medium',\r\n      'PERMISSION_ASSIGNED': 'low'\r\n    };\r\n\r\n    return severityMap[eventType] || 'low';\r\n  }\r\n\r\n  /**\r\n   * ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª\r\n   */\r\n  _triggerAlert(incident) {\r\n    // ÙŠÙ…ÙƒÙ† Ø¯Ù…Ø¬ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ Ù‡Ù†Ø§\r\n    console.warn(`ðŸš¨ Security Alert: ${incident.type}`, incident);\r\n  }\r\n\r\n  /**\r\n   * ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹Ø±Ù‘Ù ÙØ±ÙŠØ¯\r\n   */\r\n  _generateId() {\r\n    return `audit_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  /**\r\n   * Ø¨Ø¯Ø¡ Ù…Ø¤Ù‚Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ\r\n   */\r\n  startCleanupTimer() {\r\n    setInterval(() => {\r\n      const cutoffDate = new Date(Date.now() - this.config.retentionDays * 86400000);\r\n\r\n      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©\r\n      const originalLength = this.auditLog.length;\r\n      this.auditLog = this.auditLog.filter(e => e.timestamp > cutoffDate);\r\n\r\n      if (this.auditLog.length < originalLength) {\r\n        console.log(`ðŸ§¹ Cleaned up ${originalLength - this.auditLog.length} old audit entries`);\r\n      }\r\n\r\n      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©\r\n      const oldIncidentsLength = this.securityIncidents.length;\r\n      this.securityIncidents = this.securityIncidents.filter(i => i.reportedAt > cutoffDate);\r\n\r\n      if (this.securityIncidents.length < oldIncidentsLength) {\r\n        console.log(`ðŸ§¹ Cleaned up ${oldIncidentsLength - this.securityIncidents.length} old incidents`);\r\n      }\r\n    }, 86400000); // ØªØ´ØºÙŠÙ„ ÙŠÙˆÙ…ÙŠØ§Ù‹\r\n  }\r\n\r\n  /**\r\n   * ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚\r\n   */\r\n  exportAuditLogs(format = 'json') {\r\n    if (format === 'csv') {\r\n      return this._exportAsCSV();\r\n    }\r\n\r\n    return {\r\n      exportDate: new Date(),\r\n      totalRecords: this.auditLog.length,\r\n      data: this.auditLog\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ØªØµØ¯ÙŠØ± Ø¨ØµÙŠØºØ© CSV\r\n   */\r\n  _exportAsCSV() {\r\n    const headers = ['Timestamp', 'EventType', 'UserId', 'Action', 'Resource', 'Status', 'Severity'];\r\n    const rows = this.auditLog.map(e => [\r\n      e.timestamp.toISOString(),\r\n      e.eventType,\r\n      e.userId,\r\n      e.action,\r\n      e.resource,\r\n      e.status,\r\n      e.severity\r\n    ]);\r\n\r\n    let csv = headers.join(',') + '\\n';\r\n    rows.forEach(row => {\r\n      csv += row.map(cell => `\"${cell}\"`).join(',') + '\\n';\r\n    });\r\n\r\n    return csv;\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ù…Ø§Ù†\r\n   */\r\n  getSecuritySummary() {\r\n    const last7Days = this.auditLog.filter(e =>\r\n      e.timestamp > new Date(Date.now() - 604800000)\r\n    );\r\n\r\n    const last30Days = this.auditLog.filter(e =>\r\n      e.timestamp > new Date(Date.now() - 2592000000)\r\n    );\r\n\r\n    return {\r\n      last7Days: {\r\n        totalEvents: last7Days.length,\r\n        failures: last7Days.filter(e => e.status === 'failure').length,\r\n        criticalEvents: last7Days.filter(e => e.severity === 'critical').length\r\n      },\r\n      last30Days: {\r\n        totalEvents: last30Days.length,\r\n        failures: last30Days.filter(e => e.status === 'failure').length,\r\n        criticalEvents: last30Days.filter(e => e.severity === 'critical').length\r\n      },\r\n      activeIncidents: this.getSecurityIncidents({ status: 'open' }).length,\r\n      highRiskIncidents: this.getSecurityIncidents({ severity: 'high' }).length\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…\r\n   */\r\n  getUserAccessHistory(userId, limit = 50) {\r\n    const userLogs = this.auditLog\r\n      .filter(e => e.userId === userId)\r\n      .sort((a, b) => b.timestamp - a.timestamp)\r\n      .slice(0, limit);\r\n\r\n    return userLogs.map(log => ({\r\n      id: log.id,\r\n      timestamp: log.timestamp,\r\n      action: log.action,\r\n      resource: log.resource,\r\n      resourceId: log.resourceId,\r\n      status: log.status,\r\n      ipAddress: log.ipAddress,\r\n      userAgent: log.userAgent,\r\n      severity: log.severity\r\n    }));\r\n  }\r\n}\r\n\r\nmodule.exports = RBACAuditingService;\r\n"],"mappings":"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","ignoreList":[]}