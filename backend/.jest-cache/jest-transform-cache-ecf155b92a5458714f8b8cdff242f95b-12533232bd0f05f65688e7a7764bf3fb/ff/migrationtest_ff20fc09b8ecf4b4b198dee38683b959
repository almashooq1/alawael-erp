0d8852f53f976cf64721fe7a1e6fb898
/**
 * Migration System Tests
 * Comprehensive test suite for migration utilities
 */

const CSVProcessor = require('../services/migration/CSVProcessor');
const DatabaseMigration = require('../services/migration/DatabaseMigration');
const MigrationManager = require('../services/migration/MigrationManager');
const fs = require('fs');
const path = require('path');

/**
 * Test Suite for CSVProcessor
 */
describe('CSVProcessor', () => {
  let csvProcessor;
  const testCSVPath = './test-data.csv';
  beforeAll(() => {
    csvProcessor = new CSVProcessor({
      delimiter: ',',
      encoding: 'utf-8',
      maxRowsPerChunk: 10
    });

    // Create test CSV
    const testData = 'id,name,email,age\n1,John,john@example.com,30\n2,Jane,jane@example.com,25\n';
    fs.writeFileSync(testCSVPath, testData);
  });
  afterAll(() => {
    if (fs.existsSync(testCSVPath)) {
      fs.unlinkSync(testCSVPath);
    }
  });
  test('should import CSV successfully', async () => {
    const result = await csvProcessor.importCSV(testCSVPath, {
      columns: true
    });
    expect(result.success).toBe(true);
    expect(result.recordCount).toBe(2);
    expect(result.data).toHaveLength(2);
  });
  test('should export CSV successfully', async () => {
    const data = [{
      id: 1,
      name: 'John',
      email: 'john@example.com'
    }, {
      id: 2,
      name: 'Jane',
      email: 'jane@example.com'
    }];
    const exportPath = './test-export.csv';
    const result = await csvProcessor.exportToCSV(data, exportPath);
    expect(result.success).toBe(true);
    expect(result.recordCount).toBe(2);
    expect(fs.existsSync(exportPath)).toBe(true);

    // Cleanup
    fs.unlinkSync(exportPath);
  });
  test('should transform data', () => {
    const data = [{
      email: 'JOHN@EXAMPLE.COM',
      status: '1'
    }, {
      email: 'JANE@EXAMPLE.COM',
      status: '0'
    }];
    const transformRules = {
      email: val => val.toLowerCase(),
      status: {
        mapping: {
          '1': 'active',
          '0': 'inactive'
        }
      }
    };
    const transformed = csvProcessor.transformData(data, transformRules);
    expect(transformed[0].email).toBe('john@example.com');
    expect(transformed[0].status).toBe('active');
  });
  test('should validate CSV structure', async () => {
    const result = await csvProcessor.validateCSVStructure(testCSVPath, ['id', 'name', 'email']);
    expect(result.valid).toBe(true);
    expect(result.columns).toContain('id');
    expect(result.columns).toContain('name');
  });
  test('should sample CSV', async () => {
    const result = await csvProcessor.sampleCSV(testCSVPath, 1);
    expect(result.success).toBe(true);
    expect(result.samples).toHaveLength(1);
  });
  test('should get CSV info', async () => {
    const result = await csvProcessor.getCSVInfo(testCSVPath);
    expect(result.rowCount).toBe(2);
    expect(result.columnCount).toBe(4);
    expect(result.columns).toEqual(['id', 'name', 'email', 'age']);
  });
  test('should filter data', () => {
    const data = [{
      id: 1,
      status: 'active'
    }, {
      id: 2,
      status: 'inactive'
    }, {
      id: 3,
      status: 'active'
    }];
    const filtered = csvProcessor.filterData(data, row => row.status === 'active');
    expect(filtered).toHaveLength(2);
  });
});

/**
 * Test Suite for DatabaseMigration
 */
describe('DatabaseMigration', () => {
  let migration;
  let mockSourceDB;
  let mockTargetDB;
  beforeAll(() => {
    // Mock database connections
    mockSourceDB = {
      query: jest.fn()
    };
    mockTargetDB = {
      query: jest.fn()
    };
    migration = new DatabaseMigration(mockSourceDB, mockTargetDB, console);
  });
  test('should set batch size', () => {
    migration.setBatchSize(5000);
    expect(migration.batchSize).toBe(5000);
  });
  test('should migrate table successfully', async () => {
    mockSourceDB.query.mockResolvedValueOnce([{
      count: 2
    }]) // COUNT query
    .mockResolvedValueOnce([{
      id: 1,
      name: 'John'
    }, {
      id: 2,
      name: 'Jane'
    }]); // SELECT query

    mockTargetDB.query.mockResolvedValue(true); // INSERT query

    const result = await migration.migrateTable('users');
    expect(result.status).toBe('completed');
    expect(result.recordsMigrated).toBe(2);
  });
  test('should verify migration', async () => {
    mockSourceDB.query.mockResolvedValueOnce([{
      count: 100
    }]);
    mockTargetDB.query.mockResolvedValueOnce([{
      count: 100
    }]);
    const result = await migration.verifyMigration('users');
    expect(result.match).toBe(true);
    expect(result.sourceRecords).toBe(100);
    expect(result.targetRecords).toBe(100);
  });
  test('should handle discrepancies in verification', async () => {
    mockSourceDB.query.mockResolvedValueOnce([{
      count: 100
    }]);
    mockTargetDB.query.mockResolvedValueOnce([{
      count: 95
    }]);
    const result = await migration.verifyMigration('users');
    expect(result.match).toBe(false);
    expect(result.discrepancy).toBe(5);
  });
  test('should get migration summary', () => {
    migration.migrationLog = [{
      table: 'users',
      status: 'completed',
      recordsMigrated: 100,
      duration: 1000
    }, {
      table: 'products',
      status: 'completed',
      recordsMigrated: 50,
      duration: 500
    }];
    const summary = migration.getMigrationSummary();
    expect(summary.completedTables).toBe(2);
    expect(summary.totalRecordsMigrated).toBe(150);
    expect(summary.totalDuration).toBe(1500);
  });
});

/**
 * Test Suite for MigrationManager
 */
describe('MigrationManager', () => {
  let manager;
  let mockSourceDB;
  let mockTargetDB;
  beforeAll(() => {
    mockSourceDB = {
      query: jest.fn()
    };
    mockTargetDB = {
      query: jest.fn()
    };
    manager = new MigrationManager({
      sourceDB: mockSourceDB,
      targetDB: mockTargetDB,
      logger: {
        info: jest.fn(),
        error: jest.fn(),
        warn: jest.fn()
      }
    });
  });
  test('should create migration plan', () => {
    const plan = manager.createMigrationPlan(['users', 'products'], {
      preValidation: true,
      postValidation: true
    });
    expect(plan.tables).toEqual(['users', 'products']);
    expect(plan.steps.length).toBeGreaterThan(0);
    expect(plan.steps.some(s => s.type === 'validation')).toBe(true);
  });
  test('should pause migration', () => {
    const result = manager.pauseMigration();
    expect(result.status).toBe('paused');
  });
  test('should resume migration', () => {
    const result = manager.resumeMigration();
    expect(result.status).toBe('resumed');
  });
  test('should clear execution log', () => {
    manager.executionLog = [{
      step: 'test'
    }];
    manager.clearLog();
    expect(manager.executionLog).toHaveLength(0);
  });
  test('should get execution summary', () => {
    manager.executionLog = [{
      step: 'step1',
      status: 'completed',
      duration: 1000
    }, {
      step: 'step2',
      status: 'completed',
      duration: 500
    }];
    const summary = manager.getExecutionSummary();
    expect(summary.summary.completedSteps).toBe(2);
    expect(summary.summary.overallStatus).toBe('success');
  });
  test('should generate migration steps correctly', () => {
    const tables = ['users', 'products'];
    const options = {
      preValidation: true,
      postValidation: true,
      postCleanup: true
    };
    const steps = manager.generateMigrationSteps(tables, options);
    expect(steps[0].type).toBe('validation'); // pre-validation
    expect(steps[1].type).toBe('backup');
    expect(steps.some(s => s.table === 'users')).toBe(true);
    expect(steps[steps.length - 1].type).toBe('cleanup'); // post-cleanup
  });
});

/**
 * Integration Tests
 */
describe('Migration System Integration', () => {
  test('should complete full migration workflow', async () => {
    const mockSourceDB = {
      query: jest.fn().mockResolvedValueOnce([{
        count: 10
      }]) // COUNT
      .mockResolvedValueOnce(Array.from({
        length: 10
      }, (_, i) => ({
        id: i + 1,
        name: `User ${i + 1}`
      }))) // SELECT
    };
    const mockTargetDB = {
      query: jest.fn().mockResolvedValue(true)
    };
    const manager = new MigrationManager({
      sourceDB: mockSourceDB,
      targetDB: mockTargetDB,
      logger: console
    });

    // Create plan
    const plan = manager.createMigrationPlan(['users']);
    expect(plan.tables).toEqual(['users']);

    // Verify steps were created
    expect(plan.steps.length).toBeGreaterThan(0);
  });
  test('should handle CSV import and database migration', async () => {
    const csvProcessor = new CSVProcessor();
    const mockDB = {
      query: jest.fn().mockResolvedValue(true)
    };

    // Simulate CSV import and transformation
    const data = [{
      id: '1',
      email: 'JOHN@EXAMPLE.COM',
      status: '1'
    }, {
      id: '2',
      email: 'JANE@EXAMPLE.COM',
      status: '0'
    }];
    const transformed = csvProcessor.transformData(data, {
      id: {
        type: 'integer'
      },
      email: val => val.toLowerCase(),
      status: {
        mapping: {
          '1': 'active',
          '0': 'inactive'
        }
      }
    });
    expect(transformed[0].email).toBe('john@example.com');
    expect(transformed[0].status).toBe('active');
    expect(typeof transformed[0].id).toBe('number');
  });
});

/**
 * Error Handling Tests
 */
describe('Migration Error Handling', () => {
  test('should handle empty CSV', async () => {
    const csvProcessor = new CSVProcessor();
    const emptyPath = './empty-test.csv';
    fs.writeFileSync(emptyPath, '');
    try {
      const result = await csvProcessor.getCSVInfo(emptyPath);
      expect(result.rowCount).toBe(0);
    } finally {
      fs.unlinkSync(emptyPath);
    }
  });
  test('should handle invalid CSV path', async () => {
    const csvProcessor = new CSVProcessor();
    await expect(csvProcessor.getCSVInfo('./non-existent-file.csv')).rejects.toThrow();
  });
  test('should handle database errors gracefully', async () => {
    const mockSourceDB = {
      query: jest.fn().mockRejectedValue(new Error('Database error'))
    };
    const mockTargetDB = {
      query: jest.fn()
    };
    const migration = new DatabaseMigration(mockSourceDB, mockTargetDB);
    await expect(migration.migrateTable('users')).rejects.toThrow('Database error');
  });
});

/**
 * Performance Tests
 */
describe('Migration Performance', () => {
  test('should handle large batch sizes efficiently', async () => {
    const csvProcessor = new CSVProcessor({
      maxRowsPerChunk: 10000
    });

    // Create large test data
    const largeData = Array.from({
      length: 50000
    }, (_, i) => ({
      id: i + 1,
      name: `User ${i + 1}`,
      email: `user${i + 1}@example.com`
    }));
    const startTime = Date.now();
    // Transform would be applied here
    const transformed = csvProcessor.transformData(largeData, {
      email: val => val.toLowerCase()
    });
    const duration = Date.now() - startTime;
    expect(transformed).toHaveLength(50000);
    expect(duration).toBeLessThan(1000); // Should complete in less than 1 second
  });
  test('should report accurate timing information', () => {
    const manager = new MigrationManager({
      sourceDB: {},
      targetDB: {}
    });
    manager.executionLog = [{
      step: 'migration',
      status: 'completed',
      duration: 5000
    }];
    const summary = manager.getExecutionSummary();
    expect(summary.stats.totalDuration).toBe(5000);
  });
});
module.exports = {
  // Export test utilities if needed
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDU1ZQcm9jZXNzb3IiLCJyZXF1aXJlIiwiRGF0YWJhc2VNaWdyYXRpb24iLCJNaWdyYXRpb25NYW5hZ2VyIiwiZnMiLCJwYXRoIiwiZGVzY3JpYmUiLCJjc3ZQcm9jZXNzb3IiLCJ0ZXN0Q1NWUGF0aCIsImJlZm9yZUFsbCIsImRlbGltaXRlciIsImVuY29kaW5nIiwibWF4Um93c1BlckNodW5rIiwidGVzdERhdGEiLCJ3cml0ZUZpbGVTeW5jIiwiYWZ0ZXJBbGwiLCJleGlzdHNTeW5jIiwidW5saW5rU3luYyIsInRlc3QiLCJyZXN1bHQiLCJpbXBvcnRDU1YiLCJjb2x1bW5zIiwiZXhwZWN0Iiwic3VjY2VzcyIsInRvQmUiLCJyZWNvcmRDb3VudCIsImRhdGEiLCJ0b0hhdmVMZW5ndGgiLCJpZCIsIm5hbWUiLCJlbWFpbCIsImV4cG9ydFBhdGgiLCJleHBvcnRUb0NTViIsInN0YXR1cyIsInRyYW5zZm9ybVJ1bGVzIiwidmFsIiwidG9Mb3dlckNhc2UiLCJtYXBwaW5nIiwidHJhbnNmb3JtZWQiLCJ0cmFuc2Zvcm1EYXRhIiwidmFsaWRhdGVDU1ZTdHJ1Y3R1cmUiLCJ2YWxpZCIsInRvQ29udGFpbiIsInNhbXBsZUNTViIsInNhbXBsZXMiLCJnZXRDU1ZJbmZvIiwicm93Q291bnQiLCJjb2x1bW5Db3VudCIsInRvRXF1YWwiLCJmaWx0ZXJlZCIsImZpbHRlckRhdGEiLCJyb3ciLCJtaWdyYXRpb24iLCJtb2NrU291cmNlREIiLCJtb2NrVGFyZ2V0REIiLCJxdWVyeSIsImplc3QiLCJmbiIsImNvbnNvbGUiLCJzZXRCYXRjaFNpemUiLCJiYXRjaFNpemUiLCJtb2NrUmVzb2x2ZWRWYWx1ZU9uY2UiLCJjb3VudCIsIm1vY2tSZXNvbHZlZFZhbHVlIiwibWlncmF0ZVRhYmxlIiwicmVjb3Jkc01pZ3JhdGVkIiwidmVyaWZ5TWlncmF0aW9uIiwibWF0Y2giLCJzb3VyY2VSZWNvcmRzIiwidGFyZ2V0UmVjb3JkcyIsImRpc2NyZXBhbmN5IiwibWlncmF0aW9uTG9nIiwidGFibGUiLCJkdXJhdGlvbiIsInN1bW1hcnkiLCJnZXRNaWdyYXRpb25TdW1tYXJ5IiwiY29tcGxldGVkVGFibGVzIiwidG90YWxSZWNvcmRzTWlncmF0ZWQiLCJ0b3RhbER1cmF0aW9uIiwibWFuYWdlciIsInNvdXJjZURCIiwidGFyZ2V0REIiLCJsb2dnZXIiLCJpbmZvIiwiZXJyb3IiLCJ3YXJuIiwicGxhbiIsImNyZWF0ZU1pZ3JhdGlvblBsYW4iLCJwcmVWYWxpZGF0aW9uIiwicG9zdFZhbGlkYXRpb24iLCJ0YWJsZXMiLCJzdGVwcyIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiIsInNvbWUiLCJzIiwidHlwZSIsInBhdXNlTWlncmF0aW9uIiwicmVzdW1lTWlncmF0aW9uIiwiZXhlY3V0aW9uTG9nIiwic3RlcCIsImNsZWFyTG9nIiwiZ2V0RXhlY3V0aW9uU3VtbWFyeSIsImNvbXBsZXRlZFN0ZXBzIiwib3ZlcmFsbFN0YXR1cyIsIm9wdGlvbnMiLCJwb3N0Q2xlYW51cCIsImdlbmVyYXRlTWlncmF0aW9uU3RlcHMiLCJBcnJheSIsImZyb20iLCJfIiwiaSIsIm1vY2tEQiIsImVtcHR5UGF0aCIsInJlamVjdHMiLCJ0b1Rocm93IiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsImxhcmdlRGF0YSIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJ0b0JlTGVzc1RoYW4iLCJzdGF0cyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJtaWdyYXRpb24udGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTWlncmF0aW9uIFN5c3RlbSBUZXN0c1xyXG4gKiBDb21wcmVoZW5zaXZlIHRlc3Qgc3VpdGUgZm9yIG1pZ3JhdGlvbiB1dGlsaXRpZXNcclxuICovXHJcblxyXG5jb25zdCBDU1ZQcm9jZXNzb3IgPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9taWdyYXRpb24vQ1NWUHJvY2Vzc29yJyk7XHJcbmNvbnN0IERhdGFiYXNlTWlncmF0aW9uID0gcmVxdWlyZSgnLi4vc2VydmljZXMvbWlncmF0aW9uL0RhdGFiYXNlTWlncmF0aW9uJyk7XHJcbmNvbnN0IE1pZ3JhdGlvbk1hbmFnZXIgPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9taWdyYXRpb24vTWlncmF0aW9uTWFuYWdlcicpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcblxyXG4vKipcclxuICogVGVzdCBTdWl0ZSBmb3IgQ1NWUHJvY2Vzc29yXHJcbiAqL1xyXG5kZXNjcmliZSgnQ1NWUHJvY2Vzc29yJywgKCkgPT4ge1xyXG4gIGxldCBjc3ZQcm9jZXNzb3I7XHJcbiAgY29uc3QgdGVzdENTVlBhdGggPSAnLi90ZXN0LWRhdGEuY3N2JztcclxuXHJcbiAgYmVmb3JlQWxsKCgpID0+IHtcclxuICAgIGNzdlByb2Nlc3NvciA9IG5ldyBDU1ZQcm9jZXNzb3Ioe1xyXG4gICAgICBkZWxpbWl0ZXI6ICcsJyxcclxuICAgICAgZW5jb2Rpbmc6ICd1dGYtOCcsXHJcbiAgICAgIG1heFJvd3NQZXJDaHVuazogMTAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGVzdCBDU1ZcclxuICAgIGNvbnN0IHRlc3REYXRhID0gJ2lkLG5hbWUsZW1haWwsYWdlXFxuMSxKb2huLGpvaG5AZXhhbXBsZS5jb20sMzBcXG4yLEphbmUsamFuZUBleGFtcGxlLmNvbSwyNVxcbic7XHJcbiAgICBmcy53cml0ZUZpbGVTeW5jKHRlc3RDU1ZQYXRoLCB0ZXN0RGF0YSk7XHJcbiAgfSk7XHJcblxyXG4gIGFmdGVyQWxsKCgpID0+IHtcclxuICAgIGlmIChmcy5leGlzdHNTeW5jKHRlc3RDU1ZQYXRoKSkge1xyXG4gICAgICBmcy51bmxpbmtTeW5jKHRlc3RDU1ZQYXRoKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGltcG9ydCBDU1Ygc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLmltcG9ydENTVih0ZXN0Q1NWUGF0aCwgeyBjb2x1bW5zOiB0cnVlIH0pO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXN1bHQucmVjb3JkQ291bnQpLnRvQmUoMik7XHJcbiAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvSGF2ZUxlbmd0aCgyKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGV4cG9ydCBDU1Ygc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgZGF0YSA9IFtcclxuICAgICAgeyBpZDogMSwgbmFtZTogJ0pvaG4nLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH0sXHJcbiAgICAgIHsgaWQ6IDIsIG5hbWU6ICdKYW5lJywgZW1haWw6ICdqYW5lQGV4YW1wbGUuY29tJyB9LFxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBleHBvcnRQYXRoID0gJy4vdGVzdC1leHBvcnQuY3N2JztcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNzdlByb2Nlc3Nvci5leHBvcnRUb0NTVihkYXRhLCBleHBvcnRQYXRoKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICBleHBlY3QocmVzdWx0LnJlY29yZENvdW50KS50b0JlKDIpO1xyXG4gICAgZXhwZWN0KGZzLmV4aXN0c1N5bmMoZXhwb3J0UGF0aCkpLnRvQmUodHJ1ZSk7XHJcblxyXG4gICAgLy8gQ2xlYW51cFxyXG4gICAgZnMudW5saW5rU3luYyhleHBvcnRQYXRoKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIHRyYW5zZm9ybSBkYXRhJywgKCkgPT4ge1xyXG4gICAgY29uc3QgZGF0YSA9IFtcclxuICAgICAgeyBlbWFpbDogJ0pPSE5ARVhBTVBMRS5DT00nLCBzdGF0dXM6ICcxJyB9LFxyXG4gICAgICB7IGVtYWlsOiAnSkFORUBFWEFNUExFLkNPTScsIHN0YXR1czogJzAnIH0sXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IHRyYW5zZm9ybVJ1bGVzID0ge1xyXG4gICAgICBlbWFpbDogKHZhbCkgPT4gdmFsLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIHN0YXR1czogeyBtYXBwaW5nOiB7ICcxJzogJ2FjdGl2ZScsICcwJzogJ2luYWN0aXZlJyB9IH0sXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gY3N2UHJvY2Vzc29yLnRyYW5zZm9ybURhdGEoZGF0YSwgdHJhbnNmb3JtUnVsZXMpO1xyXG5cclxuICAgIGV4cGVjdCh0cmFuc2Zvcm1lZFswXS5lbWFpbCkudG9CZSgnam9obkBleGFtcGxlLmNvbScpO1xyXG4gICAgZXhwZWN0KHRyYW5zZm9ybWVkWzBdLnN0YXR1cykudG9CZSgnYWN0aXZlJyk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSBDU1Ygc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3N2UHJvY2Vzc29yLnZhbGlkYXRlQ1NWU3RydWN0dXJlKHRlc3RDU1ZQYXRoLCBbJ2lkJywgJ25hbWUnLCAnZW1haWwnXSk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC52YWxpZCkudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXN1bHQuY29sdW1ucykudG9Db250YWluKCdpZCcpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5jb2x1bW5zKS50b0NvbnRhaW4oJ25hbWUnKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIHNhbXBsZSBDU1YnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjc3ZQcm9jZXNzb3Iuc2FtcGxlQ1NWKHRlc3RDU1ZQYXRoLCAxKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICBleHBlY3QocmVzdWx0LnNhbXBsZXMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGdldCBDU1YgaW5mbycsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNzdlByb2Nlc3Nvci5nZXRDU1ZJbmZvKHRlc3RDU1ZQYXRoKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0LnJvd0NvdW50KS50b0JlKDIpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC5jb2x1bW5Db3VudCkudG9CZSg0KTtcclxuICAgIGV4cGVjdChyZXN1bHQuY29sdW1ucykudG9FcXVhbChbJ2lkJywgJ25hbWUnLCAnZW1haWwnLCAnYWdlJ10pO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgZmlsdGVyIGRhdGEnLCAoKSA9PiB7XHJcbiAgICBjb25zdCBkYXRhID0gW1xyXG4gICAgICB7IGlkOiAxLCBzdGF0dXM6ICdhY3RpdmUnIH0sXHJcbiAgICAgIHsgaWQ6IDIsIHN0YXR1czogJ2luYWN0aXZlJyB9LFxyXG4gICAgICB7IGlkOiAzLCBzdGF0dXM6ICdhY3RpdmUnIH0sXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGZpbHRlcmVkID0gY3N2UHJvY2Vzc29yLmZpbHRlckRhdGEoZGF0YSwgKHJvdykgPT4gcm93LnN0YXR1cyA9PT0gJ2FjdGl2ZScpO1xyXG5cclxuICAgIGV4cGVjdChmaWx0ZXJlZCkudG9IYXZlTGVuZ3RoKDIpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBUZXN0IFN1aXRlIGZvciBEYXRhYmFzZU1pZ3JhdGlvblxyXG4gKi9cclxuZGVzY3JpYmUoJ0RhdGFiYXNlTWlncmF0aW9uJywgKCkgPT4ge1xyXG4gIGxldCBtaWdyYXRpb247XHJcbiAgbGV0IG1vY2tTb3VyY2VEQjtcclxuICBsZXQgbW9ja1RhcmdldERCO1xyXG5cclxuICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgLy8gTW9jayBkYXRhYmFzZSBjb25uZWN0aW9uc1xyXG4gICAgbW9ja1NvdXJjZURCID0ge1xyXG4gICAgICBxdWVyeTogamVzdC5mbigpLFxyXG4gICAgfTtcclxuXHJcbiAgICBtb2NrVGFyZ2V0REIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCksXHJcbiAgICB9O1xyXG5cclxuICAgIG1pZ3JhdGlvbiA9IG5ldyBEYXRhYmFzZU1pZ3JhdGlvbihtb2NrU291cmNlREIsIG1vY2tUYXJnZXREQiwgY29uc29sZSk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBzZXQgYmF0Y2ggc2l6ZScsICgpID0+IHtcclxuICAgIG1pZ3JhdGlvbi5zZXRCYXRjaFNpemUoNTAwMCk7XHJcbiAgICBleHBlY3QobWlncmF0aW9uLmJhdGNoU2l6ZSkudG9CZSg1MDAwKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIG1pZ3JhdGUgdGFibGUgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgbW9ja1NvdXJjZURCLnF1ZXJ5XHJcbiAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW3sgY291bnQ6IDIgfV0pIC8vIENPVU5UIHF1ZXJ5XHJcbiAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW1xyXG4gICAgICAgIHsgaWQ6IDEsIG5hbWU6ICdKb2huJyB9LFxyXG4gICAgICAgIHsgaWQ6IDIsIG5hbWU6ICdKYW5lJyB9LFxyXG4gICAgICBdKTsgLy8gU0VMRUNUIHF1ZXJ5XHJcblxyXG4gICAgbW9ja1RhcmdldERCLnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpOyAvLyBJTlNFUlQgcXVlcnlcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtaWdyYXRpb24ubWlncmF0ZVRhYmxlKCd1c2VycycpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdjb21wbGV0ZWQnKTtcclxuICAgIGV4cGVjdChyZXN1bHQucmVjb3Jkc01pZ3JhdGVkKS50b0JlKDIpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgdmVyaWZ5IG1pZ3JhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgIG1vY2tTb3VyY2VEQi5xdWVyeS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW3sgY291bnQ6IDEwMCB9XSk7XHJcbiAgICBtb2NrVGFyZ2V0REIucXVlcnkubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGNvdW50OiAxMDAgfV0pO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbi52ZXJpZnlNaWdyYXRpb24oJ3VzZXJzJyk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5tYXRjaCkudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChyZXN1bHQuc291cmNlUmVjb3JkcykudG9CZSgxMDApO1xyXG4gICAgZXhwZWN0KHJlc3VsdC50YXJnZXRSZWNvcmRzKS50b0JlKDEwMCk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZGlzY3JlcGFuY2llcyBpbiB2ZXJpZmljYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICBtb2NrU291cmNlREIucXVlcnkubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGNvdW50OiAxMDAgfV0pO1xyXG4gICAgbW9ja1RhcmdldERCLnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBjb3VudDogOTUgfV0pO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbi52ZXJpZnlNaWdyYXRpb24oJ3VzZXJzJyk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5tYXRjaCkudG9CZShmYWxzZSk7XHJcbiAgICBleHBlY3QocmVzdWx0LmRpc2NyZXBhbmN5KS50b0JlKDUpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgZ2V0IG1pZ3JhdGlvbiBzdW1tYXJ5JywgKCkgPT4ge1xyXG4gICAgbWlncmF0aW9uLm1pZ3JhdGlvbkxvZyA9IFtcclxuICAgICAge1xyXG4gICAgICAgIHRhYmxlOiAndXNlcnMnLFxyXG4gICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXHJcbiAgICAgICAgcmVjb3Jkc01pZ3JhdGVkOiAxMDAsXHJcbiAgICAgICAgZHVyYXRpb246IDEwMDAsXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0YWJsZTogJ3Byb2R1Y3RzJyxcclxuICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxyXG4gICAgICAgIHJlY29yZHNNaWdyYXRlZDogNTAsXHJcbiAgICAgICAgZHVyYXRpb246IDUwMCxcclxuICAgICAgfSxcclxuICAgIF07XHJcblxyXG4gICAgY29uc3Qgc3VtbWFyeSA9IG1pZ3JhdGlvbi5nZXRNaWdyYXRpb25TdW1tYXJ5KCk7XHJcblxyXG4gICAgZXhwZWN0KHN1bW1hcnkuY29tcGxldGVkVGFibGVzKS50b0JlKDIpO1xyXG4gICAgZXhwZWN0KHN1bW1hcnkudG90YWxSZWNvcmRzTWlncmF0ZWQpLnRvQmUoMTUwKTtcclxuICAgIGV4cGVjdChzdW1tYXJ5LnRvdGFsRHVyYXRpb24pLnRvQmUoMTUwMCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIFRlc3QgU3VpdGUgZm9yIE1pZ3JhdGlvbk1hbmFnZXJcclxuICovXHJcbmRlc2NyaWJlKCdNaWdyYXRpb25NYW5hZ2VyJywgKCkgPT4ge1xyXG4gIGxldCBtYW5hZ2VyO1xyXG4gIGxldCBtb2NrU291cmNlREI7XHJcbiAgbGV0IG1vY2tUYXJnZXREQjtcclxuXHJcbiAgYmVmb3JlQWxsKCgpID0+IHtcclxuICAgIG1vY2tTb3VyY2VEQiA9IHtcclxuICAgICAgcXVlcnk6IGplc3QuZm4oKSxcclxuICAgIH07XHJcblxyXG4gICAgbW9ja1RhcmdldERCID0ge1xyXG4gICAgICBxdWVyeTogamVzdC5mbigpLFxyXG4gICAgfTtcclxuXHJcbiAgICBtYW5hZ2VyID0gbmV3IE1pZ3JhdGlvbk1hbmFnZXIoe1xyXG4gICAgICBzb3VyY2VEQjogbW9ja1NvdXJjZURCLFxyXG4gICAgICB0YXJnZXREQjogbW9ja1RhcmdldERCLFxyXG4gICAgICBsb2dnZXI6IHsgaW5mbzogamVzdC5mbigpLCBlcnJvcjogamVzdC5mbigpLCB3YXJuOiBqZXN0LmZuKCkgfSxcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgY3JlYXRlIG1pZ3JhdGlvbiBwbGFuJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcGxhbiA9IG1hbmFnZXIuY3JlYXRlTWlncmF0aW9uUGxhbihbJ3VzZXJzJywgJ3Byb2R1Y3RzJ10sIHtcclxuICAgICAgcHJlVmFsaWRhdGlvbjogdHJ1ZSxcclxuICAgICAgcG9zdFZhbGlkYXRpb246IHRydWUsXHJcbiAgICB9KTtcclxuXHJcbiAgICBleHBlY3QocGxhbi50YWJsZXMpLnRvRXF1YWwoWyd1c2VycycsICdwcm9kdWN0cyddKTtcclxuICAgIGV4cGVjdChwbGFuLnN0ZXBzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgZXhwZWN0KHBsYW4uc3RlcHMuc29tZSgocykgPT4gcy50eXBlID09PSAndmFsaWRhdGlvbicpKS50b0JlKHRydWUpO1xyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgcGF1c2UgbWlncmF0aW9uJywgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gbWFuYWdlci5wYXVzZU1pZ3JhdGlvbigpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdwYXVzZWQnKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIHJlc3VtZSBtaWdyYXRpb24nLCAoKSA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBtYW5hZ2VyLnJlc3VtZU1pZ3JhdGlvbigpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdyZXN1bWVkJyk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBjbGVhciBleGVjdXRpb24gbG9nJywgKCkgPT4ge1xyXG4gICAgbWFuYWdlci5leGVjdXRpb25Mb2cgPSBbeyBzdGVwOiAndGVzdCcgfV07XHJcbiAgICBtYW5hZ2VyLmNsZWFyTG9nKCk7XHJcblxyXG4gICAgZXhwZWN0KG1hbmFnZXIuZXhlY3V0aW9uTG9nKS50b0hhdmVMZW5ndGgoMCk7XHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCBnZXQgZXhlY3V0aW9uIHN1bW1hcnknLCAoKSA9PiB7XHJcbiAgICBtYW5hZ2VyLmV4ZWN1dGlvbkxvZyA9IFtcclxuICAgICAgeyBzdGVwOiAnc3RlcDEnLCBzdGF0dXM6ICdjb21wbGV0ZWQnLCBkdXJhdGlvbjogMTAwMCB9LFxyXG4gICAgICB7IHN0ZXA6ICdzdGVwMicsIHN0YXR1czogJ2NvbXBsZXRlZCcsIGR1cmF0aW9uOiA1MDAgfSxcclxuICAgIF07XHJcblxyXG4gICAgY29uc3Qgc3VtbWFyeSA9IG1hbmFnZXIuZ2V0RXhlY3V0aW9uU3VtbWFyeSgpO1xyXG5cclxuICAgIGV4cGVjdChzdW1tYXJ5LnN1bW1hcnkuY29tcGxldGVkU3RlcHMpLnRvQmUoMik7XHJcbiAgICBleHBlY3Qoc3VtbWFyeS5zdW1tYXJ5Lm92ZXJhbGxTdGF0dXMpLnRvQmUoJ3N1Y2Nlc3MnKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIG1pZ3JhdGlvbiBzdGVwcyBjb3JyZWN0bHknLCAoKSA9PiB7XHJcbiAgICBjb25zdCB0YWJsZXMgPSBbJ3VzZXJzJywgJ3Byb2R1Y3RzJ107XHJcbiAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICBwcmVWYWxpZGF0aW9uOiB0cnVlLFxyXG4gICAgICBwb3N0VmFsaWRhdGlvbjogdHJ1ZSxcclxuICAgICAgcG9zdENsZWFudXA6IHRydWUsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHN0ZXBzID0gbWFuYWdlci5nZW5lcmF0ZU1pZ3JhdGlvblN0ZXBzKHRhYmxlcywgb3B0aW9ucyk7XHJcblxyXG4gICAgZXhwZWN0KHN0ZXBzWzBdLnR5cGUpLnRvQmUoJ3ZhbGlkYXRpb24nKTsgLy8gcHJlLXZhbGlkYXRpb25cclxuICAgIGV4cGVjdChzdGVwc1sxXS50eXBlKS50b0JlKCdiYWNrdXAnKTtcclxuICAgIGV4cGVjdChzdGVwcy5zb21lKChzKSA9PiBzLnRhYmxlID09PSAndXNlcnMnKSkudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChzdGVwc1tzdGVwcy5sZW5ndGggLSAxXS50eXBlKS50b0JlKCdjbGVhbnVwJyk7IC8vIHBvc3QtY2xlYW51cFxyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBJbnRlZ3JhdGlvbiBUZXN0c1xyXG4gKi9cclxuZGVzY3JpYmUoJ01pZ3JhdGlvbiBTeXN0ZW0gSW50ZWdyYXRpb24nLCAoKSA9PiB7XHJcbiAgdGVzdCgnc2hvdWxkIGNvbXBsZXRlIGZ1bGwgbWlncmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgbW9ja1NvdXJjZURCID0ge1xyXG4gICAgICBxdWVyeTogamVzdC5mbigpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBjb3VudDogMTAgfV0pIC8vIENPVU5UXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShcclxuICAgICAgICAgIEFycmF5LmZyb20oeyBsZW5ndGg6IDEwIH0sIChfLCBpKSA9PiAoe1xyXG4gICAgICAgICAgICBpZDogaSArIDEsXHJcbiAgICAgICAgICAgIG5hbWU6IGBVc2VyICR7aSArIDF9YCxcclxuICAgICAgICAgIH0pKVxyXG4gICAgICAgICksIC8vIFNFTEVDVFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtb2NrVGFyZ2V0REIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSksXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgTWlncmF0aW9uTWFuYWdlcih7XHJcbiAgICAgIHNvdXJjZURCOiBtb2NrU291cmNlREIsXHJcbiAgICAgIHRhcmdldERCOiBtb2NrVGFyZ2V0REIsXHJcbiAgICAgIGxvZ2dlcjogY29uc29sZSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENyZWF0ZSBwbGFuXHJcbiAgICBjb25zdCBwbGFuID0gbWFuYWdlci5jcmVhdGVNaWdyYXRpb25QbGFuKFsndXNlcnMnXSk7XHJcbiAgICBleHBlY3QocGxhbi50YWJsZXMpLnRvRXF1YWwoWyd1c2VycyddKTtcclxuXHJcbiAgICAvLyBWZXJpZnkgc3RlcHMgd2VyZSBjcmVhdGVkXHJcbiAgICBleHBlY3QocGxhbi5zdGVwcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBDU1YgaW1wb3J0IGFuZCBkYXRhYmFzZSBtaWdyYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBjc3ZQcm9jZXNzb3IgPSBuZXcgQ1NWUHJvY2Vzc29yKCk7XHJcbiAgICBjb25zdCBtb2NrREIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSksXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNpbXVsYXRlIENTViBpbXBvcnQgYW5kIHRyYW5zZm9ybWF0aW9uXHJcbiAgICBjb25zdCBkYXRhID0gW1xyXG4gICAgICB7IGlkOiAnMScsIGVtYWlsOiAnSk9ITkBFWEFNUExFLkNPTScsIHN0YXR1czogJzEnIH0sXHJcbiAgICAgIHsgaWQ6ICcyJywgZW1haWw6ICdKQU5FQEVYQU1QTEUuQ09NJywgc3RhdHVzOiAnMCcgfSxcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgdHJhbnNmb3JtZWQgPSBjc3ZQcm9jZXNzb3IudHJhbnNmb3JtRGF0YShkYXRhLCB7XHJcbiAgICAgIGlkOiB7IHR5cGU6ICdpbnRlZ2VyJyB9LFxyXG4gICAgICBlbWFpbDogKHZhbCkgPT4gdmFsLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIHN0YXR1czogeyBtYXBwaW5nOiB7ICcxJzogJ2FjdGl2ZScsICcwJzogJ2luYWN0aXZlJyB9IH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBleHBlY3QodHJhbnNmb3JtZWRbMF0uZW1haWwpLnRvQmUoJ2pvaG5AZXhhbXBsZS5jb20nKTtcclxuICAgIGV4cGVjdCh0cmFuc2Zvcm1lZFswXS5zdGF0dXMpLnRvQmUoJ2FjdGl2ZScpO1xyXG4gICAgZXhwZWN0KHR5cGVvZiB0cmFuc2Zvcm1lZFswXS5pZCkudG9CZSgnbnVtYmVyJyk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEVycm9yIEhhbmRsaW5nIFRlc3RzXHJcbiAqL1xyXG5kZXNjcmliZSgnTWlncmF0aW9uIEVycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xyXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgQ1NWJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgY3N2UHJvY2Vzc29yID0gbmV3IENTVlByb2Nlc3NvcigpO1xyXG4gICAgY29uc3QgZW1wdHlQYXRoID0gJy4vZW1wdHktdGVzdC5jc3YnO1xyXG4gICAgZnMud3JpdGVGaWxlU3luYyhlbXB0eVBhdGgsICcnKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjc3ZQcm9jZXNzb3IuZ2V0Q1NWSW5mbyhlbXB0eVBhdGgpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnJvd0NvdW50KS50b0JlKDApO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgZnMudW5saW5rU3luYyhlbXB0eVBhdGgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICB0ZXN0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgQ1NWIHBhdGgnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBjc3ZQcm9jZXNzb3IgPSBuZXcgQ1NWUHJvY2Vzc29yKCk7XHJcblxyXG4gICAgYXdhaXQgZXhwZWN0KGNzdlByb2Nlc3Nvci5nZXRDU1ZJbmZvKCcuL25vbi1leGlzdGVudC1maWxlLmNzdicpKS5yZWplY3RzLnRvVGhyb3coKTtcclxuICB9KTtcclxuXHJcbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IG1vY2tTb3VyY2VEQiA9IHtcclxuICAgICAgcXVlcnk6IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtb2NrVGFyZ2V0REIgPSB7XHJcbiAgICAgIHF1ZXJ5OiBqZXN0LmZuKCksXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1pZ3JhdGlvbiA9IG5ldyBEYXRhYmFzZU1pZ3JhdGlvbihtb2NrU291cmNlREIsIG1vY2tUYXJnZXREQik7XHJcblxyXG4gICAgYXdhaXQgZXhwZWN0KG1pZ3JhdGlvbi5taWdyYXRlVGFibGUoJ3VzZXJzJykpLnJlamVjdHMudG9UaHJvdygnRGF0YWJhc2UgZXJyb3InKTtcclxuICB9KTtcclxufSk7XHJcblxyXG4vKipcclxuICogUGVyZm9ybWFuY2UgVGVzdHNcclxuICovXHJcbmRlc2NyaWJlKCdNaWdyYXRpb24gUGVyZm9ybWFuY2UnLCAoKSA9PiB7XHJcbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBsYXJnZSBiYXRjaCBzaXplcyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNzdlByb2Nlc3NvciA9IG5ldyBDU1ZQcm9jZXNzb3Ioe1xyXG4gICAgICBtYXhSb3dzUGVyQ2h1bms6IDEwMDAwLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGxhcmdlIHRlc3QgZGF0YVxyXG4gICAgY29uc3QgbGFyZ2VEYXRhID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNTAwMDAgfSwgKF8sIGkpID0+ICh7XHJcbiAgICAgIGlkOiBpICsgMSxcclxuICAgICAgbmFtZTogYFVzZXIgJHtpICsgMX1gLFxyXG4gICAgICBlbWFpbDogYHVzZXIke2kgKyAxfUBleGFtcGxlLmNvbWAsXHJcbiAgICB9KSk7XHJcblxyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIC8vIFRyYW5zZm9ybSB3b3VsZCBiZSBhcHBsaWVkIGhlcmVcclxuICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gY3N2UHJvY2Vzc29yLnRyYW5zZm9ybURhdGEobGFyZ2VEYXRhLCB7XHJcbiAgICAgIGVtYWlsOiAodmFsKSA9PiB2YWwudG9Mb3dlckNhc2UoKSxcclxuICAgIH0pO1xyXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xyXG5cclxuICAgIGV4cGVjdCh0cmFuc2Zvcm1lZCkudG9IYXZlTGVuZ3RoKDUwMDAwKTtcclxuICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDEwMDApOyAvLyBTaG91bGQgY29tcGxldGUgaW4gbGVzcyB0aGFuIDEgc2Vjb25kXHJcbiAgfSk7XHJcblxyXG4gIHRlc3QoJ3Nob3VsZCByZXBvcnQgYWNjdXJhdGUgdGltaW5nIGluZm9ybWF0aW9uJywgKCkgPT4ge1xyXG4gICAgY29uc3QgbWFuYWdlciA9IG5ldyBNaWdyYXRpb25NYW5hZ2VyKHtcclxuICAgICAgc291cmNlREI6IHt9LFxyXG4gICAgICB0YXJnZXREQjoge30sXHJcbiAgICB9KTtcclxuXHJcbiAgICBtYW5hZ2VyLmV4ZWN1dGlvbkxvZyA9IFtcclxuICAgICAgeyBzdGVwOiAnbWlncmF0aW9uJywgc3RhdHVzOiAnY29tcGxldGVkJywgZHVyYXRpb246IDUwMDAgfSxcclxuICAgIF07XHJcblxyXG4gICAgY29uc3Qgc3VtbWFyeSA9IG1hbmFnZXIuZ2V0RXhlY3V0aW9uU3VtbWFyeSgpO1xyXG4gICAgZXhwZWN0KHN1bW1hcnkuc3RhdHMudG90YWxEdXJhdGlvbikudG9CZSg1MDAwKTtcclxuICB9KTtcclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAvLyBFeHBvcnQgdGVzdCB1dGlsaXRpZXMgaWYgbmVlZGVkXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FB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QUU7SUFDbkIsQ0FBQyxDQUFDOztJQUVGO0lBQ0EsTUFBTTBHLFNBQVMsR0FBR1YsS0FBSyxDQUFDQyxJQUFJLENBQUM7TUFBRWpCLE1BQU0sRUFBRTtJQUFNLENBQUMsRUFBRSxDQUFDa0IsQ0FBQyxFQUFFQyxDQUFDLE1BQU07TUFDekRuRixFQUFFLEVBQUVtRixDQUFDLEdBQUcsQ0FBQztNQUNUbEYsSUFBSSxFQUFFLFFBQVFrRixDQUFDLEdBQUcsQ0FBQyxFQUFFO01BQ3JCakYsS0FBSyxFQUFFLE9BQU9pRixDQUFDLEdBQUcsQ0FBQztJQUNyQixDQUFDLENBQUMsQ0FBQztJQUVILE1BQU1RLFNBQVMsR0FBR0MsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQztJQUM1QjtJQUNBLE1BQU1uRixXQUFXLEdBQUcvQixZQUFZLENBQUNnQyxhQUFhLENBQUMrRSxTQUFTLEVBQUU7TUFDeER4RixLQUFLLEVBQUdLLEdBQUcsSUFBS0EsR0FBRyxDQUFDQyxXQUFXLENBQUM7SUFDbEMsQ0FBQyxDQUFDO0lBQ0YsTUFBTXFDLFFBQVEsR0FBRytDLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsR0FBR0YsU0FBUztJQUV2Q2pHLE1BQU0sQ0FBQ2dCLFdBQVcsQ0FBQyxDQUFDWCxZQUFZLENBQUMsS0FBSyxDQUFDO0lBQ3ZDTCxNQUFNLENBQUNtRCxRQUFRLENBQUMsQ0FBQ2lELFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZDLENBQUMsQ0FBQztFQUVGeEcsSUFBSSxDQUFDLDJDQUEyQyxFQUFFLE1BQU07SUFDdEQsTUFBTTZELE9BQU8sR0FBRyxJQUFJNUUsZ0JBQWdCLENBQUM7TUFDbkM2RSxRQUFRLEVBQUUsQ0FBQyxDQUFDO01BQ1pDLFFBQVEsRUFBRSxDQUFDO0lBQ2IsQ0FBQyxDQUFDO0lBRUZGLE9BQU8sQ0FBQ29CLFlBQVksR0FBRyxDQUNyQjtNQUFFQyxJQUFJLEVBQUUsV0FBVztNQUFFbkUsTUFBTSxFQUFFLFdBQVc7TUFBRXdDLFFBQVEsRUFBRTtJQUFLLENBQUMsQ0FDM0Q7SUFFRCxNQUFNQyxPQUFPLEdBQUdLLE9BQU8sQ0FBQ3VCLG1CQUFtQixDQUFDLENBQUM7SUFDN0NoRixNQUFNLENBQUNvRCxPQUFPLENBQUNpRCxLQUFLLENBQUM3QyxhQUFhLENBQUMsQ0FBQ3RELElBQUksQ0FBQyxJQUFJLENBQUM7RUFDaEQsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUZvRyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUNmO0FBQUEsQ0FDRCIsImlnbm9yZUxpc3QiOltdfQ==