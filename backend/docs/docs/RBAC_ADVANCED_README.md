/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ” ADVANCED RBAC SYSTEM - Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
 * System Overview and README
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

# Advanced RBAC System - Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… ÙˆØ§Ù„Ø°ÙƒÙŠ

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©](#Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª-Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
3. [Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©](#Ø§Ù„Ø¨Ù†ÙŠØ©-Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©)
4. [Ø§Ù„ØªÙƒØ§Ù…Ù„ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯](#Ø§Ù„ØªÙƒØ§Ù…Ù„-ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯)
5. [Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…](#Ø£Ù…Ø«Ù„Ø©-Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
6. [ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬ÙŠØ© JSON](#ÙˆØ§Ø¬Ù‡Ø©-Ø¨Ø±Ù…Ø¬ÙŠØ©-json)
7. [Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª](#Ø£ÙØ¶Ù„-Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª)
8. [Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡](#Ø§Ø³ØªÙƒØ´Ø§Ù-Ø§Ù„Ø£Ø®Ø·Ø§Ø¡)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù†Ø¸Ø§Ù… RBAC Ù…ØªÙ‚Ø¯Ù… ÙˆØ´Ø§Ù…Ù„ Ù…ØµÙ…Ù… Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©. ÙŠÙˆÙØ±:

- **Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Ø± ÙˆØ£Ø°ÙˆÙ†Ø§Øª** Ù‚ÙˆÙŠØ© ÙˆÙ‡Ø±Ù…ÙŠØ©
- **Ù…Ø­Ø±Ùƒ Ø³ÙŠØ§Ø³Ø§Øª** Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ³Ø¹
- **ØªØ¯Ù‚ÙŠÙ‚ ÙˆØªØªØ¨Ø¹** Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
- **ÙƒØ´Ù Ø°ÙƒÙŠ** Ù„Ù„Ø´Ø°ÙˆØ° ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø±
- **Ø­Ø¯ Ù…Ù† Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙˆØµÙˆÙ„** Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
- **ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ø°ÙƒÙŠ** Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡

---

## âœ¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### 1ï¸âƒ£ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù‡Ø±Ù…ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©

```javascript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¯ÙˆØ± Ø¨Ù‡Ø±Ù…ÙŠØ© ÙˆØ±Ø§Ø«Ø©
rbacSystem.createRole('senior-manager', {
  name: 'Senior Manager',
  description: 'High-level management role',
  parentRole: 'manager',
  level: 550,
  scope: 'department',
  expiresAt: new Date('2025-12-31'),
  maxUsers: 10
});

// Ø§Ù„Ø¯ÙˆØ± ÙŠØ±Ø« Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù€ parent
const permissions = rbacSystem.getRolePermissions('senior-manager', true);
```

### 2ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ

```javascript
// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø°ÙˆÙ†Ø§Øª Ù…Ø¹ Ø´Ø±ÙˆØ· Ù…ØªÙ‚Ø¯Ù…Ø©
rbacSystem.createPermission('docs:edit:own', {
  resource: 'documents',
  action: 'edit',
  riskLevel: 'medium',
  conditions: {
    ownerId: 'userId',
    status: 'draft'
  }
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ù…Ø¹ Ø§Ù„Ø³ÙŠØ§Ù‚
const hasAccess = rbacSystem.hasPermission(userId, 'docs:edit:own', {
  ownerId: userId,
  documentId: 'doc-123'
});
```

### 3ï¸âƒ£ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø®ØµØ§Ø¦Øµ (ABAC)

```javascript
// ØªØ¹ÙŠÙŠÙ† Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
rbacSystem.setUserAttributes(userId, {
  department: 'IT',
  team: 'Security',
  level: 4,
  clearance: 'SECRET',
  location: 'HQ'
});

// Ø§Ù„Ø´Ø±ÙˆØ· ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø®ØµØ§Ø¦Øµ
const conditions = {
  clearance: ['SECRET', 'TOP_SECRET'],
  department: { $in: ['IT', 'Security'] },
  minLevel: 3
};

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ø¹ Ø§Ù„Ø®ØµØ§Ø¦Øµ
const canAccess = rbacSystem.hasPermission(userId, 'sensitive-op', {
  requiresClearance: 'SECRET'
});
```

### 4ï¸âƒ£ Ù…Ø­Ø±Ùƒ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…

```javascript
// Ø¥Ù†Ø´Ø§Ø¡ Ø³ÙŠØ§Ø³Ø© Ù…Ø¹Ù‚Ø¯Ø©
policyEngine.createPolicy('time-based-access', {
  name: 'Time-Based Access',
  principal: { role: 'contractor' },
  action: ['read'],
  resource: ['public/*'],
  effect: 'Allow',
  conditions: {
    hour: { $gte: 8, $lte: 20 },
    dayOfWeek: { $in: [1, 2, 3, 4, 5] } // Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙ‚Ø·
  },
  priority: 600
});

// ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª
const evaluation = policyEngine.evaluatePolicies(userId, {
  action: 'read',
  resource: 'public/docs',
  hour: 15,
  dayOfWeek: 3
});
```

### 5ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù†Ø·Ø§Ù‚

```javascript
// Ø¥Ø¹Ø·Ø§Ø¡ Ø£Ø°ÙˆÙ†Ø§Øª Ù…Ù‚ÙŠØ¯Ø© Ø¨Ù†Ø·Ø§Ù‚
rbacSystem.assignRoleToUser(userId, 'manager', {
  scope: 'department',
  scopeData: {
    departmentId: 'dept-123',
    allowedTeams: ['team-1', 'team-2']
  }
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†Ø·Ø§Ù‚ Ø§Ù„ÙˆØµÙˆÙ„
const scope = rbacSystem.calculateUserScope(userId);
console.log(scope);
// {
//   global: false,
//   departments: Set ['dept-123'],
//   teams: Set ['team-1', 'team-2'],
//   resources: Set [],
//   custom: {}
// }

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯
const canAccess = rbacSystem.canAccessResource(userId, 'resource-123', {
  departmentId: 'dept-123'
});
```

### 6ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„

```javascript
// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
auditingService.logAuditEvent({
  eventType: 'ROLE_ASSIGNMENT',
  userId: 'admin-1',
  action: 'ASSIGN',
  resource: 'users/user-123',
  status: 'success',
  resourceId: 'user-123',
  metadata: { roleId: 'manager' },
  severity: 'medium'
});

// Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
const logs = auditingService.queryAuditLog({
  userId: 'user-123',
  eventType: ['ROLE_ASSIGNED', 'PERMISSION_GRANTED'],
  startDate: new Date('2025-01-01'),
  endDate: new Date('2025-02-01'),
  status: 'failure',
  limit: 100
});

// ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
const report = auditingService.generateAuditReport({
  startDate: new Date(Date.now() - 86400000 * 30),
  endDate: new Date()
});

console.log(report);
// {
//   summary: { totalEvents: 1500, successfulActions: 1450, ... },
//   eventDistribution: { ROLE_CREATED: 5, ... },
//   userActivity: { 'user-1': { totalActions: 50, ... }, ... },
//   recommendations: [...]
// }
```

### 7ï¸âƒ£ ÙƒØ´Ù Ø§Ù„Ø´Ø°ÙˆØ° ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø±

```javascript
// Ø§Ù„ÙƒØ´Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù† Ø§Ù„Ø³Ù„ÙˆÙƒ ØºÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
const riskScore = intelligentMiddleware.calculateRiskScore(userId, {
  action: 'DELETE_ROLE',
  location: 'unknown',
  deviceId: 'device-123',
  isSensitiveOperation: true,
  time: 'off-hours'
});

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­ÙˆØ§Ø¯Ø«
const incidents = auditingService.getSecurityIncidents({
  status: 'open',
  severity: 'high'
});

for (const incident of incidents) {
  console.log(`âš ï¸ ${incident.type}: ${incident.severity}`);
}
```

### 8ï¸âƒ£ Ø§Ù„Ø­Ø¯ Ù…Ù† Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ

```javascript
// Ø§Ù„Ø­Ø¯ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ±
intelligentMiddleware.setDynamicRateLimit(userId, {
  blockDurationMs: 300000 // 5 Ø¯Ù‚Ø§Ø¦Ù‚
});

// Super Admin: 500 Ø·Ù„Ø¨/Ø¯Ù‚ÙŠÙ‚Ø©
// Admin: 200 Ø·Ù„Ø¨/Ø¯Ù‚ÙŠÙ‚Ø©
// User: 100 Ø·Ù„Ø¨/Ø¯Ù‚ÙŠÙ‚Ø©
// Guest: 50 Ø·Ù„Ø¨/Ø¯Ù‚ÙŠÙ‚Ø©
```

### 9ï¸âƒ£ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©

```javascript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø©
const sessionId = intelligentMiddleware.createSession(userId, {
  ipAddress: req.ip,
  userAgent: req.headers['user-agent'],
  deviceId: req.headers['x-device-id']
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¬Ù„Ø³Ø©
const validation = intelligentMiddleware.validateSession(sessionId);

if (!validation.valid) {
  console.log('Session invalid:', validation.reason);
  // SESSION_NOT_FOUND, SESSION_EXPIRED, SESSION_IDLE_TIMEOUT
}
```

---

## ğŸ—ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Express Application                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   API Routes (rbac-advanced.routes.js)              â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚  â€¢ Roles Management          â€¢ Policy Management    â”‚    â”‚
â”‚  â”‚  â€¢ Permissions Management   â€¢ Audit & Reporting    â”‚    â”‚
â”‚  â”‚  â€¢ User-Role Assignment     â€¢ Admin Operations      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â†“                           â†“                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Intelligent RBAC   â”‚   RBAC Controller   â”‚    â”‚
â”‚  â”‚   Middleware         â”‚                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â†“                           â†“                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          Advanced RBAC System (Core)               â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚  â€¢ Role Hierarchy        â€¢ Permission Management  â”‚    â”‚
â”‚  â”‚  â€¢ User-Role Assignment  â€¢ Permission Checking    â”‚    â”‚
â”‚  â”‚  â€¢ ABAC (Attributes)     â€¢ Scope Management      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚    â†™          â†“           â†“           â†˜               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  RBAC   â”‚ Policy   â”‚  Auditing â”‚Intelligentâ”‚    â”‚
â”‚  â”‚  System â”‚  Engine  â”‚  Service  â”‚Middleware â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚     â†“         â†“         â†“         â†“               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      Persistent Storage / Database          â”‚  â”‚
â”‚  â”‚  (MongoDB / PostgreSQL / Any Database)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ Ø§Ù„ØªÙƒØ§Ù…Ù„ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯

### Ø§Ù„Ø®Ø·ÙˆØ© 1ï¸âƒ£: Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯

```javascript
const AdvancedRBACSystem = require('./services/advanced-rbac.system');
const RBACPolicyEngine = require('./services/rbac-policy-engine');
const RBACAuditingService = require('./services/rbac-auditing.service');
const IntelligentRBACMiddleware = require('./middleware/rbac-intelligent.middleware');
const AdvancedRBACController = require('./controllers/rbac.controller.advanced');
```

### Ø§Ù„Ø®Ø·ÙˆØ© 2ï¸âƒ£: Ø§Ù„ØªÙ‡ÙŠØ¦Ø©

```javascript
// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
const rbacSystem = new AdvancedRBACSystem({
  enableCache: true,
  cacheTTL: 3600000,
  enableAudit: true,
  enableAnomaly: true
});

const policyEngine = new RBACPolicyEngine(rbacSystem);
const auditingService = new RBACAuditingService();
const intelligentMiddleware = new IntelligentRBACMiddleware(
  rbacSystem,
  policyEngine,
  auditingService
);

const rbacController = new AdvancedRBACController(
  rbacSystem,
  policyEngine,
  auditingService,
  intelligentMiddleware
);
```

### Ø§Ù„Ø®Ø·ÙˆØ© 3ï¸âƒ£: Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡Ø§Øª

```javascript
const express = require('express');
const app = express();

// Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆØ¬ÙŠÙ‡Ø§Øª
const rbacRouter = require('./config/rbac-integration').setupRBACRoutes(
  rbacSystem,
  policyEngine,
  auditingService,
  intelligentMiddleware,
  rbacController
);

app.use('/api/rbac', rbacRouter);
```

---

## ğŸ“š Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### Ù…Ø«Ø§Ù„ 1: Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø­Ø¯ÙˆØ¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ± ÙˆØ§Ù„Ù‚Ø³Ù…

```javascript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¯ÙˆØ± Ù…Ø®ØµØµ
rbacSystem.createRole('department-manager', {
  name: 'Department Manager',
  scope: 'department',
  level: 500
});

// ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙˆØ± Ù…Ø¹ Ù†Ø·Ø§Ù‚ Ù…Ø­Ø¯Ø¯
rbacSystem.assignRoleToUser(userId, 'department-manager', {
  scope: 'department',
  scopeData: {
    departmentId: 'HR',
    allowedActions: ['read', 'update']
  }
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù…Ø¹ Ø§Ù„Ø³ÙŠØ§Ù‚
const canAccess = rbacSystem.hasPermission(userId, 'users:read', {
  departmentId: 'HR'
});
```

### Ù…Ø«Ø§Ù„ 2: Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ©

```javascript
// Ø³ÙŠØ§Ø³Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø®Ø§Ø±Ø¬ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„
policyEngine.createPolicy('after-hours-restricted', {
  principal: { role: 'user' },
  action: ['delete', 'sensitive_operation'],
  resource: ['*'],
  conditions: {
    hour: { $lt: 8 }, // Ù‚Ø¨Ù„ 8 ØµØ¨Ø§Ø­Ø§Ù‹
    dayOfWeek: { $in: [0, 6] } // Ø§Ù„ÙˆÙŠÙƒÙ†Ø¯
  },
  effect: 'Deny',
  priority: 2000
});
```

### Ù…Ø«Ø§Ù„ 3: Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©

```javascript
// Ø¥Ø¹Ø·Ø§Ø¡ ÙˆØµÙˆÙ„ Ù…Ø¤Ù‚Øª
intelligentMiddleware.middleware?.addTemporaryException('exc-123', {
  userId: 'user-123',
  action: 'DELETE_ROLE',
  effect: 'Allow',
  expiresAt: new Date(Date.now() + 3600000), // Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©
  reason: 'Emergency access for system maintenance',
  createdBy: 'admin-1'
});
```

### Ù…Ø«Ø§Ù„ 4: Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø­ÙˆØ§Ø¯Ø«

```javascript
// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙˆØ§Ø¯Ø«
const incidents = auditingService.getSecurityIncidents({
  status: 'open',
  severity: 'high'
});

// ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„
const complianceReport = auditingService.generateComplianceReport();

// Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
auditingService.on('anomalyDetected', (anomaly) => {
  console.log('ğŸš¨ Anomaly Detected:', anomaly);
  // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
});
```

---

## ğŸ”Œ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬ÙŠØ© JSON

### Ø¥Ù†Ø´Ø§Ø¡ Ø¯ÙˆØ±

**POST** `/api/rbac/roles`

```json
{
  "roleId": "content-manager",
  "name": "Content Manager",
  "description": "Can manage content areas",
  "level": 400,
  "scope": "global",
  "parentRole": "manager"
}
```

### ØªØ¹ÙŠÙŠÙ† Ø¯ÙˆØ± Ù…Ø¹ Ø´Ø±ÙˆØ·

**POST** `/api/rbac/users/user-123/roles/editor`

```json
{
  "expiresAt": "2025-12-31T23:59:59Z",
  "scope": "project",
  "scopeData": {
    "projectId": "proj-123"
  },
  "conditions": {
    "contentType": ["article", "blog"]
  }
}
```

### ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª

**POST** `/api/rbac/users/user-123/evaluate-policies`

```json
{
  "action": "delete",
  "resource": "users/456",
  "timestamp": "2025-02-18T10:30:00Z",
  "ipAddress": "192.168.1.1",
  "dayOfWeek": 3,
  "hour": 14
}
```

### Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚

**GET** `/api/rbac/audit-logs?eventType=ROLE_ASSIGNED&userId=user-123&limit=50&sortBy=timestamp&sortOrder=desc`

```json
{
  "success": true,
  "total": 150,
  "returned": 50,
  "results": [
    {
      "id": "audit_1234567890_abc123",
      "timestamp": "2025-02-18T10:30:00Z",
      "eventType": "ROLE_ASSIGNED",
      "userId": "admin-1",
      "action": "ASSIGN",
      "resource": "users/user-123",
      "status": "success",
      "severity": "low"
    }
    // ... more records
  ]
}
```

---

## ğŸ“ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª

### 1ï¸âƒ£ ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø¯ÙˆØ§Ø±

- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‡Ø±Ù…ÙŠØ© Ø§Ù„ÙˆØ§Ø¶Ø­Ø©
- Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙŠØ§Øª ØµØ±ÙŠØ­Ø© Ù„Ù„Ø£Ø¯ÙˆØ§Ø±
- ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…ØªØ¯Ø§Ø®Ù„Ø© Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©

```javascript
// âœ… Ø¬ÙŠØ¯
createRole('super-admin', { level: 1000 });
createRole('admin', { level: 800, parentRole: 'super-admin' });
createRole('manager', { level: 600, parentRole: 'admin' });
createRole('user', { level: 200, parentRole: 'manager' });

// âŒ Ø³ÙŠØ¡
createRole('super-admin', { level: 100 });
createRole('admin', { level: 200, parentRole: 'user' });
```

### 2ï¸âƒ£ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª

- Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø£Ø°ÙˆÙ†Ø§Øª Ù…Ø­Ø¯Ø¯Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ÙÙ‡Ù…
- Ø§Ø³ØªØ®Ø¯Ù… Ù†Ù…Ø· `resource:action`
- Ù‚Ù… Ø¨ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©

```javascript
// âœ… Ø¬ÙŠØ¯
'users:create', 'users:read', 'users:update', 'users:delete'
'documents:read:own' // Ø£Ø°ÙˆÙ†Ø§Øª Ù…Ù‚ÙŠØ¯Ø©

// âŒ Ø³ÙŠØ¡
'admin-all', 'user-stuff', 'dothis'
```

### 3ï¸âƒ£ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª

- Ø§Ø¨Ø¯Ø£ Ø¨Ù€ Deny Ø«Ù… Ø£Ø¶Ù Allow
- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø¨Ø´ÙƒÙ„ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ
- Ø§Ø®ØªØ¨Ø± Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„ØªÙØ¹ÙŠÙ„

```javascript
// âœ… Ø¬ÙŠØ¯
// Deny-by-default
policyEngine.createPolicy('deny-all', {
  principal: '*',
  action: '*',
  resource: '*',
  effect: 'Deny',
  priority: 0 // Ø£Ù‚Ù„ Ø£ÙˆÙ„ÙˆÙŠØ©
});

// Ø«Ù… Ø£Ø¶Ù Allow Ù„Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©
policyEngine.createPolicy('allow-read', {
  principal: { role: 'user' },
  action: ['read'],
  resource: ['public/*'],
  effect: 'Allow',
  priority: 100
});
```

### 4ï¸âƒ£ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚

- Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹
- Ø§Ø­ØªÙØ¸ Ø¨Ø³Ø¬Ù„Ø§Øª Ù„ÙØªØ±Ø© ÙƒØ§ÙÙŠØ©
- Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø§Ù†ØªØ¸Ø§Ù…

```javascript
// âœ… Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø³Ø¬Ù‘Ù„
auditingService.logAuditEvent({
  eventType: 'SENSITIVE_OPERATION',
  userId,
  action,
  resource,
  severity: 'high'
});
```

### 5ï¸âƒ£ Ø§Ù„Ø£Ù…Ø§Ù†

- Ø§Ø³ØªØ®Ø¯Ù… HTTPS ÙÙ‚Ø·
- Ø­Ù…Ø§ÙŠØ© Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¬Ù„Ø³Ø§Øª
- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ù…

---

## ğŸ› ï¸ Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø§ ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„ Ø±ØºÙ… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¥Ø°Ù†

```javascript
// ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
const roles = rbacSystem.getUserRoles(userId);
console.log('User Roles:', roles);

// ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª
const permissions = rbacSystem.getRolePermissions(roles[0]?.roleId);
console.log('Role Permissions:', permissions);

// ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ø±ÙˆØ·
console.log('User Attributes:', rbacSystem.getUserAttributes(userId));

// Ø§Ø®ØªØ¨Ø± Ø§Ù„Ø¥Ø°Ù† Ù…Ø¹ Ø§Ù„Ø³ÙŠØ§Ù‚
const has = rbacSystem.hasPermission(userId, permId, { /* context */ });
console.log('Has Permission:', has);
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ù„Ø§ ØªØ¹Ù…Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ØªÙˆÙ‚Ø¹

```javascript
// Ù‚ÙŠÙ‘Ù… Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©
const evaluation = policyEngine.evaluatePolicies(userId, {
  /* context */
});
console.log('Evaluation Result:', evaluation);

// ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…Ù†Ø·Ø¨Ù‚Ø©
const applicable = policyEngine.getAllPolicies({ active: true });
console.log('Applicable Policies:', applicable);
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø£Ø¯Ø§Ø¡ Ø¨Ø·ÙŠØ¡

```javascript
// ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
const stats = intelligentMiddleware.getPerformanceStats();
console.log('Performance:', stats);

// ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
intelligentMiddleware.smartCache.clear();
```

---

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©

Ù„Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø³Ø¬Ù„ Ù…Ø´Ø§ÙƒÙ„ GitHub Ø£Ùˆ ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±.

---

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø±Ø®Øµ ØªØ­Øª MIT License.

*/

module.exports = {
  version: '1.0.0',
  name: 'Advanced RBAC System',
  description: 'Enterprise-grade role-based access control system',
  author: 'Development Team',
  licience: 'MIT'
};
