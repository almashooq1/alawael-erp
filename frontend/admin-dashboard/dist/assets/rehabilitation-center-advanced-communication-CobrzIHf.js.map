{"version":3,"mappings":"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","names":["apiClient","API_ENDPOINTS","realtimeSync","connectionManager","aiAssistant","advancedCache","loadAPIModules","__vitePreload","n","RehabilitationCenterAdvancedCommunication","data","isOnline","cacheKey","cached","response","_b","_a","_c","error","stored","type","query","filtered","c","container","stats","conv","msg","template","announcement","priority","view","conversationId","templateId","announcementId","advancedCommunication","module"],"ignoreList":[],"sources":["../../src/rehabilitation-center-advanced-communication.js"],"sourcesContent":["/**\n * ğŸ’¬ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…\n * Advanced Communication Management System\n * Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ ÙˆÙ…ØªÙ‚Ø¯Ù… Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„\n */\n\n// Import API Client and endpoints (lazy loading)\nlet apiClient = null;\nlet API_ENDPOINTS = null;\nlet realtimeSync = null;\nlet connectionManager = null;\nlet aiAssistant = null;\nlet advancedCache = null;\n\nasync function loadAPIModules() {\n  if (apiClient !== null) return;\n\n  try {\n    const apiModule = await import('./utils/api-client.js');\n    apiClient = apiModule.default;\n    const configModule = await import('./config/api.js');\n    API_ENDPOINTS = configModule.API_ENDPOINTS;\n\n    try {\n      const connModule = await import('./utils/connection-manager.js');\n      connectionManager = connModule.default;\n    } catch (error) {\n      console.warn('Connection manager not available');\n    }\n\n    try {\n      const syncModule = await import('./utils/realtime-sync.js');\n      realtimeSync = syncModule.default;\n    } catch (error) {\n      console.warn('Real-time sync not available');\n    }\n\n    try {\n      const aiModule = await import('./utils/ai-assistant.js');\n      aiAssistant = aiModule.default;\n    } catch (error) {\n      console.warn('AI Assistant not available');\n    }\n\n    try {\n      const cacheModule = await import('./utils/advanced-cache.js');\n      advancedCache = cacheModule.default;\n    } catch (error) {\n      console.warn('Advanced cache not available');\n    }\n  } catch (error) {\n    console.warn('API modules not available');\n    apiClient = null;\n    API_ENDPOINTS = null;\n  }\n}\n\nclass RehabilitationCenterAdvancedCommunication {\n  constructor() {\n    this.messages = [];\n    this.conversations = [];\n    this.templates = [];\n    this.announcements = [];\n    this.selectedConversation = null;\n    this.currentView = 'conversations';\n    this.filterType = 'all';\n    this.searchQuery = '';\n    this.loading = false;\n    this.useAPI = false;\n    this.init();\n  }\n\n  async init() {\n    await loadAPIModules();\n    this.useAPI = apiClient !== null;\n\n    if (this.useAPI) {\n      await this.loadConversations();\n      await this.loadMessages();\n      await this.loadTemplates();\n      await this.loadAnnouncements();\n    } else {\n      this.initializeDefaultData();\n    }\n\n    if (realtimeSync) {\n      this.setupRealtimeSync();\n    }\n\n    if (connectionManager) {\n      this.setupConnectionMonitoring();\n    }\n\n    this.renderAdvancedCommunication();\n  }\n\n  setupRealtimeSync() {\n    realtimeSync.subscribe('communication:message:updated', data => {\n      this.loadMessages();\n    });\n\n    realtimeSync.subscribe('communication:conversation:updated', data => {\n      this.loadConversations();\n    });\n  }\n\n  setupConnectionMonitoring() {\n    connectionManager.onStatusChange(isOnline => {\n      if (isOnline && this.useAPI) {\n        this.syncPendingChanges();\n      }\n    });\n  }\n\n  async loadConversations() {\n    this.loading = true;\n    try {\n      if (this.useAPI && apiClient) {\n        const cacheKey = 'advanced_communication_conversations';\n        const cached = advancedCache ? advancedCache.get(cacheKey) : null;\n\n        if (cached) {\n          this.conversations = cached;\n        } else {\n          const response = await apiClient.get(\n            API_ENDPOINTS?.advancedCommunication?.conversations?.list ||\n              '/api/advanced-communication/conversations'\n          );\n          if (response.data?.success) {\n            this.conversations = response.data.data || [];\n            if (advancedCache) {\n              advancedCache.set(cacheKey, this.conversations, {\n                ttl: 2 * 60 * 1000,\n                tags: ['communication'],\n              });\n            }\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error loading conversations:', error);\n      this.loadConversationsFromStorage();\n    } finally {\n      this.loading = false;\n      this.renderAdvancedCommunication();\n    }\n  }\n\n  async loadMessages() {\n    try {\n      if (this.useAPI && apiClient) {\n        const response = await apiClient.get(\n          API_ENDPOINTS?.advancedCommunication?.messages?.list ||\n            '/api/advanced-communication/messages'\n        );\n        if (response.data?.success) {\n          this.messages = response.data.data || [];\n        }\n      }\n    } catch (error) {\n      console.error('Error loading messages:', error);\n      this.loadMessagesFromStorage();\n    }\n  }\n\n  async loadTemplates() {\n    try {\n      if (this.useAPI && apiClient) {\n        const response = await apiClient.get(\n          API_ENDPOINTS?.advancedCommunication?.templates?.list ||\n            '/api/advanced-communication/templates'\n        );\n        if (response.data?.success) {\n          this.templates = response.data.data || [];\n        }\n      }\n    } catch (error) {\n      console.error('Error loading templates:', error);\n      this.loadTemplatesFromStorage();\n    }\n  }\n\n  async loadAnnouncements() {\n    try {\n      if (this.useAPI && apiClient) {\n        const response = await apiClient.get(\n          API_ENDPOINTS?.advancedCommunication?.announcements?.list ||\n            '/api/advanced-communication/announcements'\n        );\n        if (response.data?.success) {\n          this.announcements = response.data.data || [];\n        }\n      }\n    } catch (error) {\n      console.error('Error loading announcements:', error);\n      this.loadAnnouncementsFromStorage();\n    }\n  }\n\n  loadConversationsFromStorage() {\n    const stored = localStorage.getItem('advanced_communication_conversations');\n    if (stored) {\n      try {\n        this.conversations = JSON.parse(stored);\n      } catch (error) {\n        console.error('Error loading conversations from storage:', error);\n      }\n    }\n  }\n\n  loadMessagesFromStorage() {\n    const stored = localStorage.getItem('advanced_communication_messages');\n    if (stored) {\n      try {\n        this.messages = JSON.parse(stored);\n      } catch (error) {\n        console.error('Error loading messages from storage:', error);\n      }\n    }\n  }\n\n  loadTemplatesFromStorage() {\n    const stored = localStorage.getItem('advanced_communication_templates');\n    if (stored) {\n      try {\n        this.templates = JSON.parse(stored);\n      } catch (error) {\n        console.error('Error loading templates from storage:', error);\n      }\n    }\n  }\n\n  loadAnnouncementsFromStorage() {\n    const stored = localStorage.getItem('advanced_communication_announcements');\n    if (stored) {\n      try {\n        this.announcements = JSON.parse(stored);\n      } catch (error) {\n        console.error('Error loading announcements from storage:', error);\n      }\n    }\n  }\n\n  saveConversationsToStorage() {\n    localStorage.setItem(\n      'advanced_communication_conversations',\n      JSON.stringify(this.conversations)\n    );\n  }\n\n  initializeDefaultData() {\n    if (this.conversations.length === 0) {\n      this.conversations = [\n        {\n          id: 1,\n          title: 'Ù…Ø­Ø§Ø¯Ø«Ø© Ø¹Ø§Ù…Ø©',\n          type: 'group',\n          participantsCount: 5,\n          lastMessage: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø§Ù„Ø¬Ù…ÙŠØ¹',\n          lastMessageTime: new Date().toISOString(),\n          unreadCount: 0,\n        },\n      ];\n      this.saveConversationsToStorage();\n    }\n  }\n\n  async syncPendingChanges() {\n    if (this.useAPI && apiClient) {\n      // TODO: Sync pending changes\n    }\n  }\n\n  filterByType(type) {\n    this.filterType = type === this.filterType ? 'all' : type;\n    this.renderAdvancedCommunication();\n  }\n\n  searchItems(query) {\n    this.searchQuery = query;\n    this.renderAdvancedCommunication();\n  }\n\n  getFilteredConversations() {\n    let filtered = this.conversations;\n\n    if (this.filterType !== 'all') {\n      filtered = filtered.filter(c => c.type === this.filterType);\n    }\n\n    if (this.searchQuery) {\n      const query = this.searchQuery.toLowerCase();\n      filtered = filtered.filter(\n        c =>\n          c.title.toLowerCase().includes(query) ||\n          (c.lastMessage && c.lastMessage.toLowerCase().includes(query))\n      );\n    }\n\n    return filtered;\n  }\n\n  renderAdvancedCommunication() {\n    const container = document.getElementById('advanced-communication-container') || document.body;\n\n    container.innerHTML = `\n      <div class=\"advanced-communication\">\n        <div class=\"header-section\">\n          <h2><i class=\"fas fa-comments\"></i> Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h2>\n          <div class=\"header-actions\">\n            <button class=\"btn btn-primary\" onclick=\"advancedCommunication.showCreateModal()\">\n              <i class=\"fas fa-plus\"></i> Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©\n            </button>\n            <button class=\"btn btn-info\" onclick=\"advancedCommunication.refresh()\" ${this.loading ? 'disabled' : ''}>\n              <i class=\"fas fa-sync-alt ${this.loading ? 'fa-spin' : ''}\"></i> ØªØ­Ø¯ÙŠØ«\n            </button>\n          </div>\n        </div>\n\n        <div class=\"filters-section\">\n          <div class=\"search-box\">\n            <i class=\"fas fa-search\"></i>\n            <input type=\"text\" class=\"search-input\" placeholder=\"Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª...\" \n                   value=\"${this.searchQuery}\"\n                   oninput=\"advancedCommunication.searchItems(this.value)\">\n          </div>\n          <div class=\"type-filters\">\n            <button class=\"filter-btn ${this.filterType === 'all' ? 'active' : ''}\" \n                    onclick=\"advancedCommunication.filterByType('all')\">\n              Ø§Ù„ÙƒÙ„\n            </button>\n            <button class=\"filter-btn ${this.filterType === 'direct' ? 'active' : ''}\" \n                    onclick=\"advancedCommunication.filterByType('direct')\">\n              <i class=\"fas fa-user\"></i> Ù…Ø¨Ø§Ø´Ø±\n            </button>\n            <button class=\"filter-btn ${this.filterType === 'group' ? 'active' : ''}\" \n                    onclick=\"advancedCommunication.filterByType('group')\">\n              <i class=\"fas fa-users\"></i> Ø¬Ù…Ø§Ø¹ÙŠ\n            </button>\n          </div>\n        </div>\n\n        <div class=\"tabs-section\">\n          <button class=\"tab-btn ${this.currentView === 'conversations' ? 'active' : ''}\" onclick=\"advancedCommunication.switchView('conversations')\">\n            <i class=\"fas fa-comments\"></i> Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'messages' ? 'active' : ''}\" onclick=\"advancedCommunication.switchView('messages')\">\n            <i class=\"fas fa-envelope\"></i> Ø§Ù„Ø±Ø³Ø§Ø¦Ù„\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'templates' ? 'active' : ''}\" onclick=\"advancedCommunication.switchView('templates')\">\n            <i class=\"fas fa-file-alt\"></i> Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'announcements' ? 'active' : ''}\" onclick=\"advancedCommunication.switchView('announcements')\">\n            <i class=\"fas fa-bullhorn\"></i> Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª\n          </button>\n        </div>\n\n        <div class=\"content-section\">\n          ${this.renderCurrentView()}\n        </div>\n      </div>\n    `;\n  }\n\n  renderCurrentView() {\n    switch (this.currentView) {\n      case 'conversations':\n        return this.renderConversations();\n      case 'messages':\n        return this.renderMessages();\n      case 'templates':\n        return this.renderTemplates();\n      case 'announcements':\n        return this.renderAnnouncements();\n      default:\n        return this.renderConversations();\n    }\n  }\n\n  renderConversations() {\n    const filtered = this.getFilteredConversations();\n    const stats = {\n      total: this.conversations.length,\n      unread: this.conversations.filter(c => c.unreadCount > 0).length,\n      direct: this.conversations.filter(c => c.type === 'direct').length,\n      group: this.conversations.filter(c => c.type === 'group').length,\n    };\n\n    return `\n      <div class=\"conversations-view\">\n        <div class=\"conversations-stats\">\n          <div class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\">\n              <i class=\"fas fa-comments\"></i>\n            </div>\n            <div class=\"stat-content\">\n              <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</h3>\n              <p class=\"count\">${stats.total}</p>\n            </div>\n          </div>\n          <div class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);\">\n              <i class=\"fas fa-envelope\"></i>\n            </div>\n            <div class=\"stat-content\">\n              <h3>ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡</h3>\n              <p class=\"count\">${stats.unread}</p>\n            </div>\n          </div>\n          <div class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\">\n              <i class=\"fas fa-user\"></i>\n            </div>\n            <div class=\"stat-content\">\n              <h3>Ù…Ø¨Ø§Ø´Ø±</h3>\n              <p class=\"count\">${stats.direct}</p>\n            </div>\n          </div>\n          <div class=\"stat-card\">\n            <div class=\"stat-icon\" style=\"background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);\">\n              <i class=\"fas fa-users\"></i>\n            </div>\n            <div class=\"stat-content\">\n              <h3>Ø¬Ù…Ø§Ø¹ÙŠ</h3>\n              <p class=\"count\">${stats.group}</p>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"conversations-list\">\n          ${\n            filtered\n              .map(\n                conv => `\n            <div class=\"conversation-card ${conv.unreadCount > 0 ? 'unread' : ''}\" onclick=\"advancedCommunication.openConversation(${conv.id})\">\n              <div class=\"conversation-avatar\">\n                ${conv.type === 'group' ? '<i class=\"fas fa-users\"></i>' : '<i class=\"fas fa-user\"></i>'}\n              </div>\n              <div class=\"conversation-content\">\n                <div class=\"conversation-header\">\n                  <h4>${conv.title}</h4>\n                  <span class=\"conversation-time\">${new Date(conv.lastMessageTime).toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' })}</span>\n                </div>\n                <div class=\"conversation-body\">\n                  <p>${conv.lastMessage || ''}</p>\n                  ${\n                    conv.unreadCount > 0\n                      ? `\n                    <span class=\"unread-badge\">${conv.unreadCount}</span>\n                  `\n                      : ''\n                  }\n                </div>\n                <div class=\"conversation-footer\">\n                  <span class=\"participants-count\">\n                    <i class=\"fas fa-users\"></i> ${conv.participantsCount || 0}\n                  </span>\n                  <span class=\"conversation-type type-${conv.type}\">\n                    ${conv.type === 'group' ? 'Ø¬Ù…Ø§Ø¹ÙŠ' : 'Ù…Ø¨Ø§Ø´Ø±'}\n                  </span>\n                </div>\n              </div>\n            </div>\n          `\n              )\n              .join('') || '<p class=\"empty-state\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª</p>'\n          }\n        </div>\n      </div>\n    `;\n  }\n\n  renderMessages() {\n    return `\n      <div class=\"messages-view\">\n        <div class=\"messages-list\">\n          ${\n            this.messages\n              .map(\n                msg => `\n            <div class=\"message-card message-${msg.direction}\">\n              <div class=\"message-header\">\n                <h4>${msg.senderName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</h4>\n                <span class=\"message-time\">${new Date(msg.timestamp).toLocaleString('ar-SA')}</span>\n              </div>\n              <div class=\"message-body\">\n                <p>${msg.content || ''}</p>\n              </div>\n              <div class=\"message-status\">\n                ${msg.read ? '<i class=\"fas fa-check-double\"></i>' : '<i class=\"fas fa-check\"></i>'}\n              </div>\n            </div>\n          `\n              )\n              .join('') || '<p class=\"empty-state\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„</p>'\n          }\n        </div>\n      </div>\n    `;\n  }\n\n  renderTemplates() {\n    return `\n      <div class=\"templates-view\">\n        <div class=\"templates-grid\">\n          ${\n            this.templates\n              .map(\n                template => `\n            <div class=\"template-card\">\n              <div class=\"template-header\">\n                <h4>${template.name}</h4>\n                <span class=\"template-category\">${template.category || 'Ø¹Ø§Ù…'}</span>\n              </div>\n              <div class=\"template-body\">\n                <p>${template.content || ''}</p>\n              </div>\n              <div class=\"template-actions\">\n                <button class=\"btn btn-sm btn-primary\" onclick=\"advancedCommunication.useTemplate(${template.id})\">\n                  <i class=\"fas fa-plus\"></i> Ø§Ø³ØªØ®Ø¯Ø§Ù…\n                </button>\n                <button class=\"btn btn-sm btn-success\" onclick=\"advancedCommunication.editTemplate(${template.id})\">\n                  <i class=\"fas fa-edit\"></i> ØªØ¹Ø¯ÙŠÙ„\n                </button>\n              </div>\n            </div>\n          `\n              )\n              .join('') || '<p class=\"empty-state\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ÙˆØ§Ù„Ø¨</p>'\n          }\n        </div>\n      </div>\n    `;\n  }\n\n  renderAnnouncements() {\n    return `\n      <div class=\"announcements-view\">\n        <div class=\"announcements-list\">\n          ${\n            this.announcements\n              .map(\n                announcement => `\n            <div class=\"announcement-card announcement-${announcement.priority}\">\n              <div class=\"announcement-header\">\n                <h4>${announcement.title}</h4>\n                <span class=\"announcement-priority priority-${announcement.priority}\">\n                  ${this.getPriorityName(announcement.priority)}\n                </span>\n              </div>\n              <div class=\"announcement-body\">\n                <p>${announcement.content || ''}</p>\n                <div class=\"announcement-info\">\n                  <div class=\"info-item\">\n                    <i class=\"fas fa-calendar\"></i>\n                    <span>${new Date(announcement.publishDate).toLocaleDateString('ar-SA')}</span>\n                  </div>\n                  <div class=\"info-item\">\n                    <i class=\"fas fa-eye\"></i>\n                    <span>${announcement.viewsCount || 0} Ù…Ø´Ø§Ù‡Ø¯Ø©</span>\n                  </div>\n                </div>\n              </div>\n              <div class=\"announcement-actions\">\n                <button class=\"btn btn-sm btn-primary\" onclick=\"advancedCommunication.viewAnnouncement(${announcement.id})\">\n                  <i class=\"fas fa-eye\"></i> Ø¹Ø±Ø¶\n                </button>\n                <button class=\"btn btn-sm btn-success\" onclick=\"advancedCommunication.editAnnouncement(${announcement.id})\">\n                  <i class=\"fas fa-edit\"></i> ØªØ¹Ø¯ÙŠÙ„\n                </button>\n              </div>\n            </div>\n          `\n              )\n              .join('') || '<p class=\"empty-state\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</p>'\n          }\n        </div>\n      </div>\n    `;\n  }\n\n  getPriorityName(priority) {\n    const names = {\n      low: 'Ù…Ù†Ø®ÙØ¶',\n      medium: 'Ù…ØªÙˆØ³Ø·',\n      high: 'Ø¹Ø§Ù„ÙŠ',\n      urgent: 'Ø¹Ø§Ø¬Ù„',\n    };\n    return names[priority] || priority;\n  }\n\n  switchView(view) {\n    this.currentView = view;\n    this.renderAdvancedCommunication();\n  }\n\n  openConversation(conversationId) {\n    alert(`ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© #${conversationId} - Ø³ÙŠØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹`);\n  }\n\n  useTemplate(templateId) {\n    alert(`Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ #${templateId} - Ø³ÙŠØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹`);\n  }\n\n  editTemplate(templateId) {\n    alert(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø§Ù„Ø¨ #${templateId} - Ø³ÙŠØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹`);\n  }\n\n  viewAnnouncement(announcementId) {\n    alert(`Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† #${announcementId} - Ø³ÙŠØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹`);\n  }\n\n  editAnnouncement(announcementId) {\n    alert(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† #${announcementId} - Ø³ÙŠØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹`);\n  }\n\n  showCreateModal() {\n    alert('Ù†Ù…ÙˆØ°Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© - Ø³ÙŠØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹');\n  }\n\n  async refresh() {\n    if (advancedCache) {\n      advancedCache.clear(['communication']);\n    }\n    await this.loadConversations();\n    await this.loadMessages();\n    await this.loadTemplates();\n    await this.loadAnnouncements();\n    if (typeof showToast === 'function') {\n      showToast('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«', 'success');\n    }\n  }\n}\n\n// Initialize advanced communication system\nconst advancedCommunication = new RehabilitationCenterAdvancedCommunication();\n\n// Make it available globally\nif (typeof window !== 'undefined') {\n  window.advancedCommunication = advancedCommunication;\n\n  // Enhance with universal module enhancer if available\n  if (window.universalModuleEnhancer) {\n    window.universalModuleEnhancer.enhanceModule(advancedCommunication, 'advancedCommunication');\n  }\n}\n\n// Export for use in other modules\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = RehabilitationCenterAdvancedCommunication;\n}\n"],"file":"assets/rehabilitation-center-advanced-communication-CobrzIHf.js"}