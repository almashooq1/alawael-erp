{"version":3,"file":"rehabilitation-center-advanced-referrals-CWRjQBkT.js","sources":["../../src/rehabilitation-center-advanced-referrals.js"],"sourcesContent":["/**\n * üîÑ Advanced Referrals & Transfers Management System\n * ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ•ÿ≠ÿßŸÑÿßÿ™ ŸàÿßŸÑÿ™ÿ≠ŸàŸäŸÑÿßÿ™ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ÿßŸÑÿ∞ŸÉŸä ÿßŸÑŸÖÿ™ŸÉÿßŸÖŸÑ\n */\n\nimport apiClient from './utils/api-client.js';\nimport { API_ENDPOINTS } from './config/api.js';\nimport connectionManager from './utils/connection-manager.js';\nimport realtimeSync from './utils/realtime-sync.js';\nimport systemEnhancer from './utils/system-enhancer.js';\nimport aiAssistant from './utils/ai-assistant.js';\nimport advancedCache from './utils/advanced-cache.js';\n\nclass AdvancedReferralsManagement {\n  constructor(container) {\n    this.container = container;\n    this.useAPI = true;\n    this.apiClient = apiClient;\n    this.API_ENDPOINTS = API_ENDPOINTS.advancedReferrals || {};\n    this.connectionManager = connectionManager;\n    this.realtimeSync = realtimeSync;\n    this.systemEnhancer = systemEnhancer;\n    this.aiAssistant = aiAssistant;\n    this.advancedCache = advancedCache;\n\n    this.referrals = [];\n    this.transfers = [];\n    this.referralSources = [];\n    this.referralDestinations = [];\n    this.followUps = [];\n    this.analytics = [];\n\n    this.currentView = 'referrals';\n    this.filters = {\n      status: 'all',\n      type: 'all',\n      search: '',\n    };\n\n    this.init();\n  }\n\n  async init() {\n    this.render();\n    this.setupEventListeners();\n    await this.loadData();\n    this.setupRealtimeSync();\n    this.setupConnectionMonitoring();\n  }\n\n  render() {\n    if (!this.container) return;\n\n    this.container.innerHTML = `\n      <div class=\"advanced-referrals-management\">\n        <div class=\"referrals-header\">\n          <h2>üîÑ ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ•ÿ≠ÿßŸÑÿßÿ™ ŸàÿßŸÑÿ™ÿ≠ŸàŸäŸÑÿßÿ™ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ ÿßŸÑÿ∞ŸÉŸä ÿßŸÑŸÖÿ™ŸÉÿßŸÖŸÑ</h2>\n          <div class=\"header-actions\">\n            <button class=\"btn btn-primary\" onclick=\"this.createReferral()\">\n              <i class=\"fas fa-plus\"></i> ÿ•ÿ≠ÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ©\n            </button>\n            <button class=\"btn btn-secondary\" onclick=\"this.createTransfer()\">\n              <i class=\"fas fa-exchange-alt\"></i> ÿ™ÿ≠ŸàŸäŸÑ ÿ¨ÿØŸäÿØ\n            </button>\n            <button class=\"btn btn-info\" onclick=\"this.addSource()\">\n              <i class=\"fas fa-building\"></i> ŸÖÿµÿØÿ± ÿ¨ÿØŸäÿØ\n            </button>\n          </div>\n        </div>\n\n        <div class=\"referrals-tabs\">\n          <button class=\"tab-btn ${this.currentView === 'referrals' ? 'active' : ''}\" \n                  onclick=\"this.switchView('referrals')\">\n            <i class=\"fas fa-arrow-right\"></i> ÿßŸÑÿ•ÿ≠ÿßŸÑÿßÿ™\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'transfers' ? 'active' : ''}\" \n                  onclick=\"this.switchView('transfers')\">\n            <i class=\"fas fa-exchange-alt\"></i> ÿßŸÑÿ™ÿ≠ŸàŸäŸÑÿßÿ™\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'sources' ? 'active' : ''}\" \n                  onclick=\"this.switchView('sources')\">\n            <i class=\"fas fa-building\"></i> ÿßŸÑŸÖÿµÿßÿØÿ±\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'destinations' ? 'active' : ''}\" \n                  onclick=\"this.switchView('destinations')\">\n            <i class=\"fas fa-map-marker-alt\"></i> ÿßŸÑŸàÿ¨Ÿáÿßÿ™\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'follow-ups' ? 'active' : ''}\" \n                  onclick=\"this.switchView('follow-ups')\">\n            <i class=\"fas fa-tasks\"></i> ÿßŸÑŸÖÿ™ÿßÿ®ÿπÿßÿ™\n          </button>\n          <button class=\"tab-btn ${this.currentView === 'analytics' ? 'active' : ''}\" \n                  onclick=\"this.switchView('analytics')\">\n            <i class=\"fas fa-chart-bar\"></i> ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™\n          </button>\n        </div>\n\n        <div class=\"referrals-filters\">\n          <select class=\"filter-select\" onchange=\"this.handleFilterChange('status', event)\">\n            <option value=\"all\">ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿßŸÑÿßÿ™</option>\n            <option value=\"pending\">ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±</option>\n            <option value=\"approved\">ŸÖŸàÿßŸÅŸÇ ÿπŸÑŸäŸá</option>\n            <option value=\"rejected\">ŸÖÿ±ŸÅŸàÿ∂</option>\n            <option value=\"completed\">ŸÖŸÉÿ™ŸÖŸÑ</option>\n          </select>\n          <select class=\"filter-select\" onchange=\"this.handleFilterChange('type', event)\">\n            <option value=\"all\">ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸÜŸàÿßÿπ</option>\n            <option value=\"internal\">ÿØÿßÿÆŸÑŸä</option>\n            <option value=\"external\">ÿÆÿßÿ±ÿ¨Ÿä</option>\n            <option value=\"emergency\">ÿ∑Ÿàÿßÿ±ÿ¶</option>\n          </select>\n          <input type=\"text\" class=\"search-input\" placeholder=\"ÿ®ÿ≠ÿ´...\" \n                 oninput=\"this.handleSearch(event)\">\n        </div>\n\n        <div class=\"referrals-content\" id=\"referralsContent\">\n          ${this.renderCurrentView()}\n        </div>\n      </div>\n    `;\n  }\n\n  renderCurrentView() {\n    switch (this.currentView) {\n      case 'referrals':\n        return this.renderReferrals();\n      case 'transfers':\n        return this.renderTransfers();\n      case 'sources':\n        return this.renderSources();\n      case 'destinations':\n        return this.renderDestinations();\n      case 'follow-ups':\n        return this.renderFollowUps();\n      case 'analytics':\n        return this.renderAnalytics();\n      default:\n        return this.renderReferrals();\n    }\n  }\n\n  renderReferrals() {\n    const filtered = this.getFilteredData(this.referrals);\n\n    if (filtered.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <i class=\"fas fa-arrow-right\"></i>\n          <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ•ÿ≠ÿßŸÑÿßÿ™</p>\n          <button class=\"btn btn-primary\" onclick=\"this.createReferral()\">\n            ÿ•ÿ∂ÿßŸÅÿ© ÿ•ÿ≠ÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ©\n          </button>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"referrals-list\">\n        ${filtered\n          .map(\n            referral => `\n          <div class=\"referral-card status-${referral.status}\">\n            <div class=\"referral-header\">\n              <h3>${referral.patientName || 'ŸÖÿ±Ÿäÿ∂'}</h3>\n              <span class=\"status-badge status-${referral.status}\">${this.getStatusText(referral.status)}</span>\n            </div>\n            <div class=\"referral-body\">\n              <div class=\"referral-details\">\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ŸÖŸÜ:</span>\n                  <span class=\"detail-value\">${referral.fromSource || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿ•ŸÑŸâ:</span>\n                  <span class=\"detail-value\">${referral.toDestination || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑŸÜŸàÿπ:</span>\n                  <span class=\"detail-value\">${this.getTypeText(referral.type)}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ™ÿßÿ±ŸäÿÆ:</span>\n                  <span class=\"detail-value\">${this.formatDate(referral.date)}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ≥ÿ®ÿ®:</span>\n                  <span class=\"detail-value\">${referral.reason || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n              </div>\n            </div>\n            <div class=\"referral-actions\">\n              <button class=\"btn btn-sm btn-primary\" onclick=\"this.viewReferral(${referral.id})\">\n                <i class=\"fas fa-eye\"></i> ÿπÿ±ÿ∂\n              </button>\n              <button class=\"btn btn-sm btn-secondary\" onclick=\"this.editReferral(${referral.id})\">\n                <i class=\"fas fa-edit\"></i> ÿ™ÿπÿØŸäŸÑ\n              </button>\n            </div>\n          </div>\n        `\n          )\n          .join('')}\n      </div>\n    `;\n  }\n\n  renderTransfers() {\n    if (this.transfers.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <i class=\"fas fa-exchange-alt\"></i>\n          <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ™ÿ≠ŸàŸäŸÑÿßÿ™</p>\n          <button class=\"btn btn-primary\" onclick=\"this.createTransfer()\">\n            ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ≠ŸàŸäŸÑ ÿ¨ÿØŸäÿØ\n          </button>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"transfers-list\">\n        ${this.transfers\n          .map(\n            transfer => `\n          <div class=\"transfer-card status-${transfer.status}\">\n            <div class=\"transfer-header\">\n              <h3>${transfer.patientName || 'ŸÖÿ±Ÿäÿ∂'}</h3>\n              <span class=\"status-badge status-${transfer.status}\">${this.getStatusText(transfer.status)}</span>\n            </div>\n            <div class=\"transfer-body\">\n              <div class=\"transfer-details\">\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ŸÖŸÜ:</span>\n                  <span class=\"detail-value\">${transfer.fromLocation || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿ•ŸÑŸâ:</span>\n                  <span class=\"detail-value\">${transfer.toLocation || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ™ÿßÿ±ŸäÿÆ:</span>\n                  <span class=\"detail-value\">${this.formatDate(transfer.date)}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ≥ÿ®ÿ®:</span>\n                  <span class=\"detail-value\">${transfer.reason || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        `\n          )\n          .join('')}\n      </div>\n    `;\n  }\n\n  renderSources() {\n    if (this.referralSources.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <i class=\"fas fa-building\"></i>\n          <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿµÿßÿØÿ±</p>\n          <button class=\"btn btn-primary\" onclick=\"this.addSource()\">\n            ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿµÿØÿ± ÿ¨ÿØŸäÿØ\n          </button>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"sources-grid\">\n        ${this.referralSources\n          .map(\n            source => `\n          <div class=\"source-card\">\n            <div class=\"source-header\">\n              <h3>${source.name || 'ŸÖÿµÿØÿ±'}</h3>\n              <span class=\"source-type\">${this.getSourceTypeText(source.type)}</span>\n            </div>\n            <div class=\"source-body\">\n              <div class=\"source-details\">\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿπÿØÿØ ÿßŸÑÿ•ÿ≠ÿßŸÑÿßÿ™:</span>\n                  <span class=\"detail-value\">${source.referralsCount || 0}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑŸáÿßÿ™ŸÅ:</span>\n                  <span class=\"detail-value\">${source.phone || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä:</span>\n                  <span class=\"detail-value\">${source.email || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        `\n          )\n          .join('')}\n      </div>\n    `;\n  }\n\n  renderDestinations() {\n    if (this.referralDestinations.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <i class=\"fas fa-map-marker-alt\"></i>\n          <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ Ÿàÿ¨Ÿáÿßÿ™</p>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"destinations-grid\">\n        ${this.referralDestinations\n          .map(\n            destination => `\n          <div class=\"destination-card\">\n            <div class=\"destination-header\">\n              <h3>${destination.name || 'Ÿàÿ¨Ÿáÿ©'}</h3>\n              <span class=\"destination-type\">${this.getDestinationTypeText(destination.type)}</span>\n            </div>\n            <div class=\"destination-body\">\n              <div class=\"destination-details\">\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿπÿØÿØ ÿßŸÑÿ•ÿ≠ÿßŸÑÿßÿ™:</span>\n                  <span class=\"detail-value\">${destination.referralsCount || 0}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑŸÖŸàŸÇÿπ:</span>\n                  <span class=\"detail-value\">${destination.location || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑŸáÿßÿ™ŸÅ:</span>\n                  <span class=\"detail-value\">${destination.phone || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        `\n          )\n          .join('')}\n      </div>\n    `;\n  }\n\n  renderFollowUps() {\n    if (this.followUps.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <i class=\"fas fa-tasks\"></i>\n          <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ™ÿßÿ®ÿπÿßÿ™</p>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"follow-ups-list\">\n        ${this.followUps\n          .map(\n            followUp => `\n          <div class=\"follow-up-card status-${followUp.status}\">\n            <div class=\"follow-up-header\">\n              <h3>${followUp.patientName || 'ŸÖÿ±Ÿäÿ∂'}</h3>\n              <span class=\"status-badge status-${followUp.status}\">${this.getStatusText(followUp.status)}</span>\n            </div>\n            <div class=\"follow-up-body\">\n              <div class=\"follow-up-details\">\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ•ÿ≠ÿßŸÑÿ©:</span>\n                  <span class=\"detail-value\">${followUp.referralId || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑÿ™ÿßÿ±ŸäÿÆ:</span>\n                  <span class=\"detail-value\">${this.formatDate(followUp.date)}</span>\n                </div>\n                <div class=\"detail-item\">\n                  <span class=\"detail-label\">ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™:</span>\n                  <span class=\"detail-value\">${followUp.notes || 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™'}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        `\n          )\n          .join('')}\n      </div>\n    `;\n  }\n\n  renderAnalytics() {\n    if (this.analytics.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <i class=\"fas fa-chart-bar\"></i>\n          <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ≠ŸÑŸäŸÑŸäÿ©</p>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"analytics-dashboard\">\n        ${this.analytics\n          .map(\n            analytic => `\n          <div class=\"analytic-card\">\n            <div class=\"analytic-header\">\n              <h3>${analytic.metric}</h3>\n              <span class=\"analytic-value\">${analytic.value}</span>\n            </div>\n            <div class=\"analytic-body\">\n              <p>${analytic.description || ''}</p>\n            </div>\n          </div>\n        `\n          )\n          .join('')}\n      </div>\n    `;\n  }\n\n  getFilteredData(data) {\n    let filtered = [...data];\n    if (this.filters.status !== 'all') {\n      filtered = filtered.filter(item => item.status === this.filters.status);\n    }\n    if (this.filters.type !== 'all') {\n      filtered = filtered.filter(item => item.type === this.filters.type);\n    }\n    if (this.filters.search) {\n      const search = this.filters.search.toLowerCase();\n      filtered = filtered.filter(\n        item =>\n          (item.patientName && item.patientName.toLowerCase().includes(search)) ||\n          (item.fromSource && item.fromSource.toLowerCase().includes(search)) ||\n          (item.toDestination && item.toDestination.toLowerCase().includes(search))\n      );\n    }\n    return filtered;\n  }\n\n  async loadData() {\n    if (!this.useAPI) {\n      this.loadFromLocalStorage();\n      return;\n    }\n\n    try {\n      if (!this.connectionManager.isFullyConnected()) {\n        this.loadFromLocalStorage();\n        return;\n      }\n\n      const [referrals, transfers, sources, destinations, followUps, analytics] = await Promise.all(\n        [\n          this.apiClient.get(this.API_ENDPOINTS.referrals || '/api/advanced-referrals/referrals'),\n          this.apiClient.get(this.API_ENDPOINTS.transfers || '/api/advanced-referrals/transfers'),\n          this.apiClient.get(this.API_ENDPOINTS.sources || '/api/advanced-referrals/sources'),\n          this.apiClient.get(\n            this.API_ENDPOINTS.destinations || '/api/advanced-referrals/destinations'\n          ),\n          this.apiClient.get(this.API_ENDPOINTS.followUps || '/api/advanced-referrals/follow-ups'),\n          this.apiClient.get(this.API_ENDPOINTS.analytics || '/api/advanced-referrals/analytics'),\n        ]\n      );\n\n      this.referrals = referrals.data || [];\n      this.transfers = transfers.data || [];\n      this.referralSources = sources.data || [];\n      this.referralDestinations = destinations.data || [];\n      this.followUps = followUps.data || [];\n      this.analytics = analytics.data || [];\n\n      this.saveToLocalStorage();\n      this.updateContent();\n    } catch (error) {\n      console.error('Error loading referrals data:', error);\n      this.loadFromLocalStorage();\n    }\n  }\n\n  setupRealtimeSync() {\n    if (!this.realtimeSync) return;\n    this.realtimeSync.subscribe('advanced-referrals', '*', update => {\n      if (update.action === 'create' || update.action === 'update' || update.action === 'delete') {\n        this.loadData();\n      }\n    });\n  }\n\n  setupConnectionMonitoring() {\n    if (!this.connectionManager) return;\n    this.connectionManager.on('online', () => {\n      this.loadData();\n    });\n  }\n\n  switchView(view) {\n    this.currentView = view;\n    this.updateContent();\n  }\n\n  handleFilterChange(type, event) {\n    this.filters[type] = event.target.value;\n    this.updateContent();\n  }\n\n  handleSearch(event) {\n    this.filters.search = event.target.value;\n    this.updateContent();\n  }\n\n  updateContent() {\n    const content = document.getElementById('referralsContent');\n    if (content) {\n      content.innerHTML = this.renderCurrentView();\n    }\n  }\n\n  getStatusText(status) {\n    const statusMap = {\n      pending: 'ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±',\n      approved: 'ŸÖŸàÿßŸÅŸÇ ÿπŸÑŸäŸá',\n      rejected: 'ŸÖÿ±ŸÅŸàÿ∂',\n      completed: 'ŸÖŸÉÿ™ŸÖŸÑ',\n    };\n    return statusMap[status] || status;\n  }\n\n  getTypeText(type) {\n    const typeMap = {\n      internal: 'ÿØÿßÿÆŸÑŸä',\n      external: 'ÿÆÿßÿ±ÿ¨Ÿä',\n      emergency: 'ÿ∑Ÿàÿßÿ±ÿ¶',\n    };\n    return typeMap[type] || type;\n  }\n\n  getSourceTypeText(type) {\n    const typeMap = {\n      hospital: 'ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ',\n      clinic: 'ÿπŸäÿßÿØÿ©',\n      center: 'ŸÖÿ±ŸÉÿ≤',\n      other: 'ÿ£ÿÆÿ±Ÿâ',\n    };\n    return typeMap[type] || type;\n  }\n\n  getDestinationTypeText(type) {\n    const typeMap = {\n      hospital: 'ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ',\n      clinic: 'ÿπŸäÿßÿØÿ©',\n      center: 'ŸÖÿ±ŸÉÿ≤',\n      specialist: 'ÿ£ÿÆÿµÿßÿ¶Ÿä',\n      other: 'ÿ£ÿÆÿ±Ÿâ',\n    };\n    return typeMap[type] || type;\n  }\n\n  formatDate(date) {\n    if (!date) return 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';\n    return new Date(date).toLocaleDateString('ar-SA');\n  }\n\n  saveToLocalStorage() {\n    try {\n      localStorage.setItem('advancedReferrals', JSON.stringify(this.referrals));\n      localStorage.setItem('advancedTransfers', JSON.stringify(this.transfers));\n      localStorage.setItem('advancedReferralSources', JSON.stringify(this.referralSources));\n      localStorage.setItem(\n        'advancedReferralDestinations',\n        JSON.stringify(this.referralDestinations)\n      );\n      localStorage.setItem('advancedFollowUps', JSON.stringify(this.followUps));\n      localStorage.setItem('advancedAnalytics', JSON.stringify(this.analytics));\n    } catch (error) {\n      console.error('Error saving to localStorage:', error);\n    }\n  }\n\n  loadFromLocalStorage() {\n    try {\n      this.referrals = JSON.parse(localStorage.getItem('advancedReferrals') || '[]');\n      this.transfers = JSON.parse(localStorage.getItem('advancedTransfers') || '[]');\n      this.referralSources = JSON.parse(localStorage.getItem('advancedReferralSources') || '[]');\n      this.referralDestinations = JSON.parse(\n        localStorage.getItem('advancedReferralDestinations') || '[]'\n      );\n      this.followUps = JSON.parse(localStorage.getItem('advancedFollowUps') || '[]');\n      this.analytics = JSON.parse(localStorage.getItem('advancedAnalytics') || '[]');\n    } catch (error) {\n      console.error('Error loading from localStorage:', error);\n    }\n  }\n\n  setupEventListeners() {\n    this.createReferral = this.createReferral.bind(this);\n    this.createTransfer = this.createTransfer.bind(this);\n    this.addSource = this.addSource.bind(this);\n    this.switchView = this.switchView.bind(this);\n    this.handleFilterChange = this.handleFilterChange.bind(this);\n    this.handleSearch = this.handleSearch.bind(this);\n    this.viewReferral = this.viewReferral.bind(this);\n    this.editReferral = this.editReferral.bind(this);\n  }\n\n  async createReferral() {\n    console.log('Create referral');\n  }\n\n  async createTransfer() {\n    console.log('Create transfer');\n  }\n\n  async addSource() {\n    console.log('Add source');\n  }\n\n  async viewReferral(id) {\n    console.log('View referral', id);\n  }\n\n  async editReferral(id) {\n    console.log('Edit referral', id);\n  }\n}\n\nexport default AdvancedReferralsManagement;\n"],"names":["AdvancedReferralsManagement","container","apiClient","API_ENDPOINTS","connectionManager","realtimeSync","systemEnhancer","aiAssistant","advancedCache","filtered","referral","transfer","source","destination","followUp","analytic","data","item","search","referrals","transfers","sources","destinations","followUps","analytics","error","update","view","type","event","content","status","date","id"],"mappings":"4EAaA,MAAMA,CAA4B,CAChC,YAAYC,EAAW,CACrB,KAAK,UAAYA,EACjB,KAAK,OAAS,GACd,KAAK,UAAYC,EACjB,KAAK,cAAgBC,EAAc,mBAAqB,CAAA,EACxD,KAAK,kBAAoBC,EACzB,KAAK,aAAeC,EACpB,KAAK,eAAiBC,EACtB,KAAK,YAAcC,EACnB,KAAK,cAAgBC,EAErB,KAAK,UAAY,CAAA,EACjB,KAAK,UAAY,CAAA,EACjB,KAAK,gBAAkB,CAAA,EACvB,KAAK,qBAAuB,CAAA,EAC5B,KAAK,UAAY,CAAA,EACjB,KAAK,UAAY,CAAA,EAEjB,KAAK,YAAc,YACnB,KAAK,QAAU,CACb,OAAQ,MACR,KAAM,MACN,OAAQ,EACd,EAEI,KAAK,KAAI,CACX,CAEA,MAAM,MAAO,CACX,KAAK,OAAM,EACX,KAAK,oBAAmB,EACxB,MAAM,KAAK,SAAQ,EACnB,KAAK,kBAAiB,EACtB,KAAK,0BAAyB,CAChC,CAEA,QAAS,CACF,KAAK,YAEV,KAAK,UAAU,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAkBI,KAAK,cAAgB,YAAc,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA,mCAIhD,KAAK,cAAgB,YAAc,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA,mCAIhD,KAAK,cAAgB,UAAY,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA,mCAI9C,KAAK,cAAgB,eAAiB,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA,mCAInD,KAAK,cAAgB,aAAe,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA,mCAIjD,KAAK,cAAgB,YAAc,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAyBvE,KAAK,kBAAiB,CAAE;AAAA;AAAA;AAAA,MAIlC,CAEA,mBAAoB,CAClB,OAAQ,KAAK,YAAW,CACtB,IAAK,YACH,OAAO,KAAK,gBAAe,EAC7B,IAAK,YACH,OAAO,KAAK,gBAAe,EAC7B,IAAK,UACH,OAAO,KAAK,cAAa,EAC3B,IAAK,eACH,OAAO,KAAK,mBAAkB,EAChC,IAAK,aACH,OAAO,KAAK,gBAAe,EAC7B,IAAK,YACH,OAAO,KAAK,gBAAe,EAC7B,QACE,OAAO,KAAK,gBAAe,CACnC,CACE,CAEA,iBAAkB,CAChB,MAAMC,EAAW,KAAK,gBAAgB,KAAK,SAAS,EAEpD,OAAIA,EAAS,SAAW,EACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAWF;AAAA;AAAA,UAEDA,EACC,IACCC,GAAY;AAAA,6CACqBA,EAAS,MAAM;AAAA;AAAA,oBAExCA,EAAS,aAAe,MAAM;AAAA,iDACDA,EAAS,MAAM,KAAK,KAAK,cAAcA,EAAS,MAAM,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAMzDA,EAAS,YAAc,UAAU;AAAA;AAAA;AAAA;AAAA,+CAIjCA,EAAS,eAAiB,UAAU;AAAA;AAAA;AAAA;AAAA,+CAIpC,KAAK,YAAYA,EAAS,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA,+CAI/B,KAAK,WAAWA,EAAS,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA,+CAI9BA,EAAS,QAAU,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,kFAKMA,EAAS,EAAE;AAAA;AAAA;AAAA,oFAGTA,EAAS,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA,SAM/F,EACW,KAAK,EAAE,CAAC;AAAA;AAAA,KAGjB,CAEA,iBAAkB,CAChB,OAAI,KAAK,UAAU,SAAW,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAWF;AAAA;AAAA,UAED,KAAK,UACJ,IACCC,GAAY;AAAA,6CACqBA,EAAS,MAAM;AAAA;AAAA,oBAExCA,EAAS,aAAe,MAAM;AAAA,iDACDA,EAAS,MAAM,KAAK,KAAK,cAAcA,EAAS,MAAM,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAMzDA,EAAS,cAAgB,UAAU;AAAA;AAAA;AAAA;AAAA,+CAInCA,EAAS,YAAc,UAAU;AAAA;AAAA;AAAA;AAAA,+CAIjC,KAAK,WAAWA,EAAS,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA,+CAI9BA,EAAS,QAAU,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,SAM5E,EACW,KAAK,EAAE,CAAC;AAAA;AAAA,KAGjB,CAEA,eAAgB,CACd,OAAI,KAAK,gBAAgB,SAAW,EAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAWF;AAAA;AAAA,UAED,KAAK,gBACJ,IACCC,GAAU;AAAA;AAAA;AAAA,oBAGFA,EAAO,MAAQ,MAAM;AAAA,0CACC,KAAK,kBAAkBA,EAAO,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAM9BA,EAAO,gBAAkB,CAAC;AAAA;AAAA;AAAA;AAAA,+CAI1BA,EAAO,OAAS,UAAU;AAAA;AAAA;AAAA;AAAA,+CAI1BA,EAAO,OAAS,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,SAMzE,EACW,KAAK,EAAE,CAAC;AAAA;AAAA,KAGjB,CAEA,oBAAqB,CACnB,OAAI,KAAK,qBAAqB,SAAW,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA,QAQF;AAAA;AAAA,UAED,KAAK,qBACJ,IACCC,GAAe;AAAA;AAAA;AAAA,oBAGPA,EAAY,MAAQ,MAAM;AAAA,+CACC,KAAK,uBAAuBA,EAAY,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAM7CA,EAAY,gBAAkB,CAAC;AAAA;AAAA;AAAA;AAAA,+CAI/BA,EAAY,UAAY,UAAU;AAAA;AAAA;AAAA;AAAA,+CAIlCA,EAAY,OAAS,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,SAM9E,EACW,KAAK,EAAE,CAAC;AAAA;AAAA,KAGjB,CAEA,iBAAkB,CAChB,OAAI,KAAK,UAAU,SAAW,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA,QAQF;AAAA;AAAA,UAED,KAAK,UACJ,IACCC,GAAY;AAAA,8CACsBA,EAAS,MAAM;AAAA;AAAA,oBAEzCA,EAAS,aAAe,MAAM;AAAA,iDACDA,EAAS,MAAM,KAAK,KAAK,cAAcA,EAAS,MAAM,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAMzDA,EAAS,YAAc,UAAU;AAAA;AAAA;AAAA;AAAA,+CAIjC,KAAK,WAAWA,EAAS,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA,+CAI9BA,EAAS,OAAS,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,SAMlF,EACW,KAAK,EAAE,CAAC;AAAA;AAAA,KAGjB,CAEA,iBAAkB,CAChB,OAAI,KAAK,UAAU,SAAW,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA,QAQF;AAAA;AAAA,UAED,KAAK,UACJ,IACCC,GAAY;AAAA;AAAA;AAAA,oBAGJA,EAAS,MAAM;AAAA,6CACUA,EAAS,KAAK;AAAA;AAAA;AAAA,mBAGxCA,EAAS,aAAe,EAAE;AAAA;AAAA;AAAA,SAI7C,EACW,KAAK,EAAE,CAAC;AAAA;AAAA,KAGjB,CAEA,gBAAgBC,EAAM,CACpB,IAAIP,EAAW,CAAC,GAAGO,CAAI,EAOvB,GANI,KAAK,QAAQ,SAAW,QAC1BP,EAAWA,EAAS,OAAOQ,GAAQA,EAAK,SAAW,KAAK,QAAQ,MAAM,GAEpE,KAAK,QAAQ,OAAS,QACxBR,EAAWA,EAAS,OAAOQ,GAAQA,EAAK,OAAS,KAAK,QAAQ,IAAI,GAEhE,KAAK,QAAQ,OAAQ,CACvB,MAAMC,EAAS,KAAK,QAAQ,OAAO,YAAW,EAC9CT,EAAWA,EAAS,OAClBQ,GACGA,EAAK,aAAeA,EAAK,YAAY,YAAW,EAAG,SAASC,CAAM,GAClED,EAAK,YAAcA,EAAK,WAAW,cAAc,SAASC,CAAM,GAChED,EAAK,eAAiBA,EAAK,cAAc,YAAW,EAAG,SAASC,CAAM,CACjF,CACI,CACA,OAAOT,CACT,CAEA,MAAM,UAAW,CACf,GAAI,CAAC,KAAK,OAAQ,CAChB,KAAK,qBAAoB,EACzB,MACF,CAEA,GAAI,CACF,GAAI,CAAC,KAAK,kBAAkB,mBAAoB,CAC9C,KAAK,qBAAoB,EACzB,MACF,CAEA,KAAM,CAACU,EAAWC,EAAWC,EAASC,EAAcC,EAAWC,CAAS,EAAI,MAAM,QAAQ,IACxF,CACE,KAAK,UAAU,IAAI,KAAK,cAAc,WAAa,mCAAmC,EACtF,KAAK,UAAU,IAAI,KAAK,cAAc,WAAa,mCAAmC,EACtF,KAAK,UAAU,IAAI,KAAK,cAAc,SAAW,iCAAiC,EAClF,KAAK,UAAU,IACb,KAAK,cAAc,cAAgB,sCAC/C,EACU,KAAK,UAAU,IAAI,KAAK,cAAc,WAAa,oCAAoC,EACvF,KAAK,UAAU,IAAI,KAAK,cAAc,WAAa,mCAAmC,CAChG,CACA,EAEM,KAAK,UAAYL,EAAU,MAAQ,CAAA,EACnC,KAAK,UAAYC,EAAU,MAAQ,CAAA,EACnC,KAAK,gBAAkBC,EAAQ,MAAQ,CAAA,EACvC,KAAK,qBAAuBC,EAAa,MAAQ,CAAA,EACjD,KAAK,UAAYC,EAAU,MAAQ,CAAA,EACnC,KAAK,UAAYC,EAAU,MAAQ,CAAA,EAEnC,KAAK,mBAAkB,EACvB,KAAK,cAAa,CACpB,OAASC,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,EACpD,KAAK,qBAAoB,CAC3B,CACF,CAEA,mBAAoB,CACb,KAAK,cACV,KAAK,aAAa,UAAU,qBAAsB,IAAKC,GAAU,EAC3DA,EAAO,SAAW,UAAYA,EAAO,SAAW,UAAYA,EAAO,SAAW,WAChF,KAAK,SAAQ,CAEjB,CAAC,CACH,CAEA,2BAA4B,CACrB,KAAK,mBACV,KAAK,kBAAkB,GAAG,SAAU,IAAM,CACxC,KAAK,SAAQ,CACf,CAAC,CACH,CAEA,WAAWC,EAAM,CACf,KAAK,YAAcA,EACnB,KAAK,cAAa,CACpB,CAEA,mBAAmBC,EAAMC,EAAO,CAC9B,KAAK,QAAQD,CAAI,EAAIC,EAAM,OAAO,MAClC,KAAK,cAAa,CACpB,CAEA,aAAaA,EAAO,CAClB,KAAK,QAAQ,OAASA,EAAM,OAAO,MACnC,KAAK,cAAa,CACpB,CAEA,eAAgB,CACd,MAAMC,EAAU,SAAS,eAAe,kBAAkB,EACtDA,IACFA,EAAQ,UAAY,KAAK,kBAAiB,EAE9C,CAEA,cAAcC,EAAQ,CAOpB,MANkB,CAChB,QAAS,eACT,SAAU,aACV,SAAU,QACV,UAAW,OACjB,EACqBA,CAAM,GAAKA,CAC9B,CAEA,YAAYH,EAAM,CAMhB,MALgB,CACd,SAAU,QACV,SAAU,QACV,UAAW,OACjB,EACmBA,CAAI,GAAKA,CAC1B,CAEA,kBAAkBA,EAAM,CAOtB,MANgB,CACd,SAAU,SACV,OAAQ,QACR,OAAQ,OACR,MAAO,MACb,EACmBA,CAAI,GAAKA,CAC1B,CAEA,uBAAuBA,EAAM,CAQ3B,MAPgB,CACd,SAAU,SACV,OAAQ,QACR,OAAQ,OACR,WAAY,SACZ,MAAO,MACb,EACmBA,CAAI,GAAKA,CAC1B,CAEA,WAAWI,EAAM,CACf,OAAKA,EACE,IAAI,KAAKA,CAAI,EAAE,mBAAmB,OAAO,EAD9B,UAEpB,CAEA,oBAAqB,CACnB,GAAI,CACF,aAAa,QAAQ,oBAAqB,KAAK,UAAU,KAAK,SAAS,CAAC,EACxE,aAAa,QAAQ,oBAAqB,KAAK,UAAU,KAAK,SAAS,CAAC,EACxE,aAAa,QAAQ,0BAA2B,KAAK,UAAU,KAAK,eAAe,CAAC,EACpF,aAAa,QACX,+BACA,KAAK,UAAU,KAAK,oBAAoB,CAChD,EACM,aAAa,QAAQ,oBAAqB,KAAK,UAAU,KAAK,SAAS,CAAC,EACxE,aAAa,QAAQ,oBAAqB,KAAK,UAAU,KAAK,SAAS,CAAC,CAC1E,OAASP,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,CACtD,CACF,CAEA,sBAAuB,CACrB,GAAI,CACF,KAAK,UAAY,KAAK,MAAM,aAAa,QAAQ,mBAAmB,GAAK,IAAI,EAC7E,KAAK,UAAY,KAAK,MAAM,aAAa,QAAQ,mBAAmB,GAAK,IAAI,EAC7E,KAAK,gBAAkB,KAAK,MAAM,aAAa,QAAQ,yBAAyB,GAAK,IAAI,EACzF,KAAK,qBAAuB,KAAK,MAC/B,aAAa,QAAQ,8BAA8B,GAAK,IAChE,EACM,KAAK,UAAY,KAAK,MAAM,aAAa,QAAQ,mBAAmB,GAAK,IAAI,EAC7E,KAAK,UAAY,KAAK,MAAM,aAAa,QAAQ,mBAAmB,GAAK,IAAI,CAC/E,OAASA,EAAO,CACd,QAAQ,MAAM,mCAAoCA,CAAK,CACzD,CACF,CAEA,qBAAsB,CACpB,KAAK,eAAiB,KAAK,eAAe,KAAK,IAAI,EACnD,KAAK,eAAiB,KAAK,eAAe,KAAK,IAAI,EACnD,KAAK,UAAY,KAAK,UAAU,KAAK,IAAI,EACzC,KAAK,WAAa,KAAK,WAAW,KAAK,IAAI,EAC3C,KAAK,mBAAqB,KAAK,mBAAmB,KAAK,IAAI,EAC3D,KAAK,aAAe,KAAK,aAAa,KAAK,IAAI,EAC/C,KAAK,aAAe,KAAK,aAAa,KAAK,IAAI,EAC/C,KAAK,aAAe,KAAK,aAAa,KAAK,IAAI,CACjD,CAEA,MAAM,gBAAiB,CACrB,QAAQ,IAAI,iBAAiB,CAC/B,CAEA,MAAM,gBAAiB,CACrB,QAAQ,IAAI,iBAAiB,CAC/B,CAEA,MAAM,WAAY,CAChB,QAAQ,IAAI,YAAY,CAC1B,CAEA,MAAM,aAAaQ,EAAI,CACrB,QAAQ,IAAI,gBAAiBA,CAAE,CACjC,CAEA,MAAM,aAAaA,EAAI,CACrB,QAAQ,IAAI,gBAAiBA,CAAE,CACjC,CACF"}