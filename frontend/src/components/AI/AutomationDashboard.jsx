import React, { useState, useEffect } from 'react';\nimport './AutomationDashboard.css';\n\n/**\n * AutomationDashboard Component\n * \n * Manages automated tasks and workflows\n * Features: task creation, scheduling, execution, history, statistics\n */\nfunction AutomationDashboard({ userId = 'default-user' }) {\n  const [tasks, setTasks] = useState([]);\n  const [newTask, setNewTask] = useState({\n    name: '',\n    type: 'email',\n    trigger: 'manual',\n    schedule: ''\n  });\n  const [activeTab, setActiveTab] = useState('tasks');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [stats, setStats] = useState({});\n  const [executionHistory, setExecutionHistory] = useState([]);\n\n  // Load tasks on mount\n  useEffect(() => {\n    loadTasks();\n  }, [userId]);\n\n  // Load tasks\n  const loadTasks = () => {\n    try {\n      const allTasks = window.automationService?.getTasks?.(userId) || [];\n      setTasks(allTasks);\n      \n      // Load stats\n      const taskStats = window.automationService?.getTaskStatistics?.(userId);\n      setStats(taskStats || {});\n      \n      // Load execution history\n      const history = window.automationService?.getExecutionHistory?.(userId);\n      setExecutionHistory(history || []);\n    } catch (err) {\n      setError(`Error loading tasks: ${err.message}`);\n      console.error('Error loading tasks:', err);\n    }\n  };\n\n  // Create new task\n  const handleCreateTask = () => {\n    if (!newTask.name.trim()) {\n      setError('Please enter a task name');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n    try {\n      const taskId = window.automationService?.createTask?.(\n        userId,\n        newTask.name,\n        newTask.type,\n        { trigger: newTask.trigger, schedule: newTask.schedule }\n      );\n\n      if (taskId) {\n        setNewTask({ name: '', type: 'email', trigger: 'manual', schedule: '' });\n        loadTasks();\n      }\n    } catch (err) {\n      setError(`Error creating task: ${err.message}`);\n      console.error('Error creating task:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Execute task\n  const handleExecuteTask = (taskId) => {\n    try {\n      window.automationService?.executeTask?.(userId, taskId);\n      loadTasks();\n    } catch (err) {\n      setError(`Error executing task: ${err.message}`);\n      console.error('Error executing task:', err);\n    }\n  };\n\n  // Delete task\n  const handleDeleteTask = (taskId) => {\n    if (window.confirm('Are you sure you want to delete this task?')) {\n      try {\n        window.automationService?.deleteTask?.(userId, taskId);\n        loadTasks();\n      } catch (err) {\n        setError(`Error deleting task: ${err.message}`);\n        console.error('Error deleting task:', err);\n      }\n    }\n  };\n\n  const taskTypes = ['email', 'notification', 'report', 'data-sync', 'backup', 'cleanup'];\n  const triggerTypes = ['manual', 'scheduled', 'event-based'];\n\n  return (\n    <div className=\"automation-dashboard\">\n      <div className=\"dashboard-header\">\n        <h2>‚öôÔ∏è Automation Dashboard</h2>\n        <p className=\"dashboard-subtitle\">Create and manage automated workflows</p>\n      </div>\n\n      {/* Statistics */}\n      <div className=\"stats-container\">\n        <div className=\"stat-card\">\n          <span className=\"stat-label\">Total Tasks</span>\n          <span className=\"stat-value\">{stats.total || 0}</span>\n        </div>\n        <div className=\"stat-card\">\n          <span className=\"stat-label\">Completed</span>\n          <span className=\"stat-value\">{stats.completed || 0}</span>\n        </div>\n        <div className=\"stat-card\">\n          <span className=\"stat-label\">Success Rate</span>\n          <span className=\"stat-value\">{(stats.successRate || 0).toFixed(1)}%</span>\n        </div>\n        <div className=\"stat-card\">\n          <span className=\"stat-label\">Avg. Duration</span>\n          <span className=\"stat-value\">{(stats.avgDuration || 0).toFixed(0)}ms</span>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"tabs\">\n        <button\n          className={`tab ${activeTab === 'tasks' ? 'active' : ''}`}\n          onClick={() => setActiveTab('tasks')}\n        >\n          üìã Tasks ({tasks.length})\n        </button>\n        <button\n          className={`tab ${activeTab === 'create' ? 'active' : ''}`}\n          onClick={() => setActiveTab('create')}\n        >\n          ‚ú® Create New\n        </button>\n        <button\n          className={`tab ${activeTab === 'history' ? 'active' : ''}`}\n          onClick={() => setActiveTab('history')}\n        >\n          üìú History ({executionHistory.length})\n        </button>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"error-message\" role=\"alert\">\n          ‚ùå {error}\n        </div>\n      )}\n\n      {/* Tasks Tab */}\n      {activeTab === 'tasks' && (\n        <div className=\"tab-content\">\n          {tasks.length === 0 ? (\n            <div className=\"empty-message\">No automation tasks yet. Create one to get started!</div>\n          ) : (\n            <div className=\"tasks-list\">\n              {tasks.map(task => (\n                <div key={task.id} className=\"task-card\">\n                  <div className=\"task-header\">\n                    <h3>{task.name}</h3>\n                    <span className={`status status-${task.status}`}>{task.status}</span>\n                  </div>\n                  <div className=\"task-details\">\n                    <span className=\"detail-badge\">Type: {task.type}</span>\n                    <span className=\"detail-badge\">Trigger: {task.trigger}</span>\n                    <span className=\"detail-badge\">\n                      Executions: {task.executionCount || 0}\n                    </span>\n                  </div>\n                  <div className=\"task-footer\">\n                    <button\n                      onClick={() => handleExecuteTask(task.id)}\n                      className=\"btn-execute\"\n                      title=\"Run this task now\"\n                    >\n                      ‚ñ∂Ô∏è Execute\n                    </button>\n                    <button\n                      onClick={() => handleDeleteTask(task.id)}\n                      className=\"btn-delete\"\n                      title=\"Delete this task\"\n                    >\n                      üóëÔ∏è Delete\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Create Task Tab */}\n      {activeTab === 'create' && (\n        <div className=\"tab-content create-task-form\">\n          <div className=\"form-group\">\n            <label htmlFor=\"task-name\">Task Name:</label>\n            <input\n              id=\"task-name\"\n              type=\"text\"\n              value={newTask.name}\n              onChange={e => setNewTask({ ...newTask, name: e.target.value })}\n              placeholder=\"e.g., Send Weekly Report\"\n              className=\"form-input\"\n            />\n          </div>\n\n          <div className=\"form-row\">\n            <div className=\"form-group\">\n              <label htmlFor=\"task-type\">Task Type:</label>\n              <select\n                id=\"task-type\"\n                value={newTask.type}\n                onChange={e => setNewTask({ ...newTask, type: e.target.value })}\n                className=\"form-select\"\n              >\n                {taskTypes.map(type => (\n                  <option key={type} value={type}>\n                    {type.charAt(0).toUpperCase() + type.slice(1).replace('-', ' ')}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"trigger-type\">Trigger Type:</label>\n              <select\n                id=\"trigger-type\"\n                value={newTask.trigger}\n                onChange={e => setNewTask({ ...newTask, trigger: e.target.value })}\n                className=\"form-select\"\n              >\n                {triggerTypes.map(trigger => (\n                  <option key={trigger} value={trigger}>\n                    {trigger.charAt(0).toUpperCase() + trigger.slice(1).replace('-', ' ')}\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          {newTask.trigger === 'scheduled' && (\n            <div className=\"form-group\">\n              <label htmlFor=\"schedule\">Schedule (cron expression):</label>\n              <input\n                id=\"schedule\"\n                type=\"text\"\n                value={newTask.schedule}\n                onChange={e => setNewTask({ ...newTask, schedule: e.target.value })}\n                placeholder=\"e.g., 0 9 * * MON (every Monday at 9 AM)\"\n                className=\"form-input\"\n              />\n            </div>\n          )}\n\n          <button\n            onClick={handleCreateTask}\n            disabled={loading}\n            className=\"btn-create-task\"\n          >\n            {loading ? '‚è≥ Creating...' : '‚ú® Create Task'}\n          </button>\n        </div>\n      )}\n\n      {/* History Tab */}\n      {activeTab === 'history' && (\n        <div className=\"tab-content\">\n          {executionHistory.length === 0 ? (\n            <div className=\"empty-message\">No execution history yet.</div>\n          ) : (\n            <div className=\"history-list\">\n              {executionHistory.slice(0, 20).map((entry, idx) => (\n                <div key={idx} className=\"history-entry\">\n                  <span className=\"history-time\">{new Date(entry.timestamp).toLocaleString()}</span>\n                  <span className=\"history-task\">{entry.taskName}</span>\n                  <span className={`history-status status-${entry.status}`}>{entry.status}</span>\n                  <span className=\"history-duration\">{entry.duration}ms</span>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default AutomationDashboard;\n