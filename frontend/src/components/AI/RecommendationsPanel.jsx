import React, { useState, useEffect } from 'react';\nimport './RecommendationsPanel.css';\n\n/**\n * RecommendationsPanel Component\n * \n * Displays AI-generated smart recommendations based on employee data\n * Categories: leaves, payroll, attendance, performance, salary, training\n */\nfunction RecommendationsPanel({ userId = 'default-user', limit = 5 }) {\n  const [recommendations, setRecommendations] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState('leaves');\n  const [loading, setLoading] = useState(false);\n  const [feedback, setFeedback] = useState({});\n  const [error, setError] = useState(null);\n  const [stats, setStats] = useState({});\n\n  // Load recommendations when category changes\n  useEffect(() => {\n    loadRecommendations(selectedCategory);\n  }, [selectedCategory, userId]);\n\n  // Load feedback stats\n  useEffect(() => {\n    try {\n      const feedbackStats = window.recommendationsService?.getFeedbackStats?.();\n      setStats(feedbackStats || {});\n    } catch (err) {\n      console.warn('Could not load feedback stats:', err);\n    }\n  }, []);\n\n  const loadRecommendations = (category) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const recs = window.recommendationsService?.getRecommendations?.(\n        userId,\n        category,\n        limit\n      ) || [];\n      setRecommendations(recs);\n    } catch (err) {\n      setError(`Error loading recommendations: ${err.message}`);\n      console.error('Error loading recommendations:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFeedback = (recId, feedbackType) => {\n    try {\n      window.recommendationsService?.submitFeedback?.(userId, recId, feedbackType);\n      setFeedback({ ...feedback, [recId]: feedbackType });\n      \n      // Update stats\n      const updatedStats = window.recommendationsService?.getFeedbackStats?.();\n      setStats(updatedStats || {});\n    } catch (err) {\n      setError(`Error submitting feedback: ${err.message}`);\n      console.error('Error submitting feedback:', err);\n    }\n  };\n\n  const categories = ['leaves', 'payroll', 'attendance', 'performance', 'salary', 'training'];\n\n  return (\n    <div className=\"recommendations-panel\">\n      <div className=\"rec-header-section\">\n        <h2>üí° Smart Recommendations</h2>\n        <p className=\"rec-subtitle\">AI-powered suggestions tailored for you</p>\n      </div>\n\n      {/* Category Filter */}\n      <div className=\"category-filter\">\n        {categories.map(cat => (\n          <button\n            key={cat}\n            className={`category-btn ${selectedCategory === cat ? 'active' : ''}`}\n            onClick={() => setSelectedCategory(cat)}\n            title={`View ${cat} recommendations`}\n          >\n            {cat.charAt(0).toUpperCase() + cat.slice(1)}\n          </button>\n        ))}\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"error-message\" role=\"alert\">\n          ‚ö†Ô∏è {error}\n        </div>\n      )}\n\n      {/* Feedback Stats */}\n      {stats.total > 0 && (\n        <div className=\"feedback-stats\">\n          <p>üìä Feedback Stats: {stats.helpfulRate?.toFixed(1) || 0}% helpful ({stats.total || 0} total)</p>\n        </div>\n      )}\n\n      {/* Recommendations List */}\n      <div className=\"recommendations-list\">\n        {loading ? (\n          <div className=\"loading-message\">‚è≥ Loading recommendations...</div>\n        ) : recommendations.length === 0 ? (\n          <div className=\"empty-message\">No recommendations available for this category at the moment.</div>\n        ) : (\n          recommendations.map(rec => (\n            <div key={rec.id} className=\"recommendation-card\" role=\"article\">\n              <div className=\"rec-header\">\n                <h3>{rec.title}</h3>\n                <span className=\"confidence\" title=\"Confidence score\">‚≠ê {rec.confidence}%</span>\n              </div>\n              <p className=\"rec-description\">{rec.description}</p>\n              <div className=\"rec-details\">\n                <span className={`priority priority-${rec.priority || 'medium'}`}>\n                  {'‚óè'.repeat(rec.priority === 'high' ? 3 : rec.priority === 'medium' ? 2 : 1)} Priority\n                </span>\n                <span className=\"type-badge\">{rec.type}</span>\n              </div>\n              <div className=\"rec-footer\">\n                <div className=\"feedback-buttons\">\n                  <button\n                    onClick={() => handleFeedback(rec.id, 'helpful')}\n                    className={`btn-feedback btn-helpful ${feedback[rec.id] === 'helpful' ? 'active' : ''}`}\n                    title=\"Mark as helpful\"\n                  >\n                    üëç Helpful\n                  </button>\n                  <button\n                    onClick={() => handleFeedback(rec.id, 'not helpful')}\n                    className={`btn-feedback btn-not-helpful ${feedback[rec.id] === 'not helpful' ? 'active' : ''}`}\n                    title=\"Mark as not helpful\"\n                  >\n                    üëé Not Helpful\n                  </button>\n                </div>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default RecommendationsPanel;\n