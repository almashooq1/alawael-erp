<template>
  <div class="page-container">
    <div class="page-header">
      <div class="header-content">
        <h1>Ø®Ø·Ø· Ø§Ù„ØªØ¯Ø±ÙŠØ¨</h1>
        <p class="page-description">Ø§Ù„Ø®Ø·Ø· Ø§Ù„ÙØ±Ø¯ÙŠØ© ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹ÙŠØ© Ù„Ù„Ø·Ù„Ø§Ø¨</p>
      </div>
      <div class="header-actions">
        <router-link to="/plans/new" class="btn btn-primary">
          â• Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©
        </router-link>
      </div>
    </div>

    <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
    <div class="stats-row">
      <div class="stat-item">
        <div class="stat-value">{{ plans.length }}</div>
        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®Ø·Ø·</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">{{ activePlans }}</div>
        <div class="stat-label">Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ù†Ø´Ø·Ø©</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">{{ completedPlans }}</div>
        <div class="stat-label">Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">{{ averageProgress }}%</div>
        <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚Ø¯Ù…</div>
      </div>
    </div>

    <!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
    <DataTable
      title="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø·"
      subtitle="Ø®Ø·Ø· Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø·Ù„Ø§Ø¨"
      :columns="tableColumns"
      :data="plans"
      :actions="tableActions"
      @row-click="onRowClick"
    />
  </div>
</template>

<script>
import DataTable from '../components/Common/DataTable.vue'

export default {
  name: 'Plans',
  components: {
    DataTable,
  },
  data() {
    return {
      plans: [
        {
          id: 1,
          title: 'Ø®Ø·Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ø£Ø­Ù…Ø¯',
          student: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯',
          program: 'Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ',
          duration: 60,
          startDate: '2026-01-01',
          endDate: '2026-03-15',
          progress: 75,
          status: 'active',
        },
        {
          id: 2,
          title: 'Ø®Ø·Ø© ØªØ·ÙˆÙŠØ± Ø§Ù„ÙˆÙŠØ¨ - ÙØ§Ø·Ù…Ø©',
          student: 'ÙØ§Ø·Ù…Ø© Ø£Ø­Ù…Ø¯',
          program: 'ØªØ·ÙˆÙŠØ± Ø§Ù„ÙˆÙŠØ¨',
          duration: 80,
          startDate: '2026-01-05',
          endDate: '2026-04-10',
          progress: 45,
          status: 'active',
        },
        {
          id: 3,
          title: 'Ø®Ø·Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© - Ø¹Ù„ÙŠ',
          student: 'Ø¹Ù„ÙŠ Ø­Ø³Ù†',
          program: 'Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ',
          duration: 60,
          startDate: '2025-10-01',
          endDate: '2025-12-20',
          progress: 100,
          status: 'completed',
        },
      ],
      tableColumns: [
        { key: 'title', label: 'Ø§Ù„Ø®Ø·Ø©', sortable: true },
        { key: 'student', label: 'Ø§Ù„Ø·Ø§Ù„Ø¨', sortable: true },
        { key: 'program', label: 'Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬', sortable: true },
        { key: 'duration', label: 'Ø§Ù„Ù…Ø¯Ø© (Ø³Ø§Ø¹Ø§Øª)' },
        { key: 'progress', label: 'Ø§Ù„ØªÙ‚Ø¯Ù…', type: 'progress' },
        {
          key: 'status',
          label: 'Ø§Ù„Ø­Ø§Ù„Ø©',
          type: 'badge',
          render: (value) => {
            const labels = { active: 'Ù†Ø´Ø·Ø©', completed: 'Ù…ÙƒØªÙ…Ù„Ø©', paused: 'Ù…Ø¤Ø¬Ù„Ø©' }
            return labels[value] || value
          },
        },
      ],
      tableActions: [
        {
          id: 'edit',
          icon: 'âœï¸',
          label: 'ØªØ¹Ø¯ÙŠÙ„',
          handler: (row) => this.editPlan(row),
        },
        {
          id: 'delete',
          icon: 'ğŸ—‘ï¸',
          label: 'Ø­Ø°Ù',
          handler: (row) => this.deletePlan(row),
        },
      ],
    }
  },
  computed: {
    activePlans() {
      return this.plans.filter(p => p.status === 'active').length
    },
    completedPlans() {
      return this.plans.filter(p => p.status === 'completed').length
    },
    averageProgress() {
      const total = this.plans.reduce((sum, p) => sum + p.progress, 0)
      return Math.round(total / this.plans.length)
    },
  },
  methods: {
    onRowClick(row) {
      this.$router.push(`/plans/${row.id}`)
    },
    editPlan(row) {
      this.$router.push(`/plans/${row.id}`)
    },
    deletePlan(row) {
      if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø®Ø·Ø© ${row.title}ØŸ`)) {
        this.plans = this.plans.filter(p => p.id !== row.id)
      }
    },
  },
}
</script>

<style scoped>
.page-container {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-2xl);
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: var(--spacing-lg);
  flex-wrap: wrap;
}

.header-content h1 {
  margin: 0 0 var(--spacing-sm) 0;
  font-size: var(--text-2xl);
  color: var(--color-gray-800);
}

.page-description {
  margin: 0;
  font-size: var(--text-base);
  color: var(--color-gray-500);
}

.header-actions {
  display: flex;
  gap: var(--spacing-md);
}

.btn {
  padding: var(--spacing-md) var(--spacing-lg);
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  font-size: var(--text-base);
  font-weight: 500;
  transition: all var(--transition-base);
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
}

.btn-primary {
  background: var(--color-primary-600);
  color: white;
}

.btn-primary:hover {
  background: var(--color-primary-700);
  box-shadow: var(--shadow-md);
}

.stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-lg);
}

.stat-item {
  background: var(--color-white);
  border: 1px solid var(--color-gray-200);
  border-radius: var(--radius-md);
  padding: var(--spacing-lg);
  text-align: center;
}

.stat-value {
  font-size: var(--text-2xl);
  font-weight: 700;
  color: var(--color-primary-600);
  margin-bottom: var(--spacing-sm);
}

.stat-label {
  font-size: var(--text-sm);
  color: var(--color-gray-500);
}

@media (max-width: 768px) {
  .page-header {
    flex-direction: column;
    align-items: stretch;
  }

  .header-actions {
    width: 100%;
  }

  .btn {
    flex: 1;
  }

  .stats-row {
    grid-template-columns: repeat(2, 1fr);
  }
}
</style>