# ğŸ’¼ Ø¯Ù„ÙŠÙ„ ØªÙƒØ§Ù…Ù„ Ù†Ø¸Ø§Ù… ERP Ù…Ø¹ Rehab AGI

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙŠØ´Ø±Ø­ ÙƒÙŠÙÙŠØ© ØªÙƒØ§Ù…Ù„ Ù†Ø¸Ø§Ù… Rehab AGI Ù…Ø¹ Ø£Ù†Ø¸Ù…Ø© ØªØ®Ø·ÙŠØ· Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª (ERP)
Ø§Ù„Ù…Ø®ØªÙ„ÙØ©. Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØµÙ…Ù… Ù„ÙŠÙƒÙˆÙ† Ù…Ø±Ù†Ø§Ù‹ ÙˆÙŠØ¯Ø¹Ù… Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ù…Ø¹Ø¸Ù… Ø£Ù†Ø¸Ù…Ø© ERP Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©.

---

## ğŸ¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©

Ù†Ø¸Ø§Ù… Rehab AGI ÙŠØªÙƒØ§Ù…Ù„ Ù…Ø¹ 8 ÙˆØ­Ø¯Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ø£Ù†Ø¸Ù…Ø© ERP:

### 1. ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© (HR Management)

- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ÙŠÙ† ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
- Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù
- Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠØ©
- ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡
- Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø­ÙˆØ§ÙØ²

### 2. ğŸ’° Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© (Finance Management)

- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙˆØ§ØªÙŠØ±
- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª
- ØªØªØ¨Ø¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©
- Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª

### 3. ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† (Inventory Management)

- ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø·Ø¨ÙŠØ©
- Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ø§Ù„ØªØ£Ù‡ÙŠÙ„ÙŠØ©
- Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©
- Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡
- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¹Ù†Ø¯ Ù†ÙØ§Ø¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†

### 4. ğŸ‘¤ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† (Beneficiary Management)

- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†
- Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
- ØªØ§Ø±ÙŠØ® Ø§Ù„Ø®Ø¯Ù…Ø§Øª
- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„

### 5. ğŸ¥ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© (Medical Records)

- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ©
- Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­ÙˆØµØ§Øª
- Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©
- Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ§Øª ÙˆØ§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª

### 6. ğŸ“š Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© (Education Services)

- Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
- Ø§Ù„Ù…Ù†Ø§Ù‡Ø¬ Ø§Ù„Ø®Ø§ØµØ©
- ØªØªØ¨Ø¹ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ
- Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©

### 7. ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª (Reports & Analytics)

- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡
- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
- Ù„ÙˆØ­Ø§Øª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
- ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©

### 8. ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (CRM)

- Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª
- Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯
- Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰
- Ø§Ø³ØªØ·Ù„Ø§Ø¹Ø§Øª Ø§Ù„Ø±Ø¶Ø§

---

## ğŸ”§ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙƒØ§Ù…Ù„

### Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªÙ‡ÙŠØ¦Ø© Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ¦Ø©

Ø£Ù†Ø´Ø¦ Ø£Ùˆ Ø¹Ø¯Ù‘Ù„ Ù…Ù„Ù `.env` ÙÙŠ Ù…Ø¬Ù„Ø¯ AGI:

```env
# Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù†Ø¸Ø§Ù… ERP
ERP_API_URL=https://your-erp-system.com/api
ERP_API_KEY=your-secret-api-key-here
ERP_COMPANY_ID=COMP-001
ERP_BRANCH_ID=BRANCH-001

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
ERP_SYNC_INTERVAL=3600000      # ÙƒÙ„ Ø³Ø§Ø¹Ø© (Ø¨Ø§Ù„Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©)
ERP_SYNC_ENABLED=true
ERP_AUTO_SYNC=true

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
ERP_RETRY_ATTEMPTS=3
ERP_RETRY_DELAY=2000           # 2 Ø«Ø§Ù†ÙŠØ©
ERP_TIMEOUT=30000              # 30 Ø«Ø§Ù†ÙŠØ©

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
ERP_LOG_LEVEL=info
ERP_LOG_REQUESTS=true
ERP_LOG_RESPONSES=false        # ØªØ¬Ù†Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†
ERP_USE_SSL=true
ERP_VERIFY_CERTIFICATE=true

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
ERP_CACHE_ENABLED=true
ERP_CACHE_TTL=300000           # 5 Ø¯Ù‚Ø§Ø¦Ù‚
```

### Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ«Ø¨ÙŠØª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ÙŠØ§Øª

```bash
npm install axios dotenv
```

### Ø§Ù„Ø®Ø·ÙˆØ© 3: ØªØ­Ø¯ÙŠØ« Ù…Ù„Ù Ø§Ù„ØªÙƒØ§Ù…Ù„

Ø¹Ø¯Ù‘Ù„ Ù…Ù„Ù `specialized/erp-integration.ts` Ø­Ø³Ø¨ Ù†Ø¸Ø§Ù… ERP Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:

```typescript
import axios, { AxiosInstance } from 'axios';
import { EventEmitter } from 'events';
import dotenv from 'dotenv';

dotenv.config();

export class ERPIntegration extends EventEmitter {
  private apiClient: AxiosInstance;
  private apiBaseUrl: string;
  private apiKey: string;

  constructor(config?: {
    apiBaseUrl?: string;
    apiKey?: string;
    timeout?: number;
  }) {
    super();

    this.apiBaseUrl = config?.apiBaseUrl || process.env.ERP_API_URL!;
    this.apiKey = config?.apiKey || process.env.ERP_API_KEY!;

    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ Axios Ù…Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    this.apiClient = axios.create({
      baseURL: this.apiBaseUrl,
      timeout: config?.timeout || parseInt(process.env.ERP_TIMEOUT || '30000'),
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${this.apiKey}`,
        'X-Company-ID': process.env.ERP_COMPANY_ID,
        'X-Branch-ID': process.env.ERP_BRANCH_ID,
      },
    });

    // Interceptor Ù„Ù„ØªØ³Ø¬ÙŠÙ„
    this.apiClient.interceptors.request.use(
      config => {
        if (process.env.ERP_LOG_REQUESTS === 'true') {
          console.log(
            '[ERP Request]',
            config.method?.toUpperCase(),
            config.url
          );
        }
        return config;
      },
      error => {
        console.error('[ERP Request Error]', error);
        return Promise.reject(error);
      }
    );

    this.apiClient.interceptors.response.use(
      response => {
        if (process.env.ERP_LOG_RESPONSES === 'true') {
          console.log('[ERP Response]', response.status, response.config.url);
        }
        return response;
      },
      async error => {
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        const config = error.config;

        if (!config || !config.retry) {
          config.retry = 0;
        }

        const maxRetries = parseInt(process.env.ERP_RETRY_ATTEMPTS || '3');

        if (config.retry < maxRetries) {
          config.retry += 1;

          const delay = parseInt(process.env.ERP_RETRY_DELAY || '2000');
          await new Promise(resolve =>
            setTimeout(resolve, delay * config.retry)
          );

          console.log(
            `[ERP Retry] Ù…Ø­Ø§ÙˆÙ„Ø© ${config.retry}/${maxRetries} - ${config.url}`
          );
          return this.apiClient(config);
        }

        console.error('[ERP Error]', error.response?.status, error.message);
        return Promise.reject(error);
      }
    );
  }

  // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„
}
```

---

## ğŸ”Œ Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø£Ù†Ø¸Ù…Ø© ERP Ø§Ù„Ù…Ø®ØªÙ„ÙØ©

### 1. SAP Business One

#### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„

```env
ERP_API_URL=https://your-sap-server:50000/b1s/v1
ERP_API_KEY=your-session-id
ERP_COMPANY_DB=SBO_DEMO_SA
```

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API

```typescript
// Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© ÙÙŠ SAP
async createSAPInvoice(beneficiaryId: string, items: any[]) {
  try {
    const response = await this.apiClient.post('/Invoices', {
      CardCode: beneficiaryId,
      DocDate: new Date().toISOString().split('T')[0],
      DocumentLines: items.map(item => ({
        ItemDescription: item.description,
        Quantity: item.quantity,
        UnitPrice: item.unitPrice,
      }))
    });

    return response.data;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© SAP:', error);
    throw error;
  }
}
```

### 2. Microsoft Dynamics 365

#### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„

```env
ERP_API_URL=https://your-org.api.crm.dynamics.com/api/data/v9.2
ERP_API_KEY=your-access-token
ERP_TENANT_ID=your-tenant-id
```

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API

```typescript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ ÙÙŠ Dynamics
async createDynamicsAccount(beneficiary: any) {
  try {
    const response = await this.apiClient.post('/accounts', {
      name: beneficiary.name,
      accountnumber: beneficiary.nationalId,
      telephone1: beneficiary.phone,
      emailaddress1: beneficiary.email,
      address1_line1: beneficiary.address.street,
      address1_city: beneficiary.address.city,
    });

    return response.data;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Dynamics:', error);
    throw error;
  }
}
```

### 3. Oracle NetSuite

#### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„

```env
ERP_API_URL=https://your-account.suitetalk.api.netsuite.com/services/rest
ERP_API_KEY=your-token-id
ERP_ACCOUNT_ID=1234567
```

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API

```typescript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ ÙÙŠ NetSuite
async createNetSuiteCustomer(beneficiary: any) {
  try {
    const response = await this.apiClient.post('/record/v1/customer', {
      companyName: beneficiary.name,
      email: beneficiary.email,
      phone: beneficiary.phone,
      isPerson: true,
      firstName: beneficiary.name.split(' ')[0],
      lastName: beneficiary.name.split(' ').slice(1).join(' '),
    });

    return response.data;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ NetSuite:', error);
    throw error;
  }
}
```

### 4. Odoo

#### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„

```env
ERP_API_URL=https://your-odoo.com
ERP_DATABASE=your-database
ERP_USERNAME=admin
ERP_PASSWORD=your-password
```

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API

```typescript
// Ù…ØµØ§Ø¯Ù‚Ø© Odoo
async authenticateOdoo() {
  try {
    const response = await axios.post(`${this.apiBaseUrl}/web/session/authenticate`, {
      jsonrpc: '2.0',
      params: {
        db: process.env.ERP_DATABASE,
        login: process.env.ERP_USERNAME,
        password: process.env.ERP_PASSWORD,
      }
    });

    return response.data.result.session_id;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ù…ØµØ§Ø¯Ù‚Ø© Odoo:', error);
    throw error;
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø±ÙŠÙƒ ÙÙŠ Odoo
async createOdooPartner(beneficiary: any) {
  try {
    const sessionId = await this.authenticateOdoo();

    const response = await axios.post(`${this.apiBaseUrl}/web/dataset/call_kw`, {
      jsonrpc: '2.0',
      params: {
        model: 'res.partner',
        method: 'create',
        args: [{
          name: beneficiary.name,
          email: beneficiary.email,
          phone: beneficiary.phone,
          street: beneficiary.address.street,
          city: beneficiary.address.city,
          is_company: false,
        }],
        kwargs: {}
      }
    }, {
      headers: {
        'Cookie': `session_id=${sessionId}`
      }
    });

    return response.data.result;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø±ÙŠÙƒ Odoo:', error);
    throw error;
  }
}
```

### 5. ERPNext

#### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„

```env
ERP_API_URL=https://your-erpnext.com/api
ERP_API_KEY=your-api-key
ERP_API_SECRET=your-api-secret
```

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API

```typescript
// Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ ÙÙŠ ERPNext
async createERPNextCustomer(beneficiary: any) {
  try {
    const response = await this.apiClient.post('/resource/Customer', {
      customer_name: beneficiary.name,
      customer_type: 'Individual',
      territory: 'Saudi Arabia',
      customer_group: 'Beneficiaries',
    });

    return response.data;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ ERPNext:', error);
    throw error;
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© ÙÙŠ ERPNext
async createERPNextInvoice(beneficiaryId: string, items: any[]) {
  try {
    const response = await this.apiClient.post('/resource/Sales Invoice', {
      customer: beneficiaryId,
      posting_date: new Date().toISOString().split('T')[0],
      due_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
      items: items.map(item => ({
        item_code: item.itemCode,
        item_name: item.description,
        qty: item.quantity,
        rate: item.unitPrice,
      }))
    });

    return response.data;
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© ERPNext:', error);
    throw error;
  }
}
```

---

## ğŸ”„ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªÙÙŠØ¯ Ø¬Ø¯ÙŠØ¯

```typescript
async function registerNewBeneficiary(beneficiaryData: any) {
  const erpIntegration = new ERPIntegration();

  try {
    // 1. Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
    const beneficiary = await saveBeneficiaryLocally(beneficiaryData);

    // 2. Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ ERP
    const syncResult = await erpIntegration.syncBeneficiary(beneficiary.id);

    // 3. Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù…Ø§Ù„ÙŠ
    const accountResult = await erpIntegration.createFinancialAccount(
      beneficiary.id
    );

    // 4. Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ØªØ±Ø­ÙŠØ¨ÙŠ
    await erpIntegration.sendNotification(
      beneficiary.id,
      'sms',
      'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ',
      `Ø£Ù‡Ù„Ø§Ù‹ ${beneficiary.name}ØŒ ØªÙ… ØªØ³Ø¬ÙŠÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ²`
    );

    console.log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­');
    return { beneficiary, syncResult, accountResult };
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯:', error);
    throw error;
  }
}
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø´Ù‡Ø±ÙŠØ©

```typescript
async function createMonthlyInvoice(beneficiaryId: string, month: string) {
  const erpIntegration = new ERPIntegration();

  try {
    // 1. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ø´Ù‡Ø±
    const sessions = await getMonthSessions(beneficiaryId, month);

    // 2. Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©
    const items = sessions.map(session => ({
      description: `Ø¬Ù„Ø³Ø© ${session.programType} - ${session.date}`,
      quantity: 1,
      unitPrice: session.cost,
      total: session.cost,
    }));

    const totalAmount = items.reduce((sum, item) => sum + item.total, 0);

    // 3. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙÙŠ ERP
    const invoice = await erpIntegration.createInvoice(
      beneficiaryId,
      items,
      totalAmount,
      new Date(Date.now() + 15 * 24 * 60 * 60 * 1000).toISOString() // Ø§Ø³ØªØ­Ù‚Ø§Ù‚ Ø¨Ø¹Ø¯ 15 ÙŠÙˆÙ…
    );

    // 4. Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    await erpIntegration.sendNotification(
      beneficiaryId,
      'email',
      'ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©',
      `ØªÙ… Ø¥ØµØ¯Ø§Ø± ÙØ§ØªÙˆØ±Ø© Ø¨Ù…Ø¨Ù„Øº ${totalAmount} Ø±ÙŠØ§Ù„. Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: ${invoice.data.invoiceNumber}`
    );

    console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©:', invoice.data.invoiceNumber);
    return invoice;
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©:', error);
    throw error;
  }
}
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹Ø© ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø³Ø§Ø¨

```typescript
async function processPayment(paymentData: any) {
  const erpIntegration = new ERPIntegration();

  try {
    // 1. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹Ø© ÙÙŠ ERP
    const payment = await erpIntegration.recordPayment(
      paymentData.beneficiaryId,
      paymentData.amount,
      paymentData.method,
      paymentData.reference
    );

    // 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯
    const summary = await erpIntegration.getFinancialSummary(
      paymentData.beneficiaryId
    );

    // 3. Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…
    await erpIntegration.sendNotification(
      paymentData.beneficiaryId,
      'sms',
      'Ø¥ÙŠØµØ§Ù„ Ø¯ÙØ¹',
      `ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¯ÙØ¹Ø© Ø¨Ù…Ø¨Ù„Øº ${paymentData.amount} Ø±ÙŠØ§Ù„. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${summary.data.balance} Ø±ÙŠØ§Ù„`
    );

    // 4. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±ØµÙŠØ¯ ØµÙØ±ØŒ Ø¥Ø±Ø³Ø§Ù„ Ø´Ù‡Ø§Ø¯Ø© Ø¥Ø®Ù„Ø§Ø¡ Ø·Ø±Ù
    if (summary.data.balance === 0) {
      await sendClearanceCertificate(paymentData.beneficiaryId);
    }

    console.log('âœ… ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¯ÙØ¹Ø© Ø¨Ù†Ø¬Ø§Ø­');
    return { payment, summary };
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¯ÙØ¹Ø©:', error);
    throw error;
  }
}
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 4: Ø¬Ø¯ÙˆÙ„Ø© Ù…ÙˆØ¹Ø¯ ÙˆØ­Ø¬Ø² Ù…ÙˆØ§Ø±Ø¯

```typescript
async function scheduleAppointment(appointmentData: any) {
  const erpIntegration = new ERPIntegration();

  try {
    // 1. Ø­Ø¬Ø² Ø§Ù„ØºØ±ÙØ©
    const roomBooking = await erpIntegration.bookResource(
      'room',
      appointmentData.roomId,
      appointmentData.beneficiaryId,
      appointmentData.therapistId,
      appointmentData.startTime,
      appointmentData.endTime,
      'Ø¬Ù„Ø³Ø© Ø¹Ù„Ø§Ø¬ÙŠØ©'
    );

    // 2. Ø­Ø¬Ø² Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
    const equipmentBookings = await Promise.all(
      appointmentData.equipment.map(eq =>
        erpIntegration.bookResource(
          'equipment',
          eq.id,
          appointmentData.beneficiaryId,
          appointmentData.therapistId,
          appointmentData.startTime,
          appointmentData.endTime,
          'Ø¬Ù„Ø³Ø© Ø¹Ù„Ø§Ø¬ÙŠØ©'
        )
      )
    );

    // 3. ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬
    await updateTherapistSchedule(
      appointmentData.therapistId,
      appointmentData.startTime,
      appointmentData.endTime
    );

    // 4. Ø¥Ø±Ø³Ø§Ù„ ØªØ°ÙƒÙŠØ± Ø¨Ø§Ù„Ù…ÙˆØ¹Ø¯
    await erpIntegration.sendNotification(
      appointmentData.beneficiaryId,
      'sms',
      'ØªØ°ÙƒÙŠØ± Ø¨Ø§Ù„Ù…ÙˆØ¹Ø¯',
      `Ù„Ø¯ÙŠÙƒ Ù…ÙˆØ¹Ø¯ ØºØ¯Ø§Ù‹ ${appointmentData.startTime} ÙÙŠ ${roomBooking.data.location}`
    );

    console.log('âœ… ØªÙ… Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­');
    return { roomBooking, equipmentBookings };
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…ÙˆØ¹Ø¯:', error);
    throw error;
  }
}
```

---

## ğŸ” Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª

### 1. Ø­Ù…Ø§ÙŠØ© Ù…ÙØ§ØªÙŠØ­ API

```typescript
// âŒ Ø³ÙŠØ¡ - Ù„Ø§ ØªÙØ¹Ù„ Ù‡Ø°Ø§
const apiKey = 'sk-1234567890abcdef';

// âœ… Ø¬ÙŠØ¯ - Ø§Ø³ØªØ®Ø¯Ù… Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
const apiKey = process.env.ERP_API_KEY;

// âœ… Ø£ÙØ¶Ù„ - Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø¯ÙŠØ± Ø£Ø³Ø±Ø§Ø±
import { SecretsManager } from '@aws-sdk/client-secrets-manager';
const apiKey = await getSecretFromVault('erp-api-key');
```

### 2. ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©

```typescript
import crypto from 'crypto';

function encryptSensitiveData(data: string): string {
  const algorithm = 'aes-256-cbc';
  const key = Buffer.from(process.env.ENCRYPTION_KEY!, 'hex');
  const iv = crypto.randomBytes(16);

  const cipher = crypto.createCipheriv(algorithm, key, iv);
  let encrypted = cipher.update(data, 'utf8', 'hex');
  encrypted += cipher.final('hex');

  return iv.toString('hex') + ':' + encrypted;
}

function decryptSensitiveData(encryptedData: string): string {
  const algorithm = 'aes-256-cbc';
  const key = Buffer.from(process.env.ENCRYPTION_KEY!, 'hex');

  const parts = encryptedData.split(':');
  const iv = Buffer.from(parts[0], 'hex');
  const encrypted = parts[1];

  const decipher = crypto.createDecipheriv(algorithm, key, iv);
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');

  return decrypted;
}
```

### 3. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†

```typescript
try {
  await erpIntegration.syncBeneficiary(id);
} catch (error) {
  // âŒ Ø³ÙŠØ¡ - Ù‚Ø¯ ÙŠÙƒØ´Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø©
  console.error('Error:', error);

  // âœ… Ø¬ÙŠØ¯ - Ø±Ø³Ø§Ø¦Ù„ Ø¹Ø§Ù…Ø©
  console.error('ÙØ´Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ ERP');

  // âœ… Ø£ÙØ¶Ù„ - ØªØ³Ø¬ÙŠÙ„ Ù…ÙØµÙ„ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙÙ‚Ø·
  logger.error('ERP sync failed', {
    beneficiaryId: id,
    error: error.message,
    stack: error.stack,
  });

  // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
  throw new Error('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.');
}
```

### 4. ØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Rate Limiting)

```typescript
import rateLimit from 'express-rate-limit';

const erpLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 Ø¯Ù‚ÙŠÙ‚Ø©
  max: 100, // Ø­Ø¯ Ø£Ù‚ØµÙ‰ 100 Ø·Ù„Ø¨ Ù„ÙƒÙ„ IP
  message: 'ØªÙ… ØªØ¬Ø§ÙˆØ² Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.',
});

// ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø±Ø§Øª ERP
app.use('/api/rehab-agi/erp', erpLimiter);
```

### 5. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```typescript
import Joi from 'joi';

const invoiceSchema = Joi.object({
  beneficiaryId: Joi.string()
    .required()
    .pattern(/^BEN-\d+$/),
  items: Joi.array().min(1).required(),
  totalAmount: Joi.number().positive().required(),
  dueDate: Joi.date().iso().min('now').required(),
});

function validateInvoiceData(data: any) {
  const { error, value } = invoiceSchema.validate(data);

  if (error) {
    throw new Error(`Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø©: ${error.details[0].message}`);
  }

  return value;
}
```

---

## ğŸ“Š Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ§Ù„ØµÙŠØ§Ù†Ø©

### 1. Ù…Ø±Ø§Ù‚Ø¨Ø© ØµØ­Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„

```typescript
async function checkERPHealth(): Promise<boolean> {
  try {
    const response = await axios.get(`${process.env.ERP_API_URL}/health`, {
      timeout: 5000,
    });

    return response.status === 200;
  } catch (error) {
    console.error('ERP health check failed:', error);
    return false;
  }
}

// ÙØ­Øµ Ø¯ÙˆØ±ÙŠ ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
setInterval(
  async () => {
    const isHealthy = await checkERPHealth();

    if (!isHealthy) {
      // Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
      await sendAlertToAdmins('Ù†Ø¸Ø§Ù… ERP ØºÙŠØ± Ù…ØªØ§Ø­');
    }
  },
  5 * 60 * 1000
);
```

### 2. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª

```typescript
import winston from 'winston';

const erpLogger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  defaultMeta: { service: 'erp-integration' },
  transports: [
    new winston.transports.File({ filename: 'erp-error.log', level: 'error' }),
    new winston.transports.File({ filename: 'erp-combined.log' }),
  ],
});

// Ø§Ø³ØªØ®Ø¯Ø§Ù…
erpLogger.info('Syncing beneficiary', { beneficiaryId: 'BEN-001' });
erpLogger.error('Sync failed', {
  beneficiaryId: 'BEN-001',
  error: 'Connection timeout',
});
```

### 3. Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡

```typescript
import { performance } from 'perf_hooks';

async function measureERPOperation<T>(
  operation: string,
  fn: () => Promise<T>
): Promise<T> {
  const start = performance.now();

  try {
    const result = await fn();
    const duration = performance.now() - start;

    console.log(`[ERP Metrics] ${operation}: ${duration.toFixed(2)}ms`);

    // Ø­ÙØ¸ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØ­Ù„ÙŠÙ„
    await saveMetric({
      operation,
      duration,
      timestamp: new Date(),
      status: 'success',
    });

    return result;
  } catch (error) {
    const duration = performance.now() - start;

    await saveMetric({
      operation,
      duration,
      timestamp: new Date(),
      status: 'error',
      error: error.message,
    });

    throw error;
  }
}

// Ø§Ø³ØªØ®Ø¯Ø§Ù…
const result = await measureERPOperation('sync-beneficiary', () =>
  erpIntegration.syncBeneficiary('BEN-001')
);
```

---

## ğŸ§ª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ­Ø¯Ø© Ù„Ù„ØªÙƒØ§Ù…Ù„

```typescript
import { describe, it, expect, jest } from '@jest/globals';
import { ERPIntegration } from './erp-integration';

describe('ERP Integration', () => {
  let erpIntegration: ERPIntegration;

  beforeEach(() => {
    erpIntegration = new ERPIntegration({
      apiBaseUrl: 'http://localhost:3000/mock-erp',
      apiKey: 'test-key',
    });
  });

  it('should create invoice successfully', async () => {
    const result = await erpIntegration.createInvoice(
      'BEN-001',
      [{ description: 'Test', quantity: 1, unitPrice: 100, total: 100 }],
      100,
      '2026-02-15'
    );

    expect(result.success).toBe(true);
    expect(result.data.invoiceNumber).toBeDefined();
  });

  it('should handle errors gracefully', async () => {
    await expect(
      erpIntegration.syncBeneficiary('INVALID-ID')
    ).rejects.toThrow();
  });
});
```

---

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù…

Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ©:

- ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: erp-support@rehab-agi.com
- ğŸ“š Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚: [REHAB_AGI_README.md](REHAB_AGI_README.md)
- ğŸ’¬ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ: +966-XX-XXXXXXX

---

_Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 30 ÙŠÙ†Ø§ÙŠØ± 2026_
