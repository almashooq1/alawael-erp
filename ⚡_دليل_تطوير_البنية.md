# ุชุญุณููุงุช ุงูุจููุฉ ุงูุชุญุชูุฉ - ุฏููู ุณุฑูุน

# Infrastructure Improvements - Quick Guide

## โ ูุง ุชู ุฅูุฌุงุฒู | Completed

### 1. ุฅูุดุงุก Nginx Reverse Proxy

**ุงูููู**: [nginx/nginx.conf](nginx/nginx.conf) **ุงูุญุงูุฉ**: โ ููุชูู

**ุงููููุฒุงุช**:

- ููุฒุน ุญูู ุจุฎูุงุฑุฒููุฉ least_conn
- ุญูุงูุฉ ูู ูุฌูุงุช DDoS ุจุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช:
  - ูุงุฌูุงุช API: 10 ุทูุจ/ุซุงููุฉ ูุน burst 20
  - ุชุณุฌูู ุงูุฏุฎูู: 5 ุทูุจ/ุฏูููุฉ ูุน burst 5
- ุถุบุท Gzip ูููุญุชูู ุงููุตู
- ุชุฎุฒูู ูุคูุช ูููููุงุช ุงูุซุงุจุชุฉ (ุณูุฉ ูุงุญุฏุฉ)
- ุฏุนู WebSocket ูู Socket.IO
- ุฑุคูุณ ุงูุฃูุงู (XSS, Frame Options, ุฅูุฎ)
- ููุทุฉ ูุญุต ุงูุตุญุฉ health check

### 2. ุณูุฑูุจุช ูุงุนุฏุฉ ุงูุจูุงูุงุช PostgreSQL

**ุงูููู**: [backend/database/init.sql](backend/database/init.sql) **ุงูุญุงูุฉ**: โ
ููุชูู

**ุงููุญุชูู**:

- ุฅูุดุงุก schema ุจุงุณู erp
- ุฌุฏุงูู: users, sessions, audit_logs, permissions, roles, role_permissions
- ููุงุฑุณ ูุญุณููุฉ ููุฃุฏุงุก
- ุฏุนู ุงูุจุญุซ ุงููุตู ุงููุงูู
- ุจูุงูุงุช ุงูุชุฑุงุถูุฉ (ูุณุชุฎุฏู admin + ุฃุฏูุงุฑ ุฃุณุงุณูุฉ)

### 3. ุงูุชูุซูู ุงูุดุงูู

**ุงููููุงุช**:

- [INFRASTRUCTURE_GUIDE.md](INFRASTRUCTURE_GUIDE.md) - ุฏููู ุดุงูู ููุจููุฉ (ูุน
  PostgreSQL)
- [INFRASTRUCTURE_IMPROVEMENTS.md](INFRASTRUCTURE_IMPROVEMENTS.md) - ุงูุชุญุณููุงุช
  ุงููุทุจูุฉ

### 4. ุณูุฑูุจุชุงุช ุงููุดุฑ

**ุงููููุงุช**:

- [deploy.sh](deploy.sh) - โณ ูุญุชุงุฌ ุชุญุฏูุซ (Linux/Mac)
- [deploy.ps1](deploy.ps1) - โณ ูุญุชุงุฌ ุชุญุฏูุซ (Windows)

## ๐ ุงูุจููุฉ ุงูุญุงููุฉ | Current Architecture

```
                    ุงููุณุชุฎุฏููู | Users
                          โ
            โโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ   Nginx (Port 80)       โ โ โ ุฌุฏูุฏ | New
            โ   Reverse Proxy         โ
            โโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
                        โ
            โโโโโโโโโโโโโดโโโโโโโโโโโโโโโ
            โ                          โ
    โโโโโโโโโผโโโโโโโโโ        โโโโโโโโโผโโโโโโโโโ
    โ Frontend:3000  โ        โ Backend:3001   โ
    โ   React SPA    โ        โ  Node.js API   โ
    โโโโโโโโโโโโโโโโโโ        โโโโโโโโโโฌโโโโโโโโ
                                       โ
                        โโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโ
                        โ                            โ
                โโโโโโโโโผโโโโโโโโโ          โโโโโโโโโผโโโโโโโโโ
                โ  MongoDB:27017 โ          โ  Redis:6379    โ
                โ    Database    โ          โ     Cache      โ
                โโโโโโโโโโโโโโโโโโ          โโโโโโโโโโโโโโโโโโ
```

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ | Next Steps

### ุงูุฎูุงุฑ 1: ุฏูุฌ Nginx ูุน Docker Compose

```bash
# ุฅุถุงูุฉ nginx ุฅูู docker-compose.yml
# ุซู ุชุดุบูู:
docker-compose up -d

# ุงููุตูู ุนุจุฑ:
# ุงููุงุฌูุฉ: http://localhost
# ุงูู API: http://localhost/api
```

### ุงูุฎูุงุฑ 2: ุฅุจูุงุก ุงูุฅุนุฏุงุฏ ุงูุญุงูู

```bash
# ุงูุชุดุบูู ุจุฏูู nginx:
docker-compose up -d

# ุงููุตูู ุนุจุฑ:
# ุงููุงุฌูุฉ: http://localhost:3000
# ุงูู API: http://localhost:3001
```

## ๐ ุชุญุณููุงุช ุงูุฃูุงู | Security Improvements

### 1. ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช (Rate Limiting)

```nginx
# ุญูุงูุฉ ูู ูุฌูุงุช DDoS
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=login_limit:10m rate=5r/m;
```

### 2. ุฑุคูุณ ุงูุฃูุงู (Security Headers)

```nginx
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: no-referrer-when-downgrade
```

### 3. ุฃูุงู MongoDB

```yaml
environment:
  MONGO_INITDB_ROOT_USERNAME: admin
  MONGO_INITDB_ROOT_PASSWORD: ูููุฉ_ูุฑูุฑ_ูููุฉ
```

### 4. ุฃูุงู Redis

```yaml
command: redis-server --requirepass ูููุฉ_ูุฑูุฑ_ูููุฉ
```

## ๐ ุชุญุณููุงุช ุงูุฃุฏุงุก | Performance Improvements

### 1. ุงูุชุฎุฒูู ุงููุคูุช ูููููุงุช ุงูุซุงุจุชุฉ

```nginx
# ุชุฎุฒูู ููุฏุฉ ุณูุฉ
location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}
```

### 2. ุถุบุท Gzip

```nginx
gzip on;
gzip_types text/plain text/css application/json;
gzip_min_length 1024;
```

### 3. Connection Pooling

```nginx
upstream backend_api {
    least_conn;
    keepalive 32;
}
```

## ๐ ููููุฉ ุงูุชูููุฐ | How to Deploy

### ุงูุฎุทูุฉ 1: ุชุญุฏูุซ docker-compose.yml

ุฃุถู ุฎุฏูุฉ nginx:

```yaml
nginx:
  image: nginx:alpine
  container_name: alaweal-nginx
  ports:
    - '80:80'
    - '443:443'
  volumes:
    - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
  depends_on:
    - client
    - api
  networks:
    - alaweal-network
  restart: unless-stopped
```

### ุงูุฎุทูุฉ 2: ุชุญุฏูุซ ููุงูุฐ ุงูุฎุฏูุงุช

```yaml
# Frontend - ุฅุฒุงูุฉ ุงููููุฐ ุงููุจุงุดุฑ
client:
  expose:
    - '80'
  # ports:
  #   - "3000:80"  # ุงุญุฐู ูุฐุง

# Backend - ุฅุฒุงูุฉ ุงููููุฐ ุงููุจุงุดุฑ
api:
  expose:
    - '3001'
  # ports:
  #   - "3001:3001"  # ุงุญุฐู ูุฐุง
```

### ุงูุฎุทูุฉ 3: ุชุญุฏูุซ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

```bash
# Frontend
REACT_APP_API_URL=http://localhost/api

# Backend
CORS_ORIGIN=http://localhost
```

### ุงูุฎุทูุฉ 4: ุงูุชุดุบูู ูุงูุงุฎุชุจุงุฑ

```bash
# ุฅููุงู ุงูุฎุฏูุงุช ุงูุญุงููุฉ
docker-compose down

# ุฅุนุงุฏุฉ ุงูุจูุงุก ูุงูุชุดุบูู
docker-compose up -d --build

# ุงูุชุญูู ูู ุญุงูุฉ ุงูุฎุฏูุงุช
docker-compose ps

# ูุดุงูุฏุฉ ุงูุณุฌูุงุช
docker-compose logs -f nginx
```

## ๐งช ุงูุงุฎุชุจุงุฑ | Testing

### ุงุฎุชุจุงุฑ Nginx

```bash
# ุงุฎุชุจุงุฑ ููู ุงูุฅุนุฏุงุฏุงุช
docker run --rm -v $(pwd)/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:alpine nginx -t
```

### ุงุฎุชุจุงุฑ Rate Limiting

```bash
# ุงุฎุชุจุงุฑ ุญุฏ API (ูุฌุจ ุฃู ููุญุธุฑ ุจุนุฏ 10 ุทูุจ/ุซุงููุฉ)
for i in {1..20}; do curl http://localhost/api/health; done

# ุงุฎุชุจุงุฑ ุญุฏ ุชุณุฌูู ุงูุฏุฎูู (ูุฌุจ ุฃู ููุญุธุฑ ุจุนุฏ 5 ุทูุจ/ุฏูููุฉ)
for i in {1..10}; do curl -X POST http://localhost/api/auth/login; done
```

### ุงุฎุชุจุงุฑ Health Checks

```bash
# ุตุญุฉ Nginx
curl http://localhost/health

# ุตุญุฉ Backend
curl http://localhost/api/health

# ุตุญุฉ Frontend
curl http://localhost/
```

## ๐ ูุงุฆูุฉ ุงููุฑุงุฌุนุฉ | Checklist

### ุงููุฑุญูุฉ 1: ุงูุจููุฉ ุงูุฃุณุงุณูุฉ โ

- [x] ุฅูุดุงุก ููู nginx.conf
- [x] ุฅูุดุงุก ุณูุฑูุจุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [x] ุชูุซูู ุงูุจููุฉ ุงูุชุญุชูุฉ
- [x] ูุฑุงุฌุนุฉ docker-compose.yml ุงูุญุงูู

### ุงููุฑุญูุฉ 2: ุงูุฏูุฌ โณ

- [ ] ุฅุถุงูุฉ ุฎุฏูุฉ nginx ุฅูู docker-compose.yml
- [ ] ุชุญุฏูุซ ููุงูุฐ ุงูุฎุฏูุงุช
- [ ] ุชุญุฏูุซ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- [ ] ุงุฎุชุจุงุฑ ุฅุนุฏุงุฏุงุช nginx
- [ ] ูุดุฑ ูุงุฎุชุจุงุฑ ุฌููุน ุงูุฎุฏูุงุช

### ุงููุฑุญูุฉ 3: ุชูููุฉ ุงูุฃูุงู

- [ ] ุฅูุดุงุก ุดูุงุฏุงุช SSL
- [ ] ุชูุนูู HTTPS ูู nginx
- [ ] ุงุฎุชุจุงุฑ Rate Limiting
- [ ] ุงุฎุชุจุงุฑ ุฑุคูุณ ุงูุฃูุงู
- [ ] ุชุทุจูู ุฅุฏุงุฑุฉ ุงูุฃุณุฑุงุฑ

### ุงููุฑุญูุฉ 4: ุงูุฌุงูุฒูุฉ ููุฅูุชุงุฌ

- [ ] ุฅุนุฏุงุฏ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู
- [ ] ุฅุนุฏุงุฏ ุงููุฑุงูุจุฉ ูุงูุชูุจููุงุช
- [ ] ุชุฌููุน ุงูุณุฌูุงุช
- [ ] ุงุฎุชุจุงุฑ ุงูุญูู
- [ ] ุฅููุงู ุงูุชูุซูู

## ๐ ููุงุญุธุงุช ูููุฉ | Important Notes

### ุงููุฑููุงุช ุจูู ุงูุจููุฉ ุงููุฎุทุท ููุง ูุงูุญุงููุฉ:

**ุงููุฎุทุท ุงูุฃุตูู (ูู INFRASTRUCTURE_GUIDE.md)**:

- PostgreSQL ููุงุนุฏุฉ ุจูุงูุงุช ุฑุฆูุณูุฉ
- 7 ุฎุฏูุงุช ุจูุง ูู ุฐูู PgAdmin

**ุงูุจููุฉ ุงูุญุงููุฉ (ูู docker-compose.yml)**:

- MongoDB ููุงุนุฏุฉ ุจูุงูุงุช ุฑุฆูุณูุฉ โ
- Redis ููุชุฎุฒูู ุงููุคูุช โ
- MailCatcher ูุงุฎุชุจุงุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู โ
- Mongo Express ูุฅุฏุงุฑุฉ MongoDB โ
- Redis Commander ูุฅุฏุงุฑุฉ Redis โ

### ุงูุชูุตูุฉ:

ุงูุงุณุชูุฑุงุฑ ูุน MongoDB ูุงูุจููุฉ ุงูุญุงููุฉ ูุน ุฅุถุงูุฉ Nginx ููุทุ ูุฃู:

1. ุงููุธุงู ูุนูู ุจุงููุนู ูุน MongoDB
2. ูุง ุญุงุฌุฉ ููุนุงูุฌุฉ ุงูุจูุงูุงุช ูููููุง
3. MongoDB ููุงุณุจ ุชูุงูุงู ููุชุทุจููุงุช ุงูุญุฏูุซุฉ
4. ุงูุชุญุณููุงุช ุงูุฃูููุฉ ูุงูุฃุฏุงุก ุชุทุจู ุนูู ููุง ุงูุญุงูุชูู

## ๐ฏ ุงูุฅุฌุฑุงุก ุงูููุตู ุจู | Recommended Action

### ุงูุฎูุงุฑ 1: ุฅุถุงูุฉ Nginx ููุท (ููุตู ุจู)

```bash
# 1. ุชุญุฏูุซ docker-compose.yml ุจุฅุถุงูุฉ nginx
# 2. ุชุญุฏูุซ ููุงูุฐ ุงูุฎุฏูุงุช
# 3. ุชุดุบูู ุงููุธุงู
docker-compose up -d --build
```

### ุงูุฎูุงุฑ 2: ุงูุชุฑุญูู ุงููุงูู ุฅูู PostgreSQL (ุงุฎุชูุงุฑู)

```bash
# 1. ุชุตุฏูุฑ ุงูุจูุงูุงุช ูู MongoDB
# 2. ุชุญุฏูุซ docker-compose.yml ููุงุณุชุฎุฏุงู PostgreSQL
# 3. ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุฅูู PostgreSQL
# 4. ุชุญุฏูุซ ููุฏ Backend ููุนูู ูุน PostgreSQL
```

## ๐ ููุงุฑุฏ ุฅุถุงููุฉ | Additional Resources

- [Nginx Documentation](https://nginx.org/en/docs/)
- [MongoDB Best Practices](https://docs.mongodb.com/manual/administration/production-notes/)
- [Redis Best Practices](https://redis.io/topics/optimization)
- [Docker Compose Production](https://docs.docker.com/compose/production/)

---

**ุงููุณุฎุฉ**: 1.0 **ุขุฎุฑ ุชุญุฏูุซ**: 20 ููุงูุฑ 2026 **ุงูุญุงูุฉ**: Nginx ุฌุงูุฒุ ูู ุงูุชุธุงุฑ
ุงูุฏูุฌ ูุน docker-compose
