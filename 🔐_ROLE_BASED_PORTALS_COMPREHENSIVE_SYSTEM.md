# ğŸ” Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø±

## Role-Based Portal System with Branch & Shift Management

**Ø§Ù„ØªØ§Ø±ÙŠØ®**: ÙŠÙ†Ø§ÙŠØ± 17ØŒ 2026  
**Ø§Ù„Ù†Ø³Ø®Ø©**: 1.0  
**Ø§Ù„Ø­Ø§Ù„Ø©**: Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ·Ø¨ÙŠÙ‚

---

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚ 1ï¸âƒ£ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø©    â”€â”€â”€â”€â”€â”€â†’ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ + Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø© â”‚
â”‚                                                                   â”‚
â”‚ 2ï¸âƒ£ Ø¨ÙˆØ§Ø¨Ø© Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ÙØ±ÙˆØ¹     â”€â”€â”€â”€â”€â”€â†’ ÙØ±Ø¹Ù‡Ù… ÙÙ‚Ø· + Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†          â”‚
â”‚                                                                   â”‚
â”‚ 3ï¸âƒ£ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†         â”€â”€â”€â”€â”€â”€â†’ ÙØ±Ø¹Ù‡Ù… + Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ§Ù…Ù‡Ù…          â”‚
â”‚                                                                   â”‚
â”‚ 4ï¸âƒ£ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†/Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ÙŠÙ† â”€â”€â†’ Ø·Ù„Ø§Ø¨Ù‡Ù… + Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ        â”‚
â”‚                                                                   â”‚
â”‚ 5ï¸âƒ£ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø·Ù„Ø§Ø¨           â”€â”€â”€â”€â”€â”€â†’ Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ© + Ø¯Ø±Ø§Ø³Ø§ØªÙ‡Ù…      â”‚
â”‚                                                                   â”‚
â”‚ 6ï¸âƒ£ Ø¨ÙˆØ§Ø¨Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±     â”€â”€â”€â”€â”€â”€â†’ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø·ÙØ§Ù„Ù‡Ù… ÙÙ‚Ø·         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¢ 1. Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© (Admin Portal)

### Ø§Ù„ÙˆØµÙˆÙ„ ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

```javascript
// backend/models/role.model.js
const AdminRole = {
  name: 'admin',
  title: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… / Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø©',
  description: 'Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
  permissions: [
    'view_all_branches',
    'manage_branches',
    'view_all_departments',
    'manage_departments',
    'view_all_users',
    'manage_users',
    'view_reports',
    'export_data',
    'manage_shifts',
    'manage_schedule',
    'view_analytics',
  ],
  canViewBranches: ['all'], // Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹
  canEditBranches: ['all'],
};
```

### Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Dashboard)

```jsx
// frontend/src/pages/admin/AdminDashboard.jsx

import React, { useState, useEffect } from 'react';
import {
  Box,
  Grid,
  Card,
  CardContent,
  Typography,
  Button,
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableRow,
  Tabs,
  Tab,
  Paper,
} from '@mui/material';

export const AdminDashboard = () => {
  const [branches, setBranches] = useState([]);
  const [selectedTab, setSelectedTab] = useState(0);
  const [stats, setStats] = useState({
    totalBranches: 0,
    totalUsers: 0,
    totalStudents: 0,
    totalEmployees: 0,
  });

  useEffect(() => {
    // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹
    fetchAllBranchesData();
    fetchStats();
  }, []);

  const fetchAllBranchesData = async () => {
    try {
      const response = await fetch('/api/admin/branches', {
        headers: { Authorization: `Bearer ${token}` },
      });
      const data = await response.json();
      setBranches(data); // Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹
    } catch (error) {
      console.error('Error fetching branches:', error);
    }
  };

  const fetchStats = async () => {
    try {
      const response = await fetch('/api/admin/stats', {
        headers: { Authorization: `Bearer ${token}` },
      });
      const data = await response.json();
      setStats(data);
    } catch (error) {
      console.error('Error fetching stats:', error);
    }
  };

  return (
    <Box sx={{ p: 3 }}>
      {/* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø© */}
      <Grid container spacing={2} sx={{ mb: 3 }}>
        <Grid item xs={12} sm={6} md={3}>
          <Card sx={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}>
            <CardContent sx={{ color: 'white' }}>
              <Typography color="inherit" gutterBottom>
                Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±ÙˆØ¹
              </Typography>
              <Typography variant="h4" sx={{ fontWeight: 'bold' }}>
                {stats.totalBranches}
              </Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <Card sx={{ background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)' }}>
            <CardContent sx={{ color: 'white' }}>
              <Typography color="inherit" gutterBottom>
                Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
              </Typography>
              <Typography variant="h4" sx={{ fontWeight: 'bold' }}>
                {stats.totalUsers}
              </Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <Card sx={{ background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)' }}>
            <CardContent sx={{ color: 'white' }}>
              <Typography color="inherit" gutterBottom>
                Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨
              </Typography>
              <Typography variant="h4" sx={{ fontWeight: 'bold' }}>
                {stats.totalStudents}
              </Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <Card sx={{ background: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)' }}>
            <CardContent sx={{ color: 'white' }}>
              <Typography color="inherit" gutterBottom>
                Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
              </Typography>
              <Typography variant="h4" sx={{ fontWeight: 'bold' }}>
                {stats.totalEmployees}
              </Typography>
            </CardContent>
          </Card>
        </Grid>
      </Grid>

      {/* Ø§Ù„ÙØ±ÙˆØ¹ */}
      <Tabs value={selectedTab} onChange={(e, newValue) => setSelectedTab(newValue)} sx={{ mb: 2 }}>
        <Tab label="ğŸ¢ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙØ±ÙˆØ¹" />
        <Tab label="ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±" />
        <Tab label="âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" />
      </Tabs>

      {selectedTab === 0 && (
        <Paper sx={{ overflow: 'hidden' }}>
          <Table>
            <TableHead sx={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}>
              <TableRow>
                <TableCell sx={{ color: 'white', fontWeight: 'bold' }}>Ø§Ù„ÙØ±Ø¹</TableCell>
                <TableCell sx={{ color: 'white', fontWeight: 'bold' }}>Ø§Ù„Ù…ÙˆÙ‚Ø¹</TableCell>
                <TableCell sx={{ color: 'white', fontWeight: 'bold' }}>Ø§Ù„Ù…Ø¯ÙŠØ±</TableCell>
                <TableCell sx={{ color: 'white', fontWeight: 'bold' }}>Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ†</TableCell>
                <TableCell sx={{ color: 'white', fontWeight: 'bold' }}>Ø§Ù„Ø·Ù„Ø§Ø¨</TableCell>
                <TableCell sx={{ color: 'white', fontWeight: 'bold' }}>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {branches.map(branch => (
                <TableRow key={branch._id} hover>
                  <TableCell sx={{ fontWeight: 'bold' }}>{branch.name}</TableCell>
                  <TableCell>{branch.location}</TableCell>
                  <TableCell>{branch.managerName}</TableCell>
                  <TableCell>{branch.employeeCount}</TableCell>
                  <TableCell>{branch.studentCount}</TableCell>
                  <TableCell>
                    <Button size="small" variant="outlined">
                      Ø¹Ø±Ø¶
                    </Button>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </Paper>
      )}
    </Box>
  );
};
```

---

## ğŸª 2. Ø¨ÙˆØ§Ø¨Ø© Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ÙØ±ÙˆØ¹ (Branch Manager Portal)

### Ø§Ù„ÙˆØµÙˆÙ„ ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

```javascript
const BranchManagerRole = {
  name: 'branch_manager',
  title: 'Ù…Ø¯ÙŠØ± Ø§Ù„ÙØ±Ø¹',
  description: 'Ø¥Ø¯Ø§Ø±Ø© ÙØ±Ø¹ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·',
  permissions: ['view_branch_data', 'manage_employees', 'view_schedule', 'manage_schedule', 'view_reports_branch'],
  canViewBranches: ['their_branch_only'],
  canEditBranches: ['their_branch_only'],
  branchRestriction: true, // Ù…Ù‚ÙŠØ¯ Ø¨ÙØ±Ø¹ ÙˆØ§Ø­Ø¯
};
```

### Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙˆØ§Ù„ØªØ­Ù‚Ù‚

```javascript
// backend/middleware/branchRestriction.middleware.js

export const checkBranchAccess = async (req, res, next) => {
  try {
    const user = req.user;
    const branchId = req.params.branchId || req.body.branchId;

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¹Ù…Ù„ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙØ±Ø¹
    if (user.role === 'branch_manager') {
      if (user.branchId !== branchId) {
        return res.status(403).json({
          error: 'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø°Ø§ Ø§Ù„ÙØ±Ø¹',
          message: 'Branch access denied',
        });
      }
    }

    // Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø¯ÙŠÙ‡Ø§ ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„
    if (user.role !== 'admin' && user.role !== 'branch_manager') {
      return res.status(403).json({
        error: 'ØµÙ„Ø§Ø­ÙŠØ© ØºÙŠØ± ÙƒØ§ÙÙŠØ©',
        message: 'Insufficient permissions',
      });
    }

    next();
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
};
```

### Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù…Ø¯ÙŠØ±

```jsx
// frontend/src/pages/branchManager/BranchManagerDashboard.jsx

import React, { useEffect, useState } from 'react';
import { Box, Card, CardContent, Typography, Grid } from '@mui/material';

export const BranchManagerDashboard = () => {
  const [branchData, setBranchData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchBranchData();
  }, []);

  const fetchBranchData = async () => {
    try {
      // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡ ÙÙ‚Ø·
      const response = await fetch('/api/branches/my-branch', {
        headers: { Authorization: `Bearer ${token}` },
      });
      const data = await response.json();
      setBranchData(data);
    } catch (error) {
      console.error('Error:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return <Typography>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</Typography>;

  return (
    <Box sx={{ p: 3 }}>
      <Typography variant="h4" sx={{ mb: 3 }}>
        ğŸ¢ {branchData?.name}
      </Typography>

      <Grid container spacing={2}>
        <Grid item xs={12} sm={6} md={3}>
          <Card>
            <CardContent>
              <Typography variant="h6">Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ†</Typography>
              <Typography variant="h3">{branchData?.employeeCount}</Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <Card>
            <CardContent>
              <Typography variant="h6">Ø§Ù„Ø·Ù„Ø§Ø¨</Typography>
              <Typography variant="h3">{branchData?.studentCount}</Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <Card>
            <CardContent>
              <Typography variant="h6">Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…</Typography>
              <Typography variant="h3">{branchData?.todayAttendance}%</Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={3}>
          <Card>
            <CardContent>
              <Typography variant="h6">Ø§Ù„Ø¯ÙˆØ§Ù…</Typography>
              <Typography variant="body2">ØµØ¨Ø§Ø­: {branchData?.morningShift}</Typography>
              <Typography variant="body2">Ù…Ø³Ø§Ø¡: {branchData?.eveningShift}</Typography>
            </CardContent>
          </Card>
        </Grid>
      </Grid>
    </Box>
  );
};
```

---

## ğŸ‘” 3. Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Employee Portal)

### Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

```javascript
// backend/models/employee.model.js

const EmployeeSchema = new mongoose.Schema({
  name: String,
  email: String,
  phone: String,
  branchId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Branch',
    required: true,
  },
  role: String,
  department: String,

  // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ§Ù…
  schedule: {
    morningShift: {
      startTime: '08:00', // 8 ØµØ¨Ø§Ø­Ø§Ù‹
      endTime: '13:00', // 1 Ø¸Ù‡Ø±Ø§Ù‹
    },
    eveningShift: {
      startTime: '14:00', // 2 Ù…Ø³Ø§Ø¡Ù‹
      endTime: '19:00', // 7 Ù…Ø³Ø§Ø¡Ù‹
    },
    currentShift: {
      type: String,
      enum: ['morning', 'evening'],
    },
    workDays: ['Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday'], // Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„
  },

  // Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±
  attendance: [
    {
      date: Date,
      shift: { type: String, enum: ['morning', 'evening'] },
      checkIn: Date,
      checkOut: Date,
      status: {
        type: String,
        enum: ['present', 'absent', 'late', 'early_leave'],
      },
    },
  ],

  // Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
  leaves: [
    {
      startDate: Date,
      endDate: Date,
      type: { type: String, enum: ['sick', 'personal', 'annual'] },
      approved: Boolean,
    },
  ],

  createdAt: { type: Date, default: Date.now },
});

const EmployeeRole = {
  name: 'employee',
  title: 'Ù…ÙˆØ¸Ù',
  description: 'Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ø¹Ù‡ ÙˆØ§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ',
  permissions: [
    'view_own_schedule',
    'view_own_attendance',
    'view_own_leaves',
    'request_leave',
    'view_branch_employees', // Ø²Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙØ±Ø¹ ÙÙ‚Ø·
  ],
  canViewBranches: ['their_branch_only'],
  branchRestriction: true,
};
```

### Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ¸Ù

```jsx
// frontend/src/pages/employee/EmployeeDashboard.jsx

import React, { useEffect, useState } from 'react';
import {
  Box,
  Card,
  CardContent,
  Typography,
  Grid,
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableRow,
  Chip,
  Button,
  Dialog,
  TextField,
  FormControl,
  InputLabel,
  Select,
  MenuItem,
} from '@mui/material';

export const EmployeeDashboard = () => {
  const [employee, setEmployee] = useState(null);
  const [attendance, setAttendance] = useState([]);
  const [schedule, setSchedule] = useState(null);
  const [leaveDialog, setLeaveDialog] = useState(false);
  const [leaveForm, setLeaveForm] = useState({
    startDate: '',
    endDate: '',
    type: 'personal',
    reason: '',
  });

  useEffect(() => {
    fetchEmployeeData();
  }, []);

  const fetchEmployeeData = async () => {
    try {
      const response = await fetch('/api/employees/me', {
        headers: { Authorization: `Bearer ${token}` },
      });
      const data = await response.json();
      setEmployee(data);
      setSchedule(data.schedule);
      setAttendance(data.attendance.slice(-30)); // Ø¢Ø®Ø± 30 ÙŠÙˆÙ…
    } catch (error) {
      console.error('Error:', error);
    }
  };

  const getShiftInfo = shift => {
    if (shift === 'morning') {
      return { label: 'ÙØªØ±Ø© ØµØ¨Ø§Ø­ÙŠØ©', color: 'warning', time: '8:00 - 13:00' };
    } else if (shift === 'evening') {
      return { label: 'ÙØªØ±Ø© Ù…Ø³Ø§Ø¦ÙŠØ©', color: 'info', time: '14:00 - 19:00' };
    }
    return { label: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯', color: 'default', time: '' };
  };

  const handleLeaveRequest = async () => {
    try {
      const response = await fetch('/api/employees/request-leave', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${token}`,
        },
        body: JSON.stringify(leaveForm),
      });
      if (response.ok) {
        alert('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø¨Ù†Ø¬Ø§Ø­');
        setLeaveDialog(false);
        fetchEmployeeData();
      }
    } catch (error) {
      console.error('Error:', error);
    }
  };

  if (!employee) return <Typography>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</Typography>;

  const shiftInfo = getShiftInfo(schedule?.currentShift);

  return (
    <Box sx={{ p: 3 }}>
      <Typography variant="h4" sx={{ mb: 3 }}>
        ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ {employee.name}
      </Typography>

      {/* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ */}
      <Grid container spacing={2} sx={{ mb: 3 }}>
        <Grid item xs={12} sm={6} md={4}>
          <Card sx={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}>
            <CardContent sx={{ color: 'white' }}>
              <Typography variant="body2" gutterBottom>
                ÙØªØ±Ø© Ø§Ù„Ø¯ÙˆØ§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©
              </Typography>
              <Typography variant="h5" sx={{ fontWeight: 'bold', mb: 1 }}>
                {shiftInfo.label}
              </Typography>
              <Typography variant="body2">â° {shiftInfo.time}</Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={4}>
          <Card>
            <CardContent>
              <Typography variant="body2" color="textSecondary" gutterBottom>
                Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„
              </Typography>
              <Box sx={{ mt: 2 }}>
                <Typography variant="body2">
                  ğŸŒ… ØµØ¨Ø§Ø­ÙŠ: {schedule?.morningShift?.startTime} - {schedule?.morningShift?.endTime}
                </Typography>
                <Typography variant="body2" sx={{ mt: 1 }}>
                  ğŸŒ™ Ù…Ø³Ø§Ø¦ÙŠ: {schedule?.eveningShift?.startTime} - {schedule?.eveningShift?.endTime}
                </Typography>
              </Box>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} sm={6} md={4}>
          <Card>
            <CardContent>
              <Typography variant="body2" color="textSecondary" gutterBottom>
                Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„
              </Typography>
              <Box sx={{ mt: 1, display: 'flex', flexWrap: 'wrap', gap: 1 }}>
                {schedule?.workDays?.map(day => (
                  <Chip key={day} label={day} size="small" variant="outlined" />
                ))}
              </Box>
            </CardContent>
          </Card>
        </Grid>
      </Grid>

      {/* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± */}
      <Card sx={{ mb: 3 }}>
        <CardContent>
          <Typography variant="h6" sx={{ mb: 2 }}>
            ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± (Ø¢Ø®Ø± 30 ÙŠÙˆÙ…)
          </Typography>
          <Table size="small">
            <TableHead sx={{ background: '#f5f5f5' }}>
              <TableRow>
                <TableCell>Ø§Ù„ØªØ§Ø±ÙŠØ®</TableCell>
                <TableCell>Ø§Ù„ÙØªØ±Ø©</TableCell>
                <TableCell>Ø§Ù„Ø­Ø¶ÙˆØ±</TableCell>
                <TableCell>ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</TableCell>
                <TableCell>ÙˆÙ‚Øª Ø§Ù„Ø®Ø±ÙˆØ¬</TableCell>
                <TableCell>Ø§Ù„Ø­Ø§Ù„Ø©</TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {attendance.map(record => (
                <TableRow key={record._id}>
                  <TableCell>{new Date(record.date).toLocaleDateString('ar-SA')}</TableCell>
                  <TableCell>{record.shift === 'morning' ? 'ğŸŒ… ØµØ¨Ø§Ø­ÙŠ' : 'ğŸŒ™ Ù…Ø³Ø§Ø¦ÙŠ'}</TableCell>
                  <TableCell>
                    {record.checkIn ? (
                      <Typography sx={{ color: 'green' }}>âœ“ Ø­Ø§Ø¶Ø±</Typography>
                    ) : (
                      <Typography sx={{ color: 'red' }}>âœ— ØºØ§Ø¦Ø¨</Typography>
                    )}
                  </TableCell>
                  <TableCell>{record.checkIn ? new Date(record.checkIn).toLocaleTimeString('ar-SA') : '-'}</TableCell>
                  <TableCell>{record.checkOut ? new Date(record.checkOut).toLocaleTimeString('ar-SA') : '-'}</TableCell>
                  <TableCell>
                    <Chip label={record.status} size="small" color={record.status === 'present' ? 'success' : 'warning'} />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </CardContent>
      </Card>

      {/* Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© */}
      <Card>
        <CardContent>
          <Typography variant="h6" sx={{ mb: 2 }}>
            ğŸ—“ï¸ Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©
          </Typography>
          <Button variant="contained" onClick={() => setLeaveDialog(true)}>
            Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© Ø¬Ø¯ÙŠØ¯Ø©
          </Button>
        </CardContent>
      </Card>

      {/* Dialog Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© */}
      <Dialog open={leaveDialog} onClose={() => setLeaveDialog(false)} maxWidth="sm" fullWidth>
        <DialogContent sx={{ pt: 3 }}>
          <TextField
            label="Ù…Ù† ØªØ§Ø±ÙŠØ®"
            type="date"
            fullWidth
            value={leaveForm.startDate}
            onChange={e => setLeaveForm({ ...leaveForm, startDate: e.target.value })}
            InputLabelProps={{ shrink: true }}
            sx={{ mb: 2 }}
          />
          <TextField
            label="Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®"
            type="date"
            fullWidth
            value={leaveForm.endDate}
            onChange={e => setLeaveForm({ ...leaveForm, endDate: e.target.value })}
            InputLabelProps={{ shrink: true }}
            sx={{ mb: 2 }}
          />
          <FormControl fullWidth sx={{ mb: 2 }}>
            <InputLabel>Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</InputLabel>
            <Select value={leaveForm.type} onChange={e => setLeaveForm({ ...leaveForm, type: e.target.value })} label="Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©">
              <MenuItem value="personal">Ø¥Ø¬Ø§Ø²Ø© Ø´Ø®ØµÙŠØ©</MenuItem>
              <MenuItem value="sick">Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©</MenuItem>
              <MenuItem value="annual">Ø¥Ø¬Ø§Ø²Ø© Ø³Ù†ÙˆÙŠØ©</MenuItem>
            </Select>
          </FormControl>
          <TextField
            label="Ø§Ù„Ø³Ø¨Ø¨"
            fullWidth
            multiline
            rows={3}
            value={leaveForm.reason}
            onChange={e => setLeaveForm({ ...leaveForm, reason: e.target.value })}
            sx={{ mb: 2 }}
          />
          <Box sx={{ display: 'flex', gap: 1 }}>
            <Button variant="outlined" onClick={() => setLeaveDialog(false)}>
              Ø¥Ù„ØºØ§Ø¡
            </Button>
            <Button variant="contained" onClick={handleLeaveRequest}>
              Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
            </Button>
          </Box>
        </DialogContent>
      </Dialog>
    </Box>
  );
};
```

---

## ğŸ‘¨â€ğŸ« 4. Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ø¬ÙŠÙ† (Teacher/Therapist Portal)

```javascript
// backend/models/teacher.model.js

const TeacherSchema = new mongoose.Schema({
  name: String,
  branchId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Branch',
    required: true,
  },
  specialization: String,
  qualifications: [String],

  // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ§Ù…
  schedule: {
    morningShift: {
      startTime: '08:00',
      endTime: '13:00',
      classes: [
        {
          className: String,
          gradeLevel: String,
          startTime: String,
          endTime: String,
          room: String,
        },
      ],
    },
    eveningShift: {
      startTime: '14:00',
      endTime: '19:00',
      classes: [],
    },
    currentShift: { type: String, enum: ['morning', 'evening'] },
  },

  // Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ÙˆÙƒÙˆÙ„ÙŠÙ† Ù„Ù„Ù…Ø¹Ù„Ù…
  assignedStudents: [
    {
      studentId: mongoose.Schema.Types.ObjectId,
      studentName: String,
      gradeLevel: String,
      shift: { type: String, enum: ['morning', 'evening'] },
    },
  ],

  // Ø§Ù„Ø³Ø¬Ù„Ø§Øª
  classRecords: [
    {
      date: Date,
      shift: String,
      className: String,
      attendanceRecord: [
        {
          studentId: mongoose.Schema.Types.ObjectId,
          status: { type: String, enum: ['present', 'absent', 'late'] },
        },
      ],
      notes: String,
    },
  ],

  createdAt: { type: Date, default: Date.now },
});

const TeacherRole = {
  name: 'teacher',
  title: 'Ù…Ø¹Ù„Ù… / Ù…Ø¹Ø§Ù„Ø¬',
  permissions: ['view_own_schedule', 'view_assigned_students', 'manage_attendance', 'upload_grades', 'send_messages_to_parents'],
  branchRestriction: true,
  shiftAware: true,
};
```

### Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¹Ù„Ù…

```jsx
// frontend/src/pages/teacher/TeacherDashboard.jsx

export const TeacherDashboard = () => {
  const [teacher, setTeacher] = useState(null);
  const [schedule, setSchedule] = useState(null);
  const [students, setStudents] = useState([]);
  const [selectedClass, setSelectedClass] = useState(null);

  useEffect(() => {
    fetchTeacherData();
  }, []);

  const fetchTeacherData = async () => {
    const response = await fetch('/api/teachers/me', {
      headers: { Authorization: `Bearer ${token}` },
    });
    const data = await response.json();
    setTeacher(data);
    setSchedule(data.schedule);
    setStudents(data.assignedStudents);
  };

  const markAttendance = async (classId, attendanceData) => {
    await fetch(`/api/teachers/attendance/${classId}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${token}`,
      },
      body: JSON.stringify(attendanceData),
    });
    alert('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±');
  };

  return (
    <Box sx={{ p: 3 }}>
      <Typography variant="h4">ğŸ“š Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…</Typography>

      {/* Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ */}
      <Grid container spacing={2} sx={{ my: 3 }}>
        <Grid item xs={12} md={6}>
          <Card>
            <CardContent>
              <Typography variant="h6">ğŸŒ… Ø§Ù„ÙØªØ±Ø© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©</Typography>
              {schedule?.morningShift?.classes?.map((cls, idx) => (
                <Box key={idx} sx={{ p: 1, my: 1, bgcolor: '#f5f5f5', borderRadius: 1 }}>
                  <Typography variant="body2">
                    {cls.className} - {cls.startTime} Ø¥Ù„Ù‰ {cls.endTime}
                  </Typography>
                  <Typography variant="caption">Ø§Ù„ÙØµÙ„: {cls.room}</Typography>
                </Box>
              ))}
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} md={6}>
          <Card>
            <CardContent>
              <Typography variant="h6">ğŸŒ™ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©</Typography>
              {schedule?.eveningShift?.classes?.map((cls, idx) => (
                <Box key={idx} sx={{ p: 1, my: 1, bgcolor: '#f5f5f5', borderRadius: 1 }}>
                  <Typography variant="body2">
                    {cls.className} - {cls.startTime} Ø¥Ù„Ù‰ {cls.endTime}
                  </Typography>
                  <Typography variant="caption">Ø§Ù„ÙØµÙ„: {cls.room}</Typography>
                </Box>
              ))}
            </CardContent>
          </Card>
        </Grid>
      </Grid>

      {/* Ø§Ù„Ø·Ù„Ø§Ø¨ */}
      <Card>
        <CardContent>
          <Typography variant="h6">ğŸ‘¥ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ÙˆÙƒÙˆÙ„ÙˆÙ†</Typography>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ background: '#f5f5f5' }}>
                <TableCell>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</TableCell>
                <TableCell>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</TableCell>
                <TableCell>Ø§Ù„ÙØªØ±Ø©</TableCell>
                <TableCell>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {students.map(student => (
                <TableRow key={student.studentId}>
                  <TableCell>{student.studentName}</TableCell>
                  <TableCell>{student.gradeLevel}</TableCell>
                  <TableCell>
                    <Chip label={student.shift === 'morning' ? 'ğŸŒ… ØµØ¨Ø§Ø­ÙŠ' : 'ğŸŒ™ Ù…Ø³Ø§Ø¦ÙŠ'} size="small" />
                  </TableCell>
                  <TableCell>
                    <Button size="small" variant="outlined">
                      Ø¹Ø±Ø¶
                    </Button>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </CardContent>
      </Card>
    </Box>
  );
};
```

---

## ğŸ‘¨â€ğŸ“ 5. Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ (Student Portal)

```javascript
const StudentRole = {
  name: 'student',
  title: 'Ø·Ø§Ù„Ø¨',
  permissions: ['view_own_data', 'view_grades', 'view_schedule', 'view_assignments', 'submit_assignments', 'message_teacher'],
  branchRestriction: true,
  shiftAware: true,
  dataRestriction: 'own_data_only',
};
```

### Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø·Ø§Ù„Ø¨

```jsx
// frontend/src/pages/student/StudentDashboard.jsx

export const StudentDashboard = () => {
  const [student, setStudent] = useState(null);
  const [grades, setGrades] = useState([]);
  const [schedule, setSchedule] = useState(null);

  useEffect(() => {
    fetchStudentData();
  }, []);

  const fetchStudentData = async () => {
    const response = await fetch('/api/students/me', {
      headers: { Authorization: `Bearer ${token}` },
    });
    const data = await response.json();
    setStudent(data);
    setGrades(data.grades);
    setSchedule(data.schedule);
  };

  return (
    <Box sx={{ p: 3 }}>
      <Typography variant="h4">ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ {student?.name}</Typography>

      {/* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø´Ø®ØµÙŠØ© */}
      <Grid container spacing={2} sx={{ my: 3 }}>
        <Grid item xs={12} md={6}>
          <Card>
            <CardContent>
              <Typography variant="overline" color="textSecondary">
                Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ©
              </Typography>
              <Typography variant="body2" sx={{ mt: 1 }}>
                ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: {student?.dateOfBirth}
              </Typography>
              <Typography variant="body2">ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: {student?.phone}</Typography>
              <Typography variant="body2">ğŸ¢ Ø§Ù„ÙØ±Ø¹: {student?.branch?.name}</Typography>
              <Typography variant="body2">ğŸ“š Ø§Ù„Ù…Ø³ØªÙˆÙ‰: {student?.gradeLevel}</Typography>
            </CardContent>
          </Card>
        </Grid>

        <Grid item xs={12} md={6}>
          <Card>
            <CardContent>
              <Typography variant="overline" color="textSecondary">
                Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ§Ù…
              </Typography>
              <Typography variant="body2" sx={{ mt: 1, fontWeight: 'bold' }}>
                {student?.schedule?.shift === 'morning' ? 'ğŸŒ… ÙØªØ±Ø© ØµØ¨Ø§Ø­ÙŠØ©' : 'ğŸŒ™ ÙØªØ±Ø© Ù…Ø³Ø§Ø¦ÙŠØ©'}
              </Typography>
              <Typography variant="body2">
                â° {student?.schedule?.startTime} - {student?.schedule?.endTime}
              </Typography>
              <Typography variant="body2">ğŸ›ï¸ Ø§Ù„ÙØµÙ„: {student?.classroom}</Typography>
            </CardContent>
          </Card>
        </Grid>
      </Grid>

      {/* Ø§Ù„Ø¯Ø±Ø¬Ø§Øª */}
      <Card sx={{ mb: 3 }}>
        <CardContent>
          <Typography variant="h6">ğŸ“Š Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</Typography>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ background: '#f5f5f5' }}>
                <TableCell>Ø§Ù„Ù…Ø§Ø¯Ø©</TableCell>
                <TableCell>Ø§Ù„Ø¯Ø±Ø¬Ø©</TableCell>
                <TableCell>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {grades.map(grade => (
                <TableRow key={grade._id}>
                  <TableCell>{grade.subject}</TableCell>
                  <TableCell>{grade.score}/100</TableCell>
                  <TableCell>
                    <Chip label={grade.score >= 80 ? 'Ù…Ù…ØªØ§Ø²' : 'Ø¬ÙŠØ¯'} size="small" color={grade.score >= 80 ? 'success' : 'warning'} />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </CardContent>
      </Card>
    </Box>
  );
};
```

---

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ 6. Ø¨ÙˆØ§Ø¨Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± (Parent Portal)

```javascript
const ParentRole = {
  name: 'parent',
  title: 'ÙˆÙ„ÙŠ Ø£Ù…Ø±',
  permissions: ['view_children_data', 'view_children_grades', 'view_children_attendance', 'message_teacher', 'view_children_schedule'],
  dataRestriction: 'children_data_only',
  branchRestriction: false, // Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù„Ø¯ÙŠÙ‡Ù… Ø£Ø·ÙØ§Ù„ ÙÙŠ ÙØ±ÙˆØ¹ Ù…Ø®ØªÙ„ÙØ©
};
```

### Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±

```jsx
// frontend/src/pages/parent/ParentDashboard.jsx

export const ParentDashboard = () => {
  const [children, setChildren] = useState([]);
  const [selectedChild, setSelectedChild] = useState(null);

  useEffect(() => {
    fetchChildrenData();
  }, []);

  const fetchChildrenData = async () => {
    const response = await fetch('/api/parents/my-children', {
      headers: { Authorization: `Bearer ${token}` },
    });
    const data = await response.json();
    setChildren(data);
    if (data.length > 0) setSelectedChild(data[0]);
  };

  return (
    <Box sx={{ p: 3 }}>
      <Typography variant="h4">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ØªØ§Ø¨Ø¹ Ø£Ø·ÙØ§Ù„Ùƒ</Typography>

      {/* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·ÙÙ„ */}
      <Box sx={{ my: 3, display: 'flex', gap: 1, flexWrap: 'wrap' }}>
        {children.map(child => (
          <Button
            key={child._id}
            variant={selectedChild?._id === child._id ? 'contained' : 'outlined'}
            onClick={() => setSelectedChild(child)}
          >
            {child.name}
          </Button>
        ))}
      </Box>

      {selectedChild && (
        <Grid container spacing={2}>
          {/* Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·ÙÙ„ */}
          <Grid item xs={12} md={6}>
            <Card>
              <CardContent>
                <Typography variant="h6">ğŸ“‹ Ø¨ÙŠØ§Ù†Ø§Øª {selectedChild.name}</Typography>
                <Typography variant="body2" sx={{ mt: 2 }}>
                  ğŸ“š Ø§Ù„Ù…Ø³ØªÙˆÙ‰: {selectedChild.gradeLevel}
                </Typography>
                <Typography variant="body2">ğŸ¢ Ø§Ù„ÙØ±Ø¹: {selectedChild.branch?.name}</Typography>
                <Typography variant="body2">
                  {selectedChild.schedule?.shift === 'morning' ? 'ğŸŒ… ØµØ¨Ø§Ø­ÙŠ' : 'ğŸŒ™ Ù…Ø³Ø§Ø¦ÙŠ'}: {selectedChild.schedule?.startTime} -{' '}
                  {selectedChild.schedule?.endTime}
                </Typography>
              </CardContent>
            </Card>
          </Grid>

          {/* Ø§Ù„Ø¯Ø±Ø¬Ø§Øª ÙˆØ§Ù„Ø­Ø¶ÙˆØ± */}
          <Grid item xs={12} md={6}>
            <Card>
              <CardContent>
                <Typography variant="h6">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</Typography>
                <Typography variant="body2" sx={{ mt: 2 }}>
                  ğŸ¯ Ø§Ù„Ù…Ø¹Ø¯Ù„: {selectedChild.gpa?.toFixed(2)}/4.0
                </Typography>
                <Typography variant="body2">âœ… Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±: {selectedChild.attendancePercentage}%</Typography>
              </CardContent>
            </Card>
          </Grid>

          {/* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª */}
          <Grid item xs={12}>
            <Card>
              <CardContent>
                <Typography variant="h6">ğŸ“ˆ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</Typography>
                <Table size="small">
                  <TableHead>
                    <TableRow sx={{ background: '#f5f5f5' }}>
                      <TableCell>Ø§Ù„Ù…Ø§Ø¯Ø©</TableCell>
                      <TableCell>Ø§Ù„Ù…Ø¹Ù„Ù…</TableCell>
                      <TableCell>Ø§Ù„Ø¯Ø±Ø¬Ø©</TableCell>
                      <TableCell>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</TableCell>
                    </TableRow>
                  </TableHead>
                  <TableBody>
                    {selectedChild.grades?.map(grade => (
                      <TableRow key={grade._id}>
                        <TableCell>{grade.subject}</TableCell>
                        <TableCell>{grade.teacher}</TableCell>
                        <TableCell>{grade.score}</TableCell>
                        <TableCell>
                          <Chip
                            label={grade.score >= 80 ? 'Ù…Ù…ØªØ§Ø²' : 'Ø¬ÙŠØ¯'}
                            size="small"
                            color={grade.score >= 80 ? 'success' : 'warning'}
                          />
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </CardContent>
            </Card>
          </Grid>
        </Grid>
      )}
    </Box>
  );
};
```

---

## â° Ù†Ø¸Ø§Ù… Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© ÙˆØ§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©

### Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ÙØªØ±Ø§Øª

```javascript
// backend/models/shift.model.js

const ShiftSchema = new mongoose.Schema({
  branchId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Branch',
    required: true,
  },
  name: {
    type: String,
    enum: ['morning', 'evening'],
  },
  startTime: String, // "08:00"
  endTime: String, // "13:00"
  breakStartTime: String,
  breakEndTime: String,
  maxCapacity: Number,
  employees: [
    {
      employeeId: mongoose.Schema.Types.ObjectId,
      name: String,
      role: String,
      department: String,
    },
  ],
  classes: [
    {
      classId: mongoose.Schema.Types.ObjectId,
      className: String,
      teacher: String,
      students: Number,
    },
  ],
  createdAt: { type: Date, default: Date.now },
});

module.exports = mongoose.model('Shift', ShiftSchema);
```

### Ø®Ø¯Ù…Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØªØ±Ø§Øª

```javascript
// backend/services/shiftManagement.service.js

class ShiftManagementService {
  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  async getCurrentShift(branchId) {
    const currentTime = new Date().getHours();
    const shift = currentTime < 14 ? 'morning' : 'evening';

    return await Shift.findOne({
      branchId,
      name: shift,
    }).populate(['employees', 'classes']);
  }

  // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø©
  async getEmployeesByShift(branchId, shift) {
    return await Shift.findOne({ branchId, name: shift }).populate('employees');
  }

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ù…Ù„ Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
  async isEmployeeWorkingNow(employeeId) {
    const employee = await Employee.findById(employeeId);
    const currentTime = new Date();
    const currentHour = currentTime.getHours();

    if (currentHour >= 8 && currentHour < 14) {
      return employee.schedule.currentShift === 'morning';
    } else if (currentHour >= 14 && currentHour < 19) {
      return employee.schedule.currentShift === 'evening';
    }
    return false;
  }

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙØªØ±Ø©
  async getShiftStatistics(branchId, shift) {
    const shiftData = await Shift.findOne({ branchId, name: shift });
    const attendance = await Attendance.find({
      branchId,
      shift,
      date: {
        $gte: new Date().setHours(0, 0, 0, 0),
        $lt: new Date().setHours(23, 59, 59, 999),
      },
    });

    return {
      totalEmployees: shiftData?.employees?.length || 0,
      totalClasses: shiftData?.classes?.length || 0,
      presentCount: attendance.filter(a => a.status === 'present').length,
      absentCount: attendance.filter(a => a.status === 'absent').length,
      lateCount: attendance.filter(a => a.status === 'late').length,
      attendance: attendance,
    };
  }
}

module.exports = new ShiftManagementService();
```

---

## ğŸ” Middleware Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

```javascript
// backend/middleware/roleAuthorization.middleware.js

export const authorizeRole = allowedRoles => {
  return (req, res, next) => {
    const userRole = req.user.role;

    if (!allowedRoles.includes(userRole)) {
      return res.status(403).json({
        error: 'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯',
        message: 'Unauthorized',
        userRole,
        allowedRoles,
      });
    }

    next();
  };
};

export const checkBranchAccess = (req, res, next) => {
  const user = req.user;
  const requestedBranchId = req.params.branchId || req.body.branchId;

  // Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø¯ÙŠÙ‡Ø§ ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„
  if (user.role === 'admin') {
    return next();
  }

  // Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ÙØ±ÙˆØ¹ ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙˆÙ† Ù…Ù‚ÙŠØ¯ÙˆÙ† Ø¨ÙØ±Ø¹Ù‡Ù…
  if (['branch_manager', 'employee', 'teacher', 'student'].includes(user.role)) {
    if (user.branchId !== requestedBranchId) {
      return res.status(403).json({
        error: 'Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø°Ø§ Ø§Ù„ÙØ±Ø¹',
        message: 'Branch access denied',
      });
    }
  }

  next();
};

export const checkShiftAccess = (req, res, next) => {
  const user = req.user;
  const requestedShift = req.params.shift || req.body.shift;

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…ÙˆØ¸Ù ÙŠØ¹Ù…Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©
  if (['employee', 'teacher', 'student'].includes(user.role)) {
    if (user.schedule?.currentShift !== requestedShift) {
      return res.status(403).json({
        error: 'Ù„Ø§ ØªØ¹Ù…Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©',
        message: 'Shift access denied',
        userShift: user.schedule?.currentShift,
        requestedShift,
      });
    }
  }

  next();
};
```

---

## ğŸ›£ï¸ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª (Routes)

```javascript
// backend/routes/portals.routes.js

import express from 'express';
import { authorizeRole, checkBranchAccess, checkShiftAccess } from '../middleware/roleAuthorization.middleware';

const router = express.Router();

// Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø©
router.get('/admin/dashboard', authorizeRole(['admin']), adminDashboard);
router.get('/admin/branches', authorizeRole(['admin']), getAllBranches);
router.get('/admin/statistics', authorizeRole(['admin']), getStatistics);

// Ø¨ÙˆØ§Ø¨Ø© Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ÙØ±ÙˆØ¹
router.get('/branch-manager/dashboard', authorizeRole(['branch_manager']), branchManagerDashboard);
router.get('/branch-manager/employees', authorizeRole(['branch_manager']), checkBranchAccess, getEmployeesByBranch);
router.get('/branch-manager/schedule', authorizeRole(['branch_manager']), checkBranchAccess, getBranchSchedule);

// Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
router.get('/employee/dashboard', authorizeRole(['employee']), employeeDashboard);
router.get('/employee/attendance', authorizeRole(['employee']), checkBranchAccess, getEmployeeAttendance);
router.post('/employee/leave-request', authorizeRole(['employee']), checkBranchAccess, requestLeave);

// Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†
router.get('/teacher/dashboard', authorizeRole(['teacher']), teacherDashboard);
router.get('/teacher/classes', authorizeRole(['teacher']), checkBranchAccess, getTeacherClasses);
router.post('/teacher/attendance', authorizeRole(['teacher']), checkBranchAccess, markAttendance);

// Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø·Ù„Ø§Ø¨
router.get('/student/dashboard', authorizeRole(['student']), studentDashboard);
router.get('/student/grades', authorizeRole(['student']), checkBranchAccess, getStudentGrades);
router.get('/student/schedule', authorizeRole(['student']), checkBranchAccess, getStudentSchedule);

// Ø¨ÙˆØ§Ø¨Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±
router.get('/parent/dashboard', authorizeRole(['parent']), parentDashboard);
router.get('/parent/children', authorizeRole(['parent']), getParentChildren);
router.get('/parent/child-grades/:childId', authorizeRole(['parent']), getChildGrades);

export default router;
```

---

## âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚

- âœ… 6 Ø¨ÙˆØ§Ø¨Ø§Øª Ù…Ù†ÙØµÙ„Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
- âœ… Ù†Ø¸Ø§Ù… Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© ÙˆØ§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©
- âœ… Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØ±Ø¹
- âœ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© ØªØ±Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹
- âœ… ÙƒÙ„ ÙØ±Ø¹ ÙŠØ±Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ø¹Ù‡ ÙÙ‚Ø·
- âœ… Ù†Ø¸Ø§Ù… Middleware Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
- âœ… Ø¬Ø¯Ø§ÙˆÙ„ Ø²Ù…Ù†ÙŠØ© Ù…Ø±Ù†Ø©
- âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨
- âœ… Ù†Ø¸Ø§Ù… Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
- âœ… Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª

---

**Ø§Ù„Ø­Ø§Ù„Ø©**: ğŸŸ¢ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙˆØ±ÙŠ âœ…
