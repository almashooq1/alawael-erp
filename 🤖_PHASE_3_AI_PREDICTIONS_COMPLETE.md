# ๐ค Phase 3: AI Prediction System - ุฏููู ุงูุชูุงูู

**ุชุงุฑูุฎ ุงูุฅูุฌุงุฒ:** 20 ููุงูุฑ 2026  
**ุงูุญุงูุฉ:** โ ููุชูู 100%

---

## ๐ ุงููููุงุช ุงูููุดุฃุฉ

### Backend (2 ูููุงุช - 780 ุณุทุฑ)

| ุงูููู                                    | ุงููุตู                | ุงูุฃุณุทุฑ |
| ---------------------------------------- | -------------------- | ------ |
| `backend/services/prediction_service.py` | ุฎุฏูุฉ ุงูุชูุจุคุงุช ุงูุฐููุฉ | 580    |
| `backend/routes/prediction_routes.py`    | ูุณุงุฑุงุช API ุงูุชูุจุคุงุช  | 200    |

### Frontend (3 ูููุงุช - 870 ุณุทุฑ)

| ุงูููู                                                          | ุงููุตู                  | ุงูุฃุณุทุฑ |
| -------------------------------------------------------------- | ---------------------- | ------ |
| `frontend/src/services/predictionService.js`                   | ุฎุฏูุฉ Frontend ููุชูุจุคุงุช | 320    |
| `frontend/src/components/Predictions/PredictionsDashboard.jsx` | ููุญุฉ ุงูุชูุจุคุงุช          | 420    |
| `frontend/src/components/Predictions/PredictionsDashboard.css` | ุฃููุงุท ุงูุชุตููู          | 130    |

**ุฅุฌูุงูู:** 5 ูููุงุช - 1,650 ุณุทุฑ ููุฏ

---

## ๐ฏ ุงูููุฒุงุช

### โ ุฃููุงุน ุงูุชูุจุคุงุช

1. **ุชูุจุคุงุช ุงููุจูุนุงุช** ๐
   - ุงูุชูุจุค ุจุงููุจูุนุงุช ุงูููููุฉ
   - ุญุณุงุจ ุงูุงุชุฌุงู ูุงูููู
   - ุชุญุฏูุฏ ุงูุญุฏูุฏ ุงูุนููุง ูุงูุฏููุง
   - ูุณุชููุงุช ุซูุฉ ูุชุฏุฑุฌุฉ

2. **ุชูุจุคุงุช ุงูุฅูุฑุงุฏุงุช** ๐ฐ
   - ุงูุชูุจุค ุจุงูุฅูุฑุงุฏุงุช ุงูุดูุฑูุฉ
   - ุชุญููู ุงูููุณููุฉ
   - ุญุณุงุจ ูุนุฏู ุงูููู
   - ุงูุชุนุฏููุงุช ุงูููุณููุฉ

3. **ุชูุจุคุงุช ุงูุญุถูุฑ** ๐ฅ
   - ุงูุชูุจุค ุจูุนุฏูุงุช ุงูุญุถูุฑ
   - ุฃููุงุท ุฃูุงู ุงูุฃุณุจูุน
   - ุชููุน ุงูุบูุงุจ
   - ุชุญููู ุงูุฃูุงู ุงูุฃูุถู/ุงูุฃุณูุฃ

4. **ุชูุจุคุงุช ุงููุฎุฒูู** ๐ฆ
   - ุงูุชูุจุค ุจุงูุทูุจ ุนูู ุงูููุชุฌุงุช
   - ุชูุตูุงุช ุฅุนุงุฏุฉ ุงูุทูุจ
   - ุชุญููู ุงูุงุชุฌุงูุงุช
   - ุชุฎุทูุท ุงููุฎุฒูู

5. **ุชุญููู ุชุณุฑุจ ุงูุนููุงุก** ๐ช
   - ุงุญุชูุงููุฉ ููุฏุงู ุงูุนููุงุก
   - ูุณุชููุงุช ุงููุฎุงุทุฑ (ุนุงูู/ูุชูุณุท/ููุฎูุถ)
   - ุชูุตูุงุช ุงูุชุฏุฎู
   - ุชุญููู ุณููู ุงูุนููุงุก

---

## ๐ ุงูุชูุงูู ุงูุณุฑูุน (5 ุฏูุงุฆู)

### ุงูุฎุทูุฉ 1: Backend Setup

#### ุชุณุฌูู Routes ูู app.py

```python
from routes.prediction_routes import prediction_bp

# ุชุณุฌูู Blueprint
app.register_blueprint(prediction_bp)
```

**ููุงุญุธุฉ:** ูุง ุชูุฌุฏ ููุชุจุงุช ุฅุถุงููุฉ ูุทููุจุฉ - ุงููุธุงู ูุณุชุฎุฏู ุงูููุชุจุงุช ุงูููุงุณูุฉ ููุท!

---

### ุงูุฎุทูุฉ 2: Frontend Setup

#### ุฅุถุงูุฉ Route ูู App.js

```jsx
import PredictionsDashboard from './components/Predictions/PredictionsDashboard';
import { PermissionRoute } from './components/Guards/RouteGuards';

// ุฏุงุฎู Routes
<Route
  path="/predictions"
  element={
    <PermissionRoute permission="view_reports">
      <PredictionsDashboard />
    </PermissionRoute>
  }
/>;
```

---

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### Example 1: ุงูุชูุจุค ุจุงููุจูุนุงุช (Backend)

```python
from services.prediction_service import PredictionService

# ุจูุงูุงุช ุชุงุฑูุฎูุฉ
historical_data = [
    {"date": "2024-01-01", "amount": 1000},
    {"date": "2024-01-02", "amount": 1200},
    {"date": "2024-01-03", "amount": 1150}
]

# ุงูุชูุจุค
result = PredictionService.predict_sales({
    "historical_sales": historical_data,
    "days_ahead": 7
})

print(result["predictions"])
# [
#   {"date": "2024-01-04", "predicted_value": 1250, "confidence": 85},
#   ...
# ]
```

### Example 2: ุงุณุชุฏุนุงุก API (Frontend)

```javascript
import PredictionService from './services/predictionService';

// ุงูุชูุจุค ุจุงููุจูุนุงุช
const historicalSales = [
  { date: '2024-01-01', amount: 1000 },
  { date: '2024-01-02', amount: 1200 },
];

const result = await PredictionService.predictSales(historicalSales, 7);
console.log(result.predictions);
```

### Example 3: ุงุณุชุฎุฏุงู ุจูุงูุงุช ุชุฌุฑูุจูุฉ

```javascript
// ุชูููุฏ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ููุงุฎุชุจุงุฑ
const mockData = PredictionService.generateMockSalesData(30);

// ุงุณุชุฎุฏุงููุง ูู ุงูุชูุจุค
const prediction = await PredictionService.predictSales(mockData, 7);
```

---

## ๐งช ุงุฎุชุจุงุฑ API

### 1. ุงูุชูุจุค ุจุงููุจูุนุงุช

```bash
curl -X POST http://localhost:3001/api/predictions/sales \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "historical_sales": [
      {"date": "2024-01-01", "amount": 1000},
      {"date": "2024-01-02", "amount": 1200}
    ],
    "days_ahead": 7
  }'
```

**Response:**

```json
{
  "prediction_type": "sales",
  "predictions": [
    {
      "date": "2024-01-03",
      "predicted_value": 1250.5,
      "confidence": 85.0,
      "lower_bound": 1063.0,
      "upper_bound": 1438.0
    }
  ],
  "analysis": {
    "average_historical": 1100.0,
    "growth_rate": 100.0,
    "trend": "increasing",
    "confidence_level": "medium"
  }
}
```

### 2. ุงูุชูุจุค ุจุงูุฅูุฑุงุฏุงุช

```bash
curl -X POST http://localhost:3001/api/predictions/revenue \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "historical_revenue": [
      {"month": "2024-01", "amount": 50000},
      {"month": "2024-02", "amount": 55000}
    ],
    "months_ahead": 3
  }'
```

### 3. ุชุญููู ุชุณุฑุจ ุงูุนููุงุก

```bash
curl -X POST http://localhost:3001/api/predictions/customer-churn \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "customers": [
      {
        "id": "cust_1",
        "name": "ุฃุญูุฏ ูุญูุฏ",
        "days_since_last_purchase": 95,
        "total_purchases": 2,
        "avg_purchase_value": 45
      }
    ]
  }'
```

**Response:**

```json
{
  "prediction_type": "customer_churn",
  "predictions": [
    {
      "customer_id": "cust_1",
      "customer_name": "ุฃุญูุฏ ูุญูุฏ",
      "churn_probability": 90,
      "risk_level": "high",
      "days_since_last_purchase": 95,
      "recommendation": "engage_immediately"
    }
  ],
  "summary": {
    "total_customers": 1,
    "high_risk": 1,
    "medium_risk": 0,
    "low_risk": 0
  }
}
```

### 4. ุฌููุน ุงูุชูุจุคุงุช

```bash
curl -X GET http://localhost:3001/api/predictions/ \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### 5. ุชุญููู ุฏูุฉ ุงูุชูุจุค

```bash
curl -X POST http://localhost:3001/api/predictions/analyze-accuracy/pred_1 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "actual_data": [
      {"date": "2024-01-03", "value": 1240}
    ]
  }'
```

---

## ๐ ููููุฉ ุนูู ุงูุฎูุงุฑุฒููุงุช

### 1. ุงูุชูุจุค ุจุงููุจูุนุงุช

```python
# ุงูุฎุทูุงุช:
1. ุญุณุงุจ ุงููุชูุณุท ุงูุชุงุฑูุฎู
2. ุญุณุงุจ ูุนุฏู ุงูููู (Growth Rate)
3. ุชููุน ุงูููู ุงููุณุชูุจููุฉ = ุงููุชูุณุท + (ูุนุฏู ุงูููู ร ุงููุชุฑุฉ)
4. ุฅุถุงูุฉ ุชุจุงูู (ยฑ15%) ูุญุณุงุจ ุงูุญุฏูุฏ
5. ุชูููู ุงูุซูุฉ ุชุฏุฑูุฌูุงู ูุน ุงูุจุนุฏ ุงูุฒููู
```

### 2. ุชุญููู ุชุณุฑุจ ุงูุนููุงุก

```python
# ูุนุงููุฑ ุงูุชูููู:
- ุงูููุช ููุฐ ุขุฎุฑ ุดุฑุงุก:
  โข > 90 ููู = +40 ููุทุฉ
  โข 60-90 ููู = +25 ููุทุฉ
  โข 30-60 ููู = +10 ููุทุฉ

- ุนุฏุฏ ุงููุดุชุฑูุงุช:
  โข < 3 ูุดุชุฑูุงุช = +30 ููุทุฉ
  โข 3-5 ูุดุชุฑูุงุช = +15 ููุทุฉ

- ูุชูุณุท ูููุฉ ุงูุดุฑุงุก:
  โข < $50 = +20 ููุทุฉ
  โข $50-$100 = +10 ููุทุฉ

# ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:
- 60+ = ูุฎุงุทุฑ ุนุงููุฉ
- 30-60 = ูุฎุงุทุฑ ูุชูุณุทุฉ
- < 30 = ูุฎุงุทุฑ ููุฎูุถุฉ
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### Dashboard Features

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ๐ค ููุญุฉ ุงูุชูุจุคุงุช ุงูุฐููุฉ             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ [ุงููุจูุนุงุช] [ุงูุฅูุฑุงุฏุงุช] [ุงูุญุถูุฑ] [ุงูุนููุงุก] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                          โ
โ  ๐ ุงูุชุญููู:                            โ
โ  โโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโโ     โ
โ  โ ุงููุชูุณุท  โ  ุงูููู   โ ุงูุงุชุฌุงู  โ     โ
โ  โ $1,100   โ  $100   โ  โ๏ธ ุตุงุนุฏ โ     โ
โ  โโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโโ     โ
โ                                          โ
โ  ๐ ุงูุชูุจุคุงุช:                           โ
โ  โโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโ        โ
โ  โ ุงูุชุงุฑูุฎ โ ุงููููุฉ  โ ุงูุซูุฉ  โ        โ
โ  โโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโค        โ
โ  โ 1-3    โ $1,250  โ 85%   โ        โ
โ  โ 1-4    โ $1,350  โ 83%   โ        โ
โ  โโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโ        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Tabs ูุชุงุญุฉ:

1. **ุงููุจูุนุงุช** - ุงูุชูุจุค ุจุงููุจูุนุงุช ุงูููููุฉ
2. **ุงูุฅูุฑุงุฏุงุช** - ุงูุชูุจุค ุจุงูุฅูุฑุงุฏุงุช ุงูุดูุฑูุฉ
3. **ุงูุญุถูุฑ** - ุงูุชูุจุค ุจูุนุฏูุงุช ุงูุญุถูุฑ
4. **ุชุณุฑุจ ุงูุนููุงุก** - ุชุญููู ูุฎุงุทุฑ ููุฏุงู ุงูุนููุงุก

---

## ๐ง ุงูุชุฎุตูุต

### ุฅุถุงูุฉ ููุน ุชูุจุค ุฌุฏูุฏ

```python
# ูู prediction_service.py

@staticmethod
def predict_new_type(data: Dict[str, Any]) -> Dict[str, Any]:
    """ุงูุชูุจุค ุงูุฌุฏูุฏ"""
    try:
        # 1. ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
        historical_data = data.get('historical_data', [])

        # 2. ุชุทุจูู ุงูุฎูุงุฑุฒููุฉ
        predictions = []

        # 3. ุฅุฑุฌุงุน ุงููุชูุฌุฉ
        return {
            "prediction_type": "new_type",
            "predictions": predictions,
            "analysis": {...}
        }
    except Exception as e:
        return {"error": str(e)}
```

### ุฅุถุงูุฉ Endpoint ุฌุฏูุฏ

```python
# ูู prediction_routes.py

@prediction_bp.route('/new-type', methods=['POST'])
@AuthMiddleware.require_auth
@AuthMiddleware.require_permission(Permission.VIEW_REPORTS)
def predict_new_type():
    """ุชูุจุค ุฌุฏูุฏ"""
    data = request.get_json()
    result = PredictionService.predict_new_type(data)
    return jsonify(result), 200
```

---

## โ๏ธ ุงูุชูููู

### ูุชุบูุฑุงุช ุงูุจูุฆุฉ (ุงุฎุชูุงุฑู)

```env
# ูู .env
PREDICTION_CONFIDENCE_THRESHOLD=70
PREDICTION_MAX_DAYS_AHEAD=90
PREDICTION_CACHE_TTL=3600
```

### ุงุณุชุฎุฏุงููุง ูู ุงูููุฏ

```python
import os

CONFIDENCE_THRESHOLD = float(os.getenv('PREDICTION_CONFIDENCE_THRESHOLD', 70))
```

---

## โ Checklist

- [ ] ุชุณุฌูู prediction_bp ูู app.py
- [ ] ุฅุถุงูุฉ Route ูู Frontend
- [ ] ุงุฎุชุจุงุฑ Sales Prediction Endpoint
- [ ] ุงุฎุชุจุงุฑ Revenue Prediction Endpoint
- [ ] ุงุฎุชุจุงุฑ Attendance Prediction Endpoint
- [ ] ุงุฎุชุจุงุฑ Customer Churn Endpoint
- [ ] ุงุฎุชุจุงุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
- [ ] ุงูุชุฃูุฏ ูู ุงูุตูุงุญูุงุช (view_reports)
- [ ] ุงุฎุชุจุงุฑ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
- [ ] ูุฑุงุฌุนุฉ ุฏูุฉ ุงูุชูุจุคุงุช

---

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### Use Case 1: ุงูุชุฎุทูุท ุงููุงูู

```
1. ุงุณุชุฎุฏู predict_revenue ููุชูุจุค ุจุงูุฅูุฑุงุฏุงุช
2. ุฑุงุฌุน ุงูุชููุนุงุช ุงูุดูุฑูุฉ
3. ุฎุทุท ููููุฒุงููุฉ ุจูุงุกู ุนูู ุงูุชูุจุคุงุช
4. ุฑุงูุจ ุงูุฏูุฉ ุดูุฑูุงู
```

### Use Case 2: ุฅุฏุงุฑุฉ ุงููุฎุฒูู

```
1. ุงุณุชุฎุฏู predict_inventory_demand
2. ุชุญูู ูู ุชูุตูุงุช ุฅุนุงุฏุฉ ุงูุทูุจ
3. ุฎุทุท ูููุดุชุฑูุงุช ูุณุจูุงู
4. ุชุฌูุจ ููุต ุฃู ูุงุฆุถ ุงููุฎุฒูู
```

### Use Case 3: ุงูุงุญุชูุงุธ ุจุงูุนููุงุก

```
1. ุงุณุชุฎุฏู predict_customer_churn
2. ุญุฏุฏ ุงูุนููุงุก ุฐูู ุงููุฎุงุทุฑ ุงูุนุงููุฉ
3. ุชูุงุตู ูุนูู ููุฑุงู
4. ูุฏู ุนุฑูุถ ุฎุงุตุฉ
5. ุฑุงูุจ ุงูุชุญุณู
```

---

## ๐ Troubleshooting

### ูุดููุฉ: "No historical data"

**ุงูุญู:**

```javascript
// ุชุฃูุฏ ูู ุฅุฑุณุงู ุงูุจูุงูุงุช ุจุงูุดูู ุงูุตุญูุญ
const data = [
  { date: '2024-01-01', amount: 1000 },
  // ... ุงููุฒูุฏ
];
```

### ูุดููุฉ: "Insufficient permissions"

**ุงูุญู:**

```python
# ุชุฃูุฏ ูู ุงูุชูุงู ุตูุงุญูุฉ view_reports
user_permissions = AdminService.get_user_permissions(user_id)
# ูุฌุจ ุฃู ุชุญุชูู ุนูู: 'view_reports'
```

### ูุดููุฉ: ูุชุงุฆุฌ ุบูุฑ ุฏูููุฉ

**ุงูุญู:**

```python
# ุงุญุชุงุฌ ุจูุงูุงุช ุฃูุซุฑ:
- ูููุจูุนุงุช: 30+ ููู
- ููุฅูุฑุงุฏุงุช: 12+ ุดูุฑ
- ููุญุถูุฑ: 30+ ููู
```

---

## ๐ ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### Phase 3.5 (ุงุฎุชูุงุฑู)

- [ ] ุชูุงูู ูุน ููุชุจุงุช ML ุงูุญููููุฉ (scikit-learn)
- [ ] ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ (Chart.js)
- [ ] ุชุตุฏูุฑ ุงูุชูุจุคุงุช ุฅูู PDF/Excel
- [ ] ุฌุฏููุฉ ุงูุชูุจุคุงุช ุงูุชููุงุฆูุฉ
- [ ] ุชูุจููุงุช ูููุฎุงุทุฑ ุงูุนุงููุฉ
- [ ] A/B Testing ููุฎูุงุฑุฒููุงุช

---

## ๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ

**Phase 4: Advanced Reports System** ๐

- Report Builder
- Custom Templates
- Scheduled Reports
- Export to Multiple Formats

**ุฌุงูุฒ ูููุชุงุจุนุฉุ** ูู: **"ุงุจุฏุฃ Phase 4"** ๐

---

**ุชุงุฑูุฎ ุงูุฅูุฌุงุฒ:** 20 ููุงูุฑ 2026  
**ุงููุฏุฉ:** ุณุงุนุฉ ูุงุญุฏุฉ  
**ุงูุญุงูุฉ:** โ ููุชูู 100%  
**ุงููููุงุช:** 5 ูููุงุช - 1,650 ุณุทุฑ
